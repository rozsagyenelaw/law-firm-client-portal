var TG=Object.defineProperty;var CG=(n,e,t)=>e in n?TG(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ie=(n,e,t)=>(CG(n,typeof e!="symbol"?e+"":e,t),t),Lk=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var c=(n,e,t)=>(Lk(n,e,"read from private field"),t?t.call(n):e.get(n)),x=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},A=(n,e,t,r)=>(Lk(n,e,"write to private field"),r?r.call(n,t):e.set(n,t),t);var Cn=(n,e,t,r)=>({set _(s){A(n,e,s,t)},get _(){return c(n,e,r)}}),D=(n,e,t)=>(Lk(n,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();var Oi=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ps(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var fU={exports:{}},JT={},pU={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var j_=Symbol.for("react.element"),kG=Symbol.for("react.portal"),NG=Symbol.for("react.fragment"),PG=Symbol.for("react.strict_mode"),IG=Symbol.for("react.profiler"),DG=Symbol.for("react.provider"),RG=Symbol.for("react.context"),MG=Symbol.for("react.forward_ref"),OG=Symbol.for("react.suspense"),LG=Symbol.for("react.memo"),jG=Symbol.for("react.lazy"),xL=Symbol.iterator;function FG(n){return n===null||typeof n!="object"?null:(n=xL&&n[xL]||n["@@iterator"],typeof n=="function"?n:null)}var mU={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},gU=Object.assign,yU={};function py(n,e,t){this.props=n,this.context=e,this.refs=yU,this.updater=t||mU}py.prototype.isReactComponent={};py.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};py.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function vU(){}vU.prototype=py.prototype;function gR(n,e,t){this.props=n,this.context=e,this.refs=yU,this.updater=t||mU}var yR=gR.prototype=new vU;yR.constructor=gR;gU(yR,py.prototype);yR.isPureReactComponent=!0;var SL=Array.isArray,wU=Object.prototype.hasOwnProperty,vR={current:null},bU={key:!0,ref:!0,__self:!0,__source:!0};function _U(n,e,t){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)wU.call(e,r)&&!bU.hasOwnProperty(r)&&(s[r]=e[r]);var o=arguments.length-2;if(o===1)s.children=t;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(n&&n.defaultProps)for(r in o=n.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return{$$typeof:j_,type:n,key:i,ref:a,props:s,_owner:vR.current}}function $G(n,e){return{$$typeof:j_,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function wR(n){return typeof n=="object"&&n!==null&&n.$$typeof===j_}function UG(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var EL=/\/+/g;function jk(n,e){return typeof n=="object"&&n!==null&&n.key!=null?UG(""+n.key):e.toString(36)}function DS(n,e,t,r,s){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var a=!1;if(n===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(n.$$typeof){case j_:case kG:a=!0}}if(a)return a=n,s=s(a),n=r===""?"."+jk(a,0):r,SL(s)?(t="",n!=null&&(t=n.replace(EL,"$&/")+"/"),DS(s,e,t,"",function(u){return u})):s!=null&&(wR(s)&&(s=$G(s,t+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(EL,"$&/")+"/")+n)),e.push(s)),1;if(a=0,r=r===""?".":r+":",SL(n))for(var o=0;o<n.length;o++){i=n[o];var l=r+jk(i,o);a+=DS(i,e,t,l,s)}else if(l=FG(n),typeof l=="function")for(n=l.call(n),o=0;!(i=n.next()).done;)i=i.value,l=r+jk(i,o++),a+=DS(i,e,t,l,s);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function zx(n,e,t){if(n==null)return n;var r=[],s=0;return DS(n,r,"","",function(i){return e.call(t,i,s++)}),r}function VG(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var is={current:null},RS={transition:null},BG={ReactCurrentDispatcher:is,ReactCurrentBatchConfig:RS,ReactCurrentOwner:vR};function xU(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:zx,forEach:function(n,e,t){zx(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return zx(n,function(){e++}),e},toArray:function(n){return zx(n,function(e){return e})||[]},only:function(n){if(!wR(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};We.Component=py;We.Fragment=NG;We.Profiler=IG;We.PureComponent=gR;We.StrictMode=PG;We.Suspense=OG;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=BG;We.act=xU;We.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=gU({},n.props),s=n.key,i=n.ref,a=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=vR.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var o=n.type.defaultProps;for(l in e)wU.call(e,l)&&!bU.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:j_,type:n.type,key:s,ref:i,props:r,_owner:a}};We.createContext=function(n){return n={$$typeof:RG,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:DG,_context:n},n.Consumer=n};We.createElement=_U;We.createFactory=function(n){var e=_U.bind(null,n);return e.type=n,e};We.createRef=function(){return{current:null}};We.forwardRef=function(n){return{$$typeof:MG,render:n}};We.isValidElement=wR;We.lazy=function(n){return{$$typeof:jG,_payload:{_status:-1,_result:n},_init:VG}};We.memo=function(n,e){return{$$typeof:LG,type:n,compare:e===void 0?null:e}};We.startTransition=function(n){var e=RS.transition;RS.transition={};try{n()}finally{RS.transition=e}};We.unstable_act=xU;We.useCallback=function(n,e){return is.current.useCallback(n,e)};We.useContext=function(n){return is.current.useContext(n)};We.useDebugValue=function(){};We.useDeferredValue=function(n){return is.current.useDeferredValue(n)};We.useEffect=function(n,e){return is.current.useEffect(n,e)};We.useId=function(){return is.current.useId()};We.useImperativeHandle=function(n,e,t){return is.current.useImperativeHandle(n,e,t)};We.useInsertionEffect=function(n,e){return is.current.useInsertionEffect(n,e)};We.useLayoutEffect=function(n,e){return is.current.useLayoutEffect(n,e)};We.useMemo=function(n,e){return is.current.useMemo(n,e)};We.useReducer=function(n,e,t){return is.current.useReducer(n,e,t)};We.useRef=function(n){return is.current.useRef(n)};We.useState=function(n){return is.current.useState(n)};We.useSyncExternalStore=function(n,e,t){return is.current.useSyncExternalStore(n,e,t)};We.useTransition=function(){return is.current.useTransition()};We.version="18.3.1";pU.exports=We;var B=pU.exports;const H=Ps(B);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zG=B,HG=Symbol.for("react.element"),WG=Symbol.for("react.fragment"),GG=Object.prototype.hasOwnProperty,qG=zG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,YG={key:!0,ref:!0,__self:!0,__source:!0};function SU(n,e,t){var r,s={},i=null,a=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)GG.call(e,r)&&!YG.hasOwnProperty(r)&&(s[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:HG,type:n,key:i,ref:a,props:s,_owner:qG.current}}JT.Fragment=WG;JT.jsx=SU;JT.jsxs=SU;fU.exports=JT;var d=fU.exports,qN={},EU={exports:{}},di={},AU={exports:{}},TU={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(K,te){var ae=K.length;K.push(te);e:for(;0<ae;){var q=ae-1>>>1,$=K[q];if(0<s($,te))K[q]=te,K[ae]=$,ae=q;else break e}}function t(K){return K.length===0?null:K[0]}function r(K){if(K.length===0)return null;var te=K[0],ae=K.pop();if(ae!==te){K[0]=ae;e:for(var q=0,$=K.length,U=$>>>1;q<U;){var G=2*(q+1)-1,V=K[G],ee=G+1,re=K[ee];if(0>s(V,ae))ee<$&&0>s(re,V)?(K[q]=re,K[ee]=ae,q=ee):(K[q]=V,K[G]=ae,q=G);else if(ee<$&&0>s(re,ae))K[q]=re,K[ee]=ae,q=ee;else break e}}return te}function s(K,te){var ae=K.sortIndex-te.sortIndex;return ae!==0?ae:K.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();n.unstable_now=function(){return a.now()-o}}var l=[],u=[],h=1,f=null,p=3,g=!1,v=!1,y=!1,_=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(K){for(var te=t(u);te!==null;){if(te.callback===null)r(u);else if(te.startTime<=K)r(u),te.sortIndex=te.expirationTime,e(l,te);else break;te=t(u)}}function T(K){if(y=!1,S(K),!v)if(t(l)!==null)v=!0,X(P);else{var te=t(u);te!==null&&J(T,te.startTime-K)}}function P(K,te){v=!1,y&&(y=!1,w(C),C=-1),g=!0;var ae=p;try{for(S(te),f=t(l);f!==null&&(!(f.expirationTime>te)||K&&!L());){var q=f.callback;if(typeof q=="function"){f.callback=null,p=f.priorityLevel;var $=q(f.expirationTime<=te);te=n.unstable_now(),typeof $=="function"?f.callback=$:f===t(l)&&r(l),S(te)}else r(l);f=t(l)}if(f!==null)var U=!0;else{var G=t(u);G!==null&&J(T,G.startTime-te),U=!1}return U}finally{f=null,p=ae,g=!1}}var R=!1,k=null,C=-1,I=5,M=-1;function L(){return!(n.unstable_now()-M<I)}function F(){if(k!==null){var K=n.unstable_now();M=K;var te=!0;try{te=k(!0,K)}finally{te?O():(R=!1,k=null)}}else R=!1}var O;if(typeof b=="function")O=function(){b(F)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,Z=Y.port2;Y.port1.onmessage=F,O=function(){Z.postMessage(null)}}else O=function(){_(F,0)};function X(K){k=K,R||(R=!0,O())}function J(K,te){C=_(function(){K(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(K){K.callback=null},n.unstable_continueExecution=function(){v||g||(v=!0,X(P))},n.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<K?Math.floor(1e3/K):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(K){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var ae=p;p=te;try{return K()}finally{p=ae}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(K,te){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ae=p;p=K;try{return te()}finally{p=ae}},n.unstable_scheduleCallback=function(K,te,ae){var q=n.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?q+ae:q):ae=q,K){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=ae+$,K={id:h++,callback:te,priorityLevel:K,startTime:ae,expirationTime:$,sortIndex:-1},ae>q?(K.sortIndex=ae,e(u,K),t(l)===null&&K===t(u)&&(y?(w(C),C=-1):y=!0,J(T,ae-q))):(K.sortIndex=$,e(l,K),v||g||(v=!0,X(P))),K},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(K){var te=p;return function(){var ae=p;p=te;try{return K.apply(this,arguments)}finally{p=ae}}}})(TU);AU.exports=TU;var KG=AU.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XG=B,ui=KG;function oe(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CU=new Set,h0={};function Df(n,e){qg(n,e),qg(n+"Capture",e)}function qg(n,e){for(h0[n]=e,n=0;n<e.length;n++)CU.add(e[n])}var $l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),YN=Object.prototype.hasOwnProperty,QG=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,AL={},TL={};function JG(n){return YN.call(TL,n)?!0:YN.call(AL,n)?!1:QG.test(n)?TL[n]=!0:(AL[n]=!0,!1)}function ZG(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function eq(n,e,t,r){if(e===null||typeof e>"u"||ZG(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function as(n,e,t,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){gr[n]=new as(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];gr[e]=new as(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){gr[n]=new as(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){gr[n]=new as(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){gr[n]=new as(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){gr[n]=new as(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){gr[n]=new as(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){gr[n]=new as(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){gr[n]=new as(n,5,!1,n.toLowerCase(),null,!1,!1)});var bR=/[\-:]([a-z])/g;function _R(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(bR,_R);gr[e]=new as(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(bR,_R);gr[e]=new as(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(bR,_R);gr[e]=new as(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){gr[n]=new as(n,1,!1,n.toLowerCase(),null,!1,!1)});gr.xlinkHref=new as("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){gr[n]=new as(n,1,!1,n.toLowerCase(),null,!0,!0)});function xR(n,e,t,r){var s=gr.hasOwnProperty(e)?gr[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(eq(e,t,s,r)&&(t=null),r||s===null?JG(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,r=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Jl=XG.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Hx=Symbol.for("react.element"),fp=Symbol.for("react.portal"),pp=Symbol.for("react.fragment"),SR=Symbol.for("react.strict_mode"),KN=Symbol.for("react.profiler"),kU=Symbol.for("react.provider"),NU=Symbol.for("react.context"),ER=Symbol.for("react.forward_ref"),XN=Symbol.for("react.suspense"),QN=Symbol.for("react.suspense_list"),AR=Symbol.for("react.memo"),dc=Symbol.for("react.lazy"),PU=Symbol.for("react.offscreen"),CL=Symbol.iterator;function Yy(n){return n===null||typeof n!="object"?null:(n=CL&&n[CL]||n["@@iterator"],typeof n=="function"?n:null)}var Zt=Object.assign,Fk;function mv(n){if(Fk===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Fk=e&&e[1]||""}return`
`+Fk+n}var $k=!1;function Uk(n,e){if(!n||$k)return"";$k=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){r=u}n.call(e.prototype)}else{try{throw Error()}catch(u){r=u}n()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var l=`
`+s[a].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=a&&0<=o);break}}}finally{$k=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?mv(n):""}function tq(n){switch(n.tag){case 5:return mv(n.type);case 16:return mv("Lazy");case 13:return mv("Suspense");case 19:return mv("SuspenseList");case 0:case 2:case 15:return n=Uk(n.type,!1),n;case 11:return n=Uk(n.type.render,!1),n;case 1:return n=Uk(n.type,!0),n;default:return""}}function JN(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case pp:return"Fragment";case fp:return"Portal";case KN:return"Profiler";case SR:return"StrictMode";case XN:return"Suspense";case QN:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case NU:return(n.displayName||"Context")+".Consumer";case kU:return(n._context.displayName||"Context")+".Provider";case ER:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case AR:return e=n.displayName||null,e!==null?e:JN(n.type)||"Memo";case dc:e=n._payload,n=n._init;try{return JN(n(e))}catch{}}return null}function nq(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return JN(e);case 8:return e===SR?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function $u(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function IU(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function rq(n){var e=IU(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function Wx(n){n._valueTracker||(n._valueTracker=rq(n))}function DU(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=IU(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function BE(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function ZN(n,e){var t=e.checked;return Zt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function kL(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=$u(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function RU(n,e){e=e.checked,e!=null&&xR(n,"checked",e,!1)}function eP(n,e){RU(n,e);var t=$u(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?tP(n,e.type,t):e.hasOwnProperty("defaultValue")&&tP(n,e.type,$u(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function NL(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function tP(n,e,t){(e!=="number"||BE(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var gv=Array.isArray;function Dp(n,e,t,r){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&r&&(n[t].defaultSelected=!0)}else{for(t=""+$u(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,r&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function nP(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return Zt({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function PL(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(oe(92));if(gv(t)){if(1<t.length)throw Error(oe(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:$u(t)}}function MU(n,e){var t=$u(e.value),r=$u(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function IL(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function OU(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rP(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?OU(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Gx,LU=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Gx=Gx||document.createElement("div"),Gx.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Gx.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function d0(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var qv={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},sq=["Webkit","ms","Moz","O"];Object.keys(qv).forEach(function(n){sq.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),qv[e]=qv[n]})});function jU(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||qv.hasOwnProperty(n)&&qv[n]?(""+e).trim():e+"px"}function FU(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,s=jU(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,s):n[t]=s}}var iq=Zt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sP(n,e){if(e){if(iq[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function iP(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var aP=null;function TR(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var oP=null,Rp=null,Mp=null;function DL(n){if(n=U_(n)){if(typeof oP!="function")throw Error(oe(280));var e=n.stateNode;e&&(e=rC(e),oP(n.stateNode,n.type,e))}}function $U(n){Rp?Mp?Mp.push(n):Mp=[n]:Rp=n}function UU(){if(Rp){var n=Rp,e=Mp;if(Mp=Rp=null,DL(n),e)for(n=0;n<e.length;n++)DL(e[n])}}function VU(n,e){return n(e)}function BU(){}var Vk=!1;function zU(n,e,t){if(Vk)return n(e,t);Vk=!0;try{return VU(n,e,t)}finally{Vk=!1,(Rp!==null||Mp!==null)&&(BU(),UU())}}function f0(n,e){var t=n.stateNode;if(t===null)return null;var r=rC(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(oe(231,e,typeof t));return t}var lP=!1;if($l)try{var Ky={};Object.defineProperty(Ky,"passive",{get:function(){lP=!0}}),window.addEventListener("test",Ky,Ky),window.removeEventListener("test",Ky,Ky)}catch{lP=!1}function aq(n,e,t,r,s,i,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var Yv=!1,zE=null,HE=!1,cP=null,oq={onError:function(n){Yv=!0,zE=n}};function lq(n,e,t,r,s,i,a,o,l){Yv=!1,zE=null,aq.apply(oq,arguments)}function cq(n,e,t,r,s,i,a,o,l){if(lq.apply(this,arguments),Yv){if(Yv){var u=zE;Yv=!1,zE=null}else throw Error(oe(198));HE||(HE=!0,cP=u)}}function Rf(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function HU(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function RL(n){if(Rf(n)!==n)throw Error(oe(188))}function uq(n){var e=n.alternate;if(!e){if(e=Rf(n),e===null)throw Error(oe(188));return e!==n?null:n}for(var t=n,r=e;;){var s=t.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){t=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===t)return RL(s),n;if(i===r)return RL(s),e;i=i.sibling}throw Error(oe(188))}if(t.return!==r.return)t=s,r=i;else{for(var a=!1,o=s.child;o;){if(o===t){a=!0,t=s,r=i;break}if(o===r){a=!0,r=s,t=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===t){a=!0,t=i,r=s;break}if(o===r){a=!0,r=i,t=s;break}o=o.sibling}if(!a)throw Error(oe(189))}}if(t.alternate!==r)throw Error(oe(190))}if(t.tag!==3)throw Error(oe(188));return t.stateNode.current===t?n:e}function WU(n){return n=uq(n),n!==null?GU(n):null}function GU(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=GU(n);if(e!==null)return e;n=n.sibling}return null}var qU=ui.unstable_scheduleCallback,ML=ui.unstable_cancelCallback,hq=ui.unstable_shouldYield,dq=ui.unstable_requestPaint,wn=ui.unstable_now,fq=ui.unstable_getCurrentPriorityLevel,CR=ui.unstable_ImmediatePriority,YU=ui.unstable_UserBlockingPriority,WE=ui.unstable_NormalPriority,pq=ui.unstable_LowPriority,KU=ui.unstable_IdlePriority,ZT=null,mo=null;function mq(n){if(mo&&typeof mo.onCommitFiberRoot=="function")try{mo.onCommitFiberRoot(ZT,n,void 0,(n.current.flags&128)===128)}catch{}}var wa=Math.clz32?Math.clz32:vq,gq=Math.log,yq=Math.LN2;function vq(n){return n>>>=0,n===0?32:31-(gq(n)/yq|0)|0}var qx=64,Yx=4194304;function yv(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function GE(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,s=n.suspendedLanes,i=n.pingedLanes,a=t&268435455;if(a!==0){var o=a&~s;o!==0?r=yv(o):(i&=a,i!==0&&(r=yv(i)))}else a=t&~s,a!==0?r=yv(a):i!==0&&(r=yv(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-wa(e),s=1<<t,r|=n[t],e&=~s;return r}function wq(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bq(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,s=n.expirationTimes,i=n.pendingLanes;0<i;){var a=31-wa(i),o=1<<a,l=s[a];l===-1?(!(o&t)||o&r)&&(s[a]=wq(o,e)):l<=e&&(n.expiredLanes|=o),i&=~o}}function uP(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function XU(){var n=qx;return qx<<=1,!(qx&4194240)&&(qx=64),n}function Bk(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function F_(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-wa(e),n[e]=t}function _q(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-wa(t),i=1<<s;e[s]=0,r[s]=-1,n[s]=-1,t&=~i}}function kR(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-wa(t),s=1<<r;s&e|n[r]&e&&(n[r]|=e),t&=~s}}var dt=0;function QU(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var JU,NR,ZU,eV,tV,hP=!1,Kx=[],Cu=null,ku=null,Nu=null,p0=new Map,m0=new Map,pc=[],xq="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function OL(n,e){switch(n){case"focusin":case"focusout":Cu=null;break;case"dragenter":case"dragleave":ku=null;break;case"mouseover":case"mouseout":Nu=null;break;case"pointerover":case"pointerout":p0.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":m0.delete(e.pointerId)}}function Xy(n,e,t,r,s,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=U_(e),e!==null&&NR(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function Sq(n,e,t,r,s){switch(e){case"focusin":return Cu=Xy(Cu,n,e,t,r,s),!0;case"dragenter":return ku=Xy(ku,n,e,t,r,s),!0;case"mouseover":return Nu=Xy(Nu,n,e,t,r,s),!0;case"pointerover":var i=s.pointerId;return p0.set(i,Xy(p0.get(i)||null,n,e,t,r,s)),!0;case"gotpointercapture":return i=s.pointerId,m0.set(i,Xy(m0.get(i)||null,n,e,t,r,s)),!0}return!1}function nV(n){var e=xh(n.target);if(e!==null){var t=Rf(e);if(t!==null){if(e=t.tag,e===13){if(e=HU(t),e!==null){n.blockedOn=e,tV(n.priority,function(){ZU(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function MS(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=dP(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);aP=r,t.target.dispatchEvent(r),aP=null}else return e=U_(t),e!==null&&NR(e),n.blockedOn=t,!1;e.shift()}return!0}function LL(n,e,t){MS(n)&&t.delete(e)}function Eq(){hP=!1,Cu!==null&&MS(Cu)&&(Cu=null),ku!==null&&MS(ku)&&(ku=null),Nu!==null&&MS(Nu)&&(Nu=null),p0.forEach(LL),m0.forEach(LL)}function Qy(n,e){n.blockedOn===e&&(n.blockedOn=null,hP||(hP=!0,ui.unstable_scheduleCallback(ui.unstable_NormalPriority,Eq)))}function g0(n){function e(s){return Qy(s,n)}if(0<Kx.length){Qy(Kx[0],n);for(var t=1;t<Kx.length;t++){var r=Kx[t];r.blockedOn===n&&(r.blockedOn=null)}}for(Cu!==null&&Qy(Cu,n),ku!==null&&Qy(ku,n),Nu!==null&&Qy(Nu,n),p0.forEach(e),m0.forEach(e),t=0;t<pc.length;t++)r=pc[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<pc.length&&(t=pc[0],t.blockedOn===null);)nV(t),t.blockedOn===null&&pc.shift()}var Op=Jl.ReactCurrentBatchConfig,qE=!0;function Aq(n,e,t,r){var s=dt,i=Op.transition;Op.transition=null;try{dt=1,PR(n,e,t,r)}finally{dt=s,Op.transition=i}}function Tq(n,e,t,r){var s=dt,i=Op.transition;Op.transition=null;try{dt=4,PR(n,e,t,r)}finally{dt=s,Op.transition=i}}function PR(n,e,t,r){if(qE){var s=dP(n,e,t,r);if(s===null)Jk(n,e,r,YE,t),OL(n,r);else if(Sq(s,n,e,t,r))r.stopPropagation();else if(OL(n,r),e&4&&-1<xq.indexOf(n)){for(;s!==null;){var i=U_(s);if(i!==null&&JU(i),i=dP(n,e,t,r),i===null&&Jk(n,e,r,YE,t),i===s)break;s=i}s!==null&&r.stopPropagation()}else Jk(n,e,r,null,t)}}var YE=null;function dP(n,e,t,r){if(YE=null,n=TR(r),n=xh(n),n!==null)if(e=Rf(n),e===null)n=null;else if(t=e.tag,t===13){if(n=HU(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return YE=n,null}function rV(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fq()){case CR:return 1;case YU:return 4;case WE:case pq:return 16;case KU:return 536870912;default:return 16}default:return 16}}var xu=null,IR=null,OS=null;function sV(){if(OS)return OS;var n,e=IR,t=e.length,r,s="value"in xu?xu.value:xu.textContent,i=s.length;for(n=0;n<t&&e[n]===s[n];n++);var a=t-n;for(r=1;r<=a&&e[t-r]===s[i-r];r++);return OS=s.slice(n,1<r?1-r:void 0)}function LS(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Xx(){return!0}function jL(){return!1}function fi(n){function e(t,r,s,i,a){this._reactName=t,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in n)n.hasOwnProperty(o)&&(t=n[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Xx:jL,this.isPropagationStopped=jL,this}return Zt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Xx)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Xx)},persist:function(){},isPersistent:Xx}),e}var my={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},DR=fi(my),$_=Zt({},my,{view:0,detail:0}),Cq=fi($_),zk,Hk,Jy,eC=Zt({},$_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:RR,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Jy&&(Jy&&n.type==="mousemove"?(zk=n.screenX-Jy.screenX,Hk=n.screenY-Jy.screenY):Hk=zk=0,Jy=n),zk)},movementY:function(n){return"movementY"in n?n.movementY:Hk}}),FL=fi(eC),kq=Zt({},eC,{dataTransfer:0}),Nq=fi(kq),Pq=Zt({},$_,{relatedTarget:0}),Wk=fi(Pq),Iq=Zt({},my,{animationName:0,elapsedTime:0,pseudoElement:0}),Dq=fi(Iq),Rq=Zt({},my,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Mq=fi(Rq),Oq=Zt({},my,{data:0}),$L=fi(Oq),Lq={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jq={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Fq={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function $q(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=Fq[n])?!!e[n]:!1}function RR(){return $q}var Uq=Zt({},$_,{key:function(n){if(n.key){var e=Lq[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=LS(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?jq[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:RR,charCode:function(n){return n.type==="keypress"?LS(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?LS(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Vq=fi(Uq),Bq=Zt({},eC,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),UL=fi(Bq),zq=Zt({},$_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:RR}),Hq=fi(zq),Wq=Zt({},my,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gq=fi(Wq),qq=Zt({},eC,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Yq=fi(qq),Kq=[9,13,27,32],MR=$l&&"CompositionEvent"in window,Kv=null;$l&&"documentMode"in document&&(Kv=document.documentMode);var Xq=$l&&"TextEvent"in window&&!Kv,iV=$l&&(!MR||Kv&&8<Kv&&11>=Kv),VL=String.fromCharCode(32),BL=!1;function aV(n,e){switch(n){case"keyup":return Kq.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function oV(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var mp=!1;function Qq(n,e){switch(n){case"compositionend":return oV(e);case"keypress":return e.which!==32?null:(BL=!0,VL);case"textInput":return n=e.data,n===VL&&BL?null:n;default:return null}}function Jq(n,e){if(mp)return n==="compositionend"||!MR&&aV(n,e)?(n=sV(),OS=IR=xu=null,mp=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return iV&&e.locale!=="ko"?null:e.data;default:return null}}var Zq={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function zL(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!Zq[n.type]:e==="textarea"}function lV(n,e,t,r){$U(r),e=KE(e,"onChange"),0<e.length&&(t=new DR("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var Xv=null,y0=null;function e8(n){wV(n,0)}function tC(n){var e=vp(n);if(DU(e))return n}function t8(n,e){if(n==="change")return e}var cV=!1;if($l){var Gk;if($l){var qk="oninput"in document;if(!qk){var HL=document.createElement("div");HL.setAttribute("oninput","return;"),qk=typeof HL.oninput=="function"}Gk=qk}else Gk=!1;cV=Gk&&(!document.documentMode||9<document.documentMode)}function WL(){Xv&&(Xv.detachEvent("onpropertychange",uV),y0=Xv=null)}function uV(n){if(n.propertyName==="value"&&tC(y0)){var e=[];lV(e,y0,n,TR(n)),zU(e8,e)}}function n8(n,e,t){n==="focusin"?(WL(),Xv=e,y0=t,Xv.attachEvent("onpropertychange",uV)):n==="focusout"&&WL()}function r8(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tC(y0)}function s8(n,e){if(n==="click")return tC(e)}function i8(n,e){if(n==="input"||n==="change")return tC(e)}function a8(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var xa=typeof Object.is=="function"?Object.is:a8;function v0(n,e){if(xa(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var s=t[r];if(!YN.call(e,s)||!xa(n[s],e[s]))return!1}return!0}function GL(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function qL(n,e){var t=GL(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=GL(t)}}function hV(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?hV(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function dV(){for(var n=window,e=BE();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=BE(n.document)}return e}function OR(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function o8(n){var e=dV(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&hV(t.ownerDocument.documentElement,t)){if(r!==null&&OR(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!n.extend&&i>r&&(s=r,r=i,i=s),s=qL(t,i);var a=qL(t,r);s&&a&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==a.node||n.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var l8=$l&&"documentMode"in document&&11>=document.documentMode,gp=null,fP=null,Qv=null,pP=!1;function YL(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;pP||gp==null||gp!==BE(r)||(r=gp,"selectionStart"in r&&OR(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Qv&&v0(Qv,r)||(Qv=r,r=KE(fP,"onSelect"),0<r.length&&(e=new DR("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=gp)))}function Qx(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var yp={animationend:Qx("Animation","AnimationEnd"),animationiteration:Qx("Animation","AnimationIteration"),animationstart:Qx("Animation","AnimationStart"),transitionend:Qx("Transition","TransitionEnd")},Yk={},fV={};$l&&(fV=document.createElement("div").style,"AnimationEvent"in window||(delete yp.animationend.animation,delete yp.animationiteration.animation,delete yp.animationstart.animation),"TransitionEvent"in window||delete yp.transitionend.transition);function nC(n){if(Yk[n])return Yk[n];if(!yp[n])return n;var e=yp[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in fV)return Yk[n]=e[t];return n}var pV=nC("animationend"),mV=nC("animationiteration"),gV=nC("animationstart"),yV=nC("transitionend"),vV=new Map,KL="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ku(n,e){vV.set(n,e),Df(e,[n])}for(var Kk=0;Kk<KL.length;Kk++){var Xk=KL[Kk],c8=Xk.toLowerCase(),u8=Xk[0].toUpperCase()+Xk.slice(1);Ku(c8,"on"+u8)}Ku(pV,"onAnimationEnd");Ku(mV,"onAnimationIteration");Ku(gV,"onAnimationStart");Ku("dblclick","onDoubleClick");Ku("focusin","onFocus");Ku("focusout","onBlur");Ku(yV,"onTransitionEnd");qg("onMouseEnter",["mouseout","mouseover"]);qg("onMouseLeave",["mouseout","mouseover"]);qg("onPointerEnter",["pointerout","pointerover"]);qg("onPointerLeave",["pointerout","pointerover"]);Df("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Df("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Df("onBeforeInput",["compositionend","keypress","textInput","paste"]);Df("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Df("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Df("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),h8=new Set("cancel close invalid load scroll toggle".split(" ").concat(vv));function XL(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,cq(r,e,void 0,n),n.currentTarget=null}function wV(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==i&&s.isPropagationStopped())break e;XL(s,o,u),i=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==i&&s.isPropagationStopped())break e;XL(s,o,u),i=l}}}if(HE)throw n=cP,HE=!1,cP=null,n}function Ot(n,e){var t=e[wP];t===void 0&&(t=e[wP]=new Set);var r=n+"__bubble";t.has(r)||(bV(e,n,2,!1),t.add(r))}function Qk(n,e,t){var r=0;e&&(r|=4),bV(t,n,r,e)}var Jx="_reactListening"+Math.random().toString(36).slice(2);function w0(n){if(!n[Jx]){n[Jx]=!0,CU.forEach(function(t){t!=="selectionchange"&&(h8.has(t)||Qk(t,!1,n),Qk(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Jx]||(e[Jx]=!0,Qk("selectionchange",!1,e))}}function bV(n,e,t,r){switch(rV(e)){case 1:var s=Aq;break;case 4:s=Tq;break;default:s=PR}t=s.bind(null,e,t,n),s=void 0,!lP||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function Jk(n,e,t,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;a=a.return}for(;o!==null;){if(a=xh(o),a===null)return;if(l=a.tag,l===5||l===6){r=i=a;continue e}o=o.parentNode}}r=r.return}zU(function(){var u=i,h=TR(t),f=[];e:{var p=vV.get(n);if(p!==void 0){var g=DR,v=n;switch(n){case"keypress":if(LS(t)===0)break e;case"keydown":case"keyup":g=Vq;break;case"focusin":v="focus",g=Wk;break;case"focusout":v="blur",g=Wk;break;case"beforeblur":case"afterblur":g=Wk;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=FL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Nq;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=Hq;break;case pV:case mV:case gV:g=Dq;break;case yV:g=Gq;break;case"scroll":g=Cq;break;case"wheel":g=Yq;break;case"copy":case"cut":case"paste":g=Mq;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=UL}var y=(e&4)!==0,_=!y&&n==="scroll",w=y?p!==null?p+"Capture":null:p;y=[];for(var b=u,S;b!==null;){S=b;var T=S.stateNode;if(S.tag===5&&T!==null&&(S=T,w!==null&&(T=f0(b,w),T!=null&&y.push(b0(b,T,S)))),_)break;b=b.return}0<y.length&&(p=new g(p,v,null,t,h),f.push({event:p,listeners:y}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==aP&&(v=t.relatedTarget||t.fromElement)&&(xh(v)||v[Ul]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(v=t.relatedTarget||t.toElement,g=u,v=v?xh(v):null,v!==null&&(_=Rf(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(g=null,v=u),g!==v)){if(y=FL,T="onMouseLeave",w="onMouseEnter",b="mouse",(n==="pointerout"||n==="pointerover")&&(y=UL,T="onPointerLeave",w="onPointerEnter",b="pointer"),_=g==null?p:vp(g),S=v==null?p:vp(v),p=new y(T,b+"leave",g,t,h),p.target=_,p.relatedTarget=S,T=null,xh(h)===u&&(y=new y(w,b+"enter",v,t,h),y.target=S,y.relatedTarget=_,T=y),_=T,g&&v)t:{for(y=g,w=v,b=0,S=y;S;S=Qf(S))b++;for(S=0,T=w;T;T=Qf(T))S++;for(;0<b-S;)y=Qf(y),b--;for(;0<S-b;)w=Qf(w),S--;for(;b--;){if(y===w||w!==null&&y===w.alternate)break t;y=Qf(y),w=Qf(w)}y=null}else y=null;g!==null&&QL(f,p,g,y,!1),v!==null&&_!==null&&QL(f,_,v,y,!0)}}e:{if(p=u?vp(u):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var P=t8;else if(zL(p))if(cV)P=i8;else{P=r8;var R=n8}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=s8);if(P&&(P=P(n,u))){lV(f,P,t,h);break e}R&&R(n,p,u),n==="focusout"&&(R=p._wrapperState)&&R.controlled&&p.type==="number"&&tP(p,"number",p.value)}switch(R=u?vp(u):window,n){case"focusin":(zL(R)||R.contentEditable==="true")&&(gp=R,fP=u,Qv=null);break;case"focusout":Qv=fP=gp=null;break;case"mousedown":pP=!0;break;case"contextmenu":case"mouseup":case"dragend":pP=!1,YL(f,t,h);break;case"selectionchange":if(l8)break;case"keydown":case"keyup":YL(f,t,h)}var k;if(MR)e:{switch(n){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else mp?aV(n,t)&&(C="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(C="onCompositionStart");C&&(iV&&t.locale!=="ko"&&(mp||C!=="onCompositionStart"?C==="onCompositionEnd"&&mp&&(k=sV()):(xu=h,IR="value"in xu?xu.value:xu.textContent,mp=!0)),R=KE(u,C),0<R.length&&(C=new $L(C,n,null,t,h),f.push({event:C,listeners:R}),k?C.data=k:(k=oV(t),k!==null&&(C.data=k)))),(k=Xq?Qq(n,t):Jq(n,t))&&(u=KE(u,"onBeforeInput"),0<u.length&&(h=new $L("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:u}),h.data=k))}wV(f,e)})}function b0(n,e,t){return{instance:n,listener:e,currentTarget:t}}function KE(n,e){for(var t=e+"Capture",r=[];n!==null;){var s=n,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=f0(n,t),i!=null&&r.unshift(b0(n,i,s)),i=f0(n,e),i!=null&&r.push(b0(n,i,s))),n=n.return}return r}function Qf(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function QL(n,e,t,r,s){for(var i=e._reactName,a=[];t!==null&&t!==r;){var o=t,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,s?(l=f0(t,i),l!=null&&a.unshift(b0(t,l,o))):s||(l=f0(t,i),l!=null&&a.push(b0(t,l,o)))),t=t.return}a.length!==0&&n.push({event:e,listeners:a})}var d8=/\r\n?/g,f8=/\u0000|\uFFFD/g;function JL(n){return(typeof n=="string"?n:""+n).replace(d8,`
`).replace(f8,"")}function Zx(n,e,t){if(e=JL(e),JL(n)!==e&&t)throw Error(oe(425))}function XE(){}var mP=null,gP=null;function yP(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var vP=typeof setTimeout=="function"?setTimeout:void 0,p8=typeof clearTimeout=="function"?clearTimeout:void 0,ZL=typeof Promise=="function"?Promise:void 0,m8=typeof queueMicrotask=="function"?queueMicrotask:typeof ZL<"u"?function(n){return ZL.resolve(null).then(n).catch(g8)}:vP;function g8(n){setTimeout(function(){throw n})}function Zk(n,e){var t=e,r=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(r===0){n.removeChild(s),g0(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=s}while(t);g0(e)}function Pu(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function ej(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var gy=Math.random().toString(36).slice(2),co="__reactFiber$"+gy,_0="__reactProps$"+gy,Ul="__reactContainer$"+gy,wP="__reactEvents$"+gy,y8="__reactListeners$"+gy,v8="__reactHandles$"+gy;function xh(n){var e=n[co];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ul]||t[co]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=ej(n);n!==null;){if(t=n[co])return t;n=ej(n)}return e}n=t,t=n.parentNode}return null}function U_(n){return n=n[co]||n[Ul],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function vp(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(oe(33))}function rC(n){return n[_0]||null}var bP=[],wp=-1;function Xu(n){return{current:n}}function $t(n){0>wp||(n.current=bP[wp],bP[wp]=null,wp--)}function Pt(n,e){wp++,bP[wp]=n.current,n.current=e}var Uu={},$r=Xu(Uu),Ss=Xu(!1),cf=Uu;function Yg(n,e){var t=n.type.contextTypes;if(!t)return Uu;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in t)s[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function Es(n){return n=n.childContextTypes,n!=null}function QE(){$t(Ss),$t($r)}function tj(n,e,t){if($r.current!==Uu)throw Error(oe(168));Pt($r,e),Pt(Ss,t)}function _V(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(oe(108,nq(n)||"Unknown",s));return Zt({},t,r)}function JE(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Uu,cf=$r.current,Pt($r,n),Pt(Ss,Ss.current),!0}function nj(n,e,t){var r=n.stateNode;if(!r)throw Error(oe(169));t?(n=_V(n,e,cf),r.__reactInternalMemoizedMergedChildContext=n,$t(Ss),$t($r),Pt($r,n)):$t(Ss),Pt(Ss,t)}var zo=null,sC=!1,eN=!1;function xV(n){zo===null?zo=[n]:zo.push(n)}function w8(n){sC=!0,xV(n)}function Qu(){if(!eN&&zo!==null){eN=!0;var n=0,e=dt;try{var t=zo;for(dt=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}zo=null,sC=!1}catch(s){throw zo!==null&&(zo=zo.slice(n+1)),qU(CR,Qu),s}finally{dt=e,eN=!1}}return null}var bp=[],_p=0,ZE=null,e1=0,Ii=[],Di=0,uf=null,Cl=1,kl="";function uh(n,e){bp[_p++]=e1,bp[_p++]=ZE,ZE=n,e1=e}function SV(n,e,t){Ii[Di++]=Cl,Ii[Di++]=kl,Ii[Di++]=uf,uf=n;var r=Cl;n=kl;var s=32-wa(r)-1;r&=~(1<<s),t+=1;var i=32-wa(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,Cl=1<<32-wa(e)+s|t<<s|r,kl=i+n}else Cl=1<<i|t<<s|r,kl=n}function LR(n){n.return!==null&&(uh(n,1),SV(n,1,0))}function jR(n){for(;n===ZE;)ZE=bp[--_p],bp[_p]=null,e1=bp[--_p],bp[_p]=null;for(;n===uf;)uf=Ii[--Di],Ii[Di]=null,kl=Ii[--Di],Ii[Di]=null,Cl=Ii[--Di],Ii[Di]=null}var li=null,ii=null,qt=!1,ma=null;function EV(n,e){var t=Li(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function rj(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,li=n,ii=Pu(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,li=n,ii=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=uf!==null?{id:Cl,overflow:kl}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Li(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,li=n,ii=null,!0):!1;default:return!1}}function _P(n){return(n.mode&1)!==0&&(n.flags&128)===0}function xP(n){if(qt){var e=ii;if(e){var t=e;if(!rj(n,e)){if(_P(n))throw Error(oe(418));e=Pu(t.nextSibling);var r=li;e&&rj(n,e)?EV(r,t):(n.flags=n.flags&-4097|2,qt=!1,li=n)}}else{if(_P(n))throw Error(oe(418));n.flags=n.flags&-4097|2,qt=!1,li=n}}}function sj(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;li=n}function eS(n){if(n!==li)return!1;if(!qt)return sj(n),qt=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!yP(n.type,n.memoizedProps)),e&&(e=ii)){if(_P(n))throw AV(),Error(oe(418));for(;e;)EV(n,e),e=Pu(e.nextSibling)}if(sj(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(oe(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){ii=Pu(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}ii=null}}else ii=li?Pu(n.stateNode.nextSibling):null;return!0}function AV(){for(var n=ii;n;)n=Pu(n.nextSibling)}function Kg(){ii=li=null,qt=!1}function FR(n){ma===null?ma=[n]:ma.push(n)}var b8=Jl.ReactCurrentBatchConfig;function Zy(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(oe(309));var r=t.stateNode}if(!r)throw Error(oe(147,n));var s=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof n!="string")throw Error(oe(284));if(!t._owner)throw Error(oe(290,n))}return n}function tS(n,e){throw n=Object.prototype.toString.call(e),Error(oe(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ij(n){var e=n._init;return e(n._payload)}function TV(n){function e(w,b){if(n){var S=w.deletions;S===null?(w.deletions=[b],w.flags|=16):S.push(b)}}function t(w,b){if(!n)return null;for(;b!==null;)e(w,b),b=b.sibling;return null}function r(w,b){for(w=new Map;b!==null;)b.key!==null?w.set(b.key,b):w.set(b.index,b),b=b.sibling;return w}function s(w,b){return w=Mu(w,b),w.index=0,w.sibling=null,w}function i(w,b,S){return w.index=S,n?(S=w.alternate,S!==null?(S=S.index,S<b?(w.flags|=2,b):S):(w.flags|=2,b)):(w.flags|=1048576,b)}function a(w){return n&&w.alternate===null&&(w.flags|=2),w}function o(w,b,S,T){return b===null||b.tag!==6?(b=oN(S,w.mode,T),b.return=w,b):(b=s(b,S),b.return=w,b)}function l(w,b,S,T){var P=S.type;return P===pp?h(w,b,S.props.children,T,S.key):b!==null&&(b.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===dc&&ij(P)===b.type)?(T=s(b,S.props),T.ref=Zy(w,b,S),T.return=w,T):(T=zS(S.type,S.key,S.props,null,w.mode,T),T.ref=Zy(w,b,S),T.return=w,T)}function u(w,b,S,T){return b===null||b.tag!==4||b.stateNode.containerInfo!==S.containerInfo||b.stateNode.implementation!==S.implementation?(b=lN(S,w.mode,T),b.return=w,b):(b=s(b,S.children||[]),b.return=w,b)}function h(w,b,S,T,P){return b===null||b.tag!==7?(b=nf(S,w.mode,T,P),b.return=w,b):(b=s(b,S),b.return=w,b)}function f(w,b,S){if(typeof b=="string"&&b!==""||typeof b=="number")return b=oN(""+b,w.mode,S),b.return=w,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Hx:return S=zS(b.type,b.key,b.props,null,w.mode,S),S.ref=Zy(w,null,b),S.return=w,S;case fp:return b=lN(b,w.mode,S),b.return=w,b;case dc:var T=b._init;return f(w,T(b._payload),S)}if(gv(b)||Yy(b))return b=nf(b,w.mode,S,null),b.return=w,b;tS(w,b)}return null}function p(w,b,S,T){var P=b!==null?b.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return P!==null?null:o(w,b,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Hx:return S.key===P?l(w,b,S,T):null;case fp:return S.key===P?u(w,b,S,T):null;case dc:return P=S._init,p(w,b,P(S._payload),T)}if(gv(S)||Yy(S))return P!==null?null:h(w,b,S,T,null);tS(w,S)}return null}function g(w,b,S,T,P){if(typeof T=="string"&&T!==""||typeof T=="number")return w=w.get(S)||null,o(b,w,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Hx:return w=w.get(T.key===null?S:T.key)||null,l(b,w,T,P);case fp:return w=w.get(T.key===null?S:T.key)||null,u(b,w,T,P);case dc:var R=T._init;return g(w,b,S,R(T._payload),P)}if(gv(T)||Yy(T))return w=w.get(S)||null,h(b,w,T,P,null);tS(b,T)}return null}function v(w,b,S,T){for(var P=null,R=null,k=b,C=b=0,I=null;k!==null&&C<S.length;C++){k.index>C?(I=k,k=null):I=k.sibling;var M=p(w,k,S[C],T);if(M===null){k===null&&(k=I);break}n&&k&&M.alternate===null&&e(w,k),b=i(M,b,C),R===null?P=M:R.sibling=M,R=M,k=I}if(C===S.length)return t(w,k),qt&&uh(w,C),P;if(k===null){for(;C<S.length;C++)k=f(w,S[C],T),k!==null&&(b=i(k,b,C),R===null?P=k:R.sibling=k,R=k);return qt&&uh(w,C),P}for(k=r(w,k);C<S.length;C++)I=g(k,w,C,S[C],T),I!==null&&(n&&I.alternate!==null&&k.delete(I.key===null?C:I.key),b=i(I,b,C),R===null?P=I:R.sibling=I,R=I);return n&&k.forEach(function(L){return e(w,L)}),qt&&uh(w,C),P}function y(w,b,S,T){var P=Yy(S);if(typeof P!="function")throw Error(oe(150));if(S=P.call(S),S==null)throw Error(oe(151));for(var R=P=null,k=b,C=b=0,I=null,M=S.next();k!==null&&!M.done;C++,M=S.next()){k.index>C?(I=k,k=null):I=k.sibling;var L=p(w,k,M.value,T);if(L===null){k===null&&(k=I);break}n&&k&&L.alternate===null&&e(w,k),b=i(L,b,C),R===null?P=L:R.sibling=L,R=L,k=I}if(M.done)return t(w,k),qt&&uh(w,C),P;if(k===null){for(;!M.done;C++,M=S.next())M=f(w,M.value,T),M!==null&&(b=i(M,b,C),R===null?P=M:R.sibling=M,R=M);return qt&&uh(w,C),P}for(k=r(w,k);!M.done;C++,M=S.next())M=g(k,w,C,M.value,T),M!==null&&(n&&M.alternate!==null&&k.delete(M.key===null?C:M.key),b=i(M,b,C),R===null?P=M:R.sibling=M,R=M);return n&&k.forEach(function(F){return e(w,F)}),qt&&uh(w,C),P}function _(w,b,S,T){if(typeof S=="object"&&S!==null&&S.type===pp&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case Hx:e:{for(var P=S.key,R=b;R!==null;){if(R.key===P){if(P=S.type,P===pp){if(R.tag===7){t(w,R.sibling),b=s(R,S.props.children),b.return=w,w=b;break e}}else if(R.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===dc&&ij(P)===R.type){t(w,R.sibling),b=s(R,S.props),b.ref=Zy(w,R,S),b.return=w,w=b;break e}t(w,R);break}else e(w,R);R=R.sibling}S.type===pp?(b=nf(S.props.children,w.mode,T,S.key),b.return=w,w=b):(T=zS(S.type,S.key,S.props,null,w.mode,T),T.ref=Zy(w,b,S),T.return=w,w=T)}return a(w);case fp:e:{for(R=S.key;b!==null;){if(b.key===R)if(b.tag===4&&b.stateNode.containerInfo===S.containerInfo&&b.stateNode.implementation===S.implementation){t(w,b.sibling),b=s(b,S.children||[]),b.return=w,w=b;break e}else{t(w,b);break}else e(w,b);b=b.sibling}b=lN(S,w.mode,T),b.return=w,w=b}return a(w);case dc:return R=S._init,_(w,b,R(S._payload),T)}if(gv(S))return v(w,b,S,T);if(Yy(S))return y(w,b,S,T);tS(w,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,b!==null&&b.tag===6?(t(w,b.sibling),b=s(b,S),b.return=w,w=b):(t(w,b),b=oN(S,w.mode,T),b.return=w,w=b),a(w)):t(w,b)}return _}var Xg=TV(!0),CV=TV(!1),t1=Xu(null),n1=null,xp=null,$R=null;function UR(){$R=xp=n1=null}function VR(n){var e=t1.current;$t(t1),n._currentValue=e}function SP(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Lp(n,e){n1=n,$R=xp=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(xs=!0),n.firstContext=null)}function Ui(n){var e=n._currentValue;if($R!==n)if(n={context:n,memoizedValue:e,next:null},xp===null){if(n1===null)throw Error(oe(308));xp=n,n1.dependencies={lanes:0,firstContext:n}}else xp=xp.next=n;return e}var Sh=null;function BR(n){Sh===null?Sh=[n]:Sh.push(n)}function kV(n,e,t,r){var s=e.interleaved;return s===null?(t.next=t,BR(e)):(t.next=s.next,s.next=t),e.interleaved=t,Vl(n,r)}function Vl(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var fc=!1;function zR(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NV(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ml(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Iu(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,nt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Vl(n,t)}return s=r.interleaved,s===null?(e.next=e,BR(r)):(e.next=s.next,s.next=e),r.interleaved=e,Vl(n,t)}function jS(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,kR(n,t)}}function aj(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var s=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var a={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?s=i=a:i=i.next=a,t=t.next}while(t!==null);i===null?s=i=e:i=i.next=e}else s=i=e;t={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function r1(n,e,t,r){var s=n.updateQueue;fc=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?i=u:a.next=u,a=l;var h=n.alternate;h!==null&&(h=h.updateQueue,o=h.lastBaseUpdate,o!==a&&(o===null?h.firstBaseUpdate=u:o.next=u,h.lastBaseUpdate=l))}if(i!==null){var f=s.baseState;a=0,h=u=l=null,o=i;do{var p=o.lane,g=o.eventTime;if((r&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=n,y=o;switch(p=e,g=t,y.tag){case 1:if(v=y.payload,typeof v=="function"){f=v.call(g,f,p);break e}f=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=y.payload,p=typeof v=="function"?v.call(g,f,p):v,p==null)break e;f=Zt({},f,p);break e;case 2:fc=!0}}o.callback!==null&&o.lane!==0&&(n.flags|=64,p=s.effects,p===null?s.effects=[o]:p.push(o))}else g={eventTime:g,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},h===null?(u=h=g,l=f):h=h.next=g,a|=p;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;p=o,o=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(1);if(h===null&&(l=f),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);df|=a,n.lanes=a,n.memoizedState=f}}function oj(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],s=r.callback;if(s!==null){if(r.callback=null,r=t,typeof s!="function")throw Error(oe(191,s));s.call(r)}}}var V_={},go=Xu(V_),x0=Xu(V_),S0=Xu(V_);function Eh(n){if(n===V_)throw Error(oe(174));return n}function HR(n,e){switch(Pt(S0,e),Pt(x0,n),Pt(go,V_),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:rP(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=rP(e,n)}$t(go),Pt(go,e)}function Qg(){$t(go),$t(x0),$t(S0)}function PV(n){Eh(S0.current);var e=Eh(go.current),t=rP(e,n.type);e!==t&&(Pt(x0,n),Pt(go,t))}function WR(n){x0.current===n&&($t(go),$t(x0))}var Xt=Xu(0);function s1(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var tN=[];function GR(){for(var n=0;n<tN.length;n++)tN[n]._workInProgressVersionPrimary=null;tN.length=0}var FS=Jl.ReactCurrentDispatcher,nN=Jl.ReactCurrentBatchConfig,hf=0,Qt=null,Dn=null,Qn=null,i1=!1,Jv=!1,E0=0,_8=0;function Sr(){throw Error(oe(321))}function qR(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!xa(n[t],e[t]))return!1;return!0}function YR(n,e,t,r,s,i){if(hf=i,Qt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,FS.current=n===null||n.memoizedState===null?A8:T8,n=t(r,s),Jv){i=0;do{if(Jv=!1,E0=0,25<=i)throw Error(oe(301));i+=1,Qn=Dn=null,e.updateQueue=null,FS.current=C8,n=t(r,s)}while(Jv)}if(FS.current=a1,e=Dn!==null&&Dn.next!==null,hf=0,Qn=Dn=Qt=null,i1=!1,e)throw Error(oe(300));return n}function KR(){var n=E0!==0;return E0=0,n}function ja(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qn===null?Qt.memoizedState=Qn=n:Qn=Qn.next=n,Qn}function Vi(){if(Dn===null){var n=Qt.alternate;n=n!==null?n.memoizedState:null}else n=Dn.next;var e=Qn===null?Qt.memoizedState:Qn.next;if(e!==null)Qn=e,Dn=n;else{if(n===null)throw Error(oe(310));Dn=n,n={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Qn===null?Qt.memoizedState=Qn=n:Qn=Qn.next=n}return Qn}function A0(n,e){return typeof e=="function"?e(n):e}function rN(n){var e=Vi(),t=e.queue;if(t===null)throw Error(oe(311));t.lastRenderedReducer=n;var r=Dn,s=r.baseQueue,i=t.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,t.pending=null}if(s!==null){i=s.next,r=r.baseState;var o=a=null,l=null,u=i;do{var h=u.lane;if((hf&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:n(r,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=f,a=r):l=l.next=f,Qt.lanes|=h,df|=h}u=u.next}while(u!==null&&u!==i);l===null?a=r:l.next=o,xa(r,e.memoizedState)||(xs=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){s=n;do i=s.lane,Qt.lanes|=i,df|=i,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function sN(n){var e=Vi(),t=e.queue;if(t===null)throw Error(oe(311));t.lastRenderedReducer=n;var r=t.dispatch,s=t.pending,i=e.memoizedState;if(s!==null){t.pending=null;var a=s=s.next;do i=n(i,a.action),a=a.next;while(a!==s);xa(i,e.memoizedState)||(xs=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function IV(){}function DV(n,e){var t=Qt,r=Vi(),s=e(),i=!xa(r.memoizedState,s);if(i&&(r.memoizedState=s,xs=!0),r=r.queue,XR(OV.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||Qn!==null&&Qn.memoizedState.tag&1){if(t.flags|=2048,T0(9,MV.bind(null,t,r,s,e),void 0,null),Jn===null)throw Error(oe(349));hf&30||RV(t,e,s)}return s}function RV(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function MV(n,e,t,r){e.value=t,e.getSnapshot=r,LV(e)&&jV(n)}function OV(n,e,t){return t(function(){LV(e)&&jV(n)})}function LV(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!xa(n,t)}catch{return!0}}function jV(n){var e=Vl(n,1);e!==null&&ba(e,n,1,-1)}function lj(n){var e=ja();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:A0,lastRenderedState:n},e.queue=n,n=n.dispatch=E8.bind(null,Qt,n),[e.memoizedState,n]}function T0(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Qt.updateQueue,e===null?(e={lastEffect:null,stores:null},Qt.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function FV(){return Vi().memoizedState}function $S(n,e,t,r){var s=ja();Qt.flags|=n,s.memoizedState=T0(1|e,t,void 0,r===void 0?null:r)}function iC(n,e,t,r){var s=Vi();r=r===void 0?null:r;var i=void 0;if(Dn!==null){var a=Dn.memoizedState;if(i=a.destroy,r!==null&&qR(r,a.deps)){s.memoizedState=T0(e,t,i,r);return}}Qt.flags|=n,s.memoizedState=T0(1|e,t,i,r)}function cj(n,e){return $S(8390656,8,n,e)}function XR(n,e){return iC(2048,8,n,e)}function $V(n,e){return iC(4,2,n,e)}function UV(n,e){return iC(4,4,n,e)}function VV(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function BV(n,e,t){return t=t!=null?t.concat([n]):null,iC(4,4,VV.bind(null,e,n),t)}function QR(){}function zV(n,e){var t=Vi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&qR(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function HV(n,e){var t=Vi();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&qR(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function WV(n,e,t){return hf&21?(xa(t,e)||(t=XU(),Qt.lanes|=t,df|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,xs=!0),n.memoizedState=t)}function x8(n,e){var t=dt;dt=t!==0&&4>t?t:4,n(!0);var r=nN.transition;nN.transition={};try{n(!1),e()}finally{dt=t,nN.transition=r}}function GV(){return Vi().memoizedState}function S8(n,e,t){var r=Ru(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},qV(n))YV(e,t);else if(t=kV(n,e,t,r),t!==null){var s=ss();ba(t,n,r,s),KV(t,e,r)}}function E8(n,e,t){var r=Ru(n),s={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(qV(n))YV(e,s);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,t);if(s.hasEagerState=!0,s.eagerState=o,xa(o,a)){var l=e.interleaved;l===null?(s.next=s,BR(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=kV(n,e,s,r),t!==null&&(s=ss(),ba(t,n,r,s),KV(t,e,r))}}function qV(n){var e=n.alternate;return n===Qt||e!==null&&e===Qt}function YV(n,e){Jv=i1=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function KV(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,kR(n,t)}}var a1={readContext:Ui,useCallback:Sr,useContext:Sr,useEffect:Sr,useImperativeHandle:Sr,useInsertionEffect:Sr,useLayoutEffect:Sr,useMemo:Sr,useReducer:Sr,useRef:Sr,useState:Sr,useDebugValue:Sr,useDeferredValue:Sr,useTransition:Sr,useMutableSource:Sr,useSyncExternalStore:Sr,useId:Sr,unstable_isNewReconciler:!1},A8={readContext:Ui,useCallback:function(n,e){return ja().memoizedState=[n,e===void 0?null:e],n},useContext:Ui,useEffect:cj,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,$S(4194308,4,VV.bind(null,e,n),t)},useLayoutEffect:function(n,e){return $S(4194308,4,n,e)},useInsertionEffect:function(n,e){return $S(4,2,n,e)},useMemo:function(n,e){var t=ja();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=ja();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=S8.bind(null,Qt,n),[r.memoizedState,n]},useRef:function(n){var e=ja();return n={current:n},e.memoizedState=n},useState:lj,useDebugValue:QR,useDeferredValue:function(n){return ja().memoizedState=n},useTransition:function(){var n=lj(!1),e=n[0];return n=x8.bind(null,n[1]),ja().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Qt,s=ja();if(qt){if(t===void 0)throw Error(oe(407));t=t()}else{if(t=e(),Jn===null)throw Error(oe(349));hf&30||RV(r,e,t)}s.memoizedState=t;var i={value:t,getSnapshot:e};return s.queue=i,cj(OV.bind(null,r,i,n),[n]),r.flags|=2048,T0(9,MV.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=ja(),e=Jn.identifierPrefix;if(qt){var t=kl,r=Cl;t=(r&~(1<<32-wa(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=E0++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=_8++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},T8={readContext:Ui,useCallback:zV,useContext:Ui,useEffect:XR,useImperativeHandle:BV,useInsertionEffect:$V,useLayoutEffect:UV,useMemo:HV,useReducer:rN,useRef:FV,useState:function(){return rN(A0)},useDebugValue:QR,useDeferredValue:function(n){var e=Vi();return WV(e,Dn.memoizedState,n)},useTransition:function(){var n=rN(A0)[0],e=Vi().memoizedState;return[n,e]},useMutableSource:IV,useSyncExternalStore:DV,useId:GV,unstable_isNewReconciler:!1},C8={readContext:Ui,useCallback:zV,useContext:Ui,useEffect:XR,useImperativeHandle:BV,useInsertionEffect:$V,useLayoutEffect:UV,useMemo:HV,useReducer:sN,useRef:FV,useState:function(){return sN(A0)},useDebugValue:QR,useDeferredValue:function(n){var e=Vi();return Dn===null?e.memoizedState=n:WV(e,Dn.memoizedState,n)},useTransition:function(){var n=sN(A0)[0],e=Vi().memoizedState;return[n,e]},useMutableSource:IV,useSyncExternalStore:DV,useId:GV,unstable_isNewReconciler:!1};function Zi(n,e){if(n&&n.defaultProps){e=Zt({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function EP(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Zt({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var aC={isMounted:function(n){return(n=n._reactInternals)?Rf(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=ss(),s=Ru(n),i=Ml(r,s);i.payload=e,t!=null&&(i.callback=t),e=Iu(n,i,s),e!==null&&(ba(e,n,s,r),jS(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=ss(),s=Ru(n),i=Ml(r,s);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Iu(n,i,s),e!==null&&(ba(e,n,s,r),jS(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=ss(),r=Ru(n),s=Ml(t,r);s.tag=2,e!=null&&(s.callback=e),e=Iu(n,s,r),e!==null&&(ba(e,n,r,t),jS(e,n,r))}};function uj(n,e,t,r,s,i,a){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!v0(t,r)||!v0(s,i):!0}function XV(n,e,t){var r=!1,s=Uu,i=e.contextType;return typeof i=="object"&&i!==null?i=Ui(i):(s=Es(e)?cf:$r.current,r=e.contextTypes,i=(r=r!=null)?Yg(n,s):Uu),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=aC,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=i),e}function hj(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&aC.enqueueReplaceState(e,e.state,null)}function AP(n,e,t,r){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},zR(n);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Ui(i):(i=Es(e)?cf:$r.current,s.context=Yg(n,i)),s.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(EP(n,e,i,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&aC.enqueueReplaceState(s,s.state,null),r1(n,t,s,r),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function Jg(n,e){try{var t="",r=e;do t+=tq(r),r=r.return;while(r);var s=t}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:s,digest:null}}function iN(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function TP(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var k8=typeof WeakMap=="function"?WeakMap:Map;function QV(n,e,t){t=Ml(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){l1||(l1=!0,LP=r),TP(n,e)},t}function JV(n,e,t){t=Ml(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;t.payload=function(){return r(s)},t.callback=function(){TP(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){TP(n,e),typeof r!="function"&&(Du===null?Du=new Set([this]):Du.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),t}function dj(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new k8;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(t)||(s.add(t),n=B8.bind(null,n,e,t),e.then(n,n))}function fj(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function pj(n,e,t,r,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ml(-1,1),e.tag=2,Iu(t,e,1))),t.lanes|=1),n)}var N8=Jl.ReactCurrentOwner,xs=!1;function Zr(n,e,t,r){e.child=n===null?CV(e,null,t,r):Xg(e,n.child,t,r)}function mj(n,e,t,r,s){t=t.render;var i=e.ref;return Lp(e,s),r=YR(n,e,t,r,i,s),t=KR(),n!==null&&!xs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Bl(n,e,s)):(qt&&t&&LR(e),e.flags|=1,Zr(n,e,r,s),e.child)}function gj(n,e,t,r,s){if(n===null){var i=t.type;return typeof i=="function"&&!i2(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,ZV(n,e,i,r,s)):(n=zS(t.type,null,r,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&s)){var a=i.memoizedProps;if(t=t.compare,t=t!==null?t:v0,t(a,r)&&n.ref===e.ref)return Bl(n,e,s)}return e.flags|=1,n=Mu(i,r),n.ref=e.ref,n.return=e,e.child=n}function ZV(n,e,t,r,s){if(n!==null){var i=n.memoizedProps;if(v0(i,r)&&n.ref===e.ref)if(xs=!1,e.pendingProps=r=i,(n.lanes&s)!==0)n.flags&131072&&(xs=!0);else return e.lanes=n.lanes,Bl(n,e,s)}return CP(n,e,t,r,s)}function e3(n,e,t){var r=e.pendingProps,s=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pt(Ep,ni),ni|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Pt(Ep,ni),ni|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Pt(Ep,ni),ni|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Pt(Ep,ni),ni|=r;return Zr(n,e,s,t),e.child}function t3(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function CP(n,e,t,r,s){var i=Es(t)?cf:$r.current;return i=Yg(e,i),Lp(e,s),t=YR(n,e,t,r,i,s),r=KR(),n!==null&&!xs?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Bl(n,e,s)):(qt&&r&&LR(e),e.flags|=1,Zr(n,e,t,s),e.child)}function yj(n,e,t,r,s){if(Es(t)){var i=!0;JE(e)}else i=!1;if(Lp(e,s),e.stateNode===null)US(n,e),XV(e,t,r),AP(e,t,r,s),r=!0;else if(n===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,u=t.contextType;typeof u=="object"&&u!==null?u=Ui(u):(u=Es(t)?cf:$r.current,u=Yg(e,u));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function";f||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&hj(e,a,r,u),fc=!1;var p=e.memoizedState;a.state=p,r1(e,r,a,s),l=e.memoizedState,o!==r||p!==l||Ss.current||fc?(typeof h=="function"&&(EP(e,t,h,r),l=e.memoizedState),(o=fc||uj(e,t,o,r,p,l,u))?(f||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,NV(n,e),o=e.memoizedProps,u=e.type===e.elementType?o:Zi(e.type,o),a.props=u,f=e.pendingProps,p=a.context,l=t.contextType,typeof l=="object"&&l!==null?l=Ui(l):(l=Es(t)?cf:$r.current,l=Yg(e,l));var g=t.getDerivedStateFromProps;(h=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==f||p!==l)&&hj(e,a,r,l),fc=!1,p=e.memoizedState,a.state=p,r1(e,r,a,s);var v=e.memoizedState;o!==f||p!==v||Ss.current||fc?(typeof g=="function"&&(EP(e,t,g,r),v=e.memoizedState),(u=fc||uj(e,t,u,r,p,v,l)||!1)?(h||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),a.props=r,a.state=v,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),r=!1)}return kP(n,e,t,r,i,s)}function kP(n,e,t,r,s,i){t3(n,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&nj(e,t,!1),Bl(n,e,i);r=e.stateNode,N8.current=e;var o=a&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&a?(e.child=Xg(e,n.child,null,i),e.child=Xg(e,null,o,i)):Zr(n,e,o,i),e.memoizedState=r.state,s&&nj(e,t,!0),e.child}function n3(n){var e=n.stateNode;e.pendingContext?tj(n,e.pendingContext,e.pendingContext!==e.context):e.context&&tj(n,e.context,!1),HR(n,e.containerInfo)}function vj(n,e,t,r,s){return Kg(),FR(s),e.flags|=256,Zr(n,e,t,r),e.child}var NP={dehydrated:null,treeContext:null,retryLane:0};function PP(n){return{baseLanes:n,cachePool:null,transitions:null}}function r3(n,e,t){var r=e.pendingProps,s=Xt.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=n!==null&&n.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Pt(Xt,s&1),n===null)return xP(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,n=r.fallback,i?(r=e.mode,i=e.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=cC(a,r,0,null),n=nf(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=PP(t),e.memoizedState=NP,n):JR(e,a));if(s=n.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return P8(n,e,a,r,o,s,t);if(i){i=r.fallback,a=e.mode,s=n.child,o=s.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Mu(s,l),r.subtreeFlags=s.subtreeFlags&14680064),o!==null?i=Mu(o,i):(i=nf(i,a,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,a=n.child.memoizedState,a=a===null?PP(t):{baseLanes:a.baseLanes|t,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=n.childLanes&~t,e.memoizedState=NP,r}return i=n.child,n=i.sibling,r=Mu(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function JR(n,e){return e=cC({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function nS(n,e,t,r){return r!==null&&FR(r),Xg(e,n.child,null,t),n=JR(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function P8(n,e,t,r,s,i,a){if(t)return e.flags&256?(e.flags&=-257,r=iN(Error(oe(422))),nS(n,e,a,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=cC({mode:"visible",children:r.children},s,0,null),i=nf(i,s,a,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Xg(e,n.child,null,a),e.child.memoizedState=PP(a),e.memoizedState=NP,i);if(!(e.mode&1))return nS(n,e,a,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(oe(419)),r=iN(i,r,void 0),nS(n,e,a,r)}if(o=(a&n.childLanes)!==0,xs||o){if(r=Jn,r!==null){switch(a&-a){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|a)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Vl(n,s),ba(r,n,s,-1))}return s2(),r=iN(Error(oe(421))),nS(n,e,a,r)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=z8.bind(null,n),s._reactRetry=e,null):(n=i.treeContext,ii=Pu(s.nextSibling),li=e,qt=!0,ma=null,n!==null&&(Ii[Di++]=Cl,Ii[Di++]=kl,Ii[Di++]=uf,Cl=n.id,kl=n.overflow,uf=e),e=JR(e,r.children),e.flags|=4096,e)}function wj(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),SP(n.return,e,t)}function aN(n,e,t,r,s){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=s)}function s3(n,e,t){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Zr(n,e,r.children,t),r=Xt.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&wj(n,t,e);else if(n.tag===19)wj(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Pt(Xt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&s1(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),aN(e,!1,s,t,i);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&s1(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}aN(e,!0,t,null,i);break;case"together":aN(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function US(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Bl(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),df|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(oe(153));if(e.child!==null){for(n=e.child,t=Mu(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Mu(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function I8(n,e,t){switch(e.tag){case 3:n3(e),Kg();break;case 5:PV(e);break;case 1:Es(e.type)&&JE(e);break;case 4:HR(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Pt(t1,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Pt(Xt,Xt.current&1),e.flags|=128,null):t&e.child.childLanes?r3(n,e,t):(Pt(Xt,Xt.current&1),n=Bl(n,e,t),n!==null?n.sibling:null);Pt(Xt,Xt.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return s3(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Pt(Xt,Xt.current),r)break;return null;case 22:case 23:return e.lanes=0,e3(n,e,t)}return Bl(n,e,t)}var i3,IP,a3,o3;i3=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};IP=function(){};a3=function(n,e,t,r){var s=n.memoizedProps;if(s!==r){n=e.stateNode,Eh(go.current);var i=null;switch(t){case"input":s=ZN(n,s),r=ZN(n,r),i=[];break;case"select":s=Zt({},s,{value:void 0}),r=Zt({},r,{value:void 0}),i=[];break;case"textarea":s=nP(n,s),r=nP(n,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=XE)}sP(t,r);var a;t=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(a in o)o.hasOwnProperty(a)&&(t||(t={}),t[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(h0.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var l=r[u];if(o=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(t||(t={}),t[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(t||(t={}),t[a]=l[a])}else t||(i||(i=[]),i.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(i=i||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(h0.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Ot("scroll",n),i||o===l||(i=[])):(i=i||[]).push(u,l))}t&&(i=i||[]).push("style",t);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};o3=function(n,e,t,r){t!==r&&(e.flags|=4)};function ev(n,e){if(!qt)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Er(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function D8(n,e,t){var r=e.pendingProps;switch(jR(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(e),null;case 1:return Es(e.type)&&QE(),Er(e),null;case 3:return r=e.stateNode,Qg(),$t(Ss),$t($r),GR(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(eS(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ma!==null&&($P(ma),ma=null))),IP(n,e),Er(e),null;case 5:WR(e);var s=Eh(S0.current);if(t=e.type,n!==null&&e.stateNode!=null)a3(n,e,t,r,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return Er(e),null}if(n=Eh(go.current),eS(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[co]=e,r[_0]=i,n=(e.mode&1)!==0,t){case"dialog":Ot("cancel",r),Ot("close",r);break;case"iframe":case"object":case"embed":Ot("load",r);break;case"video":case"audio":for(s=0;s<vv.length;s++)Ot(vv[s],r);break;case"source":Ot("error",r);break;case"img":case"image":case"link":Ot("error",r),Ot("load",r);break;case"details":Ot("toggle",r);break;case"input":kL(r,i),Ot("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ot("invalid",r);break;case"textarea":PL(r,i),Ot("invalid",r)}sP(t,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&Zx(r.textContent,o,n),s=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Zx(r.textContent,o,n),s=["children",""+o]):h0.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ot("scroll",r)}switch(t){case"input":Wx(r),NL(r,i,!0);break;case"textarea":Wx(r),IL(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=XE)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=OU(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=a.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=a.createElement(t,{is:r.is}):(n=a.createElement(t),t==="select"&&(a=n,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):n=a.createElementNS(n,t),n[co]=e,n[_0]=r,i3(n,e,!1,!1),e.stateNode=n;e:{switch(a=iP(t,r),t){case"dialog":Ot("cancel",n),Ot("close",n),s=r;break;case"iframe":case"object":case"embed":Ot("load",n),s=r;break;case"video":case"audio":for(s=0;s<vv.length;s++)Ot(vv[s],n);s=r;break;case"source":Ot("error",n),s=r;break;case"img":case"image":case"link":Ot("error",n),Ot("load",n),s=r;break;case"details":Ot("toggle",n),s=r;break;case"input":kL(n,r),s=ZN(n,r),Ot("invalid",n);break;case"option":s=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},s=Zt({},r,{value:void 0}),Ot("invalid",n);break;case"textarea":PL(n,r),s=nP(n,r),Ot("invalid",n);break;default:s=r}sP(t,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="style"?FU(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&LU(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&d0(n,l):typeof l=="number"&&d0(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(h0.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ot("scroll",n):l!=null&&xR(n,i,l,a))}switch(t){case"input":Wx(n),NL(n,r,!1);break;case"textarea":Wx(n),IL(n);break;case"option":r.value!=null&&n.setAttribute("value",""+$u(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Dp(n,!!r.multiple,i,!1):r.defaultValue!=null&&Dp(n,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=XE)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Er(e),null;case 6:if(n&&e.stateNode!=null)o3(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(t=Eh(S0.current),Eh(go.current),eS(e)){if(r=e.stateNode,t=e.memoizedProps,r[co]=e,(i=r.nodeValue!==t)&&(n=li,n!==null))switch(n.tag){case 3:Zx(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Zx(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[co]=e,e.stateNode=r}return Er(e),null;case 13:if($t(Xt),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(qt&&ii!==null&&e.mode&1&&!(e.flags&128))AV(),Kg(),e.flags|=98560,i=!1;else if(i=eS(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(oe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[co]=e}else Kg(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Er(e),i=!1}else ma!==null&&($P(ma),ma=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||Xt.current&1?Ln===0&&(Ln=3):s2())),e.updateQueue!==null&&(e.flags|=4),Er(e),null);case 4:return Qg(),IP(n,e),n===null&&w0(e.stateNode.containerInfo),Er(e),null;case 10:return VR(e.type._context),Er(e),null;case 17:return Es(e.type)&&QE(),Er(e),null;case 19:if($t(Xt),i=e.memoizedState,i===null)return Er(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)ev(i,!1);else{if(Ln!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(a=s1(n),a!==null){for(e.flags|=128,ev(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,n=a.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Pt(Xt,Xt.current&1|2),e.child}n=n.sibling}i.tail!==null&&wn()>Zg&&(e.flags|=128,r=!0,ev(i,!1),e.lanes=4194304)}else{if(!r)if(n=s1(a),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),ev(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!qt)return Er(e),null}else 2*wn()-i.renderingStartTime>Zg&&t!==1073741824&&(e.flags|=128,r=!0,ev(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(t=i.last,t!==null?t.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=wn(),e.sibling=null,t=Xt.current,Pt(Xt,r?t&1|2:t&1),e):(Er(e),null);case 22:case 23:return r2(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ni&1073741824&&(Er(e),e.subtreeFlags&6&&(e.flags|=8192)):Er(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function R8(n,e){switch(jR(e),e.tag){case 1:return Es(e.type)&&QE(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Qg(),$t(Ss),$t($r),GR(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return WR(e),null;case 13:if($t(Xt),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));Kg()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return $t(Xt),null;case 4:return Qg(),null;case 10:return VR(e.type._context),null;case 22:case 23:return r2(),null;case 24:return null;default:return null}}var rS=!1,Or=!1,M8=typeof WeakSet=="function"?WeakSet:Set,we=null;function Sp(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){on(n,e,r)}else t.current=null}function DP(n,e,t){try{t()}catch(r){on(n,e,r)}}var bj=!1;function O8(n,e){if(mP=qE,n=dV(),OR(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var a=0,o=-1,l=-1,u=0,h=0,f=n,p=null;t:for(;;){for(var g;f!==t||s!==0&&f.nodeType!==3||(o=a+s),f!==i||r!==0&&f.nodeType!==3||(l=a+r),f.nodeType===3&&(a+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===n)break t;if(p===t&&++u===s&&(o=a),p===i&&++h===r&&(l=a),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}t=o===-1||l===-1?null:{start:o,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(gP={focusedElem:n,selectionRange:t},qE=!1,we=e;we!==null;)if(e=we,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,we=n;else for(;we!==null;){e=we;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var y=v.memoizedProps,_=v.memoizedState,w=e.stateNode,b=w.getSnapshotBeforeUpdate(e.elementType===e.type?y:Zi(e.type,y),_);w.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(T){on(e,e.return,T)}if(n=e.sibling,n!==null){n.return=e.return,we=n;break}we=e.return}return v=bj,bj=!1,v}function Zv(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&n)===n){var i=s.destroy;s.destroy=void 0,i!==void 0&&DP(e,t,i)}s=s.next}while(s!==r)}}function oC(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function RP(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function l3(n){var e=n.alternate;e!==null&&(n.alternate=null,l3(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[co],delete e[_0],delete e[wP],delete e[y8],delete e[v8])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function c3(n){return n.tag===5||n.tag===3||n.tag===4}function _j(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||c3(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function MP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=XE));else if(r!==4&&(n=n.child,n!==null))for(MP(n,e,t),n=n.sibling;n!==null;)MP(n,e,t),n=n.sibling}function OP(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(OP(n,e,t),n=n.sibling;n!==null;)OP(n,e,t),n=n.sibling}var cr=null,pa=!1;function lc(n,e,t){for(t=t.child;t!==null;)u3(n,e,t),t=t.sibling}function u3(n,e,t){if(mo&&typeof mo.onCommitFiberUnmount=="function")try{mo.onCommitFiberUnmount(ZT,t)}catch{}switch(t.tag){case 5:Or||Sp(t,e);case 6:var r=cr,s=pa;cr=null,lc(n,e,t),cr=r,pa=s,cr!==null&&(pa?(n=cr,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):cr.removeChild(t.stateNode));break;case 18:cr!==null&&(pa?(n=cr,t=t.stateNode,n.nodeType===8?Zk(n.parentNode,t):n.nodeType===1&&Zk(n,t),g0(n)):Zk(cr,t.stateNode));break;case 4:r=cr,s=pa,cr=t.stateNode.containerInfo,pa=!0,lc(n,e,t),cr=r,pa=s;break;case 0:case 11:case 14:case 15:if(!Or&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&DP(t,e,a),s=s.next}while(s!==r)}lc(n,e,t);break;case 1:if(!Or&&(Sp(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(o){on(t,e,o)}lc(n,e,t);break;case 21:lc(n,e,t);break;case 22:t.mode&1?(Or=(r=Or)||t.memoizedState!==null,lc(n,e,t),Or=r):lc(n,e,t);break;default:lc(n,e,t)}}function xj(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new M8),e.forEach(function(r){var s=H8.bind(null,n,r);t.has(r)||(t.add(r),r.then(s,s))})}}function Xi(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var s=t[r];try{var i=n,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:cr=o.stateNode,pa=!1;break e;case 3:cr=o.stateNode.containerInfo,pa=!0;break e;case 4:cr=o.stateNode.containerInfo,pa=!0;break e}o=o.return}if(cr===null)throw Error(oe(160));u3(i,a,s),cr=null,pa=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){on(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)h3(e,n),e=e.sibling}function h3(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Xi(e,n),Ra(n),r&4){try{Zv(3,n,n.return),oC(3,n)}catch(y){on(n,n.return,y)}try{Zv(5,n,n.return)}catch(y){on(n,n.return,y)}}break;case 1:Xi(e,n),Ra(n),r&512&&t!==null&&Sp(t,t.return);break;case 5:if(Xi(e,n),Ra(n),r&512&&t!==null&&Sp(t,t.return),n.flags&32){var s=n.stateNode;try{d0(s,"")}catch(y){on(n,n.return,y)}}if(r&4&&(s=n.stateNode,s!=null)){var i=n.memoizedProps,a=t!==null?t.memoizedProps:i,o=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&RU(s,i),iP(o,a);var u=iP(o,i);for(a=0;a<l.length;a+=2){var h=l[a],f=l[a+1];h==="style"?FU(s,f):h==="dangerouslySetInnerHTML"?LU(s,f):h==="children"?d0(s,f):xR(s,h,f,u)}switch(o){case"input":eP(s,i);break;case"textarea":MU(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?Dp(s,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?Dp(s,!!i.multiple,i.defaultValue,!0):Dp(s,!!i.multiple,i.multiple?[]:"",!1))}s[_0]=i}catch(y){on(n,n.return,y)}}break;case 6:if(Xi(e,n),Ra(n),r&4){if(n.stateNode===null)throw Error(oe(162));s=n.stateNode,i=n.memoizedProps;try{s.nodeValue=i}catch(y){on(n,n.return,y)}}break;case 3:if(Xi(e,n),Ra(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{g0(e.containerInfo)}catch(y){on(n,n.return,y)}break;case 4:Xi(e,n),Ra(n);break;case 13:Xi(e,n),Ra(n),s=n.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(t2=wn())),r&4&&xj(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Or=(u=Or)||h,Xi(e,n),Or=u):Xi(e,n),Ra(n),r&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(we=n,h=n.child;h!==null;){for(f=we=h;we!==null;){switch(p=we,g=p.child,p.tag){case 0:case 11:case 14:case 15:Zv(4,p,p.return);break;case 1:Sp(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,t=p.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(y){on(r,t,y)}}break;case 5:Sp(p,p.return);break;case 22:if(p.memoizedState!==null){Ej(f);continue}}g!==null?(g.return=p,we=g):Ej(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{s=f.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=f.stateNode,l=f.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=jU("display",a))}catch(y){on(n,n.return,y)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(y){on(n,n.return,y)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Xi(e,n),Ra(n),r&4&&xj(n);break;case 21:break;default:Xi(e,n),Ra(n)}}function Ra(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(c3(t)){var r=t;break e}t=t.return}throw Error(oe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(d0(s,""),r.flags&=-33);var i=_j(n);OP(n,i,s);break;case 3:case 4:var a=r.stateNode.containerInfo,o=_j(n);MP(n,o,a);break;default:throw Error(oe(161))}}catch(l){on(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function L8(n,e,t){we=n,d3(n)}function d3(n,e,t){for(var r=(n.mode&1)!==0;we!==null;){var s=we,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||rS;if(!a){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Or;o=rS;var u=Or;if(rS=a,(Or=l)&&!u)for(we=s;we!==null;)a=we,l=a.child,a.tag===22&&a.memoizedState!==null?Aj(s):l!==null?(l.return=a,we=l):Aj(s);for(;i!==null;)we=i,d3(i),i=i.sibling;we=s,rS=o,Or=u}Sj(n)}else s.subtreeFlags&8772&&i!==null?(i.return=s,we=i):Sj(n)}}function Sj(n){for(;we!==null;){var e=we;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Or||oC(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Or)if(t===null)r.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:Zi(e.type,t.memoizedProps);r.componentDidUpdate(s,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&oj(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}oj(e,a,t)}break;case 5:var o=e.stateNode;if(t===null&&e.flags&4){t=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&g0(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}Or||e.flags&512&&RP(e)}catch(p){on(e,e.return,p)}}if(e===n){we=null;break}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}}function Ej(n){for(;we!==null;){var e=we;if(e===n){we=null;break}var t=e.sibling;if(t!==null){t.return=e.return,we=t;break}we=e.return}}function Aj(n){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{oC(4,e)}catch(l){on(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){on(e,s,l)}}var i=e.return;try{RP(e)}catch(l){on(e,i,l)}break;case 5:var a=e.return;try{RP(e)}catch(l){on(e,a,l)}}}catch(l){on(e,e.return,l)}if(e===n){we=null;break}var o=e.sibling;if(o!==null){o.return=e.return,we=o;break}we=e.return}}var j8=Math.ceil,o1=Jl.ReactCurrentDispatcher,ZR=Jl.ReactCurrentOwner,ji=Jl.ReactCurrentBatchConfig,nt=0,Jn=null,An=null,fr=0,ni=0,Ep=Xu(0),Ln=0,C0=null,df=0,lC=0,e2=0,e0=null,ws=null,t2=0,Zg=1/0,$o=null,l1=!1,LP=null,Du=null,sS=!1,Su=null,c1=0,t0=0,jP=null,VS=-1,BS=0;function ss(){return nt&6?wn():VS!==-1?VS:VS=wn()}function Ru(n){return n.mode&1?nt&2&&fr!==0?fr&-fr:b8.transition!==null?(BS===0&&(BS=XU()),BS):(n=dt,n!==0||(n=window.event,n=n===void 0?16:rV(n.type)),n):1}function ba(n,e,t,r){if(50<t0)throw t0=0,jP=null,Error(oe(185));F_(n,t,r),(!(nt&2)||n!==Jn)&&(n===Jn&&(!(nt&2)&&(lC|=t),Ln===4&&mc(n,fr)),As(n,r),t===1&&nt===0&&!(e.mode&1)&&(Zg=wn()+500,sC&&Qu()))}function As(n,e){var t=n.callbackNode;bq(n,e);var r=GE(n,n===Jn?fr:0);if(r===0)t!==null&&ML(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&ML(t),e===1)n.tag===0?w8(Tj.bind(null,n)):xV(Tj.bind(null,n)),m8(function(){!(nt&6)&&Qu()}),t=null;else{switch(QU(r)){case 1:t=CR;break;case 4:t=YU;break;case 16:t=WE;break;case 536870912:t=KU;break;default:t=WE}t=b3(t,f3.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function f3(n,e){if(VS=-1,BS=0,nt&6)throw Error(oe(327));var t=n.callbackNode;if(jp()&&n.callbackNode!==t)return null;var r=GE(n,n===Jn?fr:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=u1(n,r);else{e=r;var s=nt;nt|=2;var i=m3();(Jn!==n||fr!==e)&&($o=null,Zg=wn()+500,tf(n,e));do try{U8();break}catch(o){p3(n,o)}while(1);UR(),o1.current=i,nt=s,An!==null?e=0:(Jn=null,fr=0,e=Ln)}if(e!==0){if(e===2&&(s=uP(n),s!==0&&(r=s,e=FP(n,s))),e===1)throw t=C0,tf(n,0),mc(n,r),As(n,wn()),t;if(e===6)mc(n,r);else{if(s=n.current.alternate,!(r&30)&&!F8(s)&&(e=u1(n,r),e===2&&(i=uP(n),i!==0&&(r=i,e=FP(n,i))),e===1))throw t=C0,tf(n,0),mc(n,r),As(n,wn()),t;switch(n.finishedWork=s,n.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:hh(n,ws,$o);break;case 3:if(mc(n,r),(r&130023424)===r&&(e=t2+500-wn(),10<e)){if(GE(n,0)!==0)break;if(s=n.suspendedLanes,(s&r)!==r){ss(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=vP(hh.bind(null,n,ws,$o),e);break}hh(n,ws,$o);break;case 4:if(mc(n,r),(r&4194240)===r)break;for(e=n.eventTimes,s=-1;0<r;){var a=31-wa(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=wn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*j8(r/1960))-r,10<r){n.timeoutHandle=vP(hh.bind(null,n,ws,$o),r);break}hh(n,ws,$o);break;case 5:hh(n,ws,$o);break;default:throw Error(oe(329))}}}return As(n,wn()),n.callbackNode===t?f3.bind(null,n):null}function FP(n,e){var t=e0;return n.current.memoizedState.isDehydrated&&(tf(n,e).flags|=256),n=u1(n,e),n!==2&&(e=ws,ws=t,e!==null&&$P(e)),n}function $P(n){ws===null?ws=n:ws.push.apply(ws,n)}function F8(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var s=t[r],i=s.getSnapshot;s=s.value;try{if(!xa(i(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function mc(n,e){for(e&=~e2,e&=~lC,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-wa(e),r=1<<t;n[t]=-1,e&=~r}}function Tj(n){if(nt&6)throw Error(oe(327));jp();var e=GE(n,0);if(!(e&1))return As(n,wn()),null;var t=u1(n,e);if(n.tag!==0&&t===2){var r=uP(n);r!==0&&(e=r,t=FP(n,r))}if(t===1)throw t=C0,tf(n,0),mc(n,e),As(n,wn()),t;if(t===6)throw Error(oe(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,hh(n,ws,$o),As(n,wn()),null}function n2(n,e){var t=nt;nt|=1;try{return n(e)}finally{nt=t,nt===0&&(Zg=wn()+500,sC&&Qu())}}function ff(n){Su!==null&&Su.tag===0&&!(nt&6)&&jp();var e=nt;nt|=1;var t=ji.transition,r=dt;try{if(ji.transition=null,dt=1,n)return n()}finally{dt=r,ji.transition=t,nt=e,!(nt&6)&&Qu()}}function r2(){ni=Ep.current,$t(Ep)}function tf(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,p8(t)),An!==null)for(t=An.return;t!==null;){var r=t;switch(jR(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&QE();break;case 3:Qg(),$t(Ss),$t($r),GR();break;case 5:WR(r);break;case 4:Qg();break;case 13:$t(Xt);break;case 19:$t(Xt);break;case 10:VR(r.type._context);break;case 22:case 23:r2()}t=t.return}if(Jn=n,An=n=Mu(n.current,null),fr=ni=e,Ln=0,C0=null,e2=lC=df=0,ws=e0=null,Sh!==null){for(e=0;e<Sh.length;e++)if(t=Sh[e],r=t.interleaved,r!==null){t.interleaved=null;var s=r.next,i=t.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}t.pending=r}Sh=null}return n}function p3(n,e){do{var t=An;try{if(UR(),FS.current=a1,i1){for(var r=Qt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}i1=!1}if(hf=0,Qn=Dn=Qt=null,Jv=!1,E0=0,ZR.current=null,t===null||t.return===null){Ln=1,C0=e,An=null;break}e:{var i=n,a=t.return,o=t,l=e;if(e=fr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=o,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=fj(a);if(g!==null){g.flags&=-257,pj(g,a,o,i,e),g.mode&1&&dj(i,u,e),e=g,l=u;var v=e.updateQueue;if(v===null){var y=new Set;y.add(l),e.updateQueue=y}else v.add(l);break e}else{if(!(e&1)){dj(i,u,e),s2();break e}l=Error(oe(426))}}else if(qt&&o.mode&1){var _=fj(a);if(_!==null){!(_.flags&65536)&&(_.flags|=256),pj(_,a,o,i,e),FR(Jg(l,o));break e}}i=l=Jg(l,o),Ln!==4&&(Ln=2),e0===null?e0=[i]:e0.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=QV(i,l,e);aj(i,w);break e;case 1:o=l;var b=i.type,S=i.stateNode;if(!(i.flags&128)&&(typeof b.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Du===null||!Du.has(S)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=JV(i,o,e);aj(i,T);break e}}i=i.return}while(i!==null)}y3(t)}catch(P){e=P,An===t&&t!==null&&(An=t=t.return);continue}break}while(1)}function m3(){var n=o1.current;return o1.current=a1,n===null?a1:n}function s2(){(Ln===0||Ln===3||Ln===2)&&(Ln=4),Jn===null||!(df&268435455)&&!(lC&268435455)||mc(Jn,fr)}function u1(n,e){var t=nt;nt|=2;var r=m3();(Jn!==n||fr!==e)&&($o=null,tf(n,e));do try{$8();break}catch(s){p3(n,s)}while(1);if(UR(),nt=t,o1.current=r,An!==null)throw Error(oe(261));return Jn=null,fr=0,Ln}function $8(){for(;An!==null;)g3(An)}function U8(){for(;An!==null&&!hq();)g3(An)}function g3(n){var e=w3(n.alternate,n,ni);n.memoizedProps=n.pendingProps,e===null?y3(n):An=e,ZR.current=null}function y3(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=R8(t,e),t!==null){t.flags&=32767,An=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Ln=6,An=null;return}}else if(t=D8(t,e,ni),t!==null){An=t;return}if(e=e.sibling,e!==null){An=e;return}An=e=n}while(e!==null);Ln===0&&(Ln=5)}function hh(n,e,t){var r=dt,s=ji.transition;try{ji.transition=null,dt=1,V8(n,e,t,r)}finally{ji.transition=s,dt=r}return null}function V8(n,e,t,r){do jp();while(Su!==null);if(nt&6)throw Error(oe(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(oe(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(_q(n,i),n===Jn&&(An=Jn=null,fr=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||sS||(sS=!0,b3(WE,function(){return jp(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=ji.transition,ji.transition=null;var a=dt;dt=1;var o=nt;nt|=4,ZR.current=null,O8(n,t),h3(t,n),o8(gP),qE=!!mP,gP=mP=null,n.current=t,L8(t),dq(),nt=o,dt=a,ji.transition=i}else n.current=t;if(sS&&(sS=!1,Su=n,c1=s),i=n.pendingLanes,i===0&&(Du=null),mq(t.stateNode),As(n,wn()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],r(s.value,{componentStack:s.stack,digest:s.digest});if(l1)throw l1=!1,n=LP,LP=null,n;return c1&1&&n.tag!==0&&jp(),i=n.pendingLanes,i&1?n===jP?t0++:(t0=0,jP=n):t0=0,Qu(),null}function jp(){if(Su!==null){var n=QU(c1),e=ji.transition,t=dt;try{if(ji.transition=null,dt=16>n?16:n,Su===null)var r=!1;else{if(n=Su,Su=null,c1=0,nt&6)throw Error(oe(331));var s=nt;for(nt|=4,we=n.current;we!==null;){var i=we,a=i.child;if(we.flags&16){var o=i.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(we=u;we!==null;){var h=we;switch(h.tag){case 0:case 11:case 15:Zv(8,h,i)}var f=h.child;if(f!==null)f.return=h,we=f;else for(;we!==null;){h=we;var p=h.sibling,g=h.return;if(l3(h),h===u){we=null;break}if(p!==null){p.return=g,we=p;break}we=g}}}var v=i.alternate;if(v!==null){var y=v.child;if(y!==null){v.child=null;do{var _=y.sibling;y.sibling=null,y=_}while(y!==null)}}we=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,we=a;else e:for(;we!==null;){if(i=we,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Zv(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,we=w;break e}we=i.return}}var b=n.current;for(we=b;we!==null;){a=we;var S=a.child;if(a.subtreeFlags&2064&&S!==null)S.return=a,we=S;else e:for(a=b;we!==null;){if(o=we,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:oC(9,o)}}catch(P){on(o,o.return,P)}if(o===a){we=null;break e}var T=o.sibling;if(T!==null){T.return=o.return,we=T;break e}we=o.return}}if(nt=s,Qu(),mo&&typeof mo.onPostCommitFiberRoot=="function")try{mo.onPostCommitFiberRoot(ZT,n)}catch{}r=!0}return r}finally{dt=t,ji.transition=e}}return!1}function Cj(n,e,t){e=Jg(t,e),e=QV(n,e,1),n=Iu(n,e,1),e=ss(),n!==null&&(F_(n,1,e),As(n,e))}function on(n,e,t){if(n.tag===3)Cj(n,n,t);else for(;e!==null;){if(e.tag===3){Cj(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Du===null||!Du.has(r))){n=Jg(t,n),n=JV(e,n,1),e=Iu(e,n,1),n=ss(),e!==null&&(F_(e,1,n),As(e,n));break}}e=e.return}}function B8(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=ss(),n.pingedLanes|=n.suspendedLanes&t,Jn===n&&(fr&t)===t&&(Ln===4||Ln===3&&(fr&130023424)===fr&&500>wn()-t2?tf(n,0):e2|=t),As(n,e)}function v3(n,e){e===0&&(n.mode&1?(e=Yx,Yx<<=1,!(Yx&130023424)&&(Yx=4194304)):e=1);var t=ss();n=Vl(n,e),n!==null&&(F_(n,e,t),As(n,t))}function z8(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),v3(n,t)}function H8(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),v3(n,t)}var w3;w3=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Ss.current)xs=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return xs=!1,I8(n,e,t);xs=!!(n.flags&131072)}else xs=!1,qt&&e.flags&1048576&&SV(e,e1,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;US(n,e),n=e.pendingProps;var s=Yg(e,$r.current);Lp(e,t),s=YR(null,e,r,n,s,t);var i=KR();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Es(r)?(i=!0,JE(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,zR(e),s.updater=aC,e.stateNode=s,s._reactInternals=e,AP(e,r,n,t),e=kP(null,e,r,!0,i,t)):(e.tag=0,qt&&i&&LR(e),Zr(null,e,s,t),e=e.child),e;case 16:r=e.elementType;e:{switch(US(n,e),n=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=G8(r),n=Zi(r,n),s){case 0:e=CP(null,e,r,n,t);break e;case 1:e=yj(null,e,r,n,t);break e;case 11:e=mj(null,e,r,n,t);break e;case 14:e=gj(null,e,r,Zi(r.type,n),t);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zi(r,s),CP(n,e,r,s,t);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zi(r,s),yj(n,e,r,s,t);case 3:e:{if(n3(e),n===null)throw Error(oe(387));r=e.pendingProps,i=e.memoizedState,s=i.element,NV(n,e),r1(e,r,null,t);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Jg(Error(oe(423)),e),e=vj(n,e,r,t,s);break e}else if(r!==s){s=Jg(Error(oe(424)),e),e=vj(n,e,r,t,s);break e}else for(ii=Pu(e.stateNode.containerInfo.firstChild),li=e,qt=!0,ma=null,t=CV(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Kg(),r===s){e=Bl(n,e,t);break e}Zr(n,e,r,t)}e=e.child}return e;case 5:return PV(e),n===null&&xP(e),r=e.type,s=e.pendingProps,i=n!==null?n.memoizedProps:null,a=s.children,yP(r,s)?a=null:i!==null&&yP(r,i)&&(e.flags|=32),t3(n,e),Zr(n,e,a,t),e.child;case 6:return n===null&&xP(e),null;case 13:return r3(n,e,t);case 4:return HR(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=Xg(e,null,r,t):Zr(n,e,r,t),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zi(r,s),mj(n,e,r,s,t);case 7:return Zr(n,e,e.pendingProps,t),e.child;case 8:return Zr(n,e,e.pendingProps.children,t),e.child;case 12:return Zr(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Pt(t1,r._currentValue),r._currentValue=a,i!==null)if(xa(i.value,a)){if(i.children===s.children&&!Ss.current){e=Bl(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Ml(-1,t&-t),l.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),SP(i.return,t,e),o.lanes|=t;break}l=l.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(oe(341));a.lanes|=t,o=a.alternate,o!==null&&(o.lanes|=t),SP(a,t,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Zr(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Lp(e,t),s=Ui(s),r=r(s),e.flags|=1,Zr(n,e,r,t),e.child;case 14:return r=e.type,s=Zi(r,e.pendingProps),s=Zi(r.type,s),gj(n,e,r,s,t);case 15:return ZV(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Zi(r,s),US(n,e),e.tag=1,Es(r)?(n=!0,JE(e)):n=!1,Lp(e,t),XV(e,r,s),AP(e,r,s,t),kP(null,e,r,!0,n,t);case 19:return s3(n,e,t);case 22:return e3(n,e,t)}throw Error(oe(156,e.tag))};function b3(n,e){return qU(n,e)}function W8(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Li(n,e,t,r){return new W8(n,e,t,r)}function i2(n){return n=n.prototype,!(!n||!n.isReactComponent)}function G8(n){if(typeof n=="function")return i2(n)?1:0;if(n!=null){if(n=n.$$typeof,n===ER)return 11;if(n===AR)return 14}return 2}function Mu(n,e){var t=n.alternate;return t===null?(t=Li(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function zS(n,e,t,r,s,i){var a=2;if(r=n,typeof n=="function")i2(n)&&(a=1);else if(typeof n=="string")a=5;else e:switch(n){case pp:return nf(t.children,s,i,e);case SR:a=8,s|=8;break;case KN:return n=Li(12,t,e,s|2),n.elementType=KN,n.lanes=i,n;case XN:return n=Li(13,t,e,s),n.elementType=XN,n.lanes=i,n;case QN:return n=Li(19,t,e,s),n.elementType=QN,n.lanes=i,n;case PU:return cC(t,s,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case kU:a=10;break e;case NU:a=9;break e;case ER:a=11;break e;case AR:a=14;break e;case dc:a=16,r=null;break e}throw Error(oe(130,n==null?n:typeof n,""))}return e=Li(a,t,e,s),e.elementType=n,e.type=r,e.lanes=i,e}function nf(n,e,t,r){return n=Li(7,n,r,e),n.lanes=t,n}function cC(n,e,t,r){return n=Li(22,n,r,e),n.elementType=PU,n.lanes=t,n.stateNode={isHidden:!1},n}function oN(n,e,t){return n=Li(6,n,null,e),n.lanes=t,n}function lN(n,e,t){return e=Li(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function q8(n,e,t,r,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Bk(0),this.expirationTimes=Bk(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Bk(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function a2(n,e,t,r,s,i,a,o,l){return n=new q8(n,e,t,o,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Li(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},zR(i),n}function Y8(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fp,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function _3(n){if(!n)return Uu;n=n._reactInternals;e:{if(Rf(n)!==n||n.tag!==1)throw Error(oe(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Es(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(n.tag===1){var t=n.type;if(Es(t))return _V(n,t,e)}return e}function x3(n,e,t,r,s,i,a,o,l){return n=a2(t,r,!0,n,s,i,a,o,l),n.context=_3(null),t=n.current,r=ss(),s=Ru(t),i=Ml(r,s),i.callback=e??null,Iu(t,i,s),n.current.lanes=s,F_(n,s,r),As(n,r),n}function uC(n,e,t,r){var s=e.current,i=ss(),a=Ru(s);return t=_3(t),e.context===null?e.context=t:e.pendingContext=t,e=Ml(i,a),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=Iu(s,e,a),n!==null&&(ba(n,s,a,i),jS(n,s,a)),a}function h1(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function kj(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function o2(n,e){kj(n,e),(n=n.alternate)&&kj(n,e)}function K8(){return null}var S3=typeof reportError=="function"?reportError:function(n){console.error(n)};function l2(n){this._internalRoot=n}hC.prototype.render=l2.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(oe(409));uC(n,e,null,null)};hC.prototype.unmount=l2.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ff(function(){uC(null,n,null,null)}),e[Ul]=null}};function hC(n){this._internalRoot=n}hC.prototype.unstable_scheduleHydration=function(n){if(n){var e=eV();n={blockedOn:null,target:n,priority:e};for(var t=0;t<pc.length&&e!==0&&e<pc[t].priority;t++);pc.splice(t,0,n),t===0&&nV(n)}};function c2(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function dC(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Nj(){}function X8(n,e,t,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=h1(a);i.call(u)}}var a=x3(e,r,n,0,null,!1,!1,"",Nj);return n._reactRootContainer=a,n[Ul]=a.current,w0(n.nodeType===8?n.parentNode:n),ff(),a}for(;s=n.lastChild;)n.removeChild(s);if(typeof r=="function"){var o=r;r=function(){var u=h1(l);o.call(u)}}var l=a2(n,0,!1,null,null,!1,!1,"",Nj);return n._reactRootContainer=l,n[Ul]=l.current,w0(n.nodeType===8?n.parentNode:n),ff(function(){uC(e,l,t,r)}),l}function fC(n,e,t,r,s){var i=t._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var l=h1(a);o.call(l)}}uC(e,a,n,s)}else a=X8(t,e,n,s,r);return h1(a)}JU=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=yv(e.pendingLanes);t!==0&&(kR(e,t|1),As(e,wn()),!(nt&6)&&(Zg=wn()+500,Qu()))}break;case 13:ff(function(){var r=Vl(n,1);if(r!==null){var s=ss();ba(r,n,1,s)}}),o2(n,1)}};NR=function(n){if(n.tag===13){var e=Vl(n,134217728);if(e!==null){var t=ss();ba(e,n,134217728,t)}o2(n,134217728)}};ZU=function(n){if(n.tag===13){var e=Ru(n),t=Vl(n,e);if(t!==null){var r=ss();ba(t,n,e,r)}o2(n,e)}};eV=function(){return dt};tV=function(n,e){var t=dt;try{return dt=n,e()}finally{dt=t}};oP=function(n,e,t){switch(e){case"input":if(eP(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var s=rC(r);if(!s)throw Error(oe(90));DU(r),eP(r,s)}}}break;case"textarea":MU(n,t);break;case"select":e=t.value,e!=null&&Dp(n,!!t.multiple,e,!1)}};VU=n2;BU=ff;var Q8={usingClientEntryPoint:!1,Events:[U_,vp,rC,$U,UU,n2]},tv={findFiberByHostInstance:xh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},J8={bundleType:tv.bundleType,version:tv.version,rendererPackageName:tv.rendererPackageName,rendererConfig:tv.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jl.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=WU(n),n===null?null:n.stateNode},findFiberByHostInstance:tv.findFiberByHostInstance||K8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iS.isDisabled&&iS.supportsFiber)try{ZT=iS.inject(J8),mo=iS}catch{}}di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q8;di.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c2(e))throw Error(oe(200));return Y8(n,e,null,t)};di.createRoot=function(n,e){if(!c2(n))throw Error(oe(299));var t=!1,r="",s=S3;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=a2(n,1,!1,null,null,t,!1,r,s),n[Ul]=e.current,w0(n.nodeType===8?n.parentNode:n),new l2(e)};di.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(oe(188)):(n=Object.keys(n).join(","),Error(oe(268,n)));return n=WU(e),n=n===null?null:n.stateNode,n};di.flushSync=function(n){return ff(n)};di.hydrate=function(n,e,t){if(!dC(e))throw Error(oe(200));return fC(null,n,e,!0,t)};di.hydrateRoot=function(n,e,t){if(!c2(n))throw Error(oe(405));var r=t!=null&&t.hydratedSources||null,s=!1,i="",a=S3;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),e=x3(e,null,n,1,t??null,s,!1,i,a),n[Ul]=e.current,w0(n),r)for(n=0;n<r.length;n++)t=r[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new hC(e)};di.render=function(n,e,t){if(!dC(e))throw Error(oe(200));return fC(null,n,e,!1,t)};di.unmountComponentAtNode=function(n){if(!dC(n))throw Error(oe(40));return n._reactRootContainer?(ff(function(){fC(null,null,n,!1,function(){n._reactRootContainer=null,n[Ul]=null})}),!0):!1};di.unstable_batchedUpdates=n2;di.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!dC(t))throw Error(oe(200));if(n==null||n._reactInternals===void 0)throw Error(oe(38));return fC(n,e,t,!1,r)};di.version="18.3.1-next-f1338f8080-20240426";function E3(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(E3)}catch(n){console.error(n)}}E3(),EU.exports=di;var A3=EU.exports;const T3=Ps(A3);var Pj=A3;qN.createRoot=Pj.createRoot,qN.hydrateRoot=Pj.hydrateRoot;var Z8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const e7=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t7=(n,e)=>{const t=B.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:a,children:o,...l},u)=>B.createElement("svg",{ref:u,...Z8,width:s,height:s,stroke:r,strokeWidth:a?Number(i)*24/Number(s):i,className:`lucide lucide-${e7(n)}`,...l},[...e.map(([h,f])=>B.createElement(h,f)),...(Array.isArray(o)?o:[o])||[]]));return t.displayName=`${n}`,t};var Be=t7;const So=Be("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),ya=Be("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ci=Be("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]),C3=Be("Check",[["polyline",{points:"20 6 9 17 4 12",key:"10jjfj"}]]),k3=Be("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),N3=Be("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),pf=Be("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),n7=Be("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Ij=Be("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),P3=Be("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),I3=Be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),r7=Be("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),cN=Be("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),HS=Be("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),bs=Be("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),UP=Be("Folder",[["path",{d:"M4 20h16a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.93a2 2 0 0 1-1.66-.9l-.82-1.2A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13c0 1.1.9 2 2 2Z",key:"1fr9dc"}]]),D3=Be("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),d1=Be("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]),R3=Be("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),M3=Be("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),f1=Be("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),O3=Be("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),p1=Be("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),s7=Be("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]),VP=Be("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),i7=Be("PenTool",[["path",{d:"m12 19 7-7 3 3-7 7-3-3z",key:"rklqx2"}],["path",{d:"m18 13-1.5-7.5L2 2l3.5 14.5L13 18l5-5z",key:"1et58u"}],["path",{d:"m2 2 7.586 7.586",key:"etlp93"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]),WS=Be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),a7=Be("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),o7=Be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),m1=Be("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),l7=Be("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ho=Be("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),u2=Be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),c7=Be("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),k0=Be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),u7=Be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Dj=Be("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Fp=Be("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),es=Be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L3=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},h7=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],a=n[t++],o=n[t++],l=((s&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],a=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|a&63)}}return e.join("")},j3={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],a=s+1<n.length,o=a?n[s+1]:0,l=s+2<n.length,u=l?n[s+2]:0,h=i>>2,f=(i&3)<<4|o>>4;let p=(o&15)<<2|u>>6,g=u&63;l||(g=64,a||(p=64)),r.push(t[h],t[f],t[p],t[g])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(L3(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):h7(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],o=s<n.length?t[n.charAt(s)]:0;++s;const u=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||o==null||u==null||f==null)throw new d7;const p=i<<2|o>>4;if(r.push(p),u!==64){const g=o<<4&240|u>>2;if(r.push(g),f!==64){const v=u<<6&192|f;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class d7 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const f7=function(n){const e=L3(n);return j3.encodeByteArray(e,!0)},g1=function(n){return f7(n).replace(/\./g,"")},F3=function(n){try{return j3.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m7=()=>p7().__FIREBASE_DEFAULTS__,g7=()=>{if(typeof process>"u"||typeof process.env>"u")return;const n={}.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},y7=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&F3(n[1]);return e&&JSON.parse(e)},pC=()=>{try{return m7()||g7()||y7()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$3=n=>{var e,t;return(t=(e=pC())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},h2=n=>{const e=$3(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},U3=()=>{var n;return(n=pC())===null||n===void 0?void 0:n.config},V3=n=>{var e;return(e=pC())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v7{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B3(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n),o="";return[g1(JSON.stringify(t)),g1(JSON.stringify(a)),o].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function w7(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ur())}function b7(){var n;const e=(n=pC())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function _7(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function x7(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function S7(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function E7(){const n=Ur();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function A7(){return!b7()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function T7(){try{return typeof indexedDB=="object"}catch{return!1}}function C7(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k7="FirebaseError";class ka extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=k7,Object.setPrototypeOf(this,ka.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,B_.prototype.create)}}class B_{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],a=i?N7(i,r):"Error",o=`${this.serviceName}: ${a} (${s}).`;return new ka(s,o,r)}}function N7(n,e){return n.replace(P7,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const P7=/\{\$([^}]+)}/g;function I7(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function y1(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],a=e[s];if(Rj(i)&&Rj(a)){if(!y1(i,a))return!1}else if(i!==a)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Rj(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z_(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function wv(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function bv(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function D7(n,e){const t=new R7(n,e);return t.subscribe.bind(t)}class R7{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");M7(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=uN),s.error===void 0&&(s.error=uN),s.complete===void 0&&(s.complete=uN);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function M7(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function uN(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pt(n){return n&&n._delegate?n._delegate:n}class zl{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dh="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new v7;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(j7(e))try{this.getOrInitializeService({instanceIdentifier:dh})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=dh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=dh){return this.instances.has(e)}getOptions(e=dh){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,a]of this.instancesDeferred.entries()){const o=this.normalizeInstanceIdentifier(i);r===o&&a.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const a=this.instances.get(s);return a&&e(a,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:L7(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=dh){return this.component?this.component.multipleInstances?e:dh:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function L7(n){return n===dh?void 0:n}function j7(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new O7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Xe||(Xe={}));const $7={debug:Xe.DEBUG,verbose:Xe.VERBOSE,info:Xe.INFO,warn:Xe.WARN,error:Xe.ERROR,silent:Xe.SILENT},U7=Xe.INFO,V7={[Xe.DEBUG]:"log",[Xe.VERBOSE]:"log",[Xe.INFO]:"info",[Xe.WARN]:"warn",[Xe.ERROR]:"error"},B7=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=V7[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class d2{constructor(e){this.name=e,this._logLevel=U7,this._logHandler=B7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xe.DEBUG,...e),this._logHandler(this,Xe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xe.VERBOSE,...e),this._logHandler(this,Xe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xe.INFO,...e),this._logHandler(this,Xe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xe.WARN,...e),this._logHandler(this,Xe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xe.ERROR,...e),this._logHandler(this,Xe.ERROR,...e)}}const z7=(n,e)=>e.some(t=>n instanceof t);let Mj,Oj;function H7(){return Mj||(Mj=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function W7(){return Oj||(Oj=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const z3=new WeakMap,BP=new WeakMap,H3=new WeakMap,hN=new WeakMap,f2=new WeakMap;function G7(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",a)},i=()=>{t(Ou(n.result)),s()},a=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&z3.set(t,n)}).catch(()=>{}),f2.set(e,n),e}function q7(n){if(BP.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",a),n.removeEventListener("abort",a)},i=()=>{t(),s()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",a),n.addEventListener("abort",a)});BP.set(n,e)}let zP={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return BP.get(n);if(e==="objectStoreNames")return n.objectStoreNames||H3.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ou(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Y7(n){zP=n(zP)}function K7(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(dN(this),e,...t);return H3.set(r,e.sort?e.sort():[e]),Ou(r)}:W7().includes(n)?function(...e){return n.apply(dN(this),e),Ou(z3.get(this))}:function(...e){return Ou(n.apply(dN(this),e))}}function X7(n){return typeof n=="function"?K7(n):(n instanceof IDBTransaction&&q7(n),z7(n,H7())?new Proxy(n,zP):n)}function Ou(n){if(n instanceof IDBRequest)return G7(n);if(hN.has(n))return hN.get(n);const e=X7(n);return e!==n&&(hN.set(n,e),f2.set(e,n)),e}const dN=n=>f2.get(n);function Q7(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const a=indexedDB.open(n,e),o=Ou(a);return r&&a.addEventListener("upgradeneeded",l=>{r(Ou(a.result),l.oldVersion,l.newVersion,Ou(a.transaction),l)}),t&&a.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),o.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),o}const J7=["get","getKey","getAll","getAllKeys","count"],Z7=["put","add","delete","clear"],fN=new Map;function Lj(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(fN.get(e))return fN.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Z7.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||J7.includes(t)))return;const i=async function(a,...o){const l=this.transaction(a,s?"readwrite":"readonly");let u=l.store;return r&&(u=u.index(o.shift())),(await Promise.all([u[t](...o),s&&l.done]))[0]};return fN.set(e,i),i}Y7(n=>({...n,get:(e,t,r)=>Lj(e,t)||n.get(e,t,r),has:(e,t)=>!!Lj(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eY{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tY(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function tY(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const HP="@firebase/app",jj="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hl=new d2("@firebase/app"),nY="@firebase/app-compat",rY="@firebase/analytics-compat",sY="@firebase/analytics",iY="@firebase/app-check-compat",aY="@firebase/app-check",oY="@firebase/auth",lY="@firebase/auth-compat",cY="@firebase/database",uY="@firebase/data-connect",hY="@firebase/database-compat",dY="@firebase/functions",fY="@firebase/functions-compat",pY="@firebase/installations",mY="@firebase/installations-compat",gY="@firebase/messaging",yY="@firebase/messaging-compat",vY="@firebase/performance",wY="@firebase/performance-compat",bY="@firebase/remote-config",_Y="@firebase/remote-config-compat",xY="@firebase/storage",SY="@firebase/storage-compat",EY="@firebase/firestore",AY="@firebase/vertexai-preview",TY="@firebase/firestore-compat",CY="firebase",kY="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WP="[DEFAULT]",NY={[HP]:"fire-core",[nY]:"fire-core-compat",[sY]:"fire-analytics",[rY]:"fire-analytics-compat",[aY]:"fire-app-check",[iY]:"fire-app-check-compat",[oY]:"fire-auth",[lY]:"fire-auth-compat",[cY]:"fire-rtdb",[uY]:"fire-data-connect",[hY]:"fire-rtdb-compat",[dY]:"fire-fn",[fY]:"fire-fn-compat",[pY]:"fire-iid",[mY]:"fire-iid-compat",[gY]:"fire-fcm",[yY]:"fire-fcm-compat",[vY]:"fire-perf",[wY]:"fire-perf-compat",[bY]:"fire-rc",[_Y]:"fire-rc-compat",[xY]:"fire-gcs",[SY]:"fire-gcs-compat",[EY]:"fire-fst",[TY]:"fire-fst-compat",[AY]:"fire-vertex","fire-js":"fire-js",[CY]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v1=new Map,PY=new Map,GP=new Map;function Fj(n,e){try{n.container.addComponent(e)}catch(t){Hl.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Vu(n){const e=n.name;if(GP.has(e))return Hl.debug(`There were multiple attempts to register component ${e}.`),!1;GP.set(e,n);for(const t of v1.values())Fj(t,n);for(const t of PY.values())Fj(t,n);return!0}function H_(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function fo(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IY={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Lu=new B_("app","Firebase",IY);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DY{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new zl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Lu.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mf=kY;function W3(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:WP,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Lu.create("bad-app-name",{appName:String(s)});if(t||(t=U3()),!t)throw Lu.create("no-options");const i=v1.get(s);if(i){if(y1(t,i.options)&&y1(r,i.config))return i;throw Lu.create("duplicate-app",{appName:s})}const a=new F7(s);for(const l of GP.values())a.addComponent(l);const o=new DY(t,r,a);return v1.set(s,o),o}function mC(n=WP){const e=v1.get(n);if(!e&&n===WP&&U3())return W3();if(!e)throw Lu.create("no-app",{appName:n});return e}function Fi(n,e,t){var r;let s=(r=NY[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),a=e.match(/\s|\//);if(i||a){const o=[`Unable to register library "${s}" with version "${e}":`];i&&o.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Hl.warn(o.join(" "));return}Vu(new zl(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RY="firebase-heartbeat-database",MY=1,N0="firebase-heartbeat-store";let pN=null;function G3(){return pN||(pN=Q7(RY,MY,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(N0)}catch(t){console.warn(t)}}}}).catch(n=>{throw Lu.create("idb-open",{originalErrorMessage:n.message})})),pN}async function OY(n){try{const t=(await G3()).transaction(N0),r=await t.objectStore(N0).get(q3(n));return await t.done,r}catch(e){if(e instanceof ka)Hl.warn(e.message);else{const t=Lu.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Hl.warn(t.message)}}}async function $j(n,e){try{const r=(await G3()).transaction(N0,"readwrite");await r.objectStore(N0).put(e,q3(n)),await r.done}catch(t){if(t instanceof ka)Hl.warn(t.message);else{const r=Lu.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Hl.warn(r.message)}}}function q3(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LY=1024,jY=30*24*60*60*1e3;class FY{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new UY(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Uj();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{const o=new Date(a.date).valueOf();return Date.now()-o<=jY}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Hl.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Uj(),{heartbeatsToSend:r,unsentEntries:s}=$Y(this._heartbeatsCache.heartbeats),i=g1(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return Hl.warn(t),""}}}function Uj(){return new Date().toISOString().substring(0,10)}function $Y(n,e=LY){const t=[];let r=n.slice();for(const s of n){const i=t.find(a=>a.agent===s.agent);if(i){if(i.dates.push(s.date),Vj(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Vj(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class UY{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return T7()?C7().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await OY(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return $j(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return $j(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Vj(n){return g1(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VY(n){Vu(new zl("platform-logger",e=>new eY(e),"PRIVATE")),Vu(new zl("heartbeat",e=>new FY(e),"PRIVATE")),Fi(HP,jj,n),Fi(HP,jj,"esm2017"),Fi("fire-js","")}VY("");function p2(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function Y3(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const BY=Y3,K3=new B_("auth","Firebase",Y3());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w1=new d2("@firebase/auth");function zY(n,...e){w1.logLevel<=Xe.WARN&&w1.warn(`Auth (${Mf}): ${n}`,...e)}function GS(n,...e){w1.logLevel<=Xe.ERROR&&w1.error(`Auth (${Mf}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(n,...e){throw m2(n,...e)}function yo(n,...e){return m2(n,...e)}function X3(n,e,t){const r=Object.assign(Object.assign({},BY()),{[e]:t});return new B_("auth","Firebase",r).create(e,{appName:n.name})}function Ol(n){return X3(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function m2(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return K3.create(n,...e)}function Pe(n,e,...t){if(!n)throw m2(e,...t)}function Nl(n){const e="INTERNAL ASSERTION FAILED: "+n;throw GS(e),new Error(e)}function Wl(n,e){n||Nl(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qP(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function HY(){return Bj()==="http:"||Bj()==="https:"}function Bj(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WY(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(HY()||x7()||"connection"in navigator)?navigator.onLine:!0}function GY(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W_{constructor(e,t){this.shortDelay=e,this.longDelay=t,Wl(t>e,"Short delay should be less than long delay!"),this.isMobile=w7()||S7()}get(){return WY()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(n,e){Wl(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q3{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Nl("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Nl("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Nl("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qY={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YY=new W_(3e4,6e4);function Ju(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Zl(n,e,t,r,s={}){return J3(n,s,async()=>{let i={},a={};r&&(e==="GET"?a=r:i={body:JSON.stringify(r)});const o=z_(Object.assign({key:n.config.apiKey},a)).slice(1),l=await n._getAdditionalHeaders();l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode);const u=Object.assign({method:e,headers:l},i);return _7()||(u.referrerPolicy="no-referrer"),Q3.fetch()(Z3(n,n.config.apiHost,t,o),u)})}async function J3(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},qY),e);try{const s=new XY(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const a=await i.json();if("needConfirmation"in a)throw aS(n,"account-exists-with-different-credential",a);if(i.ok&&!("errorMessage"in a))return a;{const o=i.ok?a.errorMessage:a.error.message,[l,u]=o.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw aS(n,"credential-already-in-use",a);if(l==="EMAIL_EXISTS")throw aS(n,"email-already-in-use",a);if(l==="USER_DISABLED")throw aS(n,"user-disabled",a);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw X3(n,h,u);Sa(n,h)}}catch(s){if(s instanceof ka)throw s;Sa(n,"network-request-failed",{message:String(s)})}}async function G_(n,e,t,r,s={}){const i=await Zl(n,e,t,r,s);return"mfaPendingCredential"in i&&Sa(n,"multi-factor-auth-required",{_serverResponse:i}),i}function Z3(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?g2(n.config,s):`${n.config.apiScheme}://${s}`}function KY(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class XY{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(yo(this.auth,"network-request-failed")),YY.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function aS(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=yo(n,e,r);return s.customData._tokenResponse=t,s}function zj(n){return n!==void 0&&n.enterprise!==void 0}class QY{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return KY(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function JY(n,e){return Zl(n,"GET","/v2/recaptchaConfig",Ju(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZY(n,e){return Zl(n,"POST","/v1/accounts:delete",e)}async function eB(n,e){return Zl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n0(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function eK(n,e=!1){const t=pt(n),r=await t.getIdToken(e),s=y2(r);Pe(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,a=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:n0(mN(s.auth_time)),issuedAtTime:n0(mN(s.iat)),expirationTime:n0(mN(s.exp)),signInProvider:a||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function mN(n){return Number(n)*1e3}function y2(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return GS("JWT malformed, contained fewer than 3 sections"),null;try{const s=F3(t);return s?JSON.parse(s):(GS("Failed to decode base64 JWT payload"),null)}catch(s){return GS("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Hj(n){const e=y2(n);return Pe(e,"internal-error"),Pe(typeof e.exp<"u","internal-error"),Pe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ey(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof ka&&tK(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function tK({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nK{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=n0(this.lastLoginAt),this.creationTime=n0(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b1(n){var e;const t=n.auth,r=await n.getIdToken(),s=await ey(n,eB(t,{idToken:r}));Pe(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const a=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?tB(i.providerUserInfo):[],o=sK(n.providerData,a),l=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!(o!=null&&o.length),h=l?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new YP(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function rK(n){const e=pt(n);await b1(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function sK(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function tB(n){return n.map(e=>{var{providerId:t}=e,r=p2(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iK(n,e){const t=await J3(n,{},async()=>{const r=z_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,a=Z3(n,s,"/v1/token",`key=${i}`),o=await n._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Q3.fetch()(a,{method:"POST",headers:o,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function aK(n,e){return Zl(n,"POST","/v2/accounts:revokeToken",Ju(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $p{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Pe(e.idToken,"internal-error"),Pe(typeof e.idToken<"u","internal-error"),Pe(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Hj(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Pe(e.length!==0,"internal-error");const t=Hj(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Pe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await iK(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,a=new $p;return r&&(Pe(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),s&&(Pe(typeof s=="string","internal-error",{appName:e}),a.accessToken=s),i&&(Pe(typeof i=="number","internal-error",{appName:e}),a.expirationTime=i),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $p,this.toJSON())}_performRefresh(){return Nl("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(n,e){Pe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class Pl{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=p2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new nK(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new YP(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ey(this,this.stsTokenManager.getToken(this.auth,e));return Pe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return eK(this,e)}reload(){return rK(this)}_assign(e){this!==e&&(Pe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Pl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Pe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await b1(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fo(this.auth.app))return Promise.reject(Ol(this.auth));const e=await this.getIdToken();return await ey(this,ZY(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,a,o,l,u,h;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,p=(s=t.email)!==null&&s!==void 0?s:void 0,g=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,v=(a=t.photoURL)!==null&&a!==void 0?a:void 0,y=(o=t.tenantId)!==null&&o!==void 0?o:void 0,_=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,w=(u=t.createdAt)!==null&&u!==void 0?u:void 0,b=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:S,emailVerified:T,isAnonymous:P,providerData:R,stsTokenManager:k}=t;Pe(S&&k,e,"internal-error");const C=$p.fromJSON(this.name,k);Pe(typeof S=="string",e,"internal-error"),cc(f,e.name),cc(p,e.name),Pe(typeof T=="boolean",e,"internal-error"),Pe(typeof P=="boolean",e,"internal-error"),cc(g,e.name),cc(v,e.name),cc(y,e.name),cc(_,e.name),cc(w,e.name),cc(b,e.name);const I=new Pl({uid:S,auth:e,email:p,emailVerified:T,displayName:f,isAnonymous:P,photoURL:v,phoneNumber:g,tenantId:y,stsTokenManager:C,createdAt:w,lastLoginAt:b});return R&&Array.isArray(R)&&(I.providerData=R.map(M=>Object.assign({},M))),_&&(I._redirectEventId=_),I}static async _fromIdTokenResponse(e,t,r=!1){const s=new $p;s.updateFromServerResponse(t);const i=new Pl({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await b1(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];Pe(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?tB(s.providerUserInfo):[],a=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),o=new $p;o.updateFromIdToken(r);const l=new Pl({uid:s.localId,auth:e,stsTokenManager:o,isAnonymous:a}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new YP(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,u),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wj=new Map;function Il(n){Wl(n instanceof Function,"Expected a class definition");let e=Wj.get(n);return e?(Wl(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Wj.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nB{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}nB.type="NONE";const Gj=nB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qS(n,e,t){return`firebase:${n}:${e}:${t}`}class Up{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=qS(this.userKey,s.apiKey,i),this.fullPersistenceKey=qS("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Pl._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Up(Il(Gj),e,r);const s=(await Promise.all(t.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Il(Gj);const a=qS(r,e.config.apiKey,e.name);let o=null;for(const u of t)try{const h=await u._get(a);if(h){const f=Pl._fromJSON(e,h);u!==i&&(o=f),i=u;break}}catch{}const l=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Up(i,e,r):(i=l[0],o&&await i._set(a,o.toJSON()),await Promise.all(t.map(async u=>{if(u!==i)try{await u._remove(a)}catch{}})),new Up(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qj(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(aB(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rB(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(lB(e))return"Blackberry";if(cB(e))return"Webos";if(sB(e))return"Safari";if((e.includes("chrome/")||iB(e))&&!e.includes("edge/"))return"Chrome";if(oB(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function rB(n=Ur()){return/firefox\//i.test(n)}function sB(n=Ur()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function iB(n=Ur()){return/crios\//i.test(n)}function aB(n=Ur()){return/iemobile/i.test(n)}function oB(n=Ur()){return/android/i.test(n)}function lB(n=Ur()){return/blackberry/i.test(n)}function cB(n=Ur()){return/webos/i.test(n)}function v2(n=Ur()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function oK(n=Ur()){var e;return v2(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function lK(){return E7()&&document.documentMode===10}function uB(n=Ur()){return v2(n)||oB(n)||cB(n)||lB(n)||/windows phone/i.test(n)||aB(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hB(n,e=[]){let t;switch(n){case"Browser":t=qj(Ur());break;case"Worker":t=`${qj(Ur())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Mf}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cK{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((a,o)=>{try{const l=e(i);a(l)}catch(l){o(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uK(n,e={}){return Zl(n,"GET","/v2/passwordPolicy",Ju(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hK=6;class dK{constructor(e){var t,r,s,i;const a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:hK,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,a,o;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(a=l.containsNumericCharacter)!==null&&a!==void 0?a:!0),l.isValid&&(l.isValid=(o=l.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fK{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Yj(this),this.idTokenSubscription=new Yj(this),this.beforeStateQueue=new cK(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=K3,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Il(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Up.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await eB(this,{idToken:e}),r=await Pl._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(fo(this.app)){const a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,o=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!a||a===o)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(a){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Pe(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await b1(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=GY()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fo(this.app))return Promise.reject(Ol(this));const t=e?pt(e):null;return t&&Pe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Pe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fo(this.app)?Promise.reject(Ol(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fo(this.app)?Promise.reject(Ol(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Il(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await uK(this),t=new dK(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new B_("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await aK(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Il(e)||this._popupRedirectResolver;Pe(t,this,"argument-error"),this.redirectPersistenceManager=await Up.create(this,[Il(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let a=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Pe(o,this,"internal-error"),o.then(()=>{a||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{a=!0,l()}}else{const l=e.addObserver(t);return()=>{a=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Pe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hB(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&zY(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Of(n){return pt(n)}class Yj{constructor(e){this.auth=e,this.observer=null,this.addObserver=D7(t=>this.observer=t)}get next(){return Pe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gC={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function pK(n){gC=n}function dB(n){return gC.loadJS(n)}function mK(){return gC.recaptchaEnterpriseScript}function gK(){return gC.gapiScript}function yK(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const vK="recaptcha-enterprise",wK="NO_RECAPTCHA";class bK{constructor(e){this.type=vK,this.auth=Of(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(a,o)=>{JY(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)o(new Error("recaptcha Enterprise site key undefined"));else{const u=new QY(l);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,a(u.siteKey)}}).catch(l=>{o(l)})})}function s(i,a,o){const l=window.grecaptcha;zj(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(u=>{a(u)}).catch(()=>{a(wK)})}):o(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,a)=>{r(this.auth).then(o=>{if(!t&&zj(window.grecaptcha))s(o,i,a);else{if(typeof window>"u"){a(new Error("RecaptchaVerifier is only supported in browser"));return}let l=mK();l.length!==0&&(l+=o),dB(l).then(()=>{s(o,i,a)}).catch(u=>{a(u)})}}).catch(o=>{a(o)})})}}async function Kj(n,e,t,r=!1){const s=new bK(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const a=Object.assign({},e);return r?Object.assign(a,{captchaResp:i}):Object.assign(a,{captchaResponse:i}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function KP(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Kj(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const a=await Kj(n,e,t,t==="getOobCode");return r(n,a)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _K(n,e){const t=H_(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(y1(i,e??{}))return s;Sa(s,"already-initialized")}return t.initialize({options:e})}function xK(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(Il);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function SK(n,e,t){const r=Of(n);Pe(r._canInitEmulator,r,"emulator-config-failed"),Pe(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(t!=null&&t.disableWarnings),i=fB(e),{host:a,port:o}=EK(e),l=o===null?"":`:${o}`;r.config.emulator={url:`${i}//${a}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),s||AK()}function fB(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function EK(n){const e=fB(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Xj(r.substr(i.length+1))}}else{const[i,a]=r.split(":");return{host:i,port:Xj(a)}}}function Xj(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function AK(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w2{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Nl("not implemented")}_getIdTokenResponse(e){return Nl("not implemented")}_linkToIdToken(e,t){return Nl("not implemented")}_getReauthenticationResolver(e){return Nl("not implemented")}}async function TK(n,e){return Zl(n,"POST","/v1/accounts:update",e)}async function CK(n,e){return Zl(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kK(n,e){return G_(n,"POST","/v1/accounts:signInWithPassword",Ju(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NK(n,e){return G_(n,"POST","/v1/accounts:signInWithEmailLink",Ju(n,e))}async function PK(n,e){return G_(n,"POST","/v1/accounts:signInWithEmailLink",Ju(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0 extends w2{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new P0(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new P0(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return KP(e,t,"signInWithPassword",kK);case"emailLink":return NK(e,{email:this._email,oobCode:this._password});default:Sa(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return KP(e,r,"signUpPassword",CK);case"emailLink":return PK(e,{idToken:t,email:this._email,oobCode:this._password});default:Sa(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vp(n,e){return G_(n,"POST","/v1/accounts:signInWithIdp",Ju(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IK="http://localhost";class mf extends w2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new mf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Sa("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=p2(t,["providerId","signInMethod"]);if(!r||!s)return null;const a=new mf(r,s);return a.idToken=i.idToken||void 0,a.accessToken=i.accessToken||void 0,a.secret=i.secret,a.nonce=i.nonce,a.pendingToken=i.pendingToken||null,a}_getIdTokenResponse(e){const t=this.buildRequest();return Vp(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Vp(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Vp(e,t)}buildRequest(){const e={requestUri:IK,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=z_(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DK(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function RK(n){const e=wv(bv(n)).link,t=e?wv(bv(e)).deep_link_id:null,r=wv(bv(n)).deep_link_id;return(r?wv(bv(r)).link:null)||r||t||e||n}class b2{constructor(e){var t,r,s,i,a,o;const l=wv(bv(e)),u=(t=l.apiKey)!==null&&t!==void 0?t:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,f=DK((s=l.mode)!==null&&s!==void 0?s:null);Pe(u&&h&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=h,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(a=l.languageCode)!==null&&a!==void 0?a:null,this.tenantId=(o=l.tenantId)!==null&&o!==void 0?o:null}static parseLink(e){const t=RK(e);try{return new b2(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(){this.providerId=Lf.PROVIDER_ID}static credential(e,t){return P0._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=b2.parseLink(t);return Pe(r,"argument-error"),P0._fromEmailAndCode(e,r.code,r.tenantId)}}Lf.PROVIDER_ID="password";Lf.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Lf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pB{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q_ extends pB{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gc extends q_{constructor(){super("facebook.com")}static credential(e){return mf._fromParams({providerId:gc.PROVIDER_ID,signInMethod:gc.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gc.credentialFromTaggedObject(e)}static credentialFromError(e){return gc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gc.credential(e.oauthAccessToken)}catch{return null}}}gc.FACEBOOK_SIGN_IN_METHOD="facebook.com";gc.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yc extends q_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return mf._fromParams({providerId:yc.PROVIDER_ID,signInMethod:yc.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return yc.credentialFromTaggedObject(e)}static credentialFromError(e){return yc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return yc.credential(t,r)}catch{return null}}}yc.GOOGLE_SIGN_IN_METHOD="google.com";yc.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc extends q_{constructor(){super("github.com")}static credential(e){return mf._fromParams({providerId:vc.PROVIDER_ID,signInMethod:vc.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return vc.credentialFromTaggedObject(e)}static credentialFromError(e){return vc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return vc.credential(e.oauthAccessToken)}catch{return null}}}vc.GITHUB_SIGN_IN_METHOD="github.com";vc.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc extends q_{constructor(){super("twitter.com")}static credential(e,t){return mf._fromParams({providerId:wc.PROVIDER_ID,signInMethod:wc.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return wc.credentialFromTaggedObject(e)}static credentialFromError(e){return wc.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return wc.credential(t,r)}catch{return null}}}wc.TWITTER_SIGN_IN_METHOD="twitter.com";wc.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MK(n,e){return G_(n,"POST","/v1/accounts:signUp",Ju(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await Pl._fromIdTokenResponse(e,r,s),a=Qj(r);return new gf({user:i,providerId:a,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Qj(r);return new gf({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Qj(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1 extends ka{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,_1.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new _1(e,t,r,s)}}function mB(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?_1._fromErrorAndOperation(n,i,e,r):i})}async function OK(n,e,t=!1){const r=await ey(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return gf._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gB(n,e,t=!1){const{auth:r}=n;if(fo(r.app))return Promise.reject(Ol(r));const s="reauthenticate";try{const i=await ey(n,mB(r,s,e,n),t);Pe(i.idToken,r,"internal-error");const a=y2(i.idToken);Pe(a,r,"internal-error");const{sub:o}=a;return Pe(n.uid===o,r,"user-mismatch"),gf._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Sa(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yB(n,e,t=!1){if(fo(n.app))return Promise.reject(Ol(n));const r="signIn",s=await mB(n,r,e),i=await gf._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function LK(n,e){return yB(Of(n),e)}async function jK(n,e){return gB(pt(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vB(n){const e=Of(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function FK(n,e,t){if(fo(n.app))return Promise.reject(Ol(n));const r=Of(n),a=await KP(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",MK).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&vB(n),l}),o=await gf._fromIdTokenResponse(r,"signIn",a);return await r._updateCurrentUser(o.user),o}function $K(n,e,t){return fo(n.app)?Promise.reject(Ol(n)):LK(pt(n),Lf.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&vB(n),r})}function UK(n,e){return VK(pt(n),null,e)}async function VK(n,e,t){const{auth:r}=n,i={idToken:await n.getIdToken(),returnSecureToken:!0};e&&(i.email=e),t&&(i.password=t);const a=await ey(n,TK(r,i));await n._updateTokensIfNecessary(a,!0)}function BK(n,e,t,r){return pt(n).onIdTokenChanged(e,t,r)}function zK(n,e,t){return pt(n).beforeAuthStateChanged(e,t)}function wB(n,e,t,r){return pt(n).onAuthStateChanged(e,t,r)}function bB(n){return pt(n).signOut()}const x1="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _B{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(x1,"1"),this.storage.removeItem(x1),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HK=1e3,WK=10;class xB extends _B{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uB(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((a,o,l)=>{this.notifyListeners(a,l)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const a=this.storage.getItem(r);!t&&this.localCache[r]===a||this.notifyListeners(r,a)},i=this.storage.getItem(r);lK()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,WK):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},HK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}xB.type="LOCAL";const GK=xB;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SB extends _B{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}SB.type="SESSION";const EB=SB;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qK(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new yC(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,a=this.handlersMap[s];if(!(a!=null&&a.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const o=Array.from(a).map(async u=>u(t.origin,i)),l=await qK(o);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yC.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _2(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,a;return new Promise((o,l)=>{const u=_2("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);a={messageChannel:s,onMessage(f){const p=f;if(p.data.eventId===u)switch(p.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(p.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(a),s.port1.addEventListener("message",a.onMessage),this.target.postMessage({eventType:e,eventId:u,data:t},[s.port2])}).finally(()=>{a&&this.removeMessageHandler(a)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(){return window}function KK(n){vo().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AB(){return typeof vo().WorkerGlobalScope<"u"&&typeof vo().importScripts=="function"}async function XK(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function QK(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function JK(){return AB()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TB="firebaseLocalStorageDb",ZK=1,S1="firebaseLocalStorage",CB="fbase_key";class Y_{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function vC(n,e){return n.transaction([S1],e?"readwrite":"readonly").objectStore(S1)}function eX(){const n=indexedDB.deleteDatabase(TB);return new Y_(n).toPromise()}function XP(){const n=indexedDB.open(TB,ZK);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(S1,{keyPath:CB})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(S1)?e(r):(r.close(),await eX(),e(await XP()))})})}async function Jj(n,e,t){const r=vC(n,!0).put({[CB]:e,value:t});return new Y_(r).toPromise()}async function tX(n,e){const t=vC(n,!1).get(e),r=await new Y_(t).toPromise();return r===void 0?null:r.value}function Zj(n,e){const t=vC(n,!0).delete(e);return new Y_(t).toPromise()}const nX=800,rX=3;class kB{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await XP(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>rX)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return AB()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yC._getInstance(JK()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await XK(),!this.activeServiceWorker)return;this.sender=new YK(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||QK()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await XP();return await Jj(e,x1,"1"),await Zj(e,x1),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jj(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>tX(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Zj(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=vC(s,!1).getAll();return new Y_(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nX)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}kB.type="LOCAL";const sX=kB;new W_(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iX(n,e){return e?Il(e):(Pe(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2 extends w2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Vp(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Vp(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Vp(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function aX(n){return yB(n.auth,new x2(n),n.bypassAuthState)}function oX(n){const{auth:e,user:t}=n;return Pe(t,e,"internal-error"),gB(t,new x2(n),n.bypassAuthState)}async function lX(n){const{auth:e,user:t}=n;return Pe(t,e,"internal-error"),OK(t,new x2(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:a,type:o}=e;if(a){this.reject(a);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(l))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return aX;case"linkViaPopup":case"linkViaRedirect":return lX;case"reauthViaPopup":case"reauthViaRedirect":return oX;default:Sa(this.auth,"internal-error")}}resolve(e){Wl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Wl(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cX=new W_(2e3,1e4);class Ap extends NB{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Ap.currentPopupAction&&Ap.currentPopupAction.cancel(),Ap.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Pe(e,this.auth,"internal-error"),e}async onExecution(){Wl(this.filter.length===1,"Popup operations only handle one event");const e=_2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(yo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(yo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ap.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cX.get())};e()}}Ap.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uX="pendingRedirect",YS=new Map;class hX extends NB{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=YS.get(this.auth._key());if(!e){try{const r=await dX(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}YS.set(this.auth._key(),e)}return this.bypassAuthState||YS.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dX(n,e){const t=mX(e),r=pX(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function fX(n,e){YS.set(n._key(),e)}function pX(n){return Il(n._redirectPersistence)}function mX(n){return qS(uX,n.config.apiKey,n.name)}async function gX(n,e,t=!1){if(fo(n.app))return Promise.reject(Ol(n));const r=Of(n),s=iX(r,e),a=await new hX(r,s,t).execute();return a&&!t&&(delete a.user._redirectEventId,await r._persistUserIfCurrent(a.user),await r._setRedirectUser(null,e)),a}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yX=10*60*1e3;class vX{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!wX(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!PB(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(yo(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=yX&&this.cachedEventUids.clear(),this.cachedEventUids.has(eF(e))}saveEventToCache(e){this.cachedEventUids.add(eF(e)),this.lastProcessedEventTime=Date.now()}}function eF(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function PB({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function wX(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PB(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bX(n,e={}){return Zl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _X=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,xX=/^https?/;async function SX(n){if(n.config.emulator)return;const{authorizedDomains:e}=await bX(n);for(const t of e)try{if(EX(t))return}catch{}Sa(n,"unauthorized-domain")}function EX(n){const e=qP(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const a=new URL(n);return a.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&a.hostname===r}if(!xX.test(t))return!1;if(_X.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AX=new W_(3e4,6e4);function tF(){const n=vo().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function TX(n){return new Promise((e,t)=>{var r,s,i;function a(){tF(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{tF(),t(yo(n,"network-request-failed"))},timeout:AX.get()})}if(!((s=(r=vo().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=vo().gapi)===null||i===void 0)&&i.load)a();else{const o=yK("iframefcb");return vo()[o]=()=>{gapi.load?a():t(yo(n,"network-request-failed"))},dB(`${gK()}?onload=${o}`).catch(l=>t(l))}}).catch(e=>{throw KS=null,e})}let KS=null;function CX(n){return KS=KS||TX(n),KS}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kX=new W_(5e3,15e3),NX="__/auth/iframe",PX="emulator/auth/iframe",IX={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},DX=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function RX(n){const e=n.config;Pe(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?g2(e,PX):`https://${n.config.authDomain}/${NX}`,r={apiKey:e.apiKey,appName:n.name,v:Mf},s=DX.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${z_(r).slice(1)}`}async function MX(n){const e=await CX(n),t=vo().gapi;return Pe(t,n,"internal-error"),e.open({where:document.body,url:RX(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:IX,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const a=yo(n,"network-request-failed"),o=vo().setTimeout(()=>{i(a)},kX.get());function l(){vo().clearTimeout(o),s(r)}r.ping(l).then(l,()=>{i(a)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OX={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},LX=500,jX=600,FX="_blank",$X="http://localhost";class nF{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function UX(n,e,t,r=LX,s=jX){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let o="";const l=Object.assign(Object.assign({},OX),{width:r.toString(),height:s.toString(),top:i,left:a}),u=Ur().toLowerCase();t&&(o=iB(u)?FX:t),rB(u)&&(e=e||$X,l.scrollbars="yes");const h=Object.entries(l).reduce((p,[g,v])=>`${p}${g}=${v},`,"");if(oK(u)&&o!=="_self")return VX(e||"",o),new nF(null);const f=window.open(e||"",o,h);Pe(f,n,"popup-blocked");try{f.focus()}catch{}return new nF(f)}function VX(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BX="__/auth/handler",zX="emulator/auth/handler",HX=encodeURIComponent("fac");async function rF(n,e,t,r,s,i){Pe(n.config.authDomain,n,"auth-domain-config-required"),Pe(n.config.apiKey,n,"invalid-api-key");const a={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Mf,eventId:s};if(e instanceof pB){e.setDefaultLanguage(n.languageCode),a.providerId=e.providerId||"",I7(e.getCustomParameters())||(a.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries(i||{}))a[h]=f}if(e instanceof q_){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(a.scopes=h.join(","))}n.tenantId&&(a.tid=n.tenantId);const o=a;for(const h of Object.keys(o))o[h]===void 0&&delete o[h];const l=await n._getAppCheckToken(),u=l?`#${HX}=${encodeURIComponent(l)}`:"";return`${WX(n)}?${z_(o).slice(1)}${u}`}function WX({config:n}){return n.emulator?g2(n,zX):`https://${n.authDomain}/${BX}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="webStorageSupport";class GX{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=EB,this._completeRedirectFn=gX,this._overrideRedirectResult=fX}async _openPopup(e,t,r,s){var i;Wl((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const a=await rF(e,t,r,qP(),s);return UX(e,a,_2())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await rF(e,t,r,qP(),s);return KK(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(Wl(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await MX(e),r=new vX(e);return t.register("authEvent",s=>(Pe(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(gN,{type:gN},s=>{var i;const a=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[gN];a!==void 0&&t(!!a),Sa(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=SX(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return uB()||sB()||v2()}}const qX=GX;var sF="@firebase/auth",iF="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YX{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Pe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KX(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function XX(n){Vu(new zl("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;Pe(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hB(n)},u=new fK(r,s,i,l);return xK(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Vu(new zl("auth-internal",e=>{const t=Of(e.getProvider("auth").getImmediate());return(r=>new YX(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fi(sF,iF,KX(n)),Fi(sF,iF,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QX=5*60,JX=V3("authIdTokenMaxAge")||QX;let aF=null;const ZX=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>JX)return;const s=t==null?void 0:t.token;aF!==s&&(aF=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function eQ(n=mC()){const e=H_(n,"auth");if(e.isInitialized())return e.getImmediate();const t=_K(n,{popupRedirectResolver:qX,persistence:[sX,GK,EB]}),r=V3("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const a=ZX(i.toString());zK(t,a,()=>a(t.currentUser)),BK(t,o=>a(o))}}const s=$3("auth");return s&&SK(t,`http://${s}`),t}function tQ(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}pK({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=yo("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",tQ().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});XX("Browser");var oF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var rf,IB;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,C){function I(){}I.prototype=C.prototype,k.D=C.prototype,k.prototype=new I,k.prototype.constructor=k,k.C=function(M,L,F){for(var O=Array(arguments.length-2),Y=2;Y<arguments.length;Y++)O[Y-2]=arguments[Y];return C.prototype[L].apply(M,O)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(k,C,I){I||(I=0);var M=Array(16);if(typeof C=="string")for(var L=0;16>L;++L)M[L]=C.charCodeAt(I++)|C.charCodeAt(I++)<<8|C.charCodeAt(I++)<<16|C.charCodeAt(I++)<<24;else for(L=0;16>L;++L)M[L]=C[I++]|C[I++]<<8|C[I++]<<16|C[I++]<<24;C=k.g[0],I=k.g[1],L=k.g[2];var F=k.g[3],O=C+(F^I&(L^F))+M[0]+3614090360&4294967295;C=I+(O<<7&4294967295|O>>>25),O=F+(L^C&(I^L))+M[1]+3905402710&4294967295,F=C+(O<<12&4294967295|O>>>20),O=L+(I^F&(C^I))+M[2]+606105819&4294967295,L=F+(O<<17&4294967295|O>>>15),O=I+(C^L&(F^C))+M[3]+3250441966&4294967295,I=L+(O<<22&4294967295|O>>>10),O=C+(F^I&(L^F))+M[4]+4118548399&4294967295,C=I+(O<<7&4294967295|O>>>25),O=F+(L^C&(I^L))+M[5]+1200080426&4294967295,F=C+(O<<12&4294967295|O>>>20),O=L+(I^F&(C^I))+M[6]+2821735955&4294967295,L=F+(O<<17&4294967295|O>>>15),O=I+(C^L&(F^C))+M[7]+4249261313&4294967295,I=L+(O<<22&4294967295|O>>>10),O=C+(F^I&(L^F))+M[8]+1770035416&4294967295,C=I+(O<<7&4294967295|O>>>25),O=F+(L^C&(I^L))+M[9]+2336552879&4294967295,F=C+(O<<12&4294967295|O>>>20),O=L+(I^F&(C^I))+M[10]+4294925233&4294967295,L=F+(O<<17&4294967295|O>>>15),O=I+(C^L&(F^C))+M[11]+2304563134&4294967295,I=L+(O<<22&4294967295|O>>>10),O=C+(F^I&(L^F))+M[12]+1804603682&4294967295,C=I+(O<<7&4294967295|O>>>25),O=F+(L^C&(I^L))+M[13]+4254626195&4294967295,F=C+(O<<12&4294967295|O>>>20),O=L+(I^F&(C^I))+M[14]+2792965006&4294967295,L=F+(O<<17&4294967295|O>>>15),O=I+(C^L&(F^C))+M[15]+1236535329&4294967295,I=L+(O<<22&4294967295|O>>>10),O=C+(L^F&(I^L))+M[1]+4129170786&4294967295,C=I+(O<<5&4294967295|O>>>27),O=F+(I^L&(C^I))+M[6]+3225465664&4294967295,F=C+(O<<9&4294967295|O>>>23),O=L+(C^I&(F^C))+M[11]+643717713&4294967295,L=F+(O<<14&4294967295|O>>>18),O=I+(F^C&(L^F))+M[0]+3921069994&4294967295,I=L+(O<<20&4294967295|O>>>12),O=C+(L^F&(I^L))+M[5]+3593408605&4294967295,C=I+(O<<5&4294967295|O>>>27),O=F+(I^L&(C^I))+M[10]+38016083&4294967295,F=C+(O<<9&4294967295|O>>>23),O=L+(C^I&(F^C))+M[15]+3634488961&4294967295,L=F+(O<<14&4294967295|O>>>18),O=I+(F^C&(L^F))+M[4]+3889429448&4294967295,I=L+(O<<20&4294967295|O>>>12),O=C+(L^F&(I^L))+M[9]+568446438&4294967295,C=I+(O<<5&4294967295|O>>>27),O=F+(I^L&(C^I))+M[14]+3275163606&4294967295,F=C+(O<<9&4294967295|O>>>23),O=L+(C^I&(F^C))+M[3]+4107603335&4294967295,L=F+(O<<14&4294967295|O>>>18),O=I+(F^C&(L^F))+M[8]+1163531501&4294967295,I=L+(O<<20&4294967295|O>>>12),O=C+(L^F&(I^L))+M[13]+2850285829&4294967295,C=I+(O<<5&4294967295|O>>>27),O=F+(I^L&(C^I))+M[2]+4243563512&4294967295,F=C+(O<<9&4294967295|O>>>23),O=L+(C^I&(F^C))+M[7]+1735328473&4294967295,L=F+(O<<14&4294967295|O>>>18),O=I+(F^C&(L^F))+M[12]+2368359562&4294967295,I=L+(O<<20&4294967295|O>>>12),O=C+(I^L^F)+M[5]+4294588738&4294967295,C=I+(O<<4&4294967295|O>>>28),O=F+(C^I^L)+M[8]+2272392833&4294967295,F=C+(O<<11&4294967295|O>>>21),O=L+(F^C^I)+M[11]+1839030562&4294967295,L=F+(O<<16&4294967295|O>>>16),O=I+(L^F^C)+M[14]+4259657740&4294967295,I=L+(O<<23&4294967295|O>>>9),O=C+(I^L^F)+M[1]+2763975236&4294967295,C=I+(O<<4&4294967295|O>>>28),O=F+(C^I^L)+M[4]+1272893353&4294967295,F=C+(O<<11&4294967295|O>>>21),O=L+(F^C^I)+M[7]+4139469664&4294967295,L=F+(O<<16&4294967295|O>>>16),O=I+(L^F^C)+M[10]+3200236656&4294967295,I=L+(O<<23&4294967295|O>>>9),O=C+(I^L^F)+M[13]+681279174&4294967295,C=I+(O<<4&4294967295|O>>>28),O=F+(C^I^L)+M[0]+3936430074&4294967295,F=C+(O<<11&4294967295|O>>>21),O=L+(F^C^I)+M[3]+3572445317&4294967295,L=F+(O<<16&4294967295|O>>>16),O=I+(L^F^C)+M[6]+76029189&4294967295,I=L+(O<<23&4294967295|O>>>9),O=C+(I^L^F)+M[9]+3654602809&4294967295,C=I+(O<<4&4294967295|O>>>28),O=F+(C^I^L)+M[12]+3873151461&4294967295,F=C+(O<<11&4294967295|O>>>21),O=L+(F^C^I)+M[15]+530742520&4294967295,L=F+(O<<16&4294967295|O>>>16),O=I+(L^F^C)+M[2]+3299628645&4294967295,I=L+(O<<23&4294967295|O>>>9),O=C+(L^(I|~F))+M[0]+4096336452&4294967295,C=I+(O<<6&4294967295|O>>>26),O=F+(I^(C|~L))+M[7]+1126891415&4294967295,F=C+(O<<10&4294967295|O>>>22),O=L+(C^(F|~I))+M[14]+2878612391&4294967295,L=F+(O<<15&4294967295|O>>>17),O=I+(F^(L|~C))+M[5]+4237533241&4294967295,I=L+(O<<21&4294967295|O>>>11),O=C+(L^(I|~F))+M[12]+1700485571&4294967295,C=I+(O<<6&4294967295|O>>>26),O=F+(I^(C|~L))+M[3]+2399980690&4294967295,F=C+(O<<10&4294967295|O>>>22),O=L+(C^(F|~I))+M[10]+4293915773&4294967295,L=F+(O<<15&4294967295|O>>>17),O=I+(F^(L|~C))+M[1]+2240044497&4294967295,I=L+(O<<21&4294967295|O>>>11),O=C+(L^(I|~F))+M[8]+1873313359&4294967295,C=I+(O<<6&4294967295|O>>>26),O=F+(I^(C|~L))+M[15]+4264355552&4294967295,F=C+(O<<10&4294967295|O>>>22),O=L+(C^(F|~I))+M[6]+2734768916&4294967295,L=F+(O<<15&4294967295|O>>>17),O=I+(F^(L|~C))+M[13]+1309151649&4294967295,I=L+(O<<21&4294967295|O>>>11),O=C+(L^(I|~F))+M[4]+4149444226&4294967295,C=I+(O<<6&4294967295|O>>>26),O=F+(I^(C|~L))+M[11]+3174756917&4294967295,F=C+(O<<10&4294967295|O>>>22),O=L+(C^(F|~I))+M[2]+718787259&4294967295,L=F+(O<<15&4294967295|O>>>17),O=I+(F^(L|~C))+M[9]+3951481745&4294967295,k.g[0]=k.g[0]+C&4294967295,k.g[1]=k.g[1]+(L+(O<<21&4294967295|O>>>11))&4294967295,k.g[2]=k.g[2]+L&4294967295,k.g[3]=k.g[3]+F&4294967295}r.prototype.u=function(k,C){C===void 0&&(C=k.length);for(var I=C-this.blockSize,M=this.B,L=this.h,F=0;F<C;){if(L==0)for(;F<=I;)s(this,k,F),F+=this.blockSize;if(typeof k=="string"){for(;F<C;)if(M[L++]=k.charCodeAt(F++),L==this.blockSize){s(this,M),L=0;break}}else for(;F<C;)if(M[L++]=k[F++],L==this.blockSize){s(this,M),L=0;break}}this.h=L,this.o+=C},r.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var C=1;C<k.length-8;++C)k[C]=0;var I=8*this.o;for(C=k.length-8;C<k.length;++C)k[C]=I&255,I/=256;for(this.u(k),k=Array(16),C=I=0;4>C;++C)for(var M=0;32>M;M+=8)k[I++]=this.g[C]>>>M&255;return k};function i(k,C){var I=o;return Object.prototype.hasOwnProperty.call(I,k)?I[k]:I[k]=C(k)}function a(k,C){this.h=C;for(var I=[],M=!0,L=k.length-1;0<=L;L--){var F=k[L]|0;M&&F==C||(I[L]=F,M=!1)}this.g=I}var o={};function l(k){return-128<=k&&128>k?i(k,function(C){return new a([C|0],0>C?-1:0)}):new a([k|0],0>k?-1:0)}function u(k){if(isNaN(k)||!isFinite(k))return f;if(0>k)return _(u(-k));for(var C=[],I=1,M=0;k>=I;M++)C[M]=k/I|0,I*=4294967296;return new a(C,0)}function h(k,C){if(k.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(k.charAt(0)=="-")return _(h(k.substring(1),C));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var I=u(Math.pow(C,8)),M=f,L=0;L<k.length;L+=8){var F=Math.min(8,k.length-L),O=parseInt(k.substring(L,L+F),C);8>F?(F=u(Math.pow(C,F)),M=M.j(F).add(u(O))):(M=M.j(I),M=M.add(u(O)))}return M}var f=l(0),p=l(1),g=l(16777216);n=a.prototype,n.m=function(){if(y(this))return-_(this).m();for(var k=0,C=1,I=0;I<this.g.length;I++){var M=this.i(I);k+=(0<=M?M:4294967296+M)*C,C*=4294967296}return k},n.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(v(this))return"0";if(y(this))return"-"+_(this).toString(k);for(var C=u(Math.pow(k,6)),I=this,M="";;){var L=T(I,C).g;I=w(I,L.j(C));var F=((0<I.g.length?I.g[0]:I.h)>>>0).toString(k);if(I=L,v(I))return F+M;for(;6>F.length;)F="0"+F;M=F+M}},n.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function v(k){if(k.h!=0)return!1;for(var C=0;C<k.g.length;C++)if(k.g[C]!=0)return!1;return!0}function y(k){return k.h==-1}n.l=function(k){return k=w(this,k),y(k)?-1:v(k)?0:1};function _(k){for(var C=k.g.length,I=[],M=0;M<C;M++)I[M]=~k.g[M];return new a(I,~k.h).add(p)}n.abs=function(){return y(this)?_(this):this},n.add=function(k){for(var C=Math.max(this.g.length,k.g.length),I=[],M=0,L=0;L<=C;L++){var F=M+(this.i(L)&65535)+(k.i(L)&65535),O=(F>>>16)+(this.i(L)>>>16)+(k.i(L)>>>16);M=O>>>16,F&=65535,O&=65535,I[L]=O<<16|F}return new a(I,I[I.length-1]&-2147483648?-1:0)};function w(k,C){return k.add(_(C))}n.j=function(k){if(v(this)||v(k))return f;if(y(this))return y(k)?_(this).j(_(k)):_(_(this).j(k));if(y(k))return _(this.j(_(k)));if(0>this.l(g)&&0>k.l(g))return u(this.m()*k.m());for(var C=this.g.length+k.g.length,I=[],M=0;M<2*C;M++)I[M]=0;for(M=0;M<this.g.length;M++)for(var L=0;L<k.g.length;L++){var F=this.i(M)>>>16,O=this.i(M)&65535,Y=k.i(L)>>>16,Z=k.i(L)&65535;I[2*M+2*L]+=O*Z,b(I,2*M+2*L),I[2*M+2*L+1]+=F*Z,b(I,2*M+2*L+1),I[2*M+2*L+1]+=O*Y,b(I,2*M+2*L+1),I[2*M+2*L+2]+=F*Y,b(I,2*M+2*L+2)}for(M=0;M<C;M++)I[M]=I[2*M+1]<<16|I[2*M];for(M=C;M<2*C;M++)I[M]=0;return new a(I,0)};function b(k,C){for(;(k[C]&65535)!=k[C];)k[C+1]+=k[C]>>>16,k[C]&=65535,C++}function S(k,C){this.g=k,this.h=C}function T(k,C){if(v(C))throw Error("division by zero");if(v(k))return new S(f,f);if(y(k))return C=T(_(k),C),new S(_(C.g),_(C.h));if(y(C))return C=T(k,_(C)),new S(_(C.g),C.h);if(30<k.g.length){if(y(k)||y(C))throw Error("slowDivide_ only works with positive integers.");for(var I=p,M=C;0>=M.l(k);)I=P(I),M=P(M);var L=R(I,1),F=R(M,1);for(M=R(M,2),I=R(I,2);!v(M);){var O=F.add(M);0>=O.l(k)&&(L=L.add(I),F=O),M=R(M,1),I=R(I,1)}return C=w(k,L.j(C)),new S(L,C)}for(L=f;0<=k.l(C);){for(I=Math.max(1,Math.floor(k.m()/C.m())),M=Math.ceil(Math.log(I)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),F=u(I),O=F.j(C);y(O)||0<O.l(k);)I-=M,F=u(I),O=F.j(C);v(F)&&(F=p),L=L.add(F),k=w(k,O)}return new S(L,k)}n.A=function(k){return T(this,k).h},n.and=function(k){for(var C=Math.max(this.g.length,k.g.length),I=[],M=0;M<C;M++)I[M]=this.i(M)&k.i(M);return new a(I,this.h&k.h)},n.or=function(k){for(var C=Math.max(this.g.length,k.g.length),I=[],M=0;M<C;M++)I[M]=this.i(M)|k.i(M);return new a(I,this.h|k.h)},n.xor=function(k){for(var C=Math.max(this.g.length,k.g.length),I=[],M=0;M<C;M++)I[M]=this.i(M)^k.i(M);return new a(I,this.h^k.h)};function P(k){for(var C=k.g.length+1,I=[],M=0;M<C;M++)I[M]=k.i(M)<<1|k.i(M-1)>>>31;return new a(I,k.h)}function R(k,C){var I=C>>5;C%=32;for(var M=k.g.length-I,L=[],F=0;F<M;F++)L[F]=0<C?k.i(F+I)>>>C|k.i(F+I+1)<<32-C:k.i(F+I);return new a(L,k.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,IB=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=u,a.fromString=h,rf=a}).apply(typeof oF<"u"?oF:typeof self<"u"?self:typeof window<"u"?window:{});var oS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var DB,_v,RB,XS,QP,MB,OB,LB;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,E,N){return m==Array.prototype||m==Object.prototype||(m[E]=N.value),m};function t(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof oS=="object"&&oS];for(var E=0;E<m.length;++E){var N=m[E];if(N&&N.Math==Math)return N}throw Error("Cannot find global object")}var r=t(this);function s(m,E){if(E)e:{var N=r;m=m.split(".");for(var j=0;j<m.length-1;j++){var W=m[j];if(!(W in N))break e;N=N[W]}m=m[m.length-1],j=N[m],E=E(j),E!=j&&E!=null&&e(N,m,{configurable:!0,writable:!0,value:E})}}function i(m,E){m instanceof String&&(m+="");var N=0,j=!1,W={next:function(){if(!j&&N<m.length){var Q=N++;return{value:E(Q,m[Q]),done:!1}}return j=!0,{done:!0,value:void 0}}};return W[Symbol.iterator]=function(){return W},W}s("Array.prototype.values",function(m){return m||function(){return i(this,function(E,N){return N})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var a=a||{},o=this||self;function l(m){var E=typeof m;return E=E!="object"?E:m?Array.isArray(m)?"array":E:"null",E=="array"||E=="object"&&typeof m.length=="number"}function u(m){var E=typeof m;return E=="object"&&m!=null||E=="function"}function h(m,E,N){return m.call.apply(m.bind,arguments)}function f(m,E,N){if(!m)throw Error();if(2<arguments.length){var j=Array.prototype.slice.call(arguments,2);return function(){var W=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(W,j),m.apply(E,W)}}return function(){return m.apply(E,arguments)}}function p(m,E,N){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,p.apply(null,arguments)}function g(m,E){var N=Array.prototype.slice.call(arguments,1);return function(){var j=N.slice();return j.push.apply(j,arguments),m.apply(this,j)}}function v(m,E){function N(){}N.prototype=E.prototype,m.aa=E.prototype,m.prototype=new N,m.prototype.constructor=m,m.Qb=function(j,W,Q){for(var de=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)de[xt-2]=arguments[xt];return E.prototype[W].apply(j,de)}}function y(m){const E=m.length;if(0<E){const N=Array(E);for(let j=0;j<E;j++)N[j]=m[j];return N}return[]}function _(m,E){for(let N=1;N<arguments.length;N++){const j=arguments[N];if(l(j)){const W=m.length||0,Q=j.length||0;m.length=W+Q;for(let de=0;de<Q;de++)m[W+de]=j[de]}else m.push(j)}}class w{constructor(E,N){this.i=E,this.j=N,this.h=0,this.g=null}get(){let E;return 0<this.h?(this.h--,E=this.g,this.g=E.next,E.next=null):E=this.i(),E}}function b(m){return/^[\s\xa0]*$/.test(m)}function S(){var m=o.navigator;return m&&(m=m.userAgent)?m:""}function T(m){return T[" "](m),m}T[" "]=function(){};var P=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function R(m,E,N){for(const j in m)E.call(N,m[j],j,m)}function k(m,E){for(const N in m)E.call(void 0,m[N],N,m)}function C(m){const E={};for(const N in m)E[N]=m[N];return E}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(m,E){let N,j;for(let W=1;W<arguments.length;W++){j=arguments[W];for(N in j)m[N]=j[N];for(let Q=0;Q<I.length;Q++)N=I[Q],Object.prototype.hasOwnProperty.call(j,N)&&(m[N]=j[N])}}function L(m){var E=1;m=m.split(":");const N=[];for(;0<E&&m.length;)N.push(m.shift()),E--;return m.length&&N.push(m.join(":")),N}function F(m){o.setTimeout(()=>{throw m},0)}function O(){var m=te;let E=null;return m.g&&(E=m.g,m.g=m.g.next,m.g||(m.h=null),E.next=null),E}class Y{constructor(){this.h=this.g=null}add(E,N){const j=Z.get();j.set(E,N),this.h?this.h.next=j:this.g=j,this.h=j}}var Z=new w(()=>new X,m=>m.reset());class X{constructor(){this.next=this.g=this.h=null}set(E,N){this.h=E,this.g=N,this.next=null}reset(){this.next=this.g=this.h=null}}let J,K=!1,te=new Y,ae=()=>{const m=o.Promise.resolve(void 0);J=()=>{m.then(q)}};var q=()=>{for(var m;m=O();){try{m.h.call(m.g)}catch(N){F(N)}var E=Z;E.j(m),100>E.h&&(E.h++,m.next=E.g,E.g=m)}K=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function U(m,E){this.type=m,this.g=this.target=E,this.defaultPrevented=!1}U.prototype.h=function(){this.defaultPrevented=!0};var G=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var m=!1,E=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const N=()=>{};o.addEventListener("test",N,E),o.removeEventListener("test",N,E)}catch{}return m}();function V(m,E){if(U.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var N=this.type=m.type,j=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=E,E=m.relatedTarget){if(P){e:{try{T(E.nodeName);var W=!0;break e}catch{}W=!1}W||(E=null)}}else N=="mouseover"?E=m.fromElement:N=="mouseout"&&(E=m.toElement);this.relatedTarget=E,j?(this.clientX=j.clientX!==void 0?j.clientX:j.pageX,this.clientY=j.clientY!==void 0?j.clientY:j.pageY,this.screenX=j.screenX||0,this.screenY=j.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:ee[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&V.aa.h.call(this)}}v(V,U);var ee={2:"touch",3:"pen",4:"mouse"};V.prototype.h=function(){V.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var re="closure_listenable_"+(1e6*Math.random()|0),ce=0;function Ae(m,E,N,j,W){this.listener=m,this.proxy=null,this.src=E,this.type=N,this.capture=!!j,this.ha=W,this.key=++ce,this.da=this.fa=!1}function _e(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function xe(m){this.src=m,this.g={},this.h=0}xe.prototype.add=function(m,E,N,j,W){var Q=m.toString();m=this.g[Q],m||(m=this.g[Q]=[],this.h++);var de=Ye(m,E,j,W);return-1<de?(E=m[de],N||(E.fa=!1)):(E=new Ae(E,this.src,Q,!!j,W),E.fa=N,m.push(E)),E};function ke(m,E){var N=E.type;if(N in m.g){var j=m.g[N],W=Array.prototype.indexOf.call(j,E,void 0),Q;(Q=0<=W)&&Array.prototype.splice.call(j,W,1),Q&&(_e(E),m.g[N].length==0&&(delete m.g[N],m.h--))}}function Ye(m,E,N,j){for(var W=0;W<m.length;++W){var Q=m[W];if(!Q.da&&Q.listener==E&&Q.capture==!!N&&Q.ha==j)return W}return-1}var Ke="closure_lm_"+(1e6*Math.random()|0),Zn={};function wr(m,E,N,j,W){if(j&&j.once)return Io(m,E,N,j,W);if(Array.isArray(E)){for(var Q=0;Q<E.length;Q++)wr(m,E[Q],N,j,W);return null}return N=Hr(N),m&&m[re]?m.K(E,N,u(j)?!!j.capture:!!j,W):zr(m,E,N,!1,j,W)}function zr(m,E,N,j,W,Q){if(!E)throw Error("Invalid event type");var de=u(W)?!!W.capture:!!W,xt=lt(m);if(xt||(m[Ke]=xt=new xe(m)),N=xt.add(E,N,j,de,Q),N.proxy)return N;if(j=Yi(),N.proxy=j,j.src=m,j.listener=N,m.addEventListener)G||(W=de),W===void 0&&(W=!1),m.addEventListener(E.toString(),j,W);else if(m.attachEvent)m.attachEvent(Ne(E.toString()),j);else if(m.addListener&&m.removeListener)m.addListener(j);else throw Error("addEventListener and attachEvent are unavailable.");return N}function Yi(){function m(N){return E.call(m.src,m.listener,N)}const E=mt;return m}function Io(m,E,N,j,W){if(Array.isArray(E)){for(var Q=0;Q<E.length;Q++)Io(m,E[Q],N,j,W);return null}return N=Hr(N),m&&m[re]?m.L(E,N,u(j)?!!j.capture:!!j,W):zr(m,E,N,!0,j,W)}function er(m,E,N,j,W){if(Array.isArray(E))for(var Q=0;Q<E.length;Q++)er(m,E[Q],N,j,W);else j=u(j)?!!j.capture:!!j,N=Hr(N),m&&m[re]?(m=m.i,E=String(E).toString(),E in m.g&&(Q=m.g[E],N=Ye(Q,N,j,W),-1<N&&(_e(Q[N]),Array.prototype.splice.call(Q,N,1),Q.length==0&&(delete m.g[E],m.h--)))):m&&(m=lt(m))&&(E=m.g[E.toString()],m=-1,E&&(m=Ye(E,N,j,W)),(N=-1<m?E[m]:null)&&fe(N))}function fe(m){if(typeof m!="number"&&m&&!m.da){var E=m.src;if(E&&E[re])ke(E.i,m);else{var N=m.type,j=m.proxy;E.removeEventListener?E.removeEventListener(N,j,m.capture):E.detachEvent?E.detachEvent(Ne(N),j):E.addListener&&E.removeListener&&E.removeListener(j),(N=lt(E))?(ke(N,m),N.h==0&&(N.src=null,E[Ke]=null)):_e(m)}}}function Ne(m){return m in Zn?Zn[m]:Zn[m]="on"+m}function mt(m,E){if(m.da)m=!0;else{E=new V(E,this);var N=m.listener,j=m.ha||m.src;m.fa&&fe(m),m=N.call(j,E)}return m}function lt(m){return m=m[Ke],m instanceof xe?m:null}var br="__closure_events_fn_"+(1e9*Math.random()>>>0);function Hr(m){return typeof m=="function"?m:(m[br]||(m[br]=function(E){return m.handleEvent(E)}),m[br])}function gt(){$.call(this),this.i=new xe(this),this.M=this,this.F=null}v(gt,$),gt.prototype[re]=!0,gt.prototype.removeEventListener=function(m,E,N,j){er(this,m,E,N,j)};function Dt(m,E){var N,j=m.F;if(j)for(N=[];j;j=j.F)N.push(j);if(m=m.M,j=E.type||E,typeof E=="string")E=new U(E,m);else if(E instanceof U)E.target=E.target||m;else{var W=E;E=new U(j,m),M(E,W)}if(W=!0,N)for(var Q=N.length-1;0<=Q;Q--){var de=E.g=N[Q];W=Is(de,j,!0,E)&&W}if(de=E.g=m,W=Is(de,j,!0,E)&&W,W=Is(de,j,!1,E)&&W,N)for(Q=0;Q<N.length;Q++)de=E.g=N[Q],W=Is(de,j,!1,E)&&W}gt.prototype.N=function(){if(gt.aa.N.call(this),this.i){var m=this.i,E;for(E in m.g){for(var N=m.g[E],j=0;j<N.length;j++)_e(N[j]);delete m.g[E],m.h--}}this.F=null},gt.prototype.K=function(m,E,N,j){return this.i.add(String(m),E,!1,N,j)},gt.prototype.L=function(m,E,N,j){return this.i.add(String(m),E,!0,N,j)};function Is(m,E,N,j){if(E=m.i.g[String(E)],!E)return!0;E=E.concat();for(var W=!0,Q=0;Q<E.length;++Q){var de=E[Q];if(de&&!de.da&&de.capture==N){var xt=de.listener,tr=de.ha||de.src;de.fa&&ke(m.i,de),W=xt.call(tr,j)!==!1&&W}}return W&&!j.defaultPrevented}function Rt(m,E,N){if(typeof m=="function")N&&(m=p(m,N));else if(m&&typeof m.handleEvent=="function")m=p(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(E)?-1:o.setTimeout(m,E||0)}function Ds(m){m.g=Rt(()=>{m.g=null,m.i&&(m.i=!1,Ds(m))},m.l);const E=m.h;m.h=null,m.m.apply(null,E)}class kx extends ${constructor(E,N){super(),this.m=E,this.l=N,this.h=null,this.i=!1,this.g=null}j(E){this.h=arguments,this.g?this.i=!0:Ds(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Rs(m){$.call(this),this.h=m,this.g={}}v(Rs,$);var zf=[];function sh(m){R(m.g,function(E,N){this.g.hasOwnProperty(N)&&fe(E)},m),m.g={}}Rs.prototype.N=function(){Rs.aa.N.call(this),sh(this)},Rs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Hf=o.JSON.stringify,Ly=o.JSON.parse,Bt=class{stringify(m){return o.JSON.stringify(m,void 0)}parse(m){return o.JSON.parse(m,void 0)}};function mi(){}mi.prototype.h=null;function rc(m){return m.h||(m.h=m.i())}function jy(){}var Pa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function sc(){U.call(this,"d")}v(sc,U);function Wf(){U.call(this,"c")}v(Wf,U);var Ia={},Fy=null;function ih(){return Fy=Fy||new gt}Ia.La="serverreachability";function z(m){U.call(this,Ia.La,m)}v(z,U);function he(m){const E=ih();Dt(E,new z(E))}Ia.STAT_EVENT="statevent";function ct(m,E){U.call(this,Ia.STAT_EVENT,m),this.stat=E}v(ct,U);function De(m){const E=ih();Dt(E,new ct(E,m))}Ia.Ma="timingevent";function os(m,E){U.call(this,Ia.Ma,m),this.size=E}v(os,U);function fn(m,E){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){m()},E)}function Vn(){this.g=!0}Vn.prototype.xa=function(){this.g=!1};function Ms(m,E,N,j,W,Q){m.info(function(){if(m.g)if(Q)for(var de="",xt=Q.split("&"),tr=0;tr<xt.length;tr++){var rt=xt[tr].split("=");if(1<rt.length){var _r=rt[0];rt=rt[1];var xr=_r.split("_");de=2<=xr.length&&xr[1]=="type"?de+(_r+"="+rt+"&"):de+(_r+"=redacted&")}}else de=null;else de=Q;return"XMLHTTP REQ ("+j+") [attempt "+W+"]: "+E+`
`+N+`
`+de})}function Nx(m,E,N,j,W,Q,de){m.info(function(){return"XMLHTTP RESP ("+j+") [ attempt "+W+"]: "+E+`
`+N+`
`+Q+" "+de})}function Da(m,E,N,j){m.info(function(){return"XMLHTTP TEXT ("+E+"): "+Ek(m,N)+(j?" "+j:"")})}function FO(m,E){m.info(function(){return"TIMEOUT: "+E})}Vn.prototype.info=function(){};function Ek(m,E){if(!m.g)return E;if(!E)return null;try{var N=JSON.parse(E);if(N){for(m=0;m<N.length;m++)if(Array.isArray(N[m])){var j=N[m];if(!(2>j.length)){var W=j[1];if(Array.isArray(W)&&!(1>W.length)){var Q=W[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var de=1;de<W.length;de++)W[de]=""}}}}return Hf(N)}catch{return E}}var Gf={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},$y={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Px;function qf(){}v(qf,mi),qf.prototype.g=function(){return new XMLHttpRequest},qf.prototype.i=function(){return{}},Px=new qf;function He(m,E,N,j){this.j=m,this.i=E,this.l=N,this.R=j||1,this.U=new Rs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ic}function ic(){this.i=null,this.g="",this.h=!1}var $O={},Ak={};function Tk(m,E,N){m.L=1,m.v=Mx(Do(E)),m.m=N,m.P=!0,UO(m,null)}function UO(m,E){m.F=Date.now(),Ix(m),m.A=Do(m.v);var N=m.A,j=m.R;Array.isArray(j)||(j=[String(j)]),eL(N.i,"t",j),m.C=0,N=m.j.J,m.h=new ic,m.g=vL(m.j,N?E:null,!m.m),0<m.O&&(m.M=new kx(p(m.Y,m,m.g),m.O)),E=m.U,N=m.g,j=m.ca;var W="readystatechange";Array.isArray(W)||(W&&(zf[0]=W.toString()),W=zf);for(var Q=0;Q<W.length;Q++){var de=wr(N,W[Q],j||E.handleEvent,!1,E.h||E);if(!de)break;E.g[de.key]=de}E=m.H?C(m.H):{},m.m?(m.u||(m.u="POST"),E["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,E)):(m.u="GET",m.g.ea(m.A,m.u,null,E)),he(),Ms(m.i,m.u,m.A,m.l,m.R,m.m)}He.prototype.ca=function(m){m=m.target;const E=this.M;E&&Ro(m)==3?E.j():this.Y(m)},He.prototype.Y=function(m){try{if(m==this.g)e:{const xr=Ro(this.g);var E=this.g.Ba();const Xf=this.g.Z();if(!(3>xr)&&(xr!=3||this.g&&(this.h.h||this.g.oa()||oL(this.g)))){this.J||xr!=4||E==7||(E==8||0>=Xf?he(3):he(2)),Ck(this);var N=this.g.Z();this.X=N;t:if(VO(this)){var j=oL(this.g);m="";var W=j.length,Q=Ro(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ah(this),Uy(this);var de="";break t}this.h.i=new o.TextDecoder}for(E=0;E<W;E++)this.h.h=!0,m+=this.h.i.decode(j[E],{stream:!(Q&&E==W-1)});j.length=0,this.h.g+=m,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=N==200,Nx(this.i,this.u,this.A,this.l,this.R,xr,N),this.o){if(this.T&&!this.K){t:{if(this.g){var xt,tr=this.g;if((xt=tr.g?tr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!b(xt)){var rt=xt;break t}}rt=null}if(N=rt)Da(this.i,this.l,N,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,kk(this,N);else{this.o=!1,this.s=3,De(12),ah(this),Uy(this);break e}}if(this.P){N=!0;let Ki;for(;!this.J&&this.C<de.length;)if(Ki=oG(this,de),Ki==Ak){xr==4&&(this.s=4,De(14),N=!1),Da(this.i,this.l,null,"[Incomplete Response]");break}else if(Ki==$O){this.s=4,De(15),Da(this.i,this.l,de,"[Invalid Chunk]"),N=!1;break}else Da(this.i,this.l,Ki,null),kk(this,Ki);if(VO(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),xr!=4||de.length!=0||this.h.h||(this.s=1,De(16),N=!1),this.o=this.o&&N,!N)Da(this.i,this.l,de,"[Invalid Chunked Response]"),ah(this),Uy(this);else if(0<de.length&&!this.W){this.W=!0;var _r=this.j;_r.g==this&&_r.ba&&!_r.M&&(_r.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),Mk(_r),_r.M=!0,De(11))}}else Da(this.i,this.l,de,null),kk(this,de);xr==4&&ah(this),this.o&&!this.J&&(xr==4?pL(this.j,this):(this.o=!1,Ix(this)))}else EG(this.g),N==400&&0<de.indexOf("Unknown SID")?(this.s=3,De(12)):(this.s=0,De(13)),ah(this),Uy(this)}}}catch{}finally{}};function VO(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function oG(m,E){var N=m.C,j=E.indexOf(`
`,N);return j==-1?Ak:(N=Number(E.substring(N,j)),isNaN(N)?$O:(j+=1,j+N>E.length?Ak:(E=E.slice(j,j+N),m.C=j+N,E)))}He.prototype.cancel=function(){this.J=!0,ah(this)};function Ix(m){m.S=Date.now()+m.I,BO(m,m.I)}function BO(m,E){if(m.B!=null)throw Error("WatchDog timer not null");m.B=fn(p(m.ba,m),E)}function Ck(m){m.B&&(o.clearTimeout(m.B),m.B=null)}He.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(FO(this.i,this.A),this.L!=2&&(he(),De(17)),ah(this),this.s=2,Uy(this)):BO(this,this.S-m)};function Uy(m){m.j.G==0||m.J||pL(m.j,m)}function ah(m){Ck(m);var E=m.M;E&&typeof E.ma=="function"&&E.ma(),m.M=null,sh(m.U),m.g&&(E=m.g,m.g=null,E.abort(),E.ma())}function kk(m,E){try{var N=m.j;if(N.G!=0&&(N.g==m||Nk(N.h,m))){if(!m.K&&Nk(N.h,m)&&N.G==3){try{var j=N.Da.g.parse(E)}catch{j=null}if(Array.isArray(j)&&j.length==3){var W=j;if(W[0]==0){e:if(!N.u){if(N.g)if(N.g.F+3e3<m.F)Ux(N),Fx(N);else break e;Rk(N),De(18)}}else N.za=W[1],0<N.za-N.T&&37500>W[2]&&N.F&&N.v==0&&!N.C&&(N.C=fn(p(N.Za,N),6e3));if(1>=WO(N.h)&&N.ca){try{N.ca()}catch{}N.ca=void 0}}else lh(N,11)}else if((m.K||N.g==m)&&Ux(N),!b(E))for(W=N.Da.g.parse(E),E=0;E<W.length;E++){let rt=W[E];if(N.T=rt[0],rt=rt[1],N.G==2)if(rt[0]=="c"){N.K=rt[1],N.ia=rt[2];const _r=rt[3];_r!=null&&(N.la=_r,N.j.info("VER="+N.la));const xr=rt[4];xr!=null&&(N.Aa=xr,N.j.info("SVER="+N.Aa));const Xf=rt[5];Xf!=null&&typeof Xf=="number"&&0<Xf&&(j=1.5*Xf,N.L=j,N.j.info("backChannelRequestTimeoutMs_="+j)),j=N;const Ki=m.g;if(Ki){const Bx=Ki.g?Ki.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Bx){var Q=j.h;Q.g||Bx.indexOf("spdy")==-1&&Bx.indexOf("quic")==-1&&Bx.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Pk(Q,Q.h),Q.h=null))}if(j.D){const Ok=Ki.g?Ki.g.getResponseHeader("X-HTTP-Session-Id"):null;Ok&&(j.ya=Ok,Mt(j.I,j.D,Ok))}}N.G=3,N.l&&N.l.ua(),N.ba&&(N.R=Date.now()-m.F,N.j.info("Handshake RTT: "+N.R+"ms")),j=N;var de=m;if(j.qa=yL(j,j.J?j.ia:null,j.W),de.K){GO(j.h,de);var xt=de,tr=j.L;tr&&(xt.I=tr),xt.B&&(Ck(xt),Ix(xt)),j.g=de}else dL(j);0<N.i.length&&$x(N)}else rt[0]!="stop"&&rt[0]!="close"||lh(N,7);else N.G==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?lh(N,7):Dk(N):rt[0]!="noop"&&N.l&&N.l.ta(rt),N.v=0)}}he(4)}catch{}}var lG=class{constructor(m,E){this.g=m,this.map=E}};function zO(m){this.l=m||10,o.PerformanceNavigationTiming?(m=o.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function HO(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function WO(m){return m.h?1:m.g?m.g.size:0}function Nk(m,E){return m.h?m.h==E:m.g?m.g.has(E):!1}function Pk(m,E){m.g?m.g.add(E):m.h=E}function GO(m,E){m.h&&m.h==E?m.h=null:m.g&&m.g.has(E)&&m.g.delete(E)}zO.prototype.cancel=function(){if(this.i=qO(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function qO(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let E=m.i;for(const N of m.g.values())E=E.concat(N.D);return E}return y(m.i)}function cG(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(l(m)){for(var E=[],N=m.length,j=0;j<N;j++)E.push(m[j]);return E}E=[],N=0;for(j in m)E[N++]=m[j];return E}function uG(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(l(m)||typeof m=="string"){var E=[];m=m.length;for(var N=0;N<m;N++)E.push(N);return E}E=[],N=0;for(const j in m)E[N++]=j;return E}}}function YO(m,E){if(m.forEach&&typeof m.forEach=="function")m.forEach(E,void 0);else if(l(m)||typeof m=="string")Array.prototype.forEach.call(m,E,void 0);else for(var N=uG(m),j=cG(m),W=j.length,Q=0;Q<W;Q++)E.call(void 0,j[Q],N&&N[Q],m)}var KO=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hG(m,E){if(m){m=m.split("&");for(var N=0;N<m.length;N++){var j=m[N].indexOf("="),W=null;if(0<=j){var Q=m[N].substring(0,j);W=m[N].substring(j+1)}else Q=m[N];E(Q,W?decodeURIComponent(W.replace(/\+/g," ")):"")}}}function oh(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof oh){this.h=m.h,Dx(this,m.j),this.o=m.o,this.g=m.g,Rx(this,m.s),this.l=m.l;var E=m.i,N=new zy;N.i=E.i,E.g&&(N.g=new Map(E.g),N.h=E.h),XO(this,N),this.m=m.m}else m&&(E=String(m).match(KO))?(this.h=!1,Dx(this,E[1]||"",!0),this.o=Vy(E[2]||""),this.g=Vy(E[3]||"",!0),Rx(this,E[4]),this.l=Vy(E[5]||"",!0),XO(this,E[6]||"",!0),this.m=Vy(E[7]||"")):(this.h=!1,this.i=new zy(null,this.h))}oh.prototype.toString=function(){var m=[],E=this.j;E&&m.push(By(E,QO,!0),":");var N=this.g;return(N||E=="file")&&(m.push("//"),(E=this.o)&&m.push(By(E,QO,!0),"@"),m.push(encodeURIComponent(String(N)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),N=this.s,N!=null&&m.push(":",String(N))),(N=this.l)&&(this.g&&N.charAt(0)!="/"&&m.push("/"),m.push(By(N,N.charAt(0)=="/"?pG:fG,!0))),(N=this.i.toString())&&m.push("?",N),(N=this.m)&&m.push("#",By(N,gG)),m.join("")};function Do(m){return new oh(m)}function Dx(m,E,N){m.j=N?Vy(E,!0):E,m.j&&(m.j=m.j.replace(/:$/,""))}function Rx(m,E){if(E){if(E=Number(E),isNaN(E)||0>E)throw Error("Bad port number "+E);m.s=E}else m.s=null}function XO(m,E,N){E instanceof zy?(m.i=E,yG(m.i,m.h)):(N||(E=By(E,mG)),m.i=new zy(E,m.h))}function Mt(m,E,N){m.i.set(E,N)}function Mx(m){return Mt(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function Vy(m,E){return m?E?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function By(m,E,N){return typeof m=="string"?(m=encodeURI(m).replace(E,dG),N&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function dG(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var QO=/[#\/\?@]/g,fG=/[#\?:]/g,pG=/[#\?]/g,mG=/[#\?@]/g,gG=/#/g;function zy(m,E){this.h=this.g=null,this.i=m||null,this.j=!!E}function ac(m){m.g||(m.g=new Map,m.h=0,m.i&&hG(m.i,function(E,N){m.add(decodeURIComponent(E.replace(/\+/g," ")),N)}))}n=zy.prototype,n.add=function(m,E){ac(this),this.i=null,m=Yf(this,m);var N=this.g.get(m);return N||this.g.set(m,N=[]),N.push(E),this.h+=1,this};function JO(m,E){ac(m),E=Yf(m,E),m.g.has(E)&&(m.i=null,m.h-=m.g.get(E).length,m.g.delete(E))}function ZO(m,E){return ac(m),E=Yf(m,E),m.g.has(E)}n.forEach=function(m,E){ac(this),this.g.forEach(function(N,j){N.forEach(function(W){m.call(E,W,j,this)},this)},this)},n.na=function(){ac(this);const m=Array.from(this.g.values()),E=Array.from(this.g.keys()),N=[];for(let j=0;j<E.length;j++){const W=m[j];for(let Q=0;Q<W.length;Q++)N.push(E[j])}return N},n.V=function(m){ac(this);let E=[];if(typeof m=="string")ZO(this,m)&&(E=E.concat(this.g.get(Yf(this,m))));else{m=Array.from(this.g.values());for(let N=0;N<m.length;N++)E=E.concat(m[N])}return E},n.set=function(m,E){return ac(this),this.i=null,m=Yf(this,m),ZO(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[E]),this.h+=1,this},n.get=function(m,E){return m?(m=this.V(m),0<m.length?String(m[0]):E):E};function eL(m,E,N){JO(m,E),0<N.length&&(m.i=null,m.g.set(Yf(m,E),y(N)),m.h+=N.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],E=Array.from(this.g.keys());for(var N=0;N<E.length;N++){var j=E[N];const Q=encodeURIComponent(String(j)),de=this.V(j);for(j=0;j<de.length;j++){var W=Q;de[j]!==""&&(W+="="+encodeURIComponent(String(de[j]))),m.push(W)}}return this.i=m.join("&")};function Yf(m,E){return E=String(E),m.j&&(E=E.toLowerCase()),E}function yG(m,E){E&&!m.j&&(ac(m),m.i=null,m.g.forEach(function(N,j){var W=j.toLowerCase();j!=W&&(JO(this,j),eL(this,W,N))},m)),m.j=E}function vG(m,E){const N=new Vn;if(o.Image){const j=new Image;j.onload=g(oc,N,"TestLoadImage: loaded",!0,E,j),j.onerror=g(oc,N,"TestLoadImage: error",!1,E,j),j.onabort=g(oc,N,"TestLoadImage: abort",!1,E,j),j.ontimeout=g(oc,N,"TestLoadImage: timeout",!1,E,j),o.setTimeout(function(){j.ontimeout&&j.ontimeout()},1e4),j.src=m}else E(!1)}function wG(m,E){const N=new Vn,j=new AbortController,W=setTimeout(()=>{j.abort(),oc(N,"TestPingServer: timeout",!1,E)},1e4);fetch(m,{signal:j.signal}).then(Q=>{clearTimeout(W),Q.ok?oc(N,"TestPingServer: ok",!0,E):oc(N,"TestPingServer: server error",!1,E)}).catch(()=>{clearTimeout(W),oc(N,"TestPingServer: error",!1,E)})}function oc(m,E,N,j,W){try{W&&(W.onload=null,W.onerror=null,W.onabort=null,W.ontimeout=null),j(N)}catch{}}function bG(){this.g=new Bt}function _G(m,E,N){const j=N||"";try{YO(m,function(W,Q){let de=W;u(W)&&(de=Hf(W)),E.push(j+Q+"="+encodeURIComponent(de))})}catch(W){throw E.push(j+"type="+encodeURIComponent("_badmap")),W}}function Ox(m){this.l=m.Ub||null,this.j=m.eb||!1}v(Ox,mi),Ox.prototype.g=function(){return new Lx(this.l,this.j)},Ox.prototype.i=function(m){return function(){return m}}({});function Lx(m,E){gt.call(this),this.D=m,this.o=E,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Lx,gt),n=Lx.prototype,n.open=function(m,E){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=E,this.readyState=1,Wy(this)},n.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const E={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(E.body=m),(this.D||o).fetch(new Request(this.A,E)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Hy(this)),this.readyState=0},n.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Wy(this)),this.g&&(this.readyState=3,Wy(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;tL(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function tL(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}n.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var E=m.value?m.value:new Uint8Array(0);(E=this.v.decode(E,{stream:!m.done}))&&(this.response=this.responseText+=E)}m.done?Hy(this):Wy(this),this.readyState==3&&tL(this)}},n.Ra=function(m){this.g&&(this.response=this.responseText=m,Hy(this))},n.Qa=function(m){this.g&&(this.response=m,Hy(this))},n.ga=function(){this.g&&Hy(this)};function Hy(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Wy(m)}n.setRequestHeader=function(m,E){this.u.append(m,E)},n.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],E=this.h.entries();for(var N=E.next();!N.done;)N=N.value,m.push(N[0]+": "+N[1]),N=E.next();return m.join(`\r
`)};function Wy(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Lx.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function nL(m){let E="";return R(m,function(N,j){E+=j,E+=":",E+=N,E+=`\r
`}),E}function Ik(m,E,N){e:{for(j in N){var j=!1;break e}j=!0}j||(N=nL(N),typeof m=="string"?N!=null&&encodeURIComponent(String(N)):Mt(m,E,N))}function tn(m){gt.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(tn,gt);var xG=/^https?$/i,SG=["POST","PUT"];n=tn.prototype,n.Ha=function(m){this.J=m},n.ea=function(m,E,N,j){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);E=E?E.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Px.g(),this.v=this.o?rc(this.o):rc(Px),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(E,String(m),!0),this.B=!1}catch(Q){rL(this,Q);return}if(m=N||"",N=new Map(this.headers),j)if(Object.getPrototypeOf(j)===Object.prototype)for(var W in j)N.set(W,j[W]);else if(typeof j.keys=="function"&&typeof j.get=="function")for(const Q of j.keys())N.set(Q,j.get(Q));else throw Error("Unknown input type for opt_headers: "+String(j));j=Array.from(N.keys()).find(Q=>Q.toLowerCase()=="content-type"),W=o.FormData&&m instanceof o.FormData,!(0<=Array.prototype.indexOf.call(SG,E,void 0))||j||W||N.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,de]of N)this.g.setRequestHeader(Q,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{aL(this),this.u=!0,this.g.send(m),this.u=!1}catch(Q){rL(this,Q)}};function rL(m,E){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=E,m.m=5,sL(m),jx(m)}function sL(m){m.A||(m.A=!0,Dt(m,"complete"),Dt(m,"error"))}n.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,Dt(this,"complete"),Dt(this,"abort"),jx(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),jx(this,!0)),tn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?iL(this):this.bb())},n.bb=function(){iL(this)};function iL(m){if(m.h&&typeof a<"u"&&(!m.v[1]||Ro(m)!=4||m.Z()!=2)){if(m.u&&Ro(m)==4)Rt(m.Ea,0,m);else if(Dt(m,"readystatechange"),Ro(m)==4){m.h=!1;try{const de=m.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var E=!0;break e;default:E=!1}var N;if(!(N=E)){var j;if(j=de===0){var W=String(m.D).match(KO)[1]||null;!W&&o.self&&o.self.location&&(W=o.self.location.protocol.slice(0,-1)),j=!xG.test(W?W.toLowerCase():"")}N=j}if(N)Dt(m,"complete"),Dt(m,"success");else{m.m=6;try{var Q=2<Ro(m)?m.g.statusText:""}catch{Q=""}m.l=Q+" ["+m.Z()+"]",sL(m)}}finally{jx(m)}}}}function jx(m,E){if(m.g){aL(m);const N=m.g,j=m.v[0]?()=>{}:null;m.g=null,m.v=null,E||Dt(m,"ready");try{N.onreadystatechange=j}catch{}}}function aL(m){m.I&&(o.clearTimeout(m.I),m.I=null)}n.isActive=function(){return!!this.g};function Ro(m){return m.g?m.g.readyState:0}n.Z=function(){try{return 2<Ro(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(m){if(this.g){var E=this.g.responseText;return m&&E.indexOf(m)==0&&(E=E.substring(m.length)),Ly(E)}};function oL(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function EG(m){const E={};m=(m.g&&2<=Ro(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let j=0;j<m.length;j++){if(b(m[j]))continue;var N=L(m[j]);const W=N[0];if(N=N[1],typeof N!="string")continue;N=N.trim();const Q=E[W]||[];E[W]=Q,Q.push(N)}k(E,function(j){return j.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gy(m,E,N){return N&&N.internalChannelParams&&N.internalChannelParams[m]||E}function lL(m){this.Aa=0,this.i=[],this.j=new Vn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gy("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gy("baseRetryDelayMs",5e3,m),this.cb=Gy("retryDelaySeedMs",1e4,m),this.Wa=Gy("forwardChannelMaxRetries",2,m),this.wa=Gy("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new zO(m&&m.concurrentRequestLimit),this.Da=new bG,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=lL.prototype,n.la=8,n.G=1,n.connect=function(m,E,N,j){De(0),this.W=m,this.H=E||{},N&&j!==void 0&&(this.H.OSID=N,this.H.OAID=j),this.F=this.X,this.I=yL(this,null,this.W),$x(this)};function Dk(m){if(cL(m),m.G==3){var E=m.U++,N=Do(m.I);if(Mt(N,"SID",m.K),Mt(N,"RID",E),Mt(N,"TYPE","terminate"),qy(m,N),E=new He(m,m.j,E),E.L=2,E.v=Mx(Do(N)),N=!1,o.navigator&&o.navigator.sendBeacon)try{N=o.navigator.sendBeacon(E.v.toString(),"")}catch{}!N&&o.Image&&(new Image().src=E.v,N=!0),N||(E.g=vL(E.j,null),E.g.ea(E.v)),E.F=Date.now(),Ix(E)}gL(m)}function Fx(m){m.g&&(Mk(m),m.g.cancel(),m.g=null)}function cL(m){Fx(m),m.u&&(o.clearTimeout(m.u),m.u=null),Ux(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&o.clearTimeout(m.s),m.s=null)}function $x(m){if(!HO(m.h)&&!m.s){m.s=!0;var E=m.Ga;J||ae(),K||(J(),K=!0),te.add(E,m),m.B=0}}function AG(m,E){return WO(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=E.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=fn(p(m.Ga,m,E),mL(m,m.B)),m.B++,!0)}n.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const W=new He(this,this.j,m);let Q=this.o;if(this.S&&(Q?(Q=C(Q),M(Q,this.S)):Q=this.S),this.m!==null||this.O||(W.H=Q,Q=null),this.P)e:{for(var E=0,N=0;N<this.i.length;N++){t:{var j=this.i[N];if("__data__"in j.map&&(j=j.map.__data__,typeof j=="string")){j=j.length;break t}j=void 0}if(j===void 0)break;if(E+=j,4096<E){E=N;break e}if(E===4096||N===this.i.length-1){E=N+1;break e}}E=1e3}else E=1e3;E=hL(this,W,E),N=Do(this.I),Mt(N,"RID",m),Mt(N,"CVER",22),this.D&&Mt(N,"X-HTTP-Session-Id",this.D),qy(this,N),Q&&(this.O?E="headers="+encodeURIComponent(String(nL(Q)))+"&"+E:this.m&&Ik(N,this.m,Q)),Pk(this.h,W),this.Ua&&Mt(N,"TYPE","init"),this.P?(Mt(N,"$req",E),Mt(N,"SID","null"),W.T=!0,Tk(W,N,null)):Tk(W,N,E),this.G=2}}else this.G==3&&(m?uL(this,m):this.i.length==0||HO(this.h)||uL(this))};function uL(m,E){var N;E?N=E.l:N=m.U++;const j=Do(m.I);Mt(j,"SID",m.K),Mt(j,"RID",N),Mt(j,"AID",m.T),qy(m,j),m.m&&m.o&&Ik(j,m.m,m.o),N=new He(m,m.j,N,m.B+1),m.m===null&&(N.H=m.o),E&&(m.i=E.D.concat(m.i)),E=hL(m,N,1e3),N.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),Pk(m.h,N),Tk(N,j,E)}function qy(m,E){m.H&&R(m.H,function(N,j){Mt(E,j,N)}),m.l&&YO({},function(N,j){Mt(E,j,N)})}function hL(m,E,N){N=Math.min(m.i.length,N);var j=m.l?p(m.l.Na,m.l,m):null;e:{var W=m.i;let Q=-1;for(;;){const de=["count="+N];Q==-1?0<N?(Q=W[0].g,de.push("ofs="+Q)):Q=0:de.push("ofs="+Q);let xt=!0;for(let tr=0;tr<N;tr++){let rt=W[tr].g;const _r=W[tr].map;if(rt-=Q,0>rt)Q=Math.max(0,W[tr].g-100),xt=!1;else try{_G(_r,de,"req"+rt+"_")}catch{j&&j(_r)}}if(xt){j=de.join("&");break e}}}return m=m.i.splice(0,N),E.D=m,j}function dL(m){if(!m.g&&!m.u){m.Y=1;var E=m.Fa;J||ae(),K||(J(),K=!0),te.add(E,m),m.v=0}}function Rk(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=fn(p(m.Fa,m),mL(m,m.v)),m.v++,!0)}n.Fa=function(){if(this.u=null,fL(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=fn(p(this.ab,this),m)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,De(10),Fx(this),fL(this))};function Mk(m){m.A!=null&&(o.clearTimeout(m.A),m.A=null)}function fL(m){m.g=new He(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var E=Do(m.qa);Mt(E,"RID","rpc"),Mt(E,"SID",m.K),Mt(E,"AID",m.T),Mt(E,"CI",m.F?"0":"1"),!m.F&&m.ja&&Mt(E,"TO",m.ja),Mt(E,"TYPE","xmlhttp"),qy(m,E),m.m&&m.o&&Ik(E,m.m,m.o),m.L&&(m.g.I=m.L);var N=m.g;m=m.ia,N.L=1,N.v=Mx(Do(E)),N.m=null,N.P=!0,UO(N,m)}n.Za=function(){this.C!=null&&(this.C=null,Fx(this),Rk(this),De(19))};function Ux(m){m.C!=null&&(o.clearTimeout(m.C),m.C=null)}function pL(m,E){var N=null;if(m.g==E){Ux(m),Mk(m),m.g=null;var j=2}else if(Nk(m.h,E))N=E.D,GO(m.h,E),j=1;else return;if(m.G!=0){if(E.o)if(j==1){N=E.m?E.m.length:0,E=Date.now()-E.F;var W=m.B;j=ih(),Dt(j,new os(j,N)),$x(m)}else dL(m);else if(W=E.s,W==3||W==0&&0<E.X||!(j==1&&AG(m,E)||j==2&&Rk(m)))switch(N&&0<N.length&&(E=m.h,E.i=E.i.concat(N)),W){case 1:lh(m,5);break;case 4:lh(m,10);break;case 3:lh(m,6);break;default:lh(m,2)}}}function mL(m,E){let N=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(N*=2),N*E}function lh(m,E){if(m.j.info("Error code "+E),E==2){var N=p(m.fb,m),j=m.Xa;const W=!j;j=new oh(j||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Dx(j,"https"),Mx(j),W?vG(j.toString(),N):wG(j.toString(),N)}else De(2);m.G=0,m.l&&m.l.sa(E),gL(m),cL(m)}n.fb=function(m){m?(this.j.info("Successfully pinged google.com"),De(2)):(this.j.info("Failed to ping google.com"),De(1))};function gL(m){if(m.G=0,m.ka=[],m.l){const E=qO(m.h);(E.length!=0||m.i.length!=0)&&(_(m.ka,E),_(m.ka,m.i),m.h.i.length=0,y(m.i),m.i.length=0),m.l.ra()}}function yL(m,E,N){var j=N instanceof oh?Do(N):new oh(N);if(j.g!="")E&&(j.g=E+"."+j.g),Rx(j,j.s);else{var W=o.location;j=W.protocol,E=E?E+"."+W.hostname:W.hostname,W=+W.port;var Q=new oh(null);j&&Dx(Q,j),E&&(Q.g=E),W&&Rx(Q,W),N&&(Q.l=N),j=Q}return N=m.D,E=m.ya,N&&E&&Mt(j,N,E),Mt(j,"VER",m.la),qy(m,j),j}function vL(m,E,N){if(E&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return E=m.Ca&&!m.pa?new tn(new Ox({eb:N})):new tn(m.pa),E.Ha(m.J),E}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function wL(){}n=wL.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Vx(){}Vx.prototype.g=function(m,E){return new Os(m,E)};function Os(m,E){gt.call(this),this.g=new lL(E),this.l=m,this.h=E&&E.messageUrlParams||null,m=E&&E.messageHeaders||null,E&&E.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=E&&E.initMessageHeaders||null,E&&E.messageContentType&&(m?m["X-WebChannel-Content-Type"]=E.messageContentType:m={"X-WebChannel-Content-Type":E.messageContentType}),E&&E.va&&(m?m["X-WebChannel-Client-Profile"]=E.va:m={"X-WebChannel-Client-Profile":E.va}),this.g.S=m,(m=E&&E.Sb)&&!b(m)&&(this.g.m=m),this.v=E&&E.supportsCrossDomainXhr||!1,this.u=E&&E.sendRawJson||!1,(E=E&&E.httpSessionIdParam)&&!b(E)&&(this.g.D=E,m=this.h,m!==null&&E in m&&(m=this.h,E in m&&delete m[E])),this.j=new Kf(this)}v(Os,gt),Os.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Os.prototype.close=function(){Dk(this.g)},Os.prototype.o=function(m){var E=this.g;if(typeof m=="string"){var N={};N.__data__=m,m=N}else this.u&&(N={},N.__data__=Hf(m),m=N);E.i.push(new lG(E.Ya++,m)),E.G==3&&$x(E)},Os.prototype.N=function(){this.g.l=null,delete this.j,Dk(this.g),delete this.g,Os.aa.N.call(this)};function bL(m){sc.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var E=m.__sm__;if(E){e:{for(const N in E){m=N;break e}m=void 0}(this.i=m)&&(m=this.i,E=E!==null&&m in E?E[m]:void 0),this.data=E}else this.data=m}v(bL,sc);function _L(){Wf.call(this),this.status=1}v(_L,Wf);function Kf(m){this.g=m}v(Kf,wL),Kf.prototype.ua=function(){Dt(this.g,"a")},Kf.prototype.ta=function(m){Dt(this.g,new bL(m))},Kf.prototype.sa=function(m){Dt(this.g,new _L)},Kf.prototype.ra=function(){Dt(this.g,"b")},Vx.prototype.createWebChannel=Vx.prototype.g,Os.prototype.send=Os.prototype.o,Os.prototype.open=Os.prototype.m,Os.prototype.close=Os.prototype.close,LB=function(){return new Vx},OB=function(){return ih()},MB=Ia,QP={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Gf.NO_ERROR=0,Gf.TIMEOUT=8,Gf.HTTP_ERROR=6,XS=Gf,$y.COMPLETE="complete",RB=$y,jy.EventType=Pa,Pa.OPEN="a",Pa.CLOSE="b",Pa.ERROR="c",Pa.MESSAGE="d",gt.prototype.listen=gt.prototype.K,_v=jy,tn.prototype.listenOnce=tn.prototype.L,tn.prototype.getLastError=tn.prototype.Ka,tn.prototype.getLastErrorCode=tn.prototype.Ba,tn.prototype.getStatus=tn.prototype.Z,tn.prototype.getResponseJson=tn.prototype.Oa,tn.prototype.getResponseText=tn.prototype.oa,tn.prototype.send=tn.prototype.ea,tn.prototype.setWithCredentials=tn.prototype.Ha,DB=tn}).apply(typeof oS<"u"?oS:typeof self<"u"?self:typeof window<"u"?window:{});const lF="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mr.UNAUTHENTICATED=new Mr(null),Mr.GOOGLE_CREDENTIALS=new Mr("google-credentials-uid"),Mr.FIRST_PARTY=new Mr("first-party-uid"),Mr.MOCK_USER=new Mr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yy="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf=new d2("@firebase/firestore");function nv(){return yf.logLevel}function Se(n,...e){if(yf.logLevel<=Xe.DEBUG){const t=e.map(S2);yf.debug(`Firestore (${yy}): ${n}`,...t)}}function Gl(n,...e){if(yf.logLevel<=Xe.ERROR){const t=e.map(S2);yf.error(`Firestore (${yy}): ${n}`,...t)}}function ty(n,...e){if(yf.logLevel<=Xe.WARN){const t=e.map(S2);yf.warn(`Firestore (${yy}): ${n}`,...t)}}function S2(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ie(n="Unexpected state"){const e=`FIRESTORE (${yy}) INTERNAL ASSERTION FAILED: `+n;throw Gl(e),new Error(e)}function ft(n,e){n||Ie()}function Le(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class me extends ka{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ll{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jB{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class nQ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Mr.UNAUTHENTICATED))}shutdown(){}}class rQ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class sQ{constructor(e){this.t=e,this.currentUser=Mr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ft(this.o===void 0);let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Ll;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Ll,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},o=l=>{Se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(l=>o(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?o(l):(Se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Ll)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ft(typeof r.accessToken=="string"),new jB(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ft(e===null||typeof e=="string"),new Mr(e)}}class iQ{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Mr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class aQ{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new iQ(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Mr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class oQ{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lQ{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ft(this.o===void 0);const r=i=>{i.error!=null&&Se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const a=i.token!==this.R;return this.R=i.token,Se("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ft(typeof t.token=="string"),this.R=t.token,new oQ(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cQ(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FB{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=cQ(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function st(n,e){return n<e?-1:n>e?1:0}function ny(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new me(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new me(ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new me(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new me(ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Fn.fromMillis(Date.now())}static fromDate(e){return Fn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Fn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Me(e)}static min(){return new Me(new Fn(0,0))}static max(){return new Me(new Fn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0{constructor(e,t,r){t===void 0?t=0:t>e.length&&Ie(),r===void 0?r=e.length-t:r>e.length-t&&Ie(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return I0.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof I0?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),a=t.get(s);if(i<a)return-1;if(i>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Ft extends I0{construct(e,t,r){return new Ft(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new me(ne.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Ft(t)}static emptyPath(){return new Ft([])}}const uQ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class dr extends I0{construct(e,t,r){return new dr(e,t,r)}static isValidIdentifier(e){return uQ.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),dr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new dr(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new me(ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let a=!1;for(;s<e.length;){const o=e[s];if(o==="\\"){if(s+1===e.length)throw new me(ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new me(ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else o==="`"?(a=!a,s++):o!=="."||a?(r+=o,s++):(i(),s++)}if(i(),a)throw new me(ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new dr(t)}static emptyPath(){return new dr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ce{constructor(e){this.path=e}static fromPath(e){return new Ce(Ft.fromString(e))}static fromName(e){return new Ce(Ft.fromString(e).popFirst(5))}static empty(){return new Ce(Ft.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Ft.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Ft.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ce(new Ft(e.slice()))}}function hQ(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=Me.fromTimestamp(r===1e9?new Fn(t+1,0):new Fn(t,r));return new Bu(s,Ce.empty(),e)}function dQ(n){return new Bu(n.readTime,n.key,-1)}class Bu{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Bu(Me.min(),Ce.empty(),-1)}static max(){return new Bu(Me.max(),Ce.empty(),-1)}}function fQ(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ce.comparator(n.documentKey,e.documentKey),t!==0?t:st(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pQ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class mQ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K_(n){if(n.code!==ne.FAILED_PRECONDITION||n.message!==pQ)throw n;Se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ie(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(t){return se.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):se.reject(t)}static resolve(e){return new se((t,r)=>{t(e)})}static reject(e){return new se((t,r)=>{r(e)})}static waitFor(e){return new se((t,r)=>{let s=0,i=0,a=!1;e.forEach(o=>{++s,o.next(()=>{++i,a&&i===s&&t()},l=>r(l))}),a=!0,i===s&&t()})}static or(e){let t=se.resolve(!1);for(const r of e)t=t.next(s=>s?se.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new se((r,s)=>{const i=e.length,a=new Array(i);let o=0;for(let l=0;l<i;l++){const u=l;t(e[u]).next(h=>{a[u]=h,++o,o===i&&r(a)},h=>s(h))}})}static doWhile(e,t){return new se((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function gQ(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function X_(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}E2.oe=-1;function wC(n){return n==null}function E1(n){return n===0&&1/n==-1/0}function yQ(n){return typeof n=="number"&&Number.isInteger(n)&&!E1(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cF(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function jf(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function $B(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e,t){this.comparator=e,this.root=t||ur.EMPTY}insert(e,t){return new en(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ur.BLACK,null,null))}remove(e){return new en(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ur.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lS(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lS(this.root,e,this.comparator,!1)}getReverseIterator(){return new lS(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lS(this.root,e,this.comparator,!0)}}class lS{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ur{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??ur.RED,this.left=s??ur.EMPTY,this.right=i??ur.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new ur(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ur.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return ur.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ur.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ur.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ie();const e=this.left.check();if(e!==this.right.check())throw Ie();return e+(this.isRed()?0:1)}}ur.EMPTY=null,ur.RED=!0,ur.BLACK=!1;ur.EMPTY=new class{constructor(){this.size=0}get key(){throw Ie()}get value(){throw Ie()}get color(){throw Ie()}get left(){throw Ie()}get right(){throw Ie()}copy(e,t,r,s,i){return this}insert(e,t,r){return new ur(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e){this.comparator=e,this.data=new en(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new uF(this.data.getIterator())}getIteratorFrom(e){return new uF(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof pr)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new pr(this.comparator);return t.data=e,t}}class uF{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this.fields=e,e.sort(dr.comparator)}static empty(){return new ai([])}unionWith(e){let t=new pr(dr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ai(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ny(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UB extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new UB("Invalid base64 string: "+i):i}}(e);return new yr(t)}static fromUint8Array(e){const t=function(s){let i="";for(let a=0;a<s.length;++a)i+=String.fromCharCode(s[a]);return i}(e);return new yr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yr.EMPTY_BYTE_STRING=new yr("");const vQ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function zu(n){if(ft(!!n),typeof n=="string"){let e=0;const t=vQ.exec(n);if(ft(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:yn(n.seconds),nanos:yn(n.nanos)}}function yn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function vf(n){return typeof n=="string"?yr.fromBase64String(n):yr.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function T2(n){const e=n.mapValue.fields.__previous_value__;return A2(e)?T2(e):e}function D0(n){const e=zu(n.mapValue.fields.__local_write_time__.timestampValue);return new Fn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wQ{constructor(e,t,r,s,i,a,o,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=l,this.useFetchStreams=u}}class R0{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new R0("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof R0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cS={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function wf(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?A2(n)?4:_Q(n)?9007199254740991:bQ(n)?10:11:Ie()}function Eo(n,e){if(n===e)return!0;const t=wf(n);if(t!==wf(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return D0(n).isEqual(D0(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const a=zu(s.timestampValue),o=zu(i.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return vf(s.bytesValue).isEqual(vf(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return yn(s.geoPointValue.latitude)===yn(i.geoPointValue.latitude)&&yn(s.geoPointValue.longitude)===yn(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return yn(s.integerValue)===yn(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const a=yn(s.doubleValue),o=yn(i.doubleValue);return a===o?E1(a)===E1(o):isNaN(a)&&isNaN(o)}return!1}(n,e);case 9:return ny(n.arrayValue.values||[],e.arrayValue.values||[],Eo);case 10:case 11:return function(s,i){const a=s.mapValue.fields||{},o=i.mapValue.fields||{};if(cF(a)!==cF(o))return!1;for(const l in a)if(a.hasOwnProperty(l)&&(o[l]===void 0||!Eo(a[l],o[l])))return!1;return!0}(n,e);default:return Ie()}}function M0(n,e){return(n.values||[]).find(t=>Eo(t,e))!==void 0}function ry(n,e){if(n===e)return 0;const t=wf(n),r=wf(e);if(t!==r)return st(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return function(i,a){const o=yn(i.integerValue||i.doubleValue),l=yn(a.integerValue||a.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(n,e);case 3:return hF(n.timestampValue,e.timestampValue);case 4:return hF(D0(n),D0(e));case 5:return st(n.stringValue,e.stringValue);case 6:return function(i,a){const o=vf(i),l=vf(a);return o.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const o=i.split("/"),l=a.split("/");for(let u=0;u<o.length&&u<l.length;u++){const h=st(o[u],l[u]);if(h!==0)return h}return st(o.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const o=st(yn(i.latitude),yn(a.latitude));return o!==0?o:st(yn(i.longitude),yn(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return dF(n.arrayValue,e.arrayValue);case 10:return function(i,a){var o,l,u,h;const f=i.fields||{},p=a.fields||{},g=(o=f.value)===null||o===void 0?void 0:o.arrayValue,v=(l=p.value)===null||l===void 0?void 0:l.arrayValue,y=st(((u=g==null?void 0:g.values)===null||u===void 0?void 0:u.length)||0,((h=v==null?void 0:v.values)===null||h===void 0?void 0:h.length)||0);return y!==0?y:dF(g,v)}(n.mapValue,e.mapValue);case 11:return function(i,a){if(i===cS.mapValue&&a===cS.mapValue)return 0;if(i===cS.mapValue)return 1;if(a===cS.mapValue)return-1;const o=i.fields||{},l=Object.keys(o),u=a.fields||{},h=Object.keys(u);l.sort(),h.sort();for(let f=0;f<l.length&&f<h.length;++f){const p=st(l[f],h[f]);if(p!==0)return p;const g=ry(o[l[f]],u[h[f]]);if(g!==0)return g}return st(l.length,h.length)}(n.mapValue,e.mapValue);default:throw Ie()}}function hF(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return st(n,e);const t=zu(n),r=zu(e),s=st(t.seconds,r.seconds);return s!==0?s:st(t.nanos,r.nanos)}function dF(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const i=ry(t[s],r[s]);if(i)return i}return st(t.length,r.length)}function sy(n){return JP(n)}function JP(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=zu(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return vf(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ce.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=JP(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const a of r)i?i=!1:s+=",",s+=`${a}:${JP(t.fields[a])}`;return s+"}"}(n.mapValue):Ie()}function fF(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ZP(n){return!!n&&"integerValue"in n}function C2(n){return!!n&&"arrayValue"in n}function pF(n){return!!n&&"nullValue"in n}function mF(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function QS(n){return!!n&&"mapValue"in n}function bQ(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function r0(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return jf(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=r0(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=r0(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _Q(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e){this.value=e}static empty(){return new _s({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!QS(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=r0(t)}setAll(e){let t=dr.emptyPath(),r={},s=[];e.forEach((a,o)=>{if(!t.isImmediateParentOf(o)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=o.popLast()}a?r[o.lastSegment()]=r0(a):s.push(o.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());QS(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Eo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];QS(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){jf(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new _s(r0(this.value))}}function VB(n){const e=[];return jf(n.fields,(t,r)=>{const s=new dr([t]);if(QS(r)){const i=VB(r.mapValue).fields;if(i.length===0)e.push(s);else for(const a of i)e.push(s.child(a))}else e.push(s)}),new ai(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e,t,r,s,i,a,o){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=a,this.documentState=o}static newInvalidDocument(e){return new Lr(e,0,Me.min(),Me.min(),Me.min(),_s.empty(),0)}static newFoundDocument(e,t,r,s){return new Lr(e,1,t,Me.min(),r,s,0)}static newNoDocument(e,t){return new Lr(e,2,t,Me.min(),Me.min(),_s.empty(),0)}static newUnknownDocument(e,t){return new Lr(e,3,t,Me.min(),Me.min(),_s.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=_s.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=_s.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Lr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Lr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A1{constructor(e,t){this.position=e,this.inclusive=t}}function gF(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],a=n.position[s];if(i.field.isKeyField()?r=Ce.comparator(Ce.fromName(a.referenceValue),t.key):r=ry(a,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function yF(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Eo(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{constructor(e,t="asc"){this.field=e,this.dir=t}}function xQ(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB{}class Tn extends BB{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new EQ(e,t,r):t==="array-contains"?new CQ(e,r):t==="in"?new kQ(e,r):t==="not-in"?new NQ(e,r):t==="array-contains-any"?new PQ(e,r):new Tn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new AQ(e,r):new TQ(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(ry(t,this.value)):t!==null&&wf(this.value)===wf(t)&&this.matchesComparison(ry(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ie()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ea extends BB{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Ea(e,t)}matches(e){return zB(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function zB(n){return n.op==="and"}function HB(n){return SQ(n)&&zB(n)}function SQ(n){for(const e of n.filters)if(e instanceof Ea)return!1;return!0}function eI(n){if(n instanceof Tn)return n.field.canonicalString()+n.op.toString()+sy(n.value);if(HB(n))return n.filters.map(e=>eI(e)).join(",");{const e=n.filters.map(t=>eI(t)).join(",");return`${n.op}(${e})`}}function WB(n,e){return n instanceof Tn?function(r,s){return s instanceof Tn&&r.op===s.op&&r.field.isEqual(s.field)&&Eo(r.value,s.value)}(n,e):n instanceof Ea?function(r,s){return s instanceof Ea&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,a,o)=>i&&WB(a,s.filters[o]),!0):!1}(n,e):void Ie()}function GB(n){return n instanceof Tn?function(t){return`${t.field.canonicalString()} ${t.op} ${sy(t.value)}`}(n):n instanceof Ea?function(t){return t.op.toString()+" {"+t.getFilters().map(GB).join(" ,")+"}"}(n):"Filter"}class EQ extends Tn{constructor(e,t,r){super(e,t,r),this.key=Ce.fromName(r.referenceValue)}matches(e){const t=Ce.comparator(e.key,this.key);return this.matchesComparison(t)}}class AQ extends Tn{constructor(e,t){super(e,"in",t),this.keys=qB("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class TQ extends Tn{constructor(e,t){super(e,"not-in",t),this.keys=qB("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function qB(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Ce.fromName(r.referenceValue))}class CQ extends Tn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return C2(t)&&M0(t.arrayValue,this.value)}}class kQ extends Tn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&M0(this.value.arrayValue,t)}}class NQ extends Tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(M0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!M0(this.value.arrayValue,t)}}class PQ extends Tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!C2(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>M0(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IQ{constructor(e,t=null,r=[],s=[],i=null,a=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=a,this.endAt=o,this.ue=null}}function vF(n,e=null,t=[],r=[],s=null,i=null,a=null){return new IQ(n,e,t,r,s,i,a)}function k2(n){const e=Le(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>eI(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),wC(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>sy(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>sy(r)).join(",")),e.ue=t}return e.ue}function N2(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!xQ(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!WB(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!yF(n.startAt,e.startAt)&&yF(n.endAt,e.endAt)}function tI(n){return Ce.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vy{constructor(e,t=null,r=[],s=[],i=null,a="F",o=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=a,this.startAt=o,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function DQ(n,e,t,r,s,i,a,o){return new vy(n,e,t,r,s,i,a,o)}function bC(n){return new vy(n)}function wF(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function YB(n){return n.collectionGroup!==null}function s0(n){const e=Le(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new pr(dr.comparator);return a.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(o=o.add(u.field))})}),o})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new O0(i,r))}),t.has(dr.keyField().canonicalString())||e.ce.push(new O0(dr.keyField(),r))}return e.ce}function wo(n){const e=Le(n);return e.le||(e.le=RQ(e,s0(n))),e.le}function RQ(n,e){if(n.limitType==="F")return vF(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new O0(s.field,i)});const t=n.endAt?new A1(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new A1(n.startAt.position,n.startAt.inclusive):null;return vF(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function nI(n,e){const t=n.filters.concat([e]);return new vy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function rI(n,e,t){return new vy(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function _C(n,e){return N2(wo(n),wo(e))&&n.limitType===e.limitType}function KB(n){return`${k2(wo(n))}|lt:${n.limitType}`}function ep(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>GB(s)).join(", ")}]`),wC(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>sy(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>sy(s)).join(",")),`Target(${r})`}(wo(n))}; limitType=${n.limitType})`}function xC(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ce.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of s0(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(a,o,l){const u=gF(a,o,l);return a.inclusive?u<=0:u<0}(r.startAt,s0(r),s)||r.endAt&&!function(a,o,l){const u=gF(a,o,l);return a.inclusive?u>=0:u>0}(r.endAt,s0(r),s))}(n,e)}function MQ(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function XB(n){return(e,t)=>{let r=!1;for(const s of s0(n)){const i=OQ(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function OQ(n,e,t){const r=n.field.isKeyField()?Ce.comparator(e.key,t.key):function(i,a,o){const l=a.data.field(i),u=o.data.field(i);return l!==null&&u!==null?ry(l,u):Ie()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Ie()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){jf(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return $B(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LQ=new en(Ce.comparator);function ql(){return LQ}const QB=new en(Ce.comparator);function xv(...n){let e=QB;for(const t of n)e=e.insert(t.key,t);return e}function JB(n){let e=QB;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Ah(){return i0()}function ZB(){return i0()}function i0(){return new wy(n=>n.toString(),(n,e)=>n.isEqual(e))}const jQ=new en(Ce.comparator),FQ=new pr(Ce.comparator);function Ge(...n){let e=FQ;for(const t of n)e=e.add(t);return e}const $Q=new pr(st);function UQ(){return $Q}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P2(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:E1(e)?"-0":e}}function e5(n){return{integerValue:""+n}}function VQ(n,e){return yQ(e)?e5(e):P2(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(){this._=void 0}}function BQ(n,e,t){return n instanceof L0?function(s,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&A2(i)&&(i=T2(i)),i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof j0?n5(n,e):n instanceof F0?r5(n,e):function(s,i){const a=t5(s,i),o=bF(a)+bF(s.Pe);return ZP(a)&&ZP(s.Pe)?e5(o):P2(s.serializer,o)}(n,e)}function zQ(n,e,t){return n instanceof j0?n5(n,e):n instanceof F0?r5(n,e):t}function t5(n,e){return n instanceof T1?function(r){return ZP(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class L0 extends SC{}class j0 extends SC{constructor(e){super(),this.elements=e}}function n5(n,e){const t=s5(e);for(const r of n.elements)t.some(s=>Eo(s,r))||t.push(r);return{arrayValue:{values:t}}}class F0 extends SC{constructor(e){super(),this.elements=e}}function r5(n,e){let t=s5(e);for(const r of n.elements)t=t.filter(s=>!Eo(s,r));return{arrayValue:{values:t}}}class T1 extends SC{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function bF(n){return yn(n.integerValue||n.doubleValue)}function s5(n){return C2(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HQ{constructor(e,t){this.field=e,this.transform=t}}function WQ(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof j0&&s instanceof j0||r instanceof F0&&s instanceof F0?ny(r.elements,s.elements,Eo):r instanceof T1&&s instanceof T1?Eo(r.Pe,s.Pe):r instanceof L0&&s instanceof L0}(n.transform,e.transform)}class GQ{constructor(e,t){this.version=e,this.transformResults=t}}class $i{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new $i}static exists(e){return new $i(void 0,e)}static updateTime(e){return new $i(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function JS(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class EC{}function i5(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new I2(n.key,$i.none()):new Q_(n.key,n.data,$i.none());{const t=n.data,r=_s.empty();let s=new pr(dr.comparator);for(let i of e.fields)if(!s.has(i)){let a=t.field(i);a===null&&i.length>1&&(i=i.popLast(),a=t.field(i)),a===null?r.delete(i):r.set(i,a),s=s.add(i)}return new Zu(n.key,r,new ai(s.toArray()),$i.none())}}function qQ(n,e,t){n instanceof Q_?function(s,i,a){const o=s.value.clone(),l=xF(s.fieldTransforms,i,a.transformResults);o.setAll(l),i.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(n,e,t):n instanceof Zu?function(s,i,a){if(!JS(s.precondition,i))return void i.convertToUnknownDocument(a.version);const o=xF(s.fieldTransforms,i,a.transformResults),l=i.data;l.setAll(a5(s)),l.setAll(o),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,a){i.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function a0(n,e,t,r){return n instanceof Q_?function(i,a,o,l){if(!JS(i.precondition,a))return o;const u=i.value.clone(),h=SF(i.fieldTransforms,l,a);return u.setAll(h),a.convertToFoundDocument(a.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Zu?function(i,a,o,l){if(!JS(i.precondition,a))return o;const u=SF(i.fieldTransforms,l,a),h=a.data;return h.setAll(a5(i)),h.setAll(u),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,a,o){return JS(i.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(n,e,t)}function YQ(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=t5(r.transform,s||null);i!=null&&(t===null&&(t=_s.empty()),t.set(r.field,i))}return t||null}function _F(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&ny(r,s,(i,a)=>WQ(i,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Q_ extends EC{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Zu extends EC{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function a5(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function xF(n,e,t){const r=new Map;ft(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],a=i.transform,o=e.data.field(i.field);r.set(i.field,zQ(a,o,t[s]))}return r}function SF(n,e,t){const r=new Map;for(const s of n){const i=s.transform,a=t.data.field(s.field);r.set(s.field,BQ(i,a,e))}return r}class I2 extends EC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class KQ extends EC{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XQ{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&qQ(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=a0(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=a0(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=ZB();return this.mutations.forEach(s=>{const i=e.get(s.key),a=i.overlayedDocument;let o=this.applyToLocalView(a,i.mutatedFields);o=t.has(s.key)?null:o;const l=i5(a,o);l!==null&&r.set(s.key,l),a.isValidDocument()||a.convertToNoDocument(Me.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ge())}isEqual(e){return this.batchId===e.batchId&&ny(this.mutations,e.mutations,(t,r)=>_F(t,r))&&ny(this.baseMutations,e.baseMutations,(t,r)=>_F(t,r))}}class D2{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ft(e.mutations.length===r.length);let s=function(){return jQ}();const i=e.mutations;for(let a=0;a<i.length;a++)s=s.insert(i[a].key,r[a].version);return new D2(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let QQ=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JQ{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xn,Ze;function ZQ(n){switch(n){default:return Ie();case ne.CANCELLED:case ne.UNKNOWN:case ne.DEADLINE_EXCEEDED:case ne.RESOURCE_EXHAUSTED:case ne.INTERNAL:case ne.UNAVAILABLE:case ne.UNAUTHENTICATED:return!1;case ne.INVALID_ARGUMENT:case ne.NOT_FOUND:case ne.ALREADY_EXISTS:case ne.PERMISSION_DENIED:case ne.FAILED_PRECONDITION:case ne.ABORTED:case ne.OUT_OF_RANGE:case ne.UNIMPLEMENTED:case ne.DATA_LOSS:return!0}}function o5(n){if(n===void 0)return Gl("GRPC error has no .code"),ne.UNKNOWN;switch(n){case xn.OK:return ne.OK;case xn.CANCELLED:return ne.CANCELLED;case xn.UNKNOWN:return ne.UNKNOWN;case xn.DEADLINE_EXCEEDED:return ne.DEADLINE_EXCEEDED;case xn.RESOURCE_EXHAUSTED:return ne.RESOURCE_EXHAUSTED;case xn.INTERNAL:return ne.INTERNAL;case xn.UNAVAILABLE:return ne.UNAVAILABLE;case xn.UNAUTHENTICATED:return ne.UNAUTHENTICATED;case xn.INVALID_ARGUMENT:return ne.INVALID_ARGUMENT;case xn.NOT_FOUND:return ne.NOT_FOUND;case xn.ALREADY_EXISTS:return ne.ALREADY_EXISTS;case xn.PERMISSION_DENIED:return ne.PERMISSION_DENIED;case xn.FAILED_PRECONDITION:return ne.FAILED_PRECONDITION;case xn.ABORTED:return ne.ABORTED;case xn.OUT_OF_RANGE:return ne.OUT_OF_RANGE;case xn.UNIMPLEMENTED:return ne.UNIMPLEMENTED;case xn.DATA_LOSS:return ne.DATA_LOSS;default:return Ie()}}(Ze=xn||(xn={}))[Ze.OK=0]="OK",Ze[Ze.CANCELLED=1]="CANCELLED",Ze[Ze.UNKNOWN=2]="UNKNOWN",Ze[Ze.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ze[Ze.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ze[Ze.NOT_FOUND=5]="NOT_FOUND",Ze[Ze.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ze[Ze.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ze[Ze.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ze[Ze.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ze[Ze.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ze[Ze.ABORTED=10]="ABORTED",Ze[Ze.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ze[Ze.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ze[Ze.INTERNAL=13]="INTERNAL",Ze[Ze.UNAVAILABLE=14]="UNAVAILABLE",Ze[Ze.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eJ(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tJ=new rf([4294967295,4294967295],0);function EF(n){const e=eJ().encode(n),t=new IB;return t.update(e),new Uint8Array(t.digest())}function AF(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new rf([t,r],0),new rf([s,i],0)]}class R2{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Sv(`Invalid padding: ${t}`);if(r<0)throw new Sv(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Sv(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Sv(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=rf.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(rf.fromNumber(r)));return s.compare(tJ)===1&&(s=new rf([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=EF(e),[r,s]=AF(t);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);if(!this.de(a))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),a=new R2(i,s,t);return r.forEach(o=>a.insert(o)),a}insert(e){if(this.Ie===0)return;const t=EF(e),[r,s]=AF(t);for(let i=0;i<this.hashCount;i++){const a=this.Ee(r,s,i);this.Ae(a)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Sv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,J_.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new AC(Me.min(),s,new en(st),ql(),Ge())}}class J_{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new J_(r,t,Ge(),Ge(),Ge())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZS{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class l5{constructor(e,t){this.targetId=e,this.me=t}}class c5{constructor(e,t,r=yr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class TF{constructor(){this.fe=0,this.ge=kF(),this.pe=yr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ge(),t=Ge(),r=Ge();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:Ie()}}),new J_(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=kF()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ft(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class nJ{constructor(e){this.Le=e,this.Be=new Map,this.ke=ql(),this.qe=CF(),this.Qe=new en(st)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Ie()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(tI(i))if(r===0){const a=new Ce(i.path);this.Ue(t,a,Lr.newNoDocument(a,Me.min()))}else ft(r===1);else{const a=this.Ye(t);if(a!==r){const o=this.Ze(e),l=o?this.Xe(o,e,a):1;if(l!==0){this.je(t);const u=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,u)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let a,o;try{a=vf(r).toUint8Array()}catch(l){if(l instanceof UB)return ty("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{o=new R2(a,s,i)}catch(l){return ty(l instanceof Sv?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return o.Ie===0?null:o}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const a=this.Le.tt(),o=`projects/${a.projectId}/databases/${a.database}/documents/${i.path.canonicalString()}`;e.mightContain(o)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,a)=>{const o=this.Je(a);if(o){if(i.current&&tI(o.target)){const l=new Ce(o.target.path);this.ke.get(l)!==null||this.it(a,l)||this.Ue(a,l,Lr.newNoDocument(l,e))}i.be&&(t.set(a,i.ve()),i.Ce())}});let r=Ge();this.qe.forEach((i,a)=>{let o=!0;a.forEachWhile(l=>{const u=this.Je(l);return!u||u.purpose==="TargetPurposeLimboResolution"||(o=!1,!1)}),o&&(r=r.add(i))}),this.ke.forEach((i,a)=>a.setReadTime(e));const s=new AC(e,t,this.Qe,this.ke,r);return this.ke=ql(),this.qe=CF(),this.Qe=new en(st),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new TF,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new pr(st),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||Se("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new TF),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function CF(){return new en(Ce.comparator)}function kF(){return new en(Ce.comparator)}const rJ=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),sJ=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),iJ=(()=>({and:"AND",or:"OR"}))();class aJ{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function sI(n,e){return n.useProto3Json||wC(e)?e:{value:e}}function C1(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function u5(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function oJ(n,e){return C1(n,e.toTimestamp())}function bo(n){return ft(!!n),Me.fromTimestamp(function(t){const r=zu(t);return new Fn(r.seconds,r.nanos)}(n))}function M2(n,e){return iI(n,e).canonicalString()}function iI(n,e){const t=function(s){return new Ft(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function h5(n){const e=Ft.fromString(n);return ft(g5(e)),e}function aI(n,e){return M2(n.databaseId,e.path)}function yN(n,e){const t=h5(e);if(t.get(1)!==n.databaseId.projectId)throw new me(ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new me(ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ce(f5(t))}function d5(n,e){return M2(n.databaseId,e)}function lJ(n){const e=h5(n);return e.length===4?Ft.emptyPath():f5(e)}function oI(n){return new Ft(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function f5(n){return ft(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function NF(n,e,t){return{name:aI(n,e),fields:t.value.mapValue.fields}}function cJ(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:Ie()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,h){return u.useProto3Json?(ft(h===void 0||typeof h=="string"),yr.fromBase64String(h||"")):(ft(h===void 0||h instanceof Buffer||h instanceof Uint8Array),yr.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,o=a&&function(u){const h=u.code===void 0?ne.UNKNOWN:o5(u.code);return new me(h,u.message||"")}(a);t=new c5(r,s,i,o||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=yN(n,r.document.name),i=bo(r.document.updateTime),a=r.document.createTime?bo(r.document.createTime):Me.min(),o=new _s({mapValue:{fields:r.document.fields}}),l=Lr.newFoundDocument(s,i,a,o),u=r.targetIds||[],h=r.removedTargetIds||[];t=new ZS(u,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=yN(n,r.document),i=r.readTime?bo(r.readTime):Me.min(),a=Lr.newNoDocument(s,i),o=r.removedTargetIds||[];t=new ZS([],o,a.key,a)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=yN(n,r.document),i=r.removedTargetIds||[];t=new ZS([],i,s,null)}else{if(!("filter"in e))return Ie();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,a=new JQ(s,i),o=r.targetId;t=new l5(o,a)}}return t}function uJ(n,e){let t;if(e instanceof Q_)t={update:NF(n,e.key,e.value)};else if(e instanceof I2)t={delete:aI(n,e.key)};else if(e instanceof Zu)t={update:NF(n,e.key,e.data),updateMask:wJ(e.fieldMask)};else{if(!(e instanceof KQ))return Ie();t={verify:aI(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const o=a.transform;if(o instanceof L0)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof j0)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof F0)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof T1)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Ie()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:oJ(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:Ie()}(n,e.precondition)),t}function hJ(n,e){return n&&n.length>0?(ft(e!==void 0),n.map(t=>function(s,i){let a=s.updateTime?bo(s.updateTime):bo(i);return a.isEqual(Me.min())&&(a=bo(i)),new GQ(a,s.transformResults||[])}(t,e))):[]}function dJ(n,e){return{documents:[d5(n,e.path)]}}function fJ(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=d5(n,s);const i=function(u){if(u.length!==0)return m5(Ea.create(u,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const a=function(u){if(u.length!==0)return u.map(h=>function(p){return{field:tp(p.field),direction:gJ(p.dir)}}(h))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const o=sI(n,e.limit);return o!==null&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:s}}function pJ(n){let e=lJ(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ft(r===1);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=function(f){const p=p5(f);return p instanceof Ea&&HB(p)?p.getFilters():[p]}(t.where));let a=[];t.orderBy&&(a=function(f){return f.map(p=>function(v){return new O0(np(v.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(p))}(t.orderBy));let o=null;t.limit&&(o=function(f){let p;return p=typeof f=="object"?f.value:f,wC(p)?null:p}(t.limit));let l=null;t.startAt&&(l=function(f){const p=!!f.before,g=f.values||[];return new A1(g,p)}(t.startAt));let u=null;return t.endAt&&(u=function(f){const p=!f.before,g=f.values||[];return new A1(g,p)}(t.endAt)),DQ(e,s,a,i,o,"F",l,u)}function mJ(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ie()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function p5(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=np(t.unaryFilter.field);return Tn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=np(t.unaryFilter.field);return Tn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=np(t.unaryFilter.field);return Tn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=np(t.unaryFilter.field);return Tn.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ie()}}(n):n.fieldFilter!==void 0?function(t){return Tn.create(np(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ie()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Ea.create(t.compositeFilter.filters.map(r=>p5(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return Ie()}}(t.compositeFilter.op))}(n):Ie()}function gJ(n){return rJ[n]}function yJ(n){return sJ[n]}function vJ(n){return iJ[n]}function tp(n){return{fieldPath:n.canonicalString()}}function np(n){return dr.fromServerFormat(n.fieldPath)}function m5(n){return n instanceof Tn?function(t){if(t.op==="=="){if(mF(t.value))return{unaryFilter:{field:tp(t.field),op:"IS_NAN"}};if(pF(t.value))return{unaryFilter:{field:tp(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(mF(t.value))return{unaryFilter:{field:tp(t.field),op:"IS_NOT_NAN"}};if(pF(t.value))return{unaryFilter:{field:tp(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:tp(t.field),op:yJ(t.op),value:t.value}}}(n):n instanceof Ea?function(t){const r=t.getFilters().map(s=>m5(s));return r.length===1?r[0]:{compositeFilter:{op:vJ(t.op),filters:r}}}(n):Ie()}function wJ(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function g5(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eu{constructor(e,t,r,s,i=Me.min(),a=Me.min(),o=yr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=o,this.expectedCount=l}withSequenceNumber(e){return new Eu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Eu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Eu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Eu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bJ{constructor(e){this.ct=e}}function _J(n){const e=pJ({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?rI(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xJ{constructor(){this.un=new SJ}addToCollectionParentIndex(e,t){return this.un.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(Bu.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(Bu.min())}updateCollectionGroup(e,t,r){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class SJ{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new pr(Ft.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new pr(Ft.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iy{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new iy(0)}static kn(){return new iy(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(){this.changes=new wy(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Lr.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?se.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AJ{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TJ{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&a0(r.mutation,s,ai.empty(),Fn.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ge()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ge()){const s=Ah();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let a=xv();return i.forEach((o,l)=>{a=a.insert(o,l.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){const r=Ah();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ge()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((a,o)=>{t.set(a,o)})})}computeViews(e,t,r,s){let i=ql();const a=i0(),o=function(){return i0()}();return t.forEach((l,u)=>{const h=r.get(u.key);s.has(u.key)&&(h===void 0||h.mutation instanceof Zu)?i=i.insert(u.key,u):h!==void 0?(a.set(u.key,h.mutation.getFieldMask()),a0(h.mutation,u,h.mutation.getFieldMask(),Fn.now())):a.set(u.key,ai.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((u,h)=>a.set(u,h)),t.forEach((u,h)=>{var f;return o.set(u,new AJ(h,(f=a.get(u))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,t){const r=i0();let s=new en((a,o)=>a-o),i=Ge();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(const o of a)o.keys().forEach(l=>{const u=t.get(l);if(u===null)return;let h=r.get(l)||ai.empty();h=o.applyToLocalView(u,h),r.set(l,h);const f=(s.get(o.batchId)||Ge()).add(l);s=s.insert(o.batchId,f)})}).next(()=>{const a=[],o=s.getReverseIterator();for(;o.hasNext();){const l=o.getNext(),u=l.key,h=l.value,f=ZB();h.forEach(p=>{if(!i.has(p)){const g=i5(t.get(p),r.get(p));g!==null&&f.set(p,g),i=i.add(p)}}),a.push(this.documentOverlayCache.saveOverlays(e,u,f))}return se.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(a){return Ce.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):YB(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const a=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):se.resolve(Ah());let o=-1,l=i;return a.next(u=>se.forEach(u,(h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),i.get(h)?se.resolve():this.remoteDocumentCache.getEntry(e,h).next(p=>{l=l.insert(h,p)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,l,u,Ge())).next(h=>({batchId:o,changes:JB(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ce(t)).next(r=>{let s=xv();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let a=xv();return this.indexManager.getCollectionParents(e,i).next(o=>se.forEach(o,l=>{const u=function(f,p){return new vy(p,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(h=>{h.forEach((f,p)=>{a=a.insert(f,p)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(i=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(a=>{i.forEach((l,u)=>{const h=u.getKey();a.get(h)===null&&(a=a.insert(h,Lr.newInvalidDocument(h)))});let o=xv();return a.forEach((l,u)=>{const h=i.get(l);h!==void 0&&a0(h.mutation,u,ai.empty(),Fn.now()),xC(t,u)&&(o=o.insert(l,u))}),o})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CJ{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return se.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:bo(s.createTime)}}(t)),se.resolve()}getNamedQuery(e,t){return se.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(s){return{name:s.name,query:_J(s.bundledQuery),readTime:bo(s.readTime)}}(t)),se.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kJ{constructor(){this.overlays=new en(Ce.comparator),this.Ir=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Ah();return se.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),se.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),se.resolve()}getOverlaysForCollection(e,t,r){const s=Ah(),i=t.length+1,a=new Ce(t.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){const l=o.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return se.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new en((u,h)=>u-h);const a=this.overlays.getIterator();for(;a.hasNext();){const u=a.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let h=i.get(u.largestBatchId);h===null&&(h=Ah(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const o=Ah(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,h)=>o.set(u,h)),!(o.size()>=s)););return se.resolve(o)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const a=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new QQ(t,r));let i=this.Ir.get(t);i===void 0&&(i=Ge(),this.Ir.set(t,i)),this.Ir.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NJ{constructor(){this.sessionToken=yr.EMPTY_BYTE_STRING}getSessionToken(e){return se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,se.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O2{constructor(){this.Tr=new pr(Xn.Er),this.dr=new pr(Xn.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new Xn(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new Xn(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Ce(new Ft([])),r=new Xn(t,e),s=new Xn(t,e+1),i=[];return this.dr.forEachInRange([r,s],a=>{this.Vr(a),i.push(a.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Ce(new Ft([])),r=new Xn(t,e),s=new Xn(t,e+1);let i=Ge();return this.dr.forEachInRange([r,s],a=>{i=i.add(a.key)}),i}containsKey(e){const t=new Xn(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Xn{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Ce.comparator(e.key,t.key)||st(e.wr,t.wr)}static Ar(e,t){return st(e.wr,t.wr)||Ce.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PJ{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new pr(Xn.Er)}checkEmpty(e){return se.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const a=new XQ(i,t,r,s);this.mutationQueue.push(a);for(const o of s)this.br=this.br.add(new Xn(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(a)}lookupMutationBatch(e,t){return se.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.vr(r),i=s<0?0:s;return se.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Xn(t,0),s=new Xn(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],a=>{const o=this.Dr(a.wr);i.push(o)}),se.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pr(st);return t.forEach(s=>{const i=new Xn(s,0),a=new Xn(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,a],o=>{r=r.add(o.wr)})}),se.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Ce.isDocumentKey(i)||(i=i.child(""));const a=new Xn(new Ce(i),0);let o=new pr(st);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(o=o.add(l.wr)),!0)},a),se.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){ft(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return se.forEach(t.mutations,s=>{const i=new Xn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new Xn(t,0),s=this.br.firstAfterOrEqual(r);return se.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IJ{constructor(e){this.Mr=e,this.docs=function(){return new en(Ce.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return se.resolve(r?r.document.mutableCopy():Lr.newInvalidDocument(t))}getEntries(e,t){let r=ql();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Lr.newInvalidDocument(s))}),se.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=ql();const a=t.path,o=new Ce(a.child("")),l=this.docs.getIteratorFrom(o);for(;l.hasNext();){const{key:u,value:{document:h}}=l.getNext();if(!a.isPrefixOf(u.path))break;u.path.length>a.length+1||fQ(dQ(h),r)<=0||(s.has(h.key)||xC(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return se.resolve(i)}getAllFromCollectionGroup(e,t,r,s){Ie()}Or(e,t){return se.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new DJ(this)}getSize(e){return se.resolve(this.size)}}class DJ extends EJ{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),se.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RJ{constructor(e){this.persistence=e,this.Nr=new wy(t=>k2(t),N2),this.lastRemoteSnapshotVersion=Me.min(),this.highestTargetId=0,this.Lr=0,this.Br=new O2,this.targetCount=0,this.kr=iy.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,s)=>t(s)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),se.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new iy(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.Kn(t),se.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Nr.forEach((a,o)=>{o.sequenceNumber<=t&&r.get(o.targetId)===null&&(this.Nr.delete(a),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),s++)}),se.waitFor(i).next(()=>s)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return se.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),se.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(a=>{i.push(s.markPotentiallyOrphaned(e,a))}),se.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),se.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return se.resolve(r)}containsKey(e,t){return se.resolve(this.Br.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MJ{constructor(e,t){this.qr={},this.overlays={},this.Qr=new E2(0),this.Kr=!1,this.Kr=!0,this.$r=new NJ,this.referenceDelegate=e(this),this.Ur=new RJ(this),this.indexManager=new xJ,this.remoteDocumentCache=function(s){return new IJ(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new bJ(t),this.Gr=new CJ(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new kJ,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new PJ(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){Se("MemoryPersistence","Starting transaction:",e);const s=new OJ(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,t){return se.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class OJ extends mQ{constructor(e){super(),this.currentSequenceNumber=e}}class L2{constructor(e){this.persistence=e,this.Jr=new O2,this.Yr=null}static Zr(e){return new L2(e)}get Xr(){if(this.Yr)return this.Yr;throw Ie()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),se.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),se.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.Xr,r=>{const s=Ce.fromPath(r);return this.ei(e,s).next(i=>{i||t.removeEntry(s,Me.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return se.or([()=>se.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=s}static Wi(e,t){let r=Ge(),s=Ge();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new j2(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LJ{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jJ{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return A7()?8:gQ(Ur())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.Yi(e,t).next(a=>{i.result=a}).next(()=>{if(!i.result)return this.Zi(e,t,s,r).next(a=>{i.result=a})}).next(()=>{if(i.result)return;const a=new LJ;return this.Xi(e,t,a).next(o=>{if(i.result=o,this.zi)return this.es(e,t,a,o.size)})}).next(()=>i.result)}es(e,t,r,s){return r.documentReadCount<this.ji?(nv()<=Xe.DEBUG&&Se("QueryEngine","SDK will not create cache indexes for query:",ep(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),se.resolve()):(nv()<=Xe.DEBUG&&Se("QueryEngine","Query:",ep(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(nv()<=Xe.DEBUG&&Se("QueryEngine","The SDK decides to create cache indexes for query:",ep(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wo(t))):se.resolve())}Yi(e,t){if(wF(t))return se.resolve(null);let r=wo(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=rI(t,null,"F"),r=wo(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const a=Ge(...i);return this.Ji.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(t,o);return this.ns(t,u,a,l.readTime)?this.Yi(e,rI(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,r,s){return wF(t)||s.isEqual(Me.min())?se.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const a=this.ts(t,i);return this.ns(t,a,r,s)?se.resolve(null):(nv()<=Xe.DEBUG&&Se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),ep(t)),this.rs(e,a,t,hQ(s,-1)).next(o=>o))})}ts(e,t){let r=new pr(XB(e));return t.forEach((s,i)=>{xC(e,i)&&(r=r.add(i))}),r}ns(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,t,r){return nv()<=Xe.DEBUG&&Se("QueryEngine","Using full collection scan to execute query:",ep(t)),this.Ji.getDocumentsMatchingQuery(e,t,Bu.min(),r)}rs(e,t,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(a=>{i=i.insert(a.key,a)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FJ{constructor(e,t,r,s){this.persistence=e,this.ss=t,this.serializer=s,this.os=new en(st),this._s=new wy(i=>k2(i),N2),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new TJ(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function $J(n,e,t,r){return new FJ(n,e,t,r)}async function y5(n,e){const t=Le(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const a=[],o=[];let l=Ge();for(const u of s){a.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}for(const u of i){o.push(u.batchId);for(const h of u.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:a,addedBatchIds:o}))})})}function UJ(n,e){const t=Le(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.cs.newChangeBuffer({trackRemovals:!0});return function(o,l,u,h){const f=u.batch,p=f.keys();let g=se.resolve();return p.forEach(v=>{g=g.next(()=>h.getEntry(l,v)).next(y=>{const _=u.docVersions.get(v);ft(_!==null),y.version.compareTo(_)<0&&(f.applyToRemoteDocument(y,u),y.isValidDocument()&&(y.setReadTime(u.commitVersion),h.addEntry(y)))})}),g.next(()=>o.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(o){let l=Ge();for(let u=0;u<o.mutationResults.length;++u)o.mutationResults[u].transformResults.length>0&&(l=l.add(o.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function v5(n){const e=Le(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function VJ(n,e){const t=Le(n),r=e.snapshotVersion;let s=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const a=t.cs.newChangeBuffer({trackRemovals:!0});s=t.os;const o=[];e.targetChanges.forEach((h,f)=>{const p=s.get(f);if(!p)return;o.push(t.Ur.removeMatchingKeys(i,h.removedDocuments,f).next(()=>t.Ur.addMatchingKeys(i,h.addedDocuments,f)));let g=p.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?g=g.withResumeToken(yr.EMPTY_BYTE_STRING,Me.min()).withLastLimboFreeSnapshotVersion(Me.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,r)),s=s.insert(f,g),function(y,_,w){return y.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-y.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(p,g,h)&&o.push(t.Ur.updateTargetData(i,g))});let l=ql(),u=Ge();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&o.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))}),o.push(BJ(i,a,e.documentUpdates).next(h=>{l=h.Ps,u=h.Is})),!r.isEqual(Me.min())){const h=t.Ur.getLastRemoteSnapshotVersion(i).next(f=>t.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));o.push(h)}return se.waitFor(o).next(()=>a.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,u)).next(()=>l)}).then(i=>(t.os=s,i))}function BJ(n,e,t){let r=Ge(),s=Ge();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let a=ql();return t.forEach((o,l)=>{const u=i.get(o);l.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(o)),l.isNoDocument()&&l.version.isEqual(Me.min())?(e.removeEntry(o,l.readTime),a=a.insert(o,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||l.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(l),a=a.insert(o,l)):Se("LocalStore","Ignoring outdated watch update for ",o,". Current version:",u.version," Watch version:",l.version)}),{Ps:a,Is:s}})}function zJ(n,e){const t=Le(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function HJ(n,e){const t=Le(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Ur.getTargetData(r,e).next(i=>i?(s=i,se.resolve(s)):t.Ur.allocateTargetId(r).next(a=>(s=new Eu(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}async function lI(n,e,t){const r=Le(n),s=r.os.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,a=>r.persistence.referenceDelegate.removeTarget(a,s))}catch(a){if(!X_(a))throw a;Se("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function PF(n,e,t){const r=Le(n);let s=Me.min(),i=Ge();return r.persistence.runTransaction("Execute query","readwrite",a=>function(l,u,h){const f=Le(l),p=f._s.get(h);return p!==void 0?se.resolve(f.os.get(p)):f.Ur.getTargetData(u,h)}(r,a,wo(e)).next(o=>{if(o)return s=o.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,o.targetId).next(l=>{i=l})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?s:Me.min(),t?i:Ge())).next(o=>(WJ(r,MQ(e),o),{documents:o,Ts:i})))}function WJ(n,e,t){let r=n.us.get(e)||Me.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.us.set(e,r)}class IF{constructor(){this.activeTargetIds=UQ()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class GJ{constructor(){this.so=new IF,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new IF,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qJ{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DF{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uS=null;function vN(){return uS===null?uS=function(){return 268435456+Math.round(2147483648*Math.random())}():uS++,"0x"+uS.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YJ={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KJ{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ar="WebChannelConnection";class XJ extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(t,r,s,i,a){const o=vN(),l=this.xo(t,r.toUriEncodedString());Se("RestConnection",`Sending RPC '${t}' ${o}:`,l,s);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,a),this.No(t,l,u,s).then(h=>(Se("RestConnection",`Received RPC '${t}' ${o}: `,h),h),h=>{throw ty("RestConnection",`RPC '${t}' ${o} failed with error: `,h,"url: ",l,"request:",s),h})}Lo(t,r,s,i,a,o){return this.Mo(t,r,s,i,a)}Oo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+yy}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>t[a]=i),s&&s.headers.forEach((i,a)=>t[a]=i)}xo(t,r){const s=YJ[t];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,s){const i=vN();return new Promise((a,o)=>{const l=new DB;l.setWithCredentials(!0),l.listenOnce(RB.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case XS.NO_ERROR:const h=l.getResponseJson();Se(Ar,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),a(h);break;case XS.TIMEOUT:Se(Ar,`RPC '${e}' ${i} timed out`),o(new me(ne.DEADLINE_EXCEEDED,"Request time out"));break;case XS.HTTP_ERROR:const f=l.getStatus();if(Se(Ar,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let p=l.getResponseJson();Array.isArray(p)&&(p=p[0]);const g=p==null?void 0:p.error;if(g&&g.status&&g.message){const v=function(_){const w=_.toLowerCase().replace(/_/g,"-");return Object.values(ne).indexOf(w)>=0?w:ne.UNKNOWN}(g.status);o(new me(v,g.message))}else o(new me(ne.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new me(ne.UNAVAILABLE,"Connection failed."));break;default:Ie()}}finally{Se(Ar,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(s);Se(Ar,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",u,r,15)})}Bo(e,t,r){const s=vN(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=LB(),o=OB(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=i.join("");Se(Ar,`Creating RPC '${e}' stream ${s}: ${h}`,l);const f=a.createWebChannel(h,l);let p=!1,g=!1;const v=new KJ({Io:_=>{g?Se(Ar,`Not sending because RPC '${e}' stream ${s} is closed:`,_):(p||(Se(Ar,`Opening RPC '${e}' stream ${s} transport.`),f.open(),p=!0),Se(Ar,`RPC '${e}' stream ${s} sending:`,_),f.send(_))},To:()=>f.close()}),y=(_,w,b)=>{_.listen(w,S=>{try{b(S)}catch(T){setTimeout(()=>{throw T},0)}})};return y(f,_v.EventType.OPEN,()=>{g||(Se(Ar,`RPC '${e}' stream ${s} transport opened.`),v.yo())}),y(f,_v.EventType.CLOSE,()=>{g||(g=!0,Se(Ar,`RPC '${e}' stream ${s} transport closed`),v.So())}),y(f,_v.EventType.ERROR,_=>{g||(g=!0,ty(Ar,`RPC '${e}' stream ${s} transport errored:`,_),v.So(new me(ne.UNAVAILABLE,"The operation could not be completed")))}),y(f,_v.EventType.MESSAGE,_=>{var w;if(!g){const b=_.data[0];ft(!!b);const S=b,T=S.error||((w=S[0])===null||w===void 0?void 0:w.error);if(T){Se(Ar,`RPC '${e}' stream ${s} received error:`,T);const P=T.status;let R=function(I){const M=xn[I];if(M!==void 0)return o5(M)}(P),k=T.message;R===void 0&&(R=ne.INTERNAL,k="Unknown error status: "+P+" with message "+T.message),g=!0,v.So(new me(R,k)),f.close()}else Se(Ar,`RPC '${e}' stream ${s} received:`,b),v.bo(b)}}),y(o,MB.STAT_EVENT,_=>{_.stat===QP.PROXY?Se(Ar,`RPC '${e}' stream ${s} detected buffering proxy`):_.stat===QP.NOPROXY&&Se(Ar,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}function wN(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(n){return new aJ(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w5{constructor(e,t,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,t-r);s>0&&Se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b5{constructor(e,t,r,s,i,a,o,l){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new w5(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===ne.RESOURCE_EXHAUSTED?(Gl(t.toString()),Gl("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===t&&this.P_(r,s)},r=>{e(()=>{const s=new me(ne.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(Se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class QJ extends b5{constructor(e,t,r,s,i,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=cJ(this.serializer,e),r=function(i){if(!("targetChange"in i))return Me.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Me.min():a.readTime?bo(a.readTime):Me.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=oI(this.serializer),t.addTarget=function(i,a){let o;const l=a.target;if(o=tI(l)?{documents:dJ(i,l)}:{query:fJ(i,l)._t},o.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){o.resumeToken=u5(i,a.resumeToken);const u=sI(i,a.expectedCount);u!==null&&(o.expectedCount=u)}else if(a.snapshotVersion.compareTo(Me.min())>0){o.readTime=C1(i,a.snapshotVersion.toTimestamp());const u=sI(i,a.expectedCount);u!==null&&(o.expectedCount=u)}return o}(this.serializer,e);const r=mJ(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=oI(this.serializer),t.removeTarget=e,this.a_(t)}}class JJ extends b5{constructor(e,t,r,s,i,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,a),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ft(!!e.streamToken),this.lastStreamToken=e.streamToken,ft(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ft(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=hJ(e.writeResults,e.commitTime),r=bo(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=oI(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>uJ(this.serializer,r))};this.a_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZJ extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new me(ne.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.Mo(e,iI(t,r),s,i,a)).catch(i=>{throw i.name==="FirebaseError"?(i.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new me(ne.UNKNOWN,i.toString())})}Lo(e,t,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Lo(e,iI(t,r),s,a,o,i)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new me(ne.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class eZ{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Gl(t),this.D_=!1):Se("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tZ{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(a=>{r.enqueueAndForget(async()=>{Ff(this)&&(Se("RemoteStore","Restarting streams for network reachability change."),await async function(l){const u=Le(l);u.L_.add(4),await Z_(u),u.q_.set("Unknown"),u.L_.delete(4),await CC(u)}(this))})}),this.q_=new eZ(r,s)}}async function CC(n){if(Ff(n))for(const e of n.B_)await e(!0)}async function Z_(n){for(const e of n.B_)await e(!1)}function _5(n,e){const t=Le(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),V2(t)?U2(t):by(t).r_()&&$2(t,e))}function F2(n,e){const t=Le(n),r=by(t);t.N_.delete(e),r.r_()&&x5(t,e),t.N_.size===0&&(r.r_()?r.o_():Ff(t)&&t.q_.set("Unknown"))}function $2(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Me.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}by(n).A_(e)}function x5(n,e){n.Q_.xe(e),by(n).R_(e)}function U2(n){n.Q_=new nJ({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),by(n).start(),n.q_.v_()}function V2(n){return Ff(n)&&!by(n).n_()&&n.N_.size>0}function Ff(n){return Le(n).L_.size===0}function S5(n){n.Q_=void 0}async function nZ(n){n.q_.set("Online")}async function rZ(n){n.N_.forEach((e,t)=>{$2(n,e)})}async function sZ(n,e){S5(n),V2(n)?(n.q_.M_(e),U2(n)):n.q_.set("Unknown")}async function iZ(n,e,t){if(n.q_.set("Online"),e instanceof c5&&e.state===2&&e.cause)try{await async function(s,i){const a=i.cause;for(const o of i.targetIds)s.N_.has(o)&&(await s.remoteSyncer.rejectListen(o,a),s.N_.delete(o),s.Q_.removeTarget(o))}(n,e)}catch(r){Se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await k1(n,r)}else if(e instanceof ZS?n.Q_.Ke(e):e instanceof l5?n.Q_.He(e):n.Q_.We(e),!t.isEqual(Me.min()))try{const r=await v5(n.localStore);t.compareTo(r)>=0&&await function(i,a){const o=i.Q_.rt(a);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.N_.get(u);h&&i.N_.set(u,h.withResumeToken(l.resumeToken,a))}}),o.targetMismatches.forEach((l,u)=>{const h=i.N_.get(l);if(!h)return;i.N_.set(l,h.withResumeToken(yr.EMPTY_BYTE_STRING,h.snapshotVersion)),x5(i,l);const f=new Eu(h.target,l,u,h.sequenceNumber);$2(i,f)}),i.remoteSyncer.applyRemoteEvent(o)}(n,t)}catch(r){Se("RemoteStore","Failed to raise snapshot:",r),await k1(n,r)}}async function k1(n,e,t){if(!X_(e))throw e;n.L_.add(1),await Z_(n),n.q_.set("Offline"),t||(t=()=>v5(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Se("RemoteStore","Retrying IndexedDB access"),await t(),n.L_.delete(1),await CC(n)})}function E5(n,e){return e().catch(t=>k1(n,t,e))}async function kC(n){const e=Le(n),t=Hu(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;aZ(e);)try{const s=await zJ(e.localStore,r);if(s===null){e.O_.length===0&&t.o_();break}r=s.batchId,oZ(e,s)}catch(s){await k1(e,s)}A5(e)&&T5(e)}function aZ(n){return Ff(n)&&n.O_.length<10}function oZ(n,e){n.O_.push(e);const t=Hu(n);t.r_()&&t.V_&&t.m_(e.mutations)}function A5(n){return Ff(n)&&!Hu(n).n_()&&n.O_.length>0}function T5(n){Hu(n).start()}async function lZ(n){Hu(n).p_()}async function cZ(n){const e=Hu(n);for(const t of n.O_)e.m_(t.mutations)}async function uZ(n,e,t){const r=n.O_.shift(),s=D2.from(r,e,t);await E5(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await kC(n)}async function hZ(n,e){e&&Hu(n).V_&&await async function(r,s){if(function(a){return ZQ(a)&&a!==ne.ABORTED}(s.code)){const i=r.O_.shift();Hu(r).s_(),await E5(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await kC(r)}}(n,e),A5(n)&&T5(n)}async function RF(n,e){const t=Le(n);t.asyncQueue.verifyOperationInProgress(),Se("RemoteStore","RemoteStore received new credentials");const r=Ff(t);t.L_.add(3),await Z_(t),r&&t.q_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),await CC(t)}async function dZ(n,e){const t=Le(n);e?(t.L_.delete(2),await CC(t)):e||(t.L_.add(2),await Z_(t),t.q_.set("Unknown"))}function by(n){return n.K_||(n.K_=function(t,r,s){const i=Le(t);return i.w_(),new QJ(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:nZ.bind(null,n),Ro:rZ.bind(null,n),mo:sZ.bind(null,n),d_:iZ.bind(null,n)}),n.B_.push(async e=>{e?(n.K_.s_(),V2(n)?U2(n):n.q_.set("Unknown")):(await n.K_.stop(),S5(n))})),n.K_}function Hu(n){return n.U_||(n.U_=function(t,r,s){const i=Le(t);return i.w_(),new JJ(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:lZ.bind(null,n),mo:hZ.bind(null,n),f_:cZ.bind(null,n),g_:uZ.bind(null,n)}),n.B_.push(async e=>{e?(n.U_.s_(),await kC(n)):(await n.U_.stop(),n.O_.length>0&&(Se("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))})),n.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Ll,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const a=Date.now()+r,o=new B2(e,t,a,s,i);return o.start(r),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new me(ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function z2(n,e){if(Gl("AsyncQueue",`${e}: ${n}`),X_(n))return new me(ne.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bp{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ce.comparator(t.key,r.key):(t,r)=>Ce.comparator(t.key,r.key),this.keyedMap=xv(),this.sortedSet=new en(this.comparator)}static emptySet(e){return new Bp(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bp)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Bp;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(){this.W_=new en(Ce.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Ie():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class ay{constructor(e,t,r,s,i,a,o,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=a,this.syncStateChanged=o,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,s,i){const a=[];return t.forEach(o=>{a.push({type:0,doc:o})}),new ay(e,t,Bp.emptySet(t),a,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&_C(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fZ{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class pZ{constructor(){this.queries=OF(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){const s=Le(t),i=s.queries;s.queries=OF(),i.forEach((a,o)=>{for(const l of o.j_)l.onError(r)})})(this,new me(ne.ABORTED,"Firestore shutting down"))}}function OF(){return new wy(n=>KB(n),_C)}async function H2(n,e){const t=Le(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new fZ,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await t.onListen(s,!0);break;case 1:i.z_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(a){const o=z2(a,`Initialization of query '${ep(e.query)}' failed`);return void e.onError(o)}t.queries.set(s,i),i.j_.push(e),e.Z_(t.onlineState),i.z_&&e.X_(i.z_)&&G2(t)}async function W2(n,e){const t=Le(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const a=i.j_.indexOf(e);a>=0&&(i.j_.splice(a,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function mZ(n,e){const t=Le(n);let r=!1;for(const s of e){const i=s.query,a=t.queries.get(i);if(a){for(const o of a.j_)o.X_(s)&&(r=!0);a.z_=s}}r&&G2(t)}function gZ(n,e,t){const r=Le(n),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(t);r.queries.delete(e)}function G2(n){n.Y_.forEach(e=>{e.next()})}var cI,LF;(LF=cI||(cI={})).ea="default",LF.Cache="cache";class q2{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ay(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;const r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=ay.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==cI.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C5{constructor(e){this.key=e}}class k5{constructor(e){this.key=e}}class yZ{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ge(),this.mutatedKeys=Ge(),this.Aa=XB(e),this.Ra=new Bp(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new MF,s=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,a=s,o=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,f)=>{const p=s.get(h),g=xC(this.query,f)?f:null,v=!!p&&this.mutatedKeys.has(p.key),y=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations);let _=!1;p&&g?p.data.isEqual(g.data)?v!==y&&(r.track({type:3,doc:g}),_=!0):this.ga(p,g)||(r.track({type:2,doc:g}),_=!0,(l&&this.Aa(g,l)>0||u&&this.Aa(g,u)<0)&&(o=!0)):!p&&g?(r.track({type:0,doc:g}),_=!0):p&&!g&&(r.track({type:1,doc:p}),_=!0,(l||u)&&(o=!0)),_&&(g?(a=a.add(g),i=y?i.add(h):i.delete(h)):(a=a.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;a.size>this.query.limit;){const h=this.query.limitType==="F"?a.last():a.first();a=a.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:a,fa:r,ns:o,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const a=e.fa.G_();a.sort((h,f)=>function(g,v){const y=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ie()}};return y(g)-y(v)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(r),s=s!=null&&s;const o=t&&!s?this.ya():[],l=this.da.size===0&&this.current&&!s?1:0,u=l!==this.Ea;return this.Ea=l,a.length!==0||u?{snapshot:new ay(this.query,e.Ra,i,a,e.mutatedKeys,l===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new MF,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ge(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new k5(r))}),this.da.forEach(r=>{e.has(r)||t.push(new C5(r))}),t}ba(e){this.Ta=e.Ts,this.da=Ge();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return ay.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class vZ{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class wZ{constructor(e){this.key=e,this.va=!1}}class bZ{constructor(e,t,r,s,i,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new wy(o=>KB(o),_C),this.Ma=new Map,this.xa=new Set,this.Oa=new en(Ce.comparator),this.Na=new Map,this.La=new O2,this.Ba={},this.ka=new Map,this.qa=iy.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function _Z(n,e,t=!0){const r=M5(n);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await N5(r,e,t,!0),s}async function xZ(n,e){const t=M5(n);await N5(t,e,!0,!1)}async function N5(n,e,t,r){const s=await HJ(n.localStore,wo(e)),i=s.targetId,a=n.sharedClientState.addLocalQueryTarget(i,t);let o;return r&&(o=await SZ(n,e,i,a==="current",s.resumeToken)),n.isPrimaryClient&&t&&_5(n.remoteStore,s),o}async function SZ(n,e,t,r,s){n.Ka=(f,p,g)=>async function(y,_,w,b){let S=_.view.ma(w);S.ns&&(S=await PF(y.localStore,_.query,!1).then(({documents:k})=>_.view.ma(k,S)));const T=b&&b.targetChanges.get(_.targetId),P=b&&b.targetMismatches.get(_.targetId)!=null,R=_.view.applyChanges(S,y.isPrimaryClient,T,P);return FF(y,_.targetId,R.wa),R.snapshot}(n,f,p,g);const i=await PF(n.localStore,e,!0),a=new yZ(e,i.Ts),o=a.ma(i.documents),l=J_.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),u=a.applyChanges(o,n.isPrimaryClient,l);FF(n,t,u.wa);const h=new vZ(e,t,a);return n.Fa.set(e,h),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}async function EZ(n,e,t){const r=Le(n),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(a=>!_C(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await lI(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&F2(r.remoteStore,s.targetId),uI(r,s.targetId)}).catch(K_)):(uI(r,s.targetId),await lI(r.localStore,s.targetId,!0))}async function AZ(n,e){const t=Le(n),r=t.Fa.get(e),s=t.Ma.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),F2(t.remoteStore,r.targetId))}async function TZ(n,e,t){const r=RZ(n);try{const s=await function(a,o){const l=Le(a),u=Fn.now(),h=o.reduce((g,v)=>g.add(v.key),Ge());let f,p;return l.persistence.runTransaction("Locally write mutations","readwrite",g=>{let v=ql(),y=Ge();return l.cs.getEntries(g,h).next(_=>{v=_,v.forEach((w,b)=>{b.isValidDocument()||(y=y.add(w))})}).next(()=>l.localDocuments.getOverlayedDocuments(g,v)).next(_=>{f=_;const w=[];for(const b of o){const S=YQ(b,f.get(b.key).overlayedDocument);S!=null&&w.push(new Zu(b.key,S,VB(S.value.mapValue),$i.exists(!0)))}return l.mutationQueue.addMutationBatch(g,u,w,o)}).next(_=>{p=_;const w=_.applyToLocalDocumentSet(f,y);return l.documentOverlayCache.saveOverlays(g,_.batchId,w)})}).then(()=>({batchId:p.batchId,changes:JB(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(a,o,l){let u=a.Ba[a.currentUser.toKey()];u||(u=new en(st)),u=u.insert(o,l),a.Ba[a.currentUser.toKey()]=u}(r,s.batchId,t),await ex(r,s.changes),await kC(r.remoteStore)}catch(s){const i=z2(s,"Failed to persist write");t.reject(i)}}async function P5(n,e){const t=Le(n);try{const r=await VJ(t.localStore,e);e.targetChanges.forEach((s,i)=>{const a=t.Na.get(i);a&&(ft(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?a.va=!0:s.modifiedDocuments.size>0?ft(a.va):s.removedDocuments.size>0&&(ft(a.va),a.va=!1))}),await ex(t,r,e)}catch(r){await K_(r)}}function jF(n,e,t){const r=Le(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Fa.forEach((i,a)=>{const o=a.view.Z_(e);o.snapshot&&s.push(o.snapshot)}),function(a,o){const l=Le(a);l.onlineState=o;let u=!1;l.queries.forEach((h,f)=>{for(const p of f.j_)p.Z_(o)&&(u=!0)}),u&&G2(l)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function CZ(n,e,t){const r=Le(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Na.get(e),i=s&&s.key;if(i){let a=new en(Ce.comparator);a=a.insert(i,Lr.newNoDocument(i,Me.min()));const o=Ge().add(i),l=new AC(Me.min(),new Map,new en(st),a,o);await P5(r,l),r.Oa=r.Oa.remove(i),r.Na.delete(e),Y2(r)}else await lI(r.localStore,e,!1).then(()=>uI(r,e,t)).catch(K_)}async function kZ(n,e){const t=Le(n),r=e.batch.batchId;try{const s=await UJ(t.localStore,e);D5(t,r,null),I5(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await ex(t,s)}catch(s){await K_(s)}}async function NZ(n,e,t){const r=Le(n);try{const s=await function(a,o){const l=Le(a);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return l.mutationQueue.lookupMutationBatch(u,o).next(f=>(ft(f!==null),h=f.keys(),l.mutationQueue.removeMutationBatch(u,f))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,h,o)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>l.localDocuments.getDocuments(u,h))})}(r.localStore,e);D5(r,e,t),I5(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await ex(r,s)}catch(s){await K_(s)}}function I5(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function D5(n,e,t){const r=Le(n);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function uI(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||R5(n,r)})}function R5(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);t!==null&&(F2(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Y2(n))}function FF(n,e,t){for(const r of t)r instanceof C5?(n.La.addReference(r.key,e),PZ(n,r)):r instanceof k5?(Se("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||R5(n,r.key)):Ie()}function PZ(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(Se("SyncEngine","New document in limbo: "+t),n.xa.add(r),Y2(n))}function Y2(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Ce(Ft.fromString(e)),r=n.qa.next();n.Na.set(r,new wZ(t)),n.Oa=n.Oa.insert(t,r),_5(n.remoteStore,new Eu(wo(bC(t.path)),r,"TargetPurposeLimboResolution",E2.oe))}}async function ex(n,e,t){const r=Le(n),s=[],i=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((o,l)=>{a.push(r.Ka(l,e,t).then(u=>{var h;if((u||t)&&r.isPrimaryClient){const f=u?!u.fromCache:(h=t==null?void 0:t.targetChanges.get(l.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(l.targetId,f?"current":"not-current")}if(u){s.push(u);const f=j2.Wi(l.targetId,u);i.push(f)}}))}),await Promise.all(a),r.Ca.d_(s),await async function(l,u){const h=Le(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>se.forEach(u,p=>se.forEach(p.$i,g=>h.persistence.referenceDelegate.addReference(f,p.targetId,g)).next(()=>se.forEach(p.Ui,g=>h.persistence.referenceDelegate.removeReference(f,p.targetId,g)))))}catch(f){if(!X_(f))throw f;Se("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const p=f.targetId;if(!f.fromCache){const g=h.os.get(p),v=g.snapshotVersion,y=g.withLastLimboFreeSnapshotVersion(v);h.os=h.os.insert(p,y)}}}(r.localStore,i))}async function IZ(n,e){const t=Le(n);if(!t.currentUser.isEqual(e)){Se("SyncEngine","User change. New user:",e.toKey());const r=await y5(t.localStore,e);t.currentUser=e,function(i,a){i.ka.forEach(o=>{o.forEach(l=>{l.reject(new me(ne.CANCELLED,a))})}),i.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ex(t,r.hs)}}function DZ(n,e){const t=Le(n),r=t.Na.get(e);if(r&&r.va)return Ge().add(r.key);{let s=Ge();const i=t.Ma.get(e);if(!i)return s;for(const a of i){const o=t.Fa.get(a);s=s.unionWith(o.view.Va)}return s}}function M5(n){const e=Le(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=P5.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=DZ.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=CZ.bind(null,e),e.Ca.d_=mZ.bind(null,e.eventManager),e.Ca.$a=gZ.bind(null,e.eventManager),e}function RZ(n){const e=Le(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kZ.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=NZ.bind(null,e),e}class N1{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=TC(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return $J(this.persistence,new jJ,e.initialUser,this.serializer)}Ga(e){return new MJ(L2.Zr,this.serializer)}Wa(e){return new GJ}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}N1.provider={build:()=>new N1};class hI{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>jF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=IZ.bind(null,this.syncEngine),await dZ(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new pZ}()}createDatastore(e){const t=TC(e.databaseInfo.databaseId),r=function(i){return new XJ(i)}(e.databaseInfo);return function(i,a,o,l){return new ZJ(i,a,o,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,a,o){return new tZ(r,s,i,a,o)}(this.localStore,this.datastore,e.asyncQueue,t=>jF(this.syncEngine,t,0),function(){return DF.D()?new DF:new qJ}())}createSyncEngine(e,t){return function(s,i,a,o,l,u,h){const f=new bZ(s,i,a,o,l,u);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(s){const i=Le(s);Se("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Z_(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}hI.provider={build:()=>new hI};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Gl("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MZ{constructor(e,t,r,s,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Mr.UNAUTHENTICATED,this.clientId=FB.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async a=>{Se("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(r,a=>(Se("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ll;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=z2(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function bN(n,e){n.asyncQueue.verifyOperationInProgress(),Se("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await y5(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function $F(n,e){n.asyncQueue.verifyOperationInProgress();const t=await OZ(n);Se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>RF(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>RF(e.remoteStore,s)),n._onlineComponents=e}async function OZ(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Se("FirestoreClient","Using user provided OfflineComponentProvider");try{await bN(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(s){return s.name==="FirebaseError"?s.code===ne.FAILED_PRECONDITION||s.code===ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(t))throw t;ty("Error using user provided cache. Falling back to memory cache: "+t),await bN(n,new N1)}}else Se("FirestoreClient","Using default OfflineComponentProvider"),await bN(n,new N1);return n._offlineComponents}async function O5(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Se("FirestoreClient","Using user provided OnlineComponentProvider"),await $F(n,n._uninitializedComponentsProvider._online)):(Se("FirestoreClient","Using default OnlineComponentProvider"),await $F(n,new hI))),n._onlineComponents}function LZ(n){return O5(n).then(e=>e.syncEngine)}async function P1(n){const e=await O5(n),t=e.eventManager;return t.onListen=_Z.bind(null,e.syncEngine),t.onUnlisten=EZ.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xZ.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=AZ.bind(null,e.syncEngine),t}function jZ(n,e,t={}){const r=new Ll;return n.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,u){const h=new K2({next:p=>{h.Za(),a.enqueueAndForget(()=>W2(i,f));const g=p.docs.has(o);!g&&p.fromCache?u.reject(new me(ne.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&l&&l.source==="server"?u.reject(new me(ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new q2(bC(o.path),h,{includeMetadataChanges:!0,_a:!0});return H2(i,f)}(await P1(n),n.asyncQueue,e,t,r)),r.promise}function FZ(n,e,t={}){const r=new Ll;return n.asyncQueue.enqueueAndForget(async()=>function(i,a,o,l,u){const h=new K2({next:p=>{h.Za(),a.enqueueAndForget(()=>W2(i,f)),p.fromCache&&l.source==="server"?u.reject(new me(ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(p)},error:p=>u.reject(p)}),f=new q2(o,h,{includeMetadataChanges:!0,_a:!0});return H2(i,f)}(await P1(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L5(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UF=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j5(n,e,t){if(!t)throw new me(ne.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function $Z(n,e,t,r){if(e===!0&&r===!0)throw new me(ne.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function VF(n){if(!Ce.isDocumentKey(n))throw new me(ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function BF(n){if(Ce.isDocumentKey(n))throw new me(ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function NC(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":Ie()}function Ts(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new me(ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=NC(n);throw new me(ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new me(ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new me(ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}$Z("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=L5((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new me(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new me(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new me(ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class PC{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zF({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new me(ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new me(ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zF(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new nQ;switch(r.type){case"firstParty":return new aQ(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new me(ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=UF.get(t);r&&(Se("ComponentProvider","Removing Datastore"),UF.delete(t),r.terminate())}(this),Promise.resolve()}}function UZ(n,e,t,r={}){var s;const i=(n=Ts(n,PC))._getSettings(),a=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==a&&ty("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:a,ssl:!1})),r.mockUserToken){let o,l;if(typeof r.mockUserToken=="string")o=r.mockUserToken,l=Mr.MOCK_USER;else{o=B3(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new me(ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mr(u)}n._authCredentials=new rQ(new jB(o,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new eh(this.firestore,e,this._query)}}class jr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ju(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new jr(this.firestore,e,this._key)}}class ju extends eh{constructor(e,t,r){super(e,t,bC(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new jr(this.firestore,null,new Ce(e))}withConverter(e){return new ju(this.firestore,e,this._path)}}function ot(n,e,...t){if(n=pt(n),j5("collection","path",e),n instanceof PC){const r=Ft.fromString(e,...t);return BF(r),new ju(n,null,r)}{if(!(n instanceof jr||n instanceof ju))throw new me(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ft.fromString(e,...t));return BF(r),new ju(n.firestore,null,r)}}function si(n,e,...t){if(n=pt(n),arguments.length===1&&(e=FB.newId()),j5("doc","path",e),n instanceof PC){const r=Ft.fromString(e,...t);return VF(r),new jr(n,null,new Ce(r))}{if(!(n instanceof jr||n instanceof ju))throw new me(ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Ft.fromString(e,...t));return VF(r),new jr(n.firestore,n instanceof ju?n.converter:null,new Ce(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new w5(this,"async_queue_retry"),this.Vu=()=>{const r=wN();r&&Se("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=wN();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=wN();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Ll;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!X_(e))throw e;Se("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(r);throw Gl("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const s=B2.createAndSchedule(this,e,t,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&Ie()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function WF(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(n,["next","error","complete"])}class Yl extends PC{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new HF,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new HF(e),this._firestoreClient=void 0,await e}}}function VZ(n,e){const t=typeof n=="object"?n:mC(),r=typeof n=="string"?n:e||"(default)",s=H_(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=h2("firestore");i&&UZ(s,...i)}return s}function IC(n){if(n._terminated)throw new me(ne.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||BZ(n),n._firestoreClient}function BZ(n){var e,t,r;const s=n._freezeSettings(),i=function(o,l,u,h){return new wQ(o,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,L5(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new MZ(n._authCredentials,n._appCheckCredentials,n._queue,i,n._componentsProvider&&function(o){const l=o==null?void 0:o._online.build();return{_offline:o==null?void 0:o._offline.build(l),_online:l}}(n._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e){this._byteString=e}static fromBase64String(e){try{return new oy(yr.fromBase64String(e))}catch(t){throw new me(ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new oy(yr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new me(ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new dr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new me(ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new me(ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zZ=/^__.*__$/;class HZ{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Zu(e,this.data,this.fieldMask,t,this.fieldTransforms):new Q_(e,this.data,t,this.fieldTransforms)}}class F5{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function $5(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ie()}}class J2{constructor(e,t,r,s,i,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new J2(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return I1(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if($5(this.Cu)&&zZ.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class WZ{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||TC(e)}Qu(e,t,r,s=!1){return new J2({Cu:e,methodName:t,qu:r,path:dr.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function MC(n){const e=n._freezeSettings(),t=TC(n._databaseId);return new WZ(n._databaseId,!!e.ignoreUndefinedProperties,t)}function U5(n,e,t,r,s,i={}){const a=n.Qu(i.merge||i.mergeFields?2:0,e,t,s);eM("Data must be an object, but it was:",a,r);const o=V5(r,a);let l,u;if(i.merge)l=new ai(a.fieldMask),u=a.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const p=dI(e,f,t);if(!a.contains(p))throw new me(ne.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);z5(h,p)||h.push(p)}l=new ai(h),u=a.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,u=a.fieldTransforms;return new HZ(new _s(o),l,u)}class OC extends RC{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof OC}}class Z2 extends RC{_toFieldTransform(e){return new HQ(e.path,new L0)}isEqual(e){return e instanceof Z2}}function GZ(n,e,t,r){const s=n.Qu(1,e,t);eM("Data must be an object, but it was:",s,r);const i=[],a=_s.empty();jf(r,(l,u)=>{const h=tM(e,l,t);u=pt(u);const f=s.Nu(h);if(u instanceof OC)i.push(h);else{const p=tx(u,f);p!=null&&(i.push(h),a.set(h,p))}});const o=new ai(i);return new F5(a,o,s.fieldTransforms)}function qZ(n,e,t,r,s,i){const a=n.Qu(1,e,t),o=[dI(e,r,t)],l=[s];if(i.length%2!=0)throw new me(ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<i.length;p+=2)o.push(dI(e,i[p])),l.push(i[p+1]);const u=[],h=_s.empty();for(let p=o.length-1;p>=0;--p)if(!z5(u,o[p])){const g=o[p];let v=l[p];v=pt(v);const y=a.Nu(g);if(v instanceof OC)u.push(g);else{const _=tx(v,y);_!=null&&(u.push(g),h.set(g,_))}}const f=new ai(u);return new F5(h,f,a.fieldTransforms)}function YZ(n,e,t,r=!1){return tx(t,n.Qu(r?4:3,e))}function tx(n,e){if(B5(n=pt(n)))return eM("Unsupported field value:",e,n),V5(n,e);if(n instanceof RC)return function(r,s){if(!$5(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let a=0;for(const o of r){let l=tx(o,s.Lu(a));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),a++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=pt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VQ(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Fn.fromDate(r);return{timestampValue:C1(s.serializer,i)}}if(r instanceof Fn){const i=new Fn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:C1(s.serializer,i)}}if(r instanceof X2)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof oy)return{bytesValue:u5(s.serializer,r._byteString)};if(r instanceof jr){const i=s.databaseId,a=r.firestore._databaseId;if(!a.isEqual(i))throw s.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:M2(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Q2)return function(a,o){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(l=>{if(typeof l!="number")throw o.Bu("VectorValues must only contain numeric values.");return P2(o.serializer,l)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${NC(r)}`)}(n,e)}function V5(n,e){const t={};return $B(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):jf(n,(r,s)=>{const i=tx(s,e.Mu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function B5(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Fn||n instanceof X2||n instanceof oy||n instanceof jr||n instanceof RC||n instanceof Q2)}function eM(n,e,t){if(!B5(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=NC(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function dI(n,e,t){if((e=pt(e))instanceof DC)return e._internalPath;if(typeof e=="string")return tM(n,e);throw I1("Field path arguments must be of type string or ",n,!1,void 0,t)}const KZ=new RegExp("[~\\*/\\[\\]]");function tM(n,e,t){if(e.search(KZ)>=0)throw I1(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new DC(...e.split("."))._internalPath}catch{throw I1(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function I1(n,e,t,r,s){const i=r&&!r.isEmpty(),a=s!==void 0;let o=`Function ${e}() called with invalid data`;t&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(i||a)&&(l+=" (found",i&&(l+=` in field ${r}`),a&&(l+=` in document ${s}`),l+=")"),new me(ne.INVALID_ARGUMENT,o+n+l)}function z5(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XZ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(LC("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class XZ extends H5{data(){return super.data()}}function LC(n,e){return typeof e=="string"?tM(n,e):e instanceof DC?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W5(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new me(ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class nM{}class G5 extends nM{}function Mn(n,e,...t){let r=[];e instanceof nM&&r.push(e),r=r.concat(t),function(i){const a=i.filter(l=>l instanceof rM).length,o=i.filter(l=>l instanceof jC).length;if(a>1||a>0&&o>0)throw new me(ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class jC extends G5{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new jC(e,t,r)}_apply(e){const t=this._parse(e);return q5(e._query,t),new eh(e.firestore,e.converter,nI(e._query,t))}_parse(e){const t=MC(e.firestore);return function(i,a,o,l,u,h,f){let p;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new me(ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){qF(f,h);const g=[];for(const v of f)g.push(GF(l,i,v));p={arrayValue:{values:g}}}else p=GF(l,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||qF(f,h),p=YZ(o,a,f,h==="in"||h==="not-in");return Tn.create(u,h,p)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function vn(n,e,t){const r=e,s=LC("where",n);return jC._create(s,r,t)}class rM extends nM{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new rM(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Ea.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let a=s;const o=i.getFlattenedFilters();for(const l of o)q5(a,l),a=nI(a,l)}(e._query,t),new eh(e.firestore,e.converter,nI(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class sM extends G5{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new sM(e,t)}_apply(e){const t=function(s,i,a){if(s.startAt!==null)throw new me(ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new me(ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new O0(i,a)}(e._query,this._field,this._direction);return new eh(e.firestore,e.converter,function(s,i){const a=s.explicitOrderBy.concat([i]);return new vy(s.path,s.collectionGroup,a,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,t))}}function yh(n,e="asc"){const t=e,r=LC("orderBy",n);return sM._create(r,t)}function GF(n,e,t){if(typeof(t=pt(t))=="string"){if(t==="")throw new me(ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!YB(e)&&t.indexOf("/")!==-1)throw new me(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Ft.fromString(t));if(!Ce.isDocumentKey(r))throw new me(ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fF(n,new Ce(r))}if(t instanceof jr)return fF(n,t._key);throw new me(ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${NC(t)}.`)}function qF(n,e){if(!Array.isArray(n)||n.length===0)throw new me(ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function q5(n,e){const t=function(s,i){for(const a of s)for(const o of a.getFlattenedFilters())if(i.indexOf(o.op)>=0)return o.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new me(ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new me(ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class QZ{convertValue(e,t="none"){switch(wf(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ie()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return jf(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertVectorValue(e){var t,r,s;const i=(s=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(a=>yn(a.doubleValue));return new Q2(i)}convertGeoPoint(e){return new X2(yn(e.latitude),yn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=T2(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(D0(e));default:return null}}convertTimestamp(e){const t=zu(e);return new Fn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Ft.fromString(e);ft(g5(r));const s=new R0(r.get(1),r.get(3)),i=new Ce(r.popFirst(5));return s.isEqual(t)||Gl(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y5(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ev{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class K5 extends H5{constructor(e,t,r,s,i,a){super(e,t,r,s,a),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new eE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(LC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class eE extends K5{data(e={}){return super.data(e)}}class X5{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Ev(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new eE(this._firestore,this._userDataWriter,r.key,r,new Ev(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new me(ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let a=0;return s._snapshot.docChanges.map(o=>{const l=new eE(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ev(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);return o.doc,{type:"added",doc:l,oldIndex:-1,newIndex:a++}})}{let a=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(o=>i||o.type!==3).map(o=>{const l=new eE(s._firestore,s._userDataWriter,o.doc.key,o.doc,new Ev(s._snapshot.mutatedKeys.has(o.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,h=-1;return o.type!==0&&(u=a.indexOf(o.doc.key),a=a.delete(o.doc.key)),o.type!==1&&(a=a.add(o.doc),h=a.indexOf(o.doc.key)),{type:JZ(o.type),doc:l,oldIndex:u,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function JZ(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ie()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q5(n){n=Ts(n,jr);const e=Ts(n.firestore,Yl);return jZ(IC(e),n._key).then(t=>Z5(e,n,t))}class iM extends QZ{constructor(e){super(),this.firestore=e}convertBytes(e){return new oy(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new jr(this.firestore,null,t)}}function Rn(n){n=Ts(n,eh);const e=Ts(n.firestore,Yl),t=IC(e),r=new iM(e);return W5(n._query),FZ(t,n._query).then(s=>new X5(e,r,n,s))}function J5(n,e,t){n=Ts(n,jr);const r=Ts(n.firestore,Yl),s=Y5(n.converter,e,t);return FC(r,[U5(MC(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,$i.none())])}function bf(n,e,t,...r){n=Ts(n,jr);const s=Ts(n.firestore,Yl),i=MC(s);let a;return a=typeof(e=pt(e))=="string"||e instanceof DC?qZ(i,"updateDoc",n._key,e,t,r):GZ(i,"updateDoc",n._key,e),FC(s,[a.toMutation(n._key,$i.exists(!0))])}function ZZ(n){return FC(Ts(n.firestore,Yl),[new I2(n._key,$i.none())])}function _a(n,e){const t=Ts(n.firestore,Yl),r=si(n),s=Y5(n.converter,e);return FC(t,[U5(MC(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,$i.exists(!1))]).then(()=>r)}function eee(n,...e){var t,r,s;n=pt(n);let i={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||WF(e[a])||(i=e[a],a++);const o={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(WF(e[a])){const f=e[a];e[a]=(t=f.next)===null||t===void 0?void 0:t.bind(f),e[a+1]=(r=f.error)===null||r===void 0?void 0:r.bind(f),e[a+2]=(s=f.complete)===null||s===void 0?void 0:s.bind(f)}let l,u,h;if(n instanceof jr)u=Ts(n.firestore,Yl),h=bC(n._key.path),l={next:f=>{e[a]&&e[a](Z5(u,n,f))},error:e[a+1],complete:e[a+2]};else{const f=Ts(n,eh);u=Ts(f.firestore,Yl),h=f._query;const p=new iM(u);l={next:g=>{e[a]&&e[a](new X5(u,p,f,g))},error:e[a+1],complete:e[a+2]},W5(n._query)}return function(p,g,v,y){const _=new K2(y),w=new q2(g,_,v);return p.asyncQueue.enqueueAndForget(async()=>H2(await P1(p),w)),()=>{_.Za(),p.asyncQueue.enqueueAndForget(async()=>W2(await P1(p),w))}}(IC(u),h,o,l)}function FC(n,e){return function(r,s){const i=new Ll;return r.asyncQueue.enqueueAndForget(async()=>TZ(await LZ(r),s,i)),i.promise}(IC(n),e)}function Z5(n,e,t){const r=t.docs.get(e._key),s=new iM(n);return new K5(n,s,e._key,r,new Ev(t.hasPendingWrites,t.fromCache),e.converter)}function En(){return new Z2("serverTimestamp")}(function(e,t=!0){(function(s){yy=s})(Mf),Vu(new zl("firestore",(r,{instanceIdentifier:s,options:i})=>{const a=r.getProvider("app").getImmediate(),o=new Yl(new sQ(r.getProvider("auth-internal")),new lQ(r.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new me(ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new R0(u.options.projectId,h)}(a,s),a);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),Fi(lF,"4.7.3",e),Fi(lF,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e6="firebasestorage.googleapis.com",t6="storageBucket",tee=2*60*1e3,nee=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn extends ka{constructor(e,t,r=0){super(_N(e),`Firebase Storage: ${t} (${_N(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dn.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return _N(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var hn;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(hn||(hn={}));function _N(n){return"storage/"+n}function aM(){const n="An unknown error occurred, please check the error payload for server response.";return new dn(hn.UNKNOWN,n)}function ree(n){return new dn(hn.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function see(n){return new dn(hn.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function iee(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new dn(hn.UNAUTHENTICATED,n)}function aee(){return new dn(hn.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function oee(n){return new dn(hn.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function lee(){return new dn(hn.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function cee(){return new dn(hn.CANCELED,"User canceled the upload/download.")}function uee(n){return new dn(hn.INVALID_URL,"Invalid URL '"+n+"'.")}function hee(n){return new dn(hn.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function dee(){return new dn(hn.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+t6+"' property when initializing the app?")}function fee(){return new dn(hn.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function pee(){return new dn(hn.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function mee(n){return new dn(hn.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function fI(n){return new dn(hn.INVALID_ARGUMENT,n)}function n6(){return new dn(hn.APP_DELETED,"The Firebase app was deleted.")}function gee(n){return new dn(hn.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function o0(n,e){return new dn(hn.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function rv(n){throw new dn(hn.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=oi.makeFromUrl(e,t)}catch{return new oi(e,"")}if(r.path==="")return r;throw hee(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const a="(/(.*))?$",o=new RegExp("^gs://"+s+a,"i"),l={bucket:1,path:3};function u(T){T.path_=decodeURIComponent(T.path)}const h="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),p="(/([^?#]*).*)?$",g=new RegExp(`^https?://${f}/${h}/b/${s}/o${p}`,"i"),v={bucket:1,path:3},y=t===e6?"(?:storage.googleapis.com|storage.cloud.google.com)":t,_="([^?#]*)",w=new RegExp(`^https?://${y}/${s}/${_}`,"i"),S=[{regex:o,indices:l,postModify:i},{regex:g,indices:v,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let T=0;T<S.length;T++){const P=S[T],R=P.regex.exec(e);if(R){const k=R[P.indices.bucket];let C=R[P.indices.path];C||(C=""),r=new oi(k,C),P.postModify(r);break}}if(r==null)throw uee(e);return r}}class yee{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vee(n,e,t){let r=1,s=null,i=null,a=!1,o=0;function l(){return o===2}let u=!1;function h(..._){u||(u=!0,e.apply(null,_))}function f(_){s=setTimeout(()=>{s=null,n(g,l())},_)}function p(){i&&clearTimeout(i)}function g(_,...w){if(u){p();return}if(_){p(),h.call(null,_,...w);return}if(l()||a){p(),h.call(null,_,...w);return}r<64&&(r*=2);let S;o===1?(o=2,S=0):S=(r+Math.random())*1e3,f(S)}let v=!1;function y(_){v||(v=!0,p(),!u&&(s!==null?(_||(o=2),clearTimeout(s),f(0)):_||(o=1)))}return f(0),i=setTimeout(()=>{a=!0,y(!0)},t),y}function wee(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bee(n){return n!==void 0}function _ee(n){return typeof n=="object"&&!Array.isArray(n)}function oM(n){return typeof n=="string"||n instanceof String}function YF(n){return lM()&&n instanceof Blob}function lM(){return typeof Blob<"u"}function KF(n,e,t,r){if(r<e)throw fI(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw fI(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function r6(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}var sf;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(sf||(sf={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xee(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class See{constructor(e,t,r,s,i,a,o,l,u,h,f,p=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=a,this.callback_=o,this.errorCallback_=l,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=p,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,v)=>{this.resolve_=g,this.reject_=v,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new hS(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const a=o=>{const l=o.loaded,u=o.lengthComputable?o.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,u)};this.progressCallback_!==null&&i.addUploadProgressListener(a),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(a),this.pendingConnection_=null;const o=i.getErrorCode()===sf.NO_ERROR,l=i.getStatus();if(!o||xee(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===sf.ABORT;r(!1,new hS(!1,null,h));return}const u=this.successCodes_.indexOf(l)!==-1;r(!0,new hS(u,i))})},t=(r,s)=>{const i=this.resolve_,a=this.reject_,o=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(o,o.getResponse());bee(l)?i(l):i()}catch(l){a(l)}else if(o!==null){const l=aM();l.serverResponse=o.getErrorText(),this.errorCallback_?a(this.errorCallback_(o,l)):a(l)}else if(s.canceled){const l=this.appDelete_?n6():cee();a(l)}else{const l=lee();a(l)}};this.canceled_?t(!1,new hS(!1,null,!0)):this.backoffId_=vee(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&wee(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class hS{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Eee(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function Aee(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Tee(n,e){e&&(n["X-Firebase-GMPID"]=e)}function Cee(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function kee(n,e,t,r,s,i,a=!0){const o=r6(n.urlParams),l=n.url+o,u=Object.assign({},n.headers);return Tee(u,e),Eee(u,t),Aee(u,i),Cee(u,r),new See(l,n.method,u,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,a)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nee(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Pee(...n){const e=Nee();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(lM())return new Blob(n);throw new dn(hn.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Iee(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dee(n){if(typeof atob>"u")throw mee("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const po={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class xN{constructor(e,t){this.data=e,this.contentType=t||null}}function Ree(n,e){switch(n){case po.RAW:return new xN(s6(e));case po.BASE64:case po.BASE64URL:return new xN(i6(n,e));case po.DATA_URL:return new xN(Oee(e),Lee(e))}throw aM()}function s6(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=r,a=n.charCodeAt(++t);r=65536|(i&1023)<<10|a&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function Mee(n){let e;try{e=decodeURIComponent(n)}catch{throw o0(po.DATA_URL,"Malformed data URL.")}return s6(e)}function i6(n,e){switch(n){case po.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw o0(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case po.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw o0(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=Dee(e)}catch(s){throw s.message.includes("polyfill")?s:o0(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}class a6{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw o0(po.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=jee(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Oee(n){const e=new a6(n);return e.base64?i6(po.BASE64,e.rest):Mee(e.rest)}function Lee(n){return new a6(n).contentType}function jee(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bc{constructor(e,t){let r=0,s="";YF(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(YF(this.data_)){const r=this.data_,s=Iee(r,e,t);return s===null?null:new bc(s)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new bc(r,!0)}}static getBlob(...e){if(lM()){const t=e.map(r=>r instanceof bc?r.data_:r);return new bc(Pee.apply(null,t))}else{const t=e.map(a=>oM(a)?Ree(po.RAW,a).data:a.data_);let r=0;t.forEach(a=>{r+=a.byteLength});const s=new Uint8Array(r);let i=0;return t.forEach(a=>{for(let o=0;o<a.length;o++)s[i++]=a[o]}),new bc(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(n){let e;try{e=JSON.parse(n)}catch{return null}return _ee(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fee(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function $ee(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function l6(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uee(n,e){return e}class Wr{constructor(e,t,r,s){this.server=e,this.local=t||e,this.writable=!!r,this.xform=s||Uee}}let dS=null;function Vee(n){return!oM(n)||n.length<2?n:l6(n)}function c6(){if(dS)return dS;const n=[];n.push(new Wr("bucket")),n.push(new Wr("generation")),n.push(new Wr("metageneration")),n.push(new Wr("name","fullPath",!0));function e(i,a){return Vee(a)}const t=new Wr("name");t.xform=e,n.push(t);function r(i,a){return a!==void 0?Number(a):a}const s=new Wr("size");return s.xform=r,n.push(s),n.push(new Wr("timeCreated")),n.push(new Wr("updated")),n.push(new Wr("md5Hash",null,!0)),n.push(new Wr("cacheControl",null,!0)),n.push(new Wr("contentDisposition",null,!0)),n.push(new Wr("contentEncoding",null,!0)),n.push(new Wr("contentLanguage",null,!0)),n.push(new Wr("contentType",null,!0)),n.push(new Wr("metadata","customMetadata",!0)),dS=n,dS}function Bee(n,e){function t(){const r=n.bucket,s=n.fullPath,i=new oi(r,s);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function zee(n,e,t){const r={};r.type="file";const s=t.length;for(let i=0;i<s;i++){const a=t[i];r[a.local]=a.xform(r,e[a.server])}return Bee(r,n),r}function u6(n,e,t){const r=o6(e);return r===null?null:zee(n,r,t)}function Hee(n,e,t,r){const s=o6(e);if(s===null||!oM(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const a=encodeURIComponent;return i.split(",").map(u=>{const h=n.bucket,f=n.fullPath,p="/b/"+a(h)+"/o/"+a(f),g=cM(p,t,r),v=r6({alt:"media",token:u});return g+v})[0]}function Wee(n,e){const t={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class h6{constructor(e,t,r,s){this.url=e,this.method=t,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d6(n){if(!n)throw aM()}function Gee(n,e){function t(r,s){const i=u6(n,s,e);return d6(i!==null),i}return t}function qee(n,e){function t(r,s){const i=u6(n,s,e);return d6(i!==null),Hee(i,s,n.host,n._protocol)}return t}function f6(n){function e(t,r){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=aee():s=iee():t.getStatus()===402?s=see(n.bucket):t.getStatus()===403?s=oee(n.path):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Yee(n){const e=f6(n);function t(r,s){let i=e(r,s);return r.getStatus()===404&&(i=ree(n.path)),i.serverResponse=s.serverResponse,i}return t}function Kee(n,e,t){const r=e.fullServerUrl(),s=cM(r,n.host,n._protocol),i="GET",a=n.maxOperationRetryTime,o=new h6(s,i,qee(n,t),a);return o.errorHandler=Yee(e),o}function Xee(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Qee(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Xee(null,e)),r}function Jee(n,e,t,r,s){const i=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"};function o(){let S="";for(let T=0;T<2;T++)S=S+Math.random().toString().slice(2);return S}const l=o();a["Content-Type"]="multipart/related; boundary="+l;const u=Qee(e,r,s),h=Wee(u,t),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+u.contentType+`\r
\r
`,p=`\r
--`+l+"--",g=bc.getBlob(f,r,p);if(g===null)throw fee();const v={name:u.fullPath},y=cM(i,n.host,n._protocol),_="POST",w=n.maxUploadRetryTime,b=new h6(y,_,Gee(n,t),w);return b.urlParams=v,b.headers=a,b.body=g.uploadData(),b.errorHandler=f6(e),b}class Zee{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=sf.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=sf.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=sf.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,s){if(this.sent_)throw rv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw rv("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw rv("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw rv("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw rv("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class ete extends Zee{initXhr(){this.xhr_.responseType="text"}}function p6(){return new ete}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,t){this._service=e,t instanceof oi?this._location=t:this._location=oi.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new _f(e,t)}get root(){const e=new oi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return l6(this._location.path)}get storage(){return this._service}get parent(){const e=Fee(this._location.path);if(e===null)return null;const t=new oi(this._location.bucket,e);return new _f(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw gee(e)}}function tte(n,e,t){n._throwIfRoot("uploadBytes");const r=Jee(n.storage,n._location,c6(),new bc(e,!0),t);return n.storage.makeRequestWithTokens(r,p6).then(s=>({metadata:s,ref:n}))}function nte(n){n._throwIfRoot("getDownloadURL");const e=Kee(n.storage,n._location,c6());return n.storage.makeRequestWithTokens(e,p6).then(t=>{if(t===null)throw pee();return t})}function rte(n,e){const t=$ee(n._location.path,e),r=new oi(n._location.bucket,t);return new _f(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ste(n){return/^[A-Za-z]+:\/\//.test(n)}function ite(n,e){return new _f(n,e)}function m6(n,e){if(n instanceof uM){const t=n;if(t._bucket==null)throw dee();const r=new _f(t,t._bucket);return e!=null?m6(r,e):r}else return e!==void 0?rte(n,e):n}function ate(n,e){if(e&&ste(e)){if(n instanceof uM)return ite(n,e);throw fI("To use ref(service, url), the first argument must be a Storage instance.")}else return m6(n,e)}function XF(n,e){const t=e==null?void 0:e[t6];return t==null?null:oi.makeFromBucketSpec(t,n)}function ote(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:B3(s,n.app.options.projectId))}class uM{constructor(e,t,r,s,i){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=e6,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=tee,this._maxUploadRetryTime=nee,this._requests=new Set,s!=null?this._bucket=oi.makeFromBucketSpec(s,this._host):this._bucket=XF(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=oi.makeFromBucketSpec(this._url,e):this._bucket=XF(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){KF("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){KF("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new _f(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new yee(n6());{const a=kee(e,this._appId,r,s,t,this._firebaseVersion,i);return this._requests.add(a),a.getPromise().then(()=>this._requests.delete(a),()=>this._requests.delete(a)),a}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const QF="@firebase/storage",JF="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g6="storage";function nx(n,e,t){return n=pt(n),tte(n,e,t)}function rx(n){return n=pt(n),nte(n)}function sx(n,e){return n=pt(n),ate(n,e)}function lte(n=mC(),e){n=pt(n);const r=H_(n,g6).getImmediate({identifier:e}),s=h2("storage");return s&&cte(r,...s),r}function cte(n,e,t,r={}){ote(n,e,t,r)}function ute(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new uM(t,r,s,e,Mf)}function hte(){Vu(new zl(g6,ute,"PUBLIC").setMultipleInstances(!0)),Fi(QF,JF,""),Fi(QF,JF,"esm2017")}hte();var dte="firebase",fte="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fi(dte,fte,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pte="type.googleapis.com/google.protobuf.Int64Value",mte="type.googleapis.com/google.protobuf.UInt64Value";function y6(n,e){const t={};for(const r in n)n.hasOwnProperty(r)&&(t[r]=e(n[r]));return t}function pI(n){if(n==null)return null;if(n instanceof Number&&(n=n.valueOf()),typeof n=="number"&&isFinite(n)||n===!0||n===!1||Object.prototype.toString.call(n)==="[object String]")return n;if(n instanceof Date)return n.toISOString();if(Array.isArray(n))return n.map(e=>pI(e));if(typeof n=="function"||typeof n=="object")return y6(n,e=>pI(e));throw new Error("Data cannot be encoded in JSON: "+n)}function D1(n){if(n==null)return n;if(n["@type"])switch(n["@type"]){case pte:case mte:{const e=Number(n.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+n);return e}default:throw new Error("Data cannot be decoded from JSON: "+n)}return Array.isArray(n)?n.map(e=>D1(e)):typeof n=="function"||typeof n=="object"?y6(n,e=>D1(e)):n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hM="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class zp extends ka{constructor(e,t,r){super(`${hM}/${e}`,t||""),this.details=r}}function gte(n){if(n>=200&&n<300)return"ok";switch(n){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function yte(n,e){let t=gte(n),r=t,s;try{const i=e&&e.error;if(i){const a=i.status;if(typeof a=="string"){if(!ZF[a])return new zp("internal","internal");t=ZF[a],r=a}const o=i.message;typeof o=="string"&&(r=o),s=i.details,s!==void 0&&(s=D1(s))}}catch{}return t==="ok"?null:new zp(t,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vte{constructor(e,t,r){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then(s=>this.auth=s,()=>{}),this.messaging||t.get().then(s=>this.messaging=s,()=>{}),this.appCheck||r.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mI="us-central1";function wte(n){let e=null;return{promise:new Promise((t,r)=>{e=setTimeout(()=>{r(new zp("deadline-exceeded","deadline-exceeded"))},n)}),cancel:()=>{e&&clearTimeout(e)}}}class bte{constructor(e,t,r,s,i=mI,a){this.app=e,this.fetchImpl=a,this.emulatorOrigin=null,this.contextProvider=new vte(t,r,s),this.cancelAllRequests=new Promise(o=>{this.deleteService=()=>Promise.resolve(o())});try{const o=new URL(i);this.customDomain=o.origin+(o.pathname==="/"?"":o.pathname),this.region=mI}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function _te(n,e,t){n.emulatorOrigin=`http://${e}:${t}`}function xte(n,e,t){return r=>Ate(n,e,r,t||{})}function Ste(n,e,t){return r=>v6(n,e,r,t||{})}async function Ete(n,e,t,r){t["Content-Type"]="application/json";let s;try{s=await r(n,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}function Ate(n,e,t,r){const s=n._url(e);return v6(n,s,t,r)}async function v6(n,e,t,r){t=pI(t);const s={data:t},i={},a=await n.contextProvider.getContext(r.limitedUseAppCheckTokens);a.authToken&&(i.Authorization="Bearer "+a.authToken),a.messagingToken&&(i["Firebase-Instance-ID-Token"]=a.messagingToken),a.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=a.appCheckToken);const o=r.timeout||7e4,l=wte(o),u=await Promise.race([Ete(e,s,i,n.fetchImpl),l.promise,n.cancelAllRequests]);if(l.cancel(),!u)throw new zp("cancelled","Firebase Functions instance was deleted.");const h=yte(u.status,u.json);if(h)throw h;if(!u.json)throw new zp("internal","Response is not valid JSON object.");let f=u.json.data;if(typeof f>"u"&&(f=u.json.result),typeof f>"u")throw new zp("internal","Response is missing data field.");return{data:D1(f)}}const e$="@firebase/functions",t$="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tte="auth-internal",Cte="app-check-internal",kte="messaging-internal";function Nte(n,e){const t=(r,{instanceIdentifier:s})=>{const i=r.getProvider("app").getImmediate(),a=r.getProvider(Tte),o=r.getProvider(kte),l=r.getProvider(Cte);return new bte(i,a,o,l,s,n)};Vu(new zl(hM,t,"PUBLIC").setMultipleInstances(!0)),Fi(e$,t$,e),Fi(e$,t$,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w6(n=mC(),e=mI){const r=H_(pt(n),hM).getImmediate({identifier:e}),s=h2("functions");return s&&Pte(r,...s),r}function Pte(n,e,t){_te(pt(n),e,t)}function ns(n,e,t){return xte(pt(n),e,t)}function sAe(n,e,t){return Ste(pt(n),e,t)}Nte(fetch.bind(self));const Ite={apiKey:"AIzaSyDvpy1J7FggY2nA07F5oSX5wIWLj1vLgaQ",authDomain:"law-firm-client-portal.firebaseapp.com",projectId:"law-firm-client-portal",storageBucket:"law-firm-client-portal.firebasestorage.app",messagingSenderId:"1012595229",appId:"1:1012595229:web:2ba56185a9eefba5d0a4f4"},_y=W3(Ite),On=eQ(_y),Re=VZ(_y),xy=lte(_y),rs=w6(_y,"us-central1"),b6="pk_live_51RQxRiLLy2lrya6t1VUp5Zl0kOvs0TprmtQMPO4uxrTimy7RqqX9XFyMzMMelV7jDOSGTrY29Lne4nLKiOINxtRr00Bd3kmxBb",Dte=Object.freeze(Object.defineProperty({__proto__:null,STRIPE_PUBLISHABLE_KEY:b6,auth:On,db:Re,default:_y,functions:rs,storage:xy},Symbol.toStringTag,{value:"Module"}));var _6="https://js.stripe.com/v3",Rte=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,n$="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",Mte=function(){for(var e=document.querySelectorAll('script[src^="'.concat(_6,'"]')),t=0;t<e.length;t++){var r=e[t];if(Rte.test(r.src))return r}return null},r$=function(e){var t=e&&!e.advancedFraudSignals?"?advancedFraudSignals=false":"",r=document.createElement("script");r.src="".concat(_6).concat(t);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},Ote=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:t})},sv=null,fS=null,pS=null,Lte=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},jte=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},Fte=function(e){return sv!==null?sv:(sv=new Promise(function(t,r){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe&&e&&console.warn(n$),window.Stripe){t(window.Stripe);return}try{var s=Mte();if(s&&e)console.warn(n$);else if(!s)s=r$(e);else if(s&&pS!==null&&fS!==null){var i;s.removeEventListener("load",pS),s.removeEventListener("error",fS),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=r$(e)}pS=jte(t,r),fS=Lte(r),s.addEventListener("load",pS),s.addEventListener("error",fS)}catch(a){r(a);return}}),sv.catch(function(t){return sv=null,Promise.reject(t)}))},$te=function(e,t,r){if(e===null)return null;var s=e.apply(void 0,t);return Ote(s,r),s},iv,x6=!1,S6=function(){return iv||(iv=Fte(null).catch(function(e){return iv=null,Promise.reject(e)}),iv)};Promise.resolve().then(function(){return S6()}).catch(function(n){x6||console.warn(n)});var Ute=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];x6=!0;var s=Date.now();return S6().then(function(i){return $te(i,t,s)})};Ute(b6);const Vte=({user:n,amount:e,description:t,onSuccess:r})=>{const[s,i]=B.useState(!1),[a,o]=B.useState(""),[l,u]=B.useState(!1);B.useState("card");const[h,f]=B.useState(e||""),p=[{label:"Initial Consultation",amount:0,paymentLink:null},{label:"Trust Amendment",amount:150,paymentLink:"https://buy.stripe.com/eVqcN6evT5lq4lCai83Nm03"},{label:"Single Will",amount:250,paymentLink:"https://buy.stripe.com/fZu14odrP29ebO4gGw3Nm08"},{label:"Joint Will",amount:350,paymentLink:"https://buy.stripe.com/3cI8wQ2Nb3di19q3TK3Nm09"},{label:"Living Trust (Single)",amount:575,paymentLink:"https://buy.stripe.com/9B65kE9bz6puf0g0Hy3Nm00"},{label:"Living Trust (Joint)",amount:675,paymentLink:"https://buy.stripe.com/bJeeVe0F3eW0g4k61S3Nm02"}],g=async()=>{if(!h||parseFloat(h)<0){o("Please enter a valid amount");return}if(parseFloat(h)===0){window.location.href="https://square.site/book/0W2A8PKKPYC21/law-offices-of-rozsa-gyene-glendale-ca";return}i(!0),o("");try{const v=p.find(y=>y.amount===parseFloat(h));v&&v.paymentLink?window.location.href=v.paymentLink:(alert(`For custom amount payments of $${h}, please contact our office at (818) 291-6217 or email rozsagyenelaw@yahoo.com to arrange payment.`),i(!1))}catch{o("Payment setup failed. Please try again."),i(!1)}};return l?d.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 text-center",children:[d.jsx(C3,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Payment Initiated!"}),d.jsx("p",{className:"text-gray-600",children:"You have been redirected to our secure payment page."})]}):d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Select Service"}),d.jsx("div",{className:"grid grid-cols-2 gap-3",children:p.map(v=>d.jsxs("button",{onClick:()=>{v.amount===0?window.location.href="https://square.site/book/0W2A8PKKPYC21/law-offices-of-rozsa-gyene-glendale-ca":f(v.amount.toString())},className:`p-3 border rounded-lg text-left transition-colors ${h===v.amount.toString()?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:v.label}),d.jsx("p",{className:"text-lg font-semibold text-gray-700",children:v.amount===0?"Free - Schedule Now":`${v.amount}`})]},v.label))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Amount (for Trust Administration or other services)"}),d.jsxs("div",{className:"relative",children:[d.jsx(P3,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{id:"amount",type:"number",min:"0",step:"0.01",value:h,onChange:v=>f(v.target.value),className:"pl-10 w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"0.00"})]})]}),d.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx(Ij,{className:"h-5 w-5 text-gray-600 mr-2"}),d.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Accepted Payment Methods"})]}),d.jsx("p",{className:"text-sm text-gray-600",children:"Credit Card, Debit Card, Apple Pay, Google Pay"})]}),a&&d.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start",children:[d.jsx(So,{className:"h-5 w-5 text-red-600 mt-0.5 mr-2 flex-shrink-0"}),d.jsx("p",{className:"text-sm text-red-800",children:a})]}),d.jsx("button",{onClick:g,disabled:s||!h,className:`w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white ${s||!h?"bg-gray-400 cursor-not-allowed":"bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}`,children:s?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):d.jsxs(d.Fragment,{children:["Pay $",h||"0.00"," with Stripe",d.jsx(r7,{className:"ml-2 h-4 w-4"})]})}),d.jsxs("div",{className:"flex items-center justify-center space-x-4 text-xs text-gray-500",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ho,{className:"h-4 w-4 mr-1"}),d.jsx("span",{children:"Secure Payment"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Ij,{className:"h-4 w-4 mr-1"}),d.jsx("span",{children:"Powered by Stripe"})]})]})]})};function Kl(n){"@babel/helpers - typeof";return Kl=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kl(n)}function Bte(n,e){if(Kl(n)!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e||"default");if(Kl(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function E6(n){var e=Bte(n,"string");return Kl(e)=="symbol"?e:e+""}function vh(n,e,t){return(e=E6(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function s$(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),t.push.apply(t,r)}return t}function At(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?s$(Object(t),!0).forEach(function(r){vh(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):s$(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function $C(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}function Ao(n,e){if(n==null)return{};var t,r,s=$C(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(r=0;r<i.length;r++)t=i[r],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(s[t]=n[t])}return s}function $n(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function i$(n,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,E6(r.key),r)}}function Un(n,e,t){return e&&i$(n.prototype,e),t&&i$(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function R1(n){return R1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},R1(n)}function A6(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A6=function(){return!!n})()}function zte(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Hte(n,e){if(e&&(Kl(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zte(n)}function Vr(n,e,t){return e=R1(e),Hte(n,A6()?Reflect.construct(e,t||[],R1(n).constructor):e.apply(n,t))}function M1(n,e){return M1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},M1(n,e)}function Br(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&M1(n,e)}function T6(n){if(Array.isArray(n))return n}function Wte(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,s,i,a,o=[],l=!0,u=!1;try{if(i=(t=t.call(n)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(r=i.call(t)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(h){u=!0,s=h}finally{try{if(!l&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(u)throw s}}return o}}function gI(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function dM(n,e){if(n){if(typeof n=="string")return gI(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?gI(n,e):void 0}}function C6(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mi(n,e){return T6(n)||Wte(n,e)||dM(n,e)||C6()}function k6(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n))for(e=0;e<n.length;e++)n[e]&&(t=k6(n[e]))&&(r&&(r+=" "),r+=t);else for(e in n)n[e]&&(r&&(r+=" "),r+=e);return r}function un(){for(var n,e,t=0,r="";t<arguments.length;)(n=arguments[t++])&&(e=k6(n))&&(r&&(r+=" "),r+=e);return r}function ln(){return ln=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},ln.apply(null,arguments)}var Gte=function(n,e,t,r,s,i,a,o){if(!n){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[t,r,s,i,a,o],h=0;l=new Error(e.replace(/%s/g,function(){return u[h++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},qte=Gte;const $0=Ps(qte);var Yte=function(){};function Kte(n,e){var t={};return Object.keys(n).forEach(function(r){t[tE(r)]=Yte}),t}function a$(n,e){return n[e]!==void 0}function tE(n){return"default"+n.charAt(0).toUpperCase()+n.substr(1)}function Xte(n){return!!n&&(typeof n!="function"||n.prototype&&n.prototype.isReactComponent)}function Qte(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,M1(n,e)}function N6(){var n=this.constructor.getDerivedStateFromProps(this.props,this.state);n!=null&&this.setState(n)}function P6(n){function e(t){var r=this.constructor.getDerivedStateFromProps(n,t);return r??null}this.setState(e.bind(this))}function I6(n,e){try{var t=this.props,r=this.state;this.props=n,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(t,r)}finally{this.props=t,this.state=r}}N6.__suppressDeprecationWarning=!0;P6.__suppressDeprecationWarning=!0;I6.__suppressDeprecationWarning=!0;function Jte(n){var e=n.prototype;if(!e||!e.isReactComponent)throw new Error("Can only polyfill class components");if(typeof n.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function")return n;var t=null,r=null,s=null;if(typeof e.componentWillMount=="function"?t="componentWillMount":typeof e.UNSAFE_componentWillMount=="function"&&(t="UNSAFE_componentWillMount"),typeof e.componentWillReceiveProps=="function"?r="componentWillReceiveProps":typeof e.UNSAFE_componentWillReceiveProps=="function"&&(r="UNSAFE_componentWillReceiveProps"),typeof e.componentWillUpdate=="function"?s="componentWillUpdate":typeof e.UNSAFE_componentWillUpdate=="function"&&(s="UNSAFE_componentWillUpdate"),t!==null||r!==null||s!==null){var i=n.displayName||n.name,a=typeof n.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+i+" uses "+a+" but also contains the following legacy lifecycles:"+(t!==null?`
  `+t:"")+(r!==null?`
  `+r:"")+(s!==null?`
  `+s:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof n.getDerivedStateFromProps=="function"&&(e.componentWillMount=N6,e.componentWillReceiveProps=P6),typeof e.getSnapshotBeforeUpdate=="function"){if(typeof e.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");e.componentWillUpdate=I6;var o=e.componentDidUpdate;e.componentDidUpdate=function(u,h,f){var p=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:f;o.call(this,u,h,p)}}return n}var Zte="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function D6(n,e,t){t===void 0&&(t=[]);var r=n.displayName||n.name||"Component",s=Xte(n),i=Object.keys(e),a=i.map(tE);s||!t.length||$0(!1);var o=function(u){Qte(h,u);function h(){for(var p,g=arguments.length,v=new Array(g),y=0;y<g;y++)v[y]=arguments[y];p=u.call.apply(u,[this].concat(v))||this,p.handlers=Object.create(null),i.forEach(function(w){var b=e[w],S=function(P){if(p.props[b]){var R;p._notifying=!0;for(var k=arguments.length,C=new Array(k>1?k-1:0),I=1;I<k;I++)C[I-1]=arguments[I];(R=p.props)[b].apply(R,[P].concat(C)),p._notifying=!1}p.unmounted||p.setState(function(M){var L,F=M.values;return{values:ln(Object.create(null),F,(L={},L[w]=P,L))}})};p.handlers[b]=S}),t.length&&(p.attachRef=function(w){p.inner=w});var _=Object.create(null);return i.forEach(function(w){_[w]=p.props[tE(w)]}),p.state={values:_,prevProps:{}},p}var f=h.prototype;return f.shouldComponentUpdate=function(){return!this._notifying},h.getDerivedStateFromProps=function(g,v){var y=v.values,_=v.prevProps,w={values:ln(Object.create(null),y),prevProps:{}};return i.forEach(function(b){w.prevProps[b]=g[b],!a$(g,b)&&a$(_,b)&&(w.values[b]=g[tE(b)])}),w},f.componentWillUnmount=function(){this.unmounted=!0},f.render=function(){var g=this,v=this.props,y=v.innerRef,_=$C(v,["innerRef"]);a.forEach(function(b){delete _[b]});var w={};return i.forEach(function(b){var S=g.props[b];w[b]=S!==void 0?S:g.state.values[b]}),H.createElement(n,ln({},_,w,this.handlers,{ref:y||this.attachRef}))},h}(H.Component);Jte(o),o.displayName="Uncontrolled("+r+")",o.propTypes=ln({innerRef:function(){}},Kte(e)),t.forEach(function(u){o.prototype[u]=function(){var f;return(f=this.inner)[u].apply(f,arguments)}});var l=o;return H.forwardRef&&(l=H.forwardRef(function(u,h){return H.createElement(o,ln({},u,{innerRef:h,__source:{fileName:Zte,lineNumber:128},__self:this}))}),l.propTypes=o.propTypes),l.ControlledComponent=n,l.deferControlTo=function(u,h,f){return h===void 0&&(h={}),D6(u,ln({},e,h),f)},l}var R6={exports:{}},ene="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",tne=ene,nne=tne;function M6(){}function O6(){}O6.resetWarningCache=M6;var rne=function(){function n(r,s,i,a,o,l){if(l!==nne){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:O6,resetWarningCache:M6};return t.PropTypes=t,t};R6.exports=rne();var sne=R6.exports;const ue=Ps(sne);var O1="milliseconds",U0="seconds",V0="minutes",B0="hours",xf="day",ly="week",z0="month",Sf="year",Ef="decade",Af="century",L6={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},ine={month:1,year:12,decade:10*12,century:100*12};function ane(n){return[31,one(n),31,30,31,30,31,31,30,31,30,31]}function one(n){return n%4===0&&n%100!==0||n%400===0?29:28}function Aa(n,e,t){switch(n=new Date(n),t){case O1:case U0:case V0:case B0:case xf:case ly:return lne(n,e*L6[t]);case z0:case Sf:case Ef:case Af:return cne(n,e*ine[t])}throw new TypeError('Invalid units: "'+t+'"')}function lne(n,e){var t=new Date(+n+e);return une(n,t)}function cne(n,e){var t=n.getFullYear(),r=n.getMonth(),s=n.getDate(),i=t*12+r+e,a=Math.trunc(i/12),o=i%12,l=Math.min(s,ane(a)[o]),u=new Date(n);return u.setFullYear(a),u.setDate(1),u.setMonth(o),u.setDate(l),u}function une(n,e){var t=n.getTimezoneOffset(),r=e.getTimezoneOffset(),s=r-t;return new Date(+e+s*L6.minutes)}function H0(n,e,t){return Aa(n,-e,t)}function vr(n,e,t){switch(n=new Date(n),e){case Af:case Ef:case Sf:n=j1(n,0);case z0:n=V6(n,1);case ly:case xf:n=q0(n,0);case B0:n=cy(n,0);case V0:n=G0(n,0);case U0:n=W0(n,0)}return e===Ef&&(n=H0(n,Tf(n)%10,"year")),e===Af&&(n=H0(n,Tf(n)%100,"year")),e===ly&&(n=B6(n,0,t)),n}function L1(n,e,t){switch(n=new Date(n),n=vr(n,e,t),e){case Af:case Ef:case Sf:case z0:case ly:n=Aa(n,1,e),n=H0(n,1,xf),n.setHours(23,59,59,999);break;case xf:n.setHours(23,59,59,999);break;case B0:case V0:case U0:n=Aa(n,1,e),n=H0(n,1,O1)}return n}var ix=Ey(function(n,e){return n===e}),fM=Ey(function(n,e){return n!==e}),UC=Ey(function(n,e){return n>e}),ax=Ey(function(n,e){return n>=e}),pM=Ey(function(n,e){return n<e}),Sy=Ey(function(n,e){return n<=e});function j6(){return new Date(Math.min.apply(Math,arguments))}function F6(){return new Date(Math.max.apply(Math,arguments))}function $6(n,e,t,r){return r=r||"day",(!e||ax(n,e,r))&&(!t||Sy(n,t,r))}var W0=th("Milliseconds"),G0=th("Seconds"),cy=th("Minutes"),q0=th("Hours"),U6=th("Day"),V6=th("Date"),j1=th("Month"),Tf=th("FullYear");function hne(n,e){return e===void 0?Tf(vr(n,Ef)):Aa(n,e+10,Sf)}function dne(n,e){return e===void 0?Tf(vr(n,Af)):Aa(n,e+100,Sf)}function B6(n,e,t){var r=(U6(n)+7-(t||0))%7;return e===void 0?r:Aa(n,e-r,xf)}function fne(n,e,t,r){var s,i,a;switch(t){case O1:case U0:case V0:case B0:case xf:case ly:s=e.getTime()-n.getTime();break;case z0:case Sf:case Ef:case Af:s=(Tf(e)-Tf(n))*12+j1(e)-j1(n);break;default:throw new TypeError('Invalid units: "'+t+'"')}switch(t){case O1:i=1;break;case U0:i=1e3;break;case V0:i=1e3*60;break;case B0:i=1e3*60*60;break;case xf:i=1e3*60*60*24;break;case ly:i=1e3*60*60*24*7;break;case z0:i=1;break;case Sf:i=12;break;case Ef:i=120;break;case Af:i=1200;break;default:throw new TypeError('Invalid units: "'+t+'"')}return a=s/i,r?a:Math.round(a)}function th(n){var e=function(t){switch(t){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(n);return function(t,r){if(r===void 0)return t["get"+n]();var s=new Date(t);return s["set"+n](r),e&&s["get"+n]()!=r&&(n==="Hours"||r>=e&&s.getHours()-t.getHours()<Math.floor(r/e))&&s["set"+n](r+e),s}}function Ey(n){return function(e,t,r){return n(+vr(e,r),+vr(t,r))}}const o$=Object.freeze(Object.defineProperty({__proto__:null,add:Aa,century:dne,date:V6,day:U6,decade:hne,diff:fne,endOf:L1,eq:ix,gt:UC,gte:ax,hours:q0,inRange:$6,lt:pM,lte:Sy,max:F6,milliseconds:W0,min:j6,minutes:cy,month:j1,neq:fM,seconds:G0,startOf:vr,subtract:H0,weekday:B6,year:Tf},Symbol.toStringTag,{value:"Module"}));function pne(n){if(Array.isArray(n))return gI(n)}function z6(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function mne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nE(n){return pne(n)||z6(n)||dM(n)||mne()}function gne(n,e,t){var r=-1,s=n.length;e<0&&(e=-e>s?0:s+e),t=t>s?s:t,t<0&&(t+=s),s=e>t?0:t-e>>>0,e>>>=0;for(var i=Array(s);++r<s;)i[r]=n[r+e];return i}var H6=gne;function yne(n,e){return n===e||n!==n&&e!==e}var ox=yne,vne=typeof Oi=="object"&&Oi&&Oi.Object===Object&&Oi,W6=vne,wne=W6,bne=typeof self=="object"&&self&&self.Object===Object&&self,_ne=wne||bne||Function("return this")(),ko=_ne,xne=ko,Sne=xne.Symbol,Ay=Sne,l$=Ay,G6=Object.prototype,Ene=G6.hasOwnProperty,Ane=G6.toString,av=l$?l$.toStringTag:void 0;function Tne(n){var e=Ene.call(n,av),t=n[av];try{n[av]=void 0;var r=!0}catch{}var s=Ane.call(n);return r&&(e?n[av]=t:delete n[av]),s}var Cne=Tne,kne=Object.prototype,Nne=kne.toString;function Pne(n){return Nne.call(n)}var Ine=Pne,c$=Ay,Dne=Cne,Rne=Ine,Mne="[object Null]",One="[object Undefined]",u$=c$?c$.toStringTag:void 0;function Lne(n){return n==null?n===void 0?One:Mne:u$&&u$ in Object(n)?Dne(n):Rne(n)}var Ty=Lne;function jne(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var ec=jne,Fne=Ty,$ne=ec,Une="[object AsyncFunction]",Vne="[object Function]",Bne="[object GeneratorFunction]",zne="[object Proxy]";function Hne(n){if(!$ne(n))return!1;var e=Fne(n);return e==Vne||e==Bne||e==Une||e==zne}var mM=Hne,Wne=9007199254740991;function Gne(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=Wne}var gM=Gne,qne=mM,Yne=gM;function Kne(n){return n!=null&&Yne(n.length)&&!qne(n)}var lx=Kne,Xne=9007199254740991,Qne=/^(?:0|[1-9]\d*)$/;function Jne(n,e){var t=typeof n;return e=e??Xne,!!e&&(t=="number"||t!="symbol"&&Qne.test(n))&&n>-1&&n%1==0&&n<e}var yM=Jne,Zne=ox,ere=lx,tre=yM,nre=ec;function rre(n,e,t){if(!nre(t))return!1;var r=typeof e;return(r=="number"?ere(t)&&tre(e,t.length):r=="string"&&e in t)?Zne(t[e],n):!1}var VC=rre,sre=/\s/;function ire(n){for(var e=n.length;e--&&sre.test(n.charAt(e)););return e}var are=ire,ore=are,lre=/^\s+/;function cre(n){return n&&n.slice(0,ore(n)+1).replace(lre,"")}var ure=cre;function hre(n){return n!=null&&typeof n=="object"}var nh=hre,dre=Ty,fre=nh,pre="[object Symbol]";function mre(n){return typeof n=="symbol"||fre(n)&&dre(n)==pre}var cx=mre,gre=ure,h$=ec,yre=cx,d$=0/0,vre=/^[-+]0x[0-9a-f]+$/i,wre=/^0b[01]+$/i,bre=/^0o[0-7]+$/i,_re=parseInt;function xre(n){if(typeof n=="number")return n;if(yre(n))return d$;if(h$(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=h$(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=gre(n);var t=wre.test(n);return t||bre.test(n)?_re(n.slice(2),t?2:8):vre.test(n)?d$:+n}var Sre=xre,Ere=Sre,f$=1/0,Are=17976931348623157e292;function Tre(n){if(!n)return n===0?n:0;if(n=Ere(n),n===f$||n===-f$){var e=n<0?-1:1;return e*Are}return n===n?n:0}var q6=Tre,Cre=q6;function kre(n){var e=Cre(n),t=e%1;return e===e?t?e-t:e:0}var Y6=kre,Nre=H6,Pre=VC,Ire=Y6,Dre=Math.ceil,Rre=Math.max;function Mre(n,e,t){(t?Pre(n,e,t):e===void 0)?e=1:e=Rre(Ire(e),0);var r=n==null?0:n.length;if(!r||e<1)return[];for(var s=0,i=0,a=Array(Dre(r/e));s<r;)a[i++]=Nre(n,s,s+=e);return a}var Ore=Mre;const Lre=Ps(Ore);function ux(n){return n&&n.ownerDocument||document}function jre(n){var e=ux(n);return e&&e.defaultView||window}function Fre(n,e){return jre(n).getComputedStyle(n,e)}var $re=/([A-Z])/g;function Ure(n){return n.replace($re,"-$1").toLowerCase()}var Vre=/^ms-/;function mS(n){return Ure(n).replace(Vre,"-ms-")}var Bre=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function zre(n){return!!(n&&Bre.test(n))}function rp(n,e){var t="",r="";if(typeof e=="string")return n.style.getPropertyValue(mS(e))||Fre(n).getPropertyValue(mS(e));Object.keys(e).forEach(function(s){var i=e[s];!i&&i!==0?n.style.removeProperty(mS(s)):zre(s)?r+=s+"("+i+") ":t+=mS(s)+": "+i+";"}),r&&(t+="transform: "+r+";"),n.style.cssText+=";"+t}function Y0(n,e){if(n.contains)return n.contains(e);if(n.compareDocumentPosition)return n===e||!!(n.compareDocumentPosition(e)&16)}function Hre(n){return"nodeType"in n&&n.nodeType===document.DOCUMENT_NODE}function vM(n){return"window"in n&&n.window===n?n:Hre(n)&&n.defaultView||!1}function K6(n){var e=n==="pageXOffset"?"scrollLeft":"scrollTop";function t(r,s){var i=vM(r);if(s===void 0)return i?i[n]:r[e];i?i.scrollTo(i[n],s):r[e]=s}return t}const X6=K6("pageXOffset"),Q6=K6("pageYOffset");function af(n){var e=ux(n),t={top:0,left:0,height:0,width:0},r=e&&e.documentElement;return!r||!Y0(r,n)||(n.getBoundingClientRect!==void 0&&(t=n.getBoundingClientRect()),t={top:t.top+Q6(r)-(r.clientTop||0),left:t.left+X6(r)-(r.clientLeft||0),width:t.width,height:t.height}),t}var Wre=function(e){return!!e&&"offsetParent"in e};function Gre(n){for(var e=ux(n),t=n&&n.offsetParent;Wre(t)&&t.nodeName!=="HTML"&&rp(t,"position")==="static";)t=t.offsetParent;return t||e.documentElement}var qre=function(e){return e.nodeName&&e.nodeName.toLowerCase()};function J6(n,e){var t={top:0,left:0},r;if(rp(n,"position")==="fixed")r=n.getBoundingClientRect();else{var s=e||Gre(n);r=af(n),qre(s)!=="html"&&(t=af(s));var i=String(rp(s,"borderTopWidth")||0);t.top+=parseInt(i,10)-Q6(s)||0;var a=String(rp(s,"borderLeftWidth")||0);t.left+=parseInt(a,10)-X6(s)||0}var o=String(rp(n,"marginTop")||0),l=String(rp(n,"marginLeft")||0);return ln({},r,{top:r.top-t.top-(parseInt(o,10)||0),left:r.left-t.left-(parseInt(l,10)||0)})}const wM=!!(typeof window<"u"&&window.document&&window.document.createElement);var p$=new Date().getTime();function Yre(n){var e=new Date().getTime(),t=Math.max(0,16-(e-p$)),r=setTimeout(n,t);return p$=e,r}var Kre=["","webkit","moz","o","ms"],yI="clearTimeout",vI=Yre,m$=function(e,t){return e+(e?t[0].toUpperCase()+t.substr(1):t)+"AnimationFrame"};wM&&Kre.some(function(n){var e=m$(n,"request");return e in window&&(yI=m$(n,"cancel"),vI=function(r){return window[e](r)}),!!vI});var g$=function(e){typeof window[yI]=="function"&&window[yI](e)},Z6=vI,SN;function Xre(n,e){if(!SN){var t=document.body,r=t.matches||t.matchesSelector||t.webkitMatchesSelector||t.mozMatchesSelector||t.msMatchesSelector;SN=function(i,a){return r.call(i,a)}}return SN(n,e)}var Qre=Function.prototype.bind.call(Function.prototype.call,[].slice);function Jre(n,e){return Qre(n.querySelectorAll(e))}var wI=!1,bI=!1;try{var EN={get passive(){return wI=!0},get once(){return bI=wI=!0}};wM&&(window.addEventListener("test",EN,EN),window.removeEventListener("test",EN,!0))}catch{}function Zre(n,e,t,r){if(r&&typeof r!="boolean"&&!bI){var s=r.once,i=r.capture,a=t;!bI&&s&&(a=t.__once||function o(l){this.removeEventListener(e,o,i),t.call(this,l)},t.__once=a),n.addEventListener(e,a,wI?r:i)}n.addEventListener(e,t,r)}function ese(n){const e=B.useRef(n);return B.useEffect(()=>{e.current=n},[n]),e}function y$(n){const e=ese(n);return B.useCallback(function(...t){return e.current&&e.current(...t)},[e])}function v$(){return B.useState(null)}function tse(){const n=B.useRef(!0),e=B.useRef(()=>n.current);return B.useEffect(()=>(n.current=!0,()=>{n.current=!1}),[]),e.current}function nse(n){const e=tse();return[n[0],B.useCallback(t=>{if(e())return n[1](t)},[e,n[1]])]}var Cs="top",Bi="bottom",zi="right",ks="left",bM="auto",hx=[Cs,Bi,zi,ks],uy="start",K0="end",rse="clippingParents",ez="viewport",ov="popper",sse="reference",w$=hx.reduce(function(n,e){return n.concat([e+"-"+uy,e+"-"+K0])},[]),_M=[].concat(hx,[bM]).reduce(function(n,e){return n.concat([e,e+"-"+uy,e+"-"+K0])},[]),ise="beforeRead",ase="read",ose="afterRead",lse="beforeMain",cse="main",use="afterMain",hse="beforeWrite",dse="write",fse="afterWrite",pse=[ise,ase,ose,lse,cse,use,hse,dse,fse];function _o(n){return n.split("-")[0]}function hi(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function Cf(n){var e=hi(n).Element;return n instanceof e||n instanceof Element}function xo(n){var e=hi(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function xM(n){if(typeof ShadowRoot>"u")return!1;var e=hi(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}var of=Math.max,F1=Math.min,hy=Math.round;function _I(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function tz(){return!/^((?!chrome|android).)*safari/i.test(_I())}function dy(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var r=n.getBoundingClientRect(),s=1,i=1;e&&xo(n)&&(s=n.offsetWidth>0&&hy(r.width)/n.offsetWidth||1,i=n.offsetHeight>0&&hy(r.height)/n.offsetHeight||1);var a=Cf(n)?hi(n):window,o=a.visualViewport,l=!tz()&&t,u=(r.left+(l&&o?o.offsetLeft:0))/s,h=(r.top+(l&&o?o.offsetTop:0))/i,f=r.width/s,p=r.height/i;return{width:f,height:p,top:h,right:u+f,bottom:h+p,left:u,x:u,y:h}}function SM(n){var e=dy(n),t=n.offsetWidth,r=n.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:n.offsetLeft,y:n.offsetTop,width:t,height:r}}function nz(n,e){var t=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(t&&xM(t)){var r=e;do{if(r&&n.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function Wu(n){return n?(n.nodeName||"").toLowerCase():null}function Xl(n){return hi(n).getComputedStyle(n)}function mse(n){return["table","td","th"].indexOf(Wu(n))>=0}function rh(n){return((Cf(n)?n.ownerDocument:n.document)||window.document).documentElement}function BC(n){return Wu(n)==="html"?n:n.assignedSlot||n.parentNode||(xM(n)?n.host:null)||rh(n)}function b$(n){return!xo(n)||Xl(n).position==="fixed"?null:n.offsetParent}function gse(n){var e=/firefox/i.test(_I()),t=/Trident/i.test(_I());if(t&&xo(n)){var r=Xl(n);if(r.position==="fixed")return null}var s=BC(n);for(xM(s)&&(s=s.host);xo(s)&&["html","body"].indexOf(Wu(s))<0;){var i=Xl(s);if(i.transform!=="none"||i.perspective!=="none"||i.contain==="paint"||["transform","perspective"].indexOf(i.willChange)!==-1||e&&i.willChange==="filter"||e&&i.filter&&i.filter!=="none")return s;s=s.parentNode}return null}function dx(n){for(var e=hi(n),t=b$(n);t&&mse(t)&&Xl(t).position==="static";)t=b$(t);return t&&(Wu(t)==="html"||Wu(t)==="body"&&Xl(t).position==="static")?e:t||gse(n)||e}function EM(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function l0(n,e,t){return of(n,F1(e,t))}function yse(n,e,t){var r=l0(n,e,t);return r>t?t:r}function rz(){return{top:0,right:0,bottom:0,left:0}}function sz(n){return Object.assign({},rz(),n)}function iz(n,e){return e.reduce(function(t,r){return t[r]=n,t},{})}var vse=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,sz(typeof e!="number"?e:iz(e,hx))};function wse(n){var e,t=n.state,r=n.name,s=n.options,i=t.elements.arrow,a=t.modifiersData.popperOffsets,o=_o(t.placement),l=EM(o),u=[ks,zi].indexOf(o)>=0,h=u?"height":"width";if(!(!i||!a)){var f=vse(s.padding,t),p=SM(i),g=l==="y"?Cs:ks,v=l==="y"?Bi:zi,y=t.rects.reference[h]+t.rects.reference[l]-a[l]-t.rects.popper[h],_=a[l]-t.rects.reference[l],w=dx(i),b=w?l==="y"?w.clientHeight||0:w.clientWidth||0:0,S=y/2-_/2,T=f[g],P=b-p[h]-f[v],R=b/2-p[h]/2+S,k=l0(T,R,P),C=l;t.modifiersData[r]=(e={},e[C]=k,e.centerOffset=k-R,e)}}function bse(n){var e=n.state,t=n.options,r=t.element,s=r===void 0?"[data-popper-arrow]":r;s!=null&&(typeof s=="string"&&(s=e.elements.popper.querySelector(s),!s)||nz(e.elements.popper,s)&&(e.elements.arrow=s))}const _se={name:"arrow",enabled:!0,phase:"main",fn:wse,effect:bse,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function fy(n){return n.split("-")[1]}var xse={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Sse(n,e){var t=n.x,r=n.y,s=e.devicePixelRatio||1;return{x:hy(t*s)/s||0,y:hy(r*s)/s||0}}function _$(n){var e,t=n.popper,r=n.popperRect,s=n.placement,i=n.variation,a=n.offsets,o=n.position,l=n.gpuAcceleration,u=n.adaptive,h=n.roundOffsets,f=n.isFixed,p=a.x,g=p===void 0?0:p,v=a.y,y=v===void 0?0:v,_=typeof h=="function"?h({x:g,y}):{x:g,y};g=_.x,y=_.y;var w=a.hasOwnProperty("x"),b=a.hasOwnProperty("y"),S=ks,T=Cs,P=window;if(u){var R=dx(t),k="clientHeight",C="clientWidth";if(R===hi(t)&&(R=rh(t),Xl(R).position!=="static"&&o==="absolute"&&(k="scrollHeight",C="scrollWidth")),R=R,s===Cs||(s===ks||s===zi)&&i===K0){T=Bi;var I=f&&R===P&&P.visualViewport?P.visualViewport.height:R[k];y-=I-r.height,y*=l?1:-1}if(s===ks||(s===Cs||s===Bi)&&i===K0){S=zi;var M=f&&R===P&&P.visualViewport?P.visualViewport.width:R[C];g-=M-r.width,g*=l?1:-1}}var L=Object.assign({position:o},u&&xse),F=h===!0?Sse({x:g,y},hi(t)):{x:g,y};if(g=F.x,y=F.y,l){var O;return Object.assign({},L,(O={},O[T]=b?"0":"",O[S]=w?"0":"",O.transform=(P.devicePixelRatio||1)<=1?"translate("+g+"px, "+y+"px)":"translate3d("+g+"px, "+y+"px, 0)",O))}return Object.assign({},L,(e={},e[T]=b?y+"px":"",e[S]=w?g+"px":"",e.transform="",e))}function Ese(n){var e=n.state,t=n.options,r=t.gpuAcceleration,s=r===void 0?!0:r,i=t.adaptive,a=i===void 0?!0:i,o=t.roundOffsets,l=o===void 0?!0:o,u={placement:_o(e.placement),variation:fy(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:s,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,_$(Object.assign({},u,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:l})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,_$(Object.assign({},u,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Ase={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Ese,data:{}};var gS={passive:!0};function Tse(n){var e=n.state,t=n.instance,r=n.options,s=r.scroll,i=s===void 0?!0:s,a=r.resize,o=a===void 0?!0:a,l=hi(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return i&&u.forEach(function(h){h.addEventListener("scroll",t.update,gS)}),o&&l.addEventListener("resize",t.update,gS),function(){i&&u.forEach(function(h){h.removeEventListener("scroll",t.update,gS)}),o&&l.removeEventListener("resize",t.update,gS)}}const Cse={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Tse,data:{}};var kse={left:"right",right:"left",bottom:"top",top:"bottom"};function rE(n){return n.replace(/left|right|bottom|top/g,function(e){return kse[e]})}var Nse={start:"end",end:"start"};function x$(n){return n.replace(/start|end/g,function(e){return Nse[e]})}function AM(n){var e=hi(n),t=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:t,scrollTop:r}}function TM(n){return dy(rh(n)).left+AM(n).scrollLeft}function Pse(n,e){var t=hi(n),r=rh(n),s=t.visualViewport,i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;var u=tz();(u||!u&&e==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o+TM(n),y:l}}function Ise(n){var e,t=rh(n),r=AM(n),s=(e=n.ownerDocument)==null?void 0:e.body,i=of(t.scrollWidth,t.clientWidth,s?s.scrollWidth:0,s?s.clientWidth:0),a=of(t.scrollHeight,t.clientHeight,s?s.scrollHeight:0,s?s.clientHeight:0),o=-r.scrollLeft+TM(n),l=-r.scrollTop;return Xl(s||t).direction==="rtl"&&(o+=of(t.clientWidth,s?s.clientWidth:0)-i),{width:i,height:a,x:o,y:l}}function CM(n){var e=Xl(n),t=e.overflow,r=e.overflowX,s=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+s+r)}function az(n){return["html","body","#document"].indexOf(Wu(n))>=0?n.ownerDocument.body:xo(n)&&CM(n)?n:az(BC(n))}function c0(n,e){var t;e===void 0&&(e=[]);var r=az(n),s=r===((t=n.ownerDocument)==null?void 0:t.body),i=hi(r),a=s?[i].concat(i.visualViewport||[],CM(r)?r:[]):r,o=e.concat(a);return s?o:o.concat(c0(BC(a)))}function xI(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function Dse(n,e){var t=dy(n,!1,e==="fixed");return t.top=t.top+n.clientTop,t.left=t.left+n.clientLeft,t.bottom=t.top+n.clientHeight,t.right=t.left+n.clientWidth,t.width=n.clientWidth,t.height=n.clientHeight,t.x=t.left,t.y=t.top,t}function S$(n,e,t){return e===ez?xI(Pse(n,t)):Cf(e)?Dse(e,t):xI(Ise(rh(n)))}function Rse(n){var e=c0(BC(n)),t=["absolute","fixed"].indexOf(Xl(n).position)>=0,r=t&&xo(n)?dx(n):n;return Cf(r)?e.filter(function(s){return Cf(s)&&nz(s,r)&&Wu(s)!=="body"}):[]}function Mse(n,e,t,r){var s=e==="clippingParents"?Rse(n):[].concat(e),i=[].concat(s,[t]),a=i[0],o=i.reduce(function(l,u){var h=S$(n,u,r);return l.top=of(h.top,l.top),l.right=F1(h.right,l.right),l.bottom=F1(h.bottom,l.bottom),l.left=of(h.left,l.left),l},S$(n,a,r));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function oz(n){var e=n.reference,t=n.element,r=n.placement,s=r?_o(r):null,i=r?fy(r):null,a=e.x+e.width/2-t.width/2,o=e.y+e.height/2-t.height/2,l;switch(s){case Cs:l={x:a,y:e.y-t.height};break;case Bi:l={x:a,y:e.y+e.height};break;case zi:l={x:e.x+e.width,y:o};break;case ks:l={x:e.x-t.width,y:o};break;default:l={x:e.x,y:e.y}}var u=s?EM(s):null;if(u!=null){var h=u==="y"?"height":"width";switch(i){case uy:l[u]=l[u]-(e[h]/2-t[h]/2);break;case K0:l[u]=l[u]+(e[h]/2-t[h]/2);break}}return l}function X0(n,e){e===void 0&&(e={});var t=e,r=t.placement,s=r===void 0?n.placement:r,i=t.strategy,a=i===void 0?n.strategy:i,o=t.boundary,l=o===void 0?rse:o,u=t.rootBoundary,h=u===void 0?ez:u,f=t.elementContext,p=f===void 0?ov:f,g=t.altBoundary,v=g===void 0?!1:g,y=t.padding,_=y===void 0?0:y,w=sz(typeof _!="number"?_:iz(_,hx)),b=p===ov?sse:ov,S=n.rects.popper,T=n.elements[v?b:p],P=Mse(Cf(T)?T:T.contextElement||rh(n.elements.popper),l,h,a),R=dy(n.elements.reference),k=oz({reference:R,element:S,strategy:"absolute",placement:s}),C=xI(Object.assign({},S,k)),I=p===ov?C:R,M={top:P.top-I.top+w.top,bottom:I.bottom-P.bottom+w.bottom,left:P.left-I.left+w.left,right:I.right-P.right+w.right},L=n.modifiersData.offset;if(p===ov&&L){var F=L[s];Object.keys(M).forEach(function(O){var Y=[zi,Bi].indexOf(O)>=0?1:-1,Z=[Cs,Bi].indexOf(O)>=0?"y":"x";M[O]+=F[Z]*Y})}return M}function Ose(n,e){e===void 0&&(e={});var t=e,r=t.placement,s=t.boundary,i=t.rootBoundary,a=t.padding,o=t.flipVariations,l=t.allowedAutoPlacements,u=l===void 0?_M:l,h=fy(r),f=h?o?w$:w$.filter(function(v){return fy(v)===h}):hx,p=f.filter(function(v){return u.indexOf(v)>=0});p.length===0&&(p=f);var g=p.reduce(function(v,y){return v[y]=X0(n,{placement:y,boundary:s,rootBoundary:i,padding:a})[_o(y)],v},{});return Object.keys(g).sort(function(v,y){return g[v]-g[y]})}function Lse(n){if(_o(n)===bM)return[];var e=rE(n);return[x$(n),e,x$(e)]}function jse(n){var e=n.state,t=n.options,r=n.name;if(!e.modifiersData[r]._skip){for(var s=t.mainAxis,i=s===void 0?!0:s,a=t.altAxis,o=a===void 0?!0:a,l=t.fallbackPlacements,u=t.padding,h=t.boundary,f=t.rootBoundary,p=t.altBoundary,g=t.flipVariations,v=g===void 0?!0:g,y=t.allowedAutoPlacements,_=e.options.placement,w=_o(_),b=w===_,S=l||(b||!v?[rE(_)]:Lse(_)),T=[_].concat(S).reduce(function(G,V){return G.concat(_o(V)===bM?Ose(e,{placement:V,boundary:h,rootBoundary:f,padding:u,flipVariations:v,allowedAutoPlacements:y}):V)},[]),P=e.rects.reference,R=e.rects.popper,k=new Map,C=!0,I=T[0],M=0;M<T.length;M++){var L=T[M],F=_o(L),O=fy(L)===uy,Y=[Cs,Bi].indexOf(F)>=0,Z=Y?"width":"height",X=X0(e,{placement:L,boundary:h,rootBoundary:f,altBoundary:p,padding:u}),J=Y?O?zi:ks:O?Bi:Cs;P[Z]>R[Z]&&(J=rE(J));var K=rE(J),te=[];if(i&&te.push(X[F]<=0),o&&te.push(X[J]<=0,X[K]<=0),te.every(function(G){return G})){I=L,C=!1;break}k.set(L,te)}if(C)for(var ae=v?3:1,q=function(V){var ee=T.find(function(re){var ce=k.get(re);if(ce)return ce.slice(0,V).every(function(Ae){return Ae})});if(ee)return I=ee,"break"},$=ae;$>0;$--){var U=q($);if(U==="break")break}e.placement!==I&&(e.modifiersData[r]._skip=!0,e.placement=I,e.reset=!0)}}const Fse={name:"flip",enabled:!0,phase:"main",fn:jse,requiresIfExists:["offset"],data:{_skip:!1}};function E$(n,e,t){return t===void 0&&(t={x:0,y:0}),{top:n.top-e.height-t.y,right:n.right-e.width+t.x,bottom:n.bottom-e.height+t.y,left:n.left-e.width-t.x}}function A$(n){return[Cs,zi,Bi,ks].some(function(e){return n[e]>=0})}function $se(n){var e=n.state,t=n.name,r=e.rects.reference,s=e.rects.popper,i=e.modifiersData.preventOverflow,a=X0(e,{elementContext:"reference"}),o=X0(e,{altBoundary:!0}),l=E$(a,r),u=E$(o,s,i),h=A$(l),f=A$(u);e.modifiersData[t]={referenceClippingOffsets:l,popperEscapeOffsets:u,isReferenceHidden:h,hasPopperEscaped:f},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":h,"data-popper-escaped":f})}const Use={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:$se};function Vse(n,e,t){var r=_o(n),s=[ks,Cs].indexOf(r)>=0?-1:1,i=typeof t=="function"?t(Object.assign({},e,{placement:n})):t,a=i[0],o=i[1];return a=a||0,o=(o||0)*s,[ks,zi].indexOf(r)>=0?{x:o,y:a}:{x:a,y:o}}function Bse(n){var e=n.state,t=n.options,r=n.name,s=t.offset,i=s===void 0?[0,0]:s,a=_M.reduce(function(h,f){return h[f]=Vse(f,e.rects,i),h},{}),o=a[e.placement],l=o.x,u=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=l,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=a}const zse={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Bse};function Hse(n){var e=n.state,t=n.name;e.modifiersData[t]=oz({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const Wse={name:"popperOffsets",enabled:!0,phase:"read",fn:Hse,data:{}};function Gse(n){return n==="x"?"y":"x"}function qse(n){var e=n.state,t=n.options,r=n.name,s=t.mainAxis,i=s===void 0?!0:s,a=t.altAxis,o=a===void 0?!1:a,l=t.boundary,u=t.rootBoundary,h=t.altBoundary,f=t.padding,p=t.tether,g=p===void 0?!0:p,v=t.tetherOffset,y=v===void 0?0:v,_=X0(e,{boundary:l,rootBoundary:u,padding:f,altBoundary:h}),w=_o(e.placement),b=fy(e.placement),S=!b,T=EM(w),P=Gse(T),R=e.modifiersData.popperOffsets,k=e.rects.reference,C=e.rects.popper,I=typeof y=="function"?y(Object.assign({},e.rects,{placement:e.placement})):y,M=typeof I=="number"?{mainAxis:I,altAxis:I}:Object.assign({mainAxis:0,altAxis:0},I),L=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(R){if(i){var O,Y=T==="y"?Cs:ks,Z=T==="y"?Bi:zi,X=T==="y"?"height":"width",J=R[T],K=J+_[Y],te=J-_[Z],ae=g?-C[X]/2:0,q=b===uy?k[X]:C[X],$=b===uy?-C[X]:-k[X],U=e.elements.arrow,G=g&&U?SM(U):{width:0,height:0},V=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:rz(),ee=V[Y],re=V[Z],ce=l0(0,k[X],G[X]),Ae=S?k[X]/2-ae-ce-ee-M.mainAxis:q-ce-ee-M.mainAxis,_e=S?-k[X]/2+ae+ce+re+M.mainAxis:$+ce+re+M.mainAxis,xe=e.elements.arrow&&dx(e.elements.arrow),ke=xe?T==="y"?xe.clientTop||0:xe.clientLeft||0:0,Ye=(O=L==null?void 0:L[T])!=null?O:0,Ke=J+Ae-Ye-ke,Zn=J+_e-Ye,wr=l0(g?F1(K,Ke):K,J,g?of(te,Zn):te);R[T]=wr,F[T]=wr-J}if(o){var zr,Yi=T==="x"?Cs:ks,Io=T==="x"?Bi:zi,er=R[P],fe=P==="y"?"height":"width",Ne=er+_[Yi],mt=er-_[Io],lt=[Cs,ks].indexOf(w)!==-1,br=(zr=L==null?void 0:L[P])!=null?zr:0,Hr=lt?Ne:er-k[fe]-C[fe]-br+M.altAxis,gt=lt?er+k[fe]+C[fe]-br-M.altAxis:mt,Dt=g&&lt?yse(Hr,er,gt):l0(g?Hr:Ne,er,g?gt:mt);R[P]=Dt,F[P]=Dt-er}e.modifiersData[r]=F}}const Yse={name:"preventOverflow",enabled:!0,phase:"main",fn:qse,requiresIfExists:["offset"]};function Kse(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function Xse(n){return n===hi(n)||!xo(n)?AM(n):Kse(n)}function Qse(n){var e=n.getBoundingClientRect(),t=hy(e.width)/n.offsetWidth||1,r=hy(e.height)/n.offsetHeight||1;return t!==1||r!==1}function Jse(n,e,t){t===void 0&&(t=!1);var r=xo(e),s=xo(e)&&Qse(e),i=rh(e),a=dy(n,s,t),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!t)&&((Wu(e)!=="body"||CM(i))&&(o=Xse(e)),xo(e)?(l=dy(e,!0),l.x+=e.clientLeft,l.y+=e.clientTop):i&&(l.x=TM(i))),{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function Zse(n){var e=new Map,t=new Set,r=[];n.forEach(function(i){e.set(i.name,i)});function s(i){t.add(i.name);var a=[].concat(i.requires||[],i.requiresIfExists||[]);a.forEach(function(o){if(!t.has(o)){var l=e.get(o);l&&s(l)}}),r.push(i)}return n.forEach(function(i){t.has(i.name)||s(i)}),r}function eie(n){var e=Zse(n);return pse.reduce(function(t,r){return t.concat(e.filter(function(s){return s.phase===r}))},[])}function tie(n){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(n())})})),e}}function nie(n){var e=n.reduce(function(t,r){var s=t[r.name];return t[r.name]=s?Object.assign({},s,r,{options:Object.assign({},s.options,r.options),data:Object.assign({},s.data,r.data)}):r,t},{});return Object.keys(e).map(function(t){return e[t]})}var T$={placement:"bottom",modifiers:[],strategy:"absolute"};function C$(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function rie(n){n===void 0&&(n={});var e=n,t=e.defaultModifiers,r=t===void 0?[]:t,s=e.defaultOptions,i=s===void 0?T$:s;return function(o,l,u){u===void 0&&(u=i);var h={placement:"bottom",orderedModifiers:[],options:Object.assign({},T$,i),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},f=[],p=!1,g={state:h,setOptions:function(w){var b=typeof w=="function"?w(h.options):w;y(),h.options=Object.assign({},i,h.options,b),h.scrollParents={reference:Cf(o)?c0(o):o.contextElement?c0(o.contextElement):[],popper:c0(l)};var S=eie(nie([].concat(r,h.options.modifiers)));return h.orderedModifiers=S.filter(function(T){return T.enabled}),v(),g.update()},forceUpdate:function(){if(!p){var w=h.elements,b=w.reference,S=w.popper;if(C$(b,S)){h.rects={reference:Jse(b,dx(S),h.options.strategy==="fixed"),popper:SM(S)},h.reset=!1,h.placement=h.options.placement,h.orderedModifiers.forEach(function(M){return h.modifiersData[M.name]=Object.assign({},M.data)});for(var T=0;T<h.orderedModifiers.length;T++){if(h.reset===!0){h.reset=!1,T=-1;continue}var P=h.orderedModifiers[T],R=P.fn,k=P.options,C=k===void 0?{}:k,I=P.name;typeof R=="function"&&(h=R({state:h,options:C,name:I,instance:g})||h)}}}},update:tie(function(){return new Promise(function(_){g.forceUpdate(),_(h)})}),destroy:function(){y(),p=!0}};if(!C$(o,l))return g;g.setOptions(u).then(function(_){!p&&u.onFirstUpdate&&u.onFirstUpdate(_)});function v(){h.orderedModifiers.forEach(function(_){var w=_.name,b=_.options,S=b===void 0?{}:b,T=_.effect;if(typeof T=="function"){var P=T({state:h,name:w,instance:g,options:S}),R=function(){};f.push(P||R)}})}function y(){f.forEach(function(_){return _()}),f=[]}return g}}var sie=rie({defaultModifiers:[Use,Wse,Ase,Cse,zse,Fse,Yse,_se]}),k$=function(e){return{position:e,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},iie={name:"applyStyles",enabled:!1},aie={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(e){var t=e.state;return function(){var r=t.elements,s=r.reference,i=r.popper;if("removeAttribute"in s){var a=(s.getAttribute("aria-describedby")||"").split(",").filter(function(o){return o.trim()!==i.id});a.length?s.setAttribute("aria-describedby",a.join(",")):s.removeAttribute("aria-describedby")}}},fn:function(e){var t,r=e.state,s=r.elements,i=s.popper,a=s.reference,o=(t=i.getAttribute("role"))==null?void 0:t.toLowerCase();if(i.id&&o==="tooltip"&&"setAttribute"in a){var l=a.getAttribute("aria-describedby");if(l&&l.split(",").indexOf(i.id)!==-1)return;a.setAttribute("aria-describedby",l?l+","+i.id:i.id)}}},oie=[];function lie(n,e,t){var r=t===void 0?{}:t,s=r.enabled,i=s===void 0?!0:s,a=r.placement,o=a===void 0?"bottom":a,l=r.strategy,u=l===void 0?"absolute":l,h=r.modifiers,f=h===void 0?oie:h,p=$C(r,["enabled","placement","strategy","modifiers"]),g=B.useRef(),v=B.useCallback(function(){var T;(T=g.current)==null||T.update()},[]),y=B.useCallback(function(){var T;(T=g.current)==null||T.forceUpdate()},[]),_=nse(B.useState({placement:o,update:v,forceUpdate:y,attributes:{},styles:{popper:k$(u),arrow:{}}})),w=_[0],b=_[1],S=B.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(P){var R=P.state,k={},C={};Object.keys(R.elements).forEach(function(I){k[I]=R.styles[I],C[I]=R.attributes[I]}),b({state:R,styles:k,attributes:C,update:v,forceUpdate:y,placement:R.placement})}}},[v,y,b]);return B.useEffect(function(){!g.current||!i||g.current.setOptions({placement:o,strategy:u,modifiers:[].concat(f,[S,iie])})},[u,o,S,i]),B.useEffect(function(){if(!(!i||n==null||e==null))return g.current=sie(n,e,ln({},p,{placement:o,strategy:u,modifiers:[].concat(f,[aie,S])})),function(){g.current!=null&&(g.current.destroy(),g.current=void 0,b(function(T){return ln({},T,{attributes:{},styles:{popper:k$(u)}})}))}},[i,n,e]),w}function cie(n,e,t,r){var s=r&&typeof r!="boolean"?r.capture:r;n.removeEventListener(e,t,s),t.__once&&n.removeEventListener(e,t.__once,s)}function Av(n,e,t,r){return Zre(n,e,t,r),function(){cie(n,e,t,r)}}var uie=function(){},hie=uie;const die=Ps(hie);function fie(n){return n&&"setState"in n?T3.findDOMNode(n):n??null}const pie=function(n){return ux(fie(n))};var mie=27,N$=function(){};function gie(n){return n.button===0}function yie(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}var P$=function(e){return e&&("current"in e?e.current:e)};function vie(n,e,t){var r=t===void 0?{}:t,s=r.disabled,i=r.clickTrigger,a=i===void 0?"click":i,o=B.useRef(!1),l=e||N$,u=B.useCallback(function(p){var g,v=P$(n);die(!!v,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),o.current=!v||yie(p)||!gie(p)||!!Y0(v,(g=p.composedPath==null?void 0:p.composedPath()[0])!=null?g:p.target)},[n]),h=y$(function(p){o.current||l(p)}),f=y$(function(p){p.keyCode===mie&&l(p)});B.useEffect(function(){if(!(s||n==null)){var p=window.event,g=pie(P$(n)),v=Av(g,a,u,!0),y=Av(g,a,function(b){if(b===p){p=void 0;return}h(b)}),_=Av(g,"keyup",function(b){if(b===p){p=void 0;return}f(b)}),w=[];return"ontouchstart"in g.documentElement&&(w=[].slice.call(g.body.children).map(function(b){return Av(b,"mousemove",N$)})),function(){v(),y(),_(),w.forEach(function(b){return b()})}}},[n,s,a,u,h,f])}function wie(n){var e={};return Array.isArray(n)?(n==null||n.forEach(function(t){e[t.name]=t}),e):n||e}function bie(n){return n===void 0&&(n={}),Array.isArray(n)?n:Object.keys(n).map(function(e){return n[e].name=e,n[e]})}function _ie(n){var e,t,r,s,i=n.enabled,a=n.enableEvents,o=n.placement,l=n.flip,u=n.offset,h=n.fixed,f=n.containerPadding,p=n.arrowElement,g=n.popperConfig,v=g===void 0?{}:g,y=wie(v.modifiers);return ln({},v,{placement:o,enabled:i,strategy:h?"fixed":v.strategy,modifiers:bie(ln({},y,{eventListeners:{enabled:a},preventOverflow:ln({},y.preventOverflow,{options:f?ln({padding:f},(e=y.preventOverflow)==null?void 0:e.options):(t=y.preventOverflow)==null?void 0:t.options}),offset:{options:ln({offset:u},(r=y.offset)==null?void 0:r.options)},arrow:ln({},y.arrow,{enabled:!!p,options:ln({},(s=y.arrow)==null?void 0:s.options,{element:p})}),flip:ln({enabled:!!l},y.flip)}))})}function xie(n,e){return n.classList?!!e&&n.classList.contains(e):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+e+" ")!==-1}function Sie(n,e){n.classList?n.classList.add(e):xie(n,e)||(typeof n.className=="string"?n.className=n.className+" "+e:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+e))}function I$(n,e){return n.replace(new RegExp("(^|\\s)"+e+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function Eie(n,e){n.classList?n.classList.remove(e):typeof n.className=="string"?n.className=I$(n.className,e):n.setAttribute("class",I$(n.className&&n.className.baseVal||"",e))}var yS;function kM(n){if((!yS&&yS!==0||n)&&wM){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),yS=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return yS}var AN=function(e){var t;return typeof document>"u"?null:e==null?ux().body:(typeof e=="function"&&(e=e()),e&&"current"in e&&(e=e.current),(t=e)!=null&&t.nodeType&&e||null)};function D$(n,e){var t=B.useState(function(){return AN(n)}),r=t[0],s=t[1];if(!r){var i=AN(n);i&&s(i)}return B.useEffect(function(){e&&r&&e(r)},[e,r]),B.useEffect(function(){var a=AN(n);a!==r&&s(a)},[n,r]),r}const R$=n=>!n||typeof n=="function"?n:e=>{n.current=e};function Aie(n,e){const t=R$(n),r=R$(e);return s=>{t&&t(s),r&&r(s)}}function Tie(n,e){return B.useMemo(()=>Aie(n,e),[n,e])}var NM=H.forwardRef(function(n,e){var t=n.flip,r=n.offset,s=n.placement,i=n.containerPadding,a=i===void 0?5:i,o=n.popperConfig,l=o===void 0?{}:o,u=n.transition,h=v$(),f=h[0],p=h[1],g=v$(),v=g[0],y=g[1],_=Tie(p,e),w=D$(n.container),b=D$(n.target),S=B.useState(!n.show),T=S[0],P=S[1],R=lie(b,f,_ie({placement:s,enableEvents:!!n.show,containerPadding:a||5,flip:t,offset:r,arrowElement:v,popperConfig:l})),k=R.styles,C=R.attributes,I=$C(R,["styles","attributes"]);n.show?T&&P(!1):!n.transition&&!T&&P(!0);var M=function(){P(!0),n.onExited&&n.onExited.apply(n,arguments)},L=n.show||u&&!T;if(vie(f,n.onHide,{disabled:!n.rootClose||n.rootCloseDisabled,clickTrigger:n.rootCloseEvent}),!L)return null;var F=n.children(ln({},I,{show:!!n.show,props:ln({},C.popper,{style:k.popper,ref:_}),arrowProps:ln({},C.arrow,{style:k.arrow,ref:y})}));if(u){var O=n.onExit,Y=n.onExiting,Z=n.onEnter,X=n.onEntering,J=n.onEntered;F=H.createElement(u,{in:n.show,appear:!0,onExit:O,onExiting:Y,onExited:M,onEnter:Z,onEntering:X,onEntered:J},F)}return w?T3.createPortal(F,w):null});NM.displayName="Overlay";NM.propTypes={show:ue.bool,placement:ue.oneOf(_M),target:ue.any,container:ue.any,flip:ue.bool,children:ue.func.isRequired,containerPadding:ue.number,popperConfig:ue.object,rootClose:ue.bool,rootCloseEvent:ue.oneOf(["click","mousedown"]),rootCloseDisabled:ue.bool,onHide:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),s=1;s<t;s++)r[s-1]=arguments[s];if(e.rootClose){var i;return(i=ue.func).isRequired.apply(i,[e].concat(r))}return ue.func.apply(ue,[e].concat(r))},transition:ue.elementType,onEnter:ue.func,onEntering:ue.func,onEntered:ue.func,onExit:ue.func,onExiting:ue.func,onExited:ue.func};const Cie=NM;function kie(){this.__data__=[],this.size=0}var Nie=kie,Pie=ox;function Iie(n,e){for(var t=n.length;t--;)if(Pie(n[t][0],e))return t;return-1}var zC=Iie,Die=zC,Rie=Array.prototype,Mie=Rie.splice;function Oie(n){var e=this.__data__,t=Die(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():Mie.call(e,t,1),--this.size,!0}var Lie=Oie,jie=zC;function Fie(n){var e=this.__data__,t=jie(e,n);return t<0?void 0:e[t][1]}var $ie=Fie,Uie=zC;function Vie(n){return Uie(this.__data__,n)>-1}var Bie=Vie,zie=zC;function Hie(n,e){var t=this.__data__,r=zie(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}var Wie=Hie,Gie=Nie,qie=Lie,Yie=$ie,Kie=Bie,Xie=Wie;function Cy(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Cy.prototype.clear=Gie;Cy.prototype.delete=qie;Cy.prototype.get=Yie;Cy.prototype.has=Kie;Cy.prototype.set=Xie;var HC=Cy,Qie=HC;function Jie(){this.__data__=new Qie,this.size=0}var Zie=Jie;function eae(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}var tae=eae;function nae(n){return this.__data__.get(n)}var rae=nae;function sae(n){return this.__data__.has(n)}var iae=sae,aae=ko,oae=aae["__core-js_shared__"],lae=oae,TN=lae,M$=function(){var n=/[^.]+$/.exec(TN&&TN.keys&&TN.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function cae(n){return!!M$&&M$ in n}var uae=cae,hae=Function.prototype,dae=hae.toString;function fae(n){if(n!=null){try{return dae.call(n)}catch{}try{return n+""}catch{}}return""}var lz=fae,pae=mM,mae=uae,gae=ec,yae=lz,vae=/[\\^$.*+?()[\]{}|]/g,wae=/^\[object .+?Constructor\]$/,bae=Function.prototype,_ae=Object.prototype,xae=bae.toString,Sae=_ae.hasOwnProperty,Eae=RegExp("^"+xae.call(Sae).replace(vae,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Aae(n){if(!gae(n)||mae(n))return!1;var e=pae(n)?Eae:wae;return e.test(yae(n))}var Tae=Aae;function Cae(n,e){return n==null?void 0:n[e]}var kae=Cae,Nae=Tae,Pae=kae;function Iae(n,e){var t=Pae(n,e);return Nae(t)?t:void 0}var $f=Iae,Dae=$f,Rae=ko,Mae=Dae(Rae,"Map"),PM=Mae,Oae=$f,Lae=Oae(Object,"create"),WC=Lae,O$=WC;function jae(){this.__data__=O$?O$(null):{},this.size=0}var Fae=jae;function $ae(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var Uae=$ae,Vae=WC,Bae="__lodash_hash_undefined__",zae=Object.prototype,Hae=zae.hasOwnProperty;function Wae(n){var e=this.__data__;if(Vae){var t=e[n];return t===Bae?void 0:t}return Hae.call(e,n)?e[n]:void 0}var Gae=Wae,qae=WC,Yae=Object.prototype,Kae=Yae.hasOwnProperty;function Xae(n){var e=this.__data__;return qae?e[n]!==void 0:Kae.call(e,n)}var Qae=Xae,Jae=WC,Zae="__lodash_hash_undefined__";function eoe(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=Jae&&e===void 0?Zae:e,this}var toe=eoe,noe=Fae,roe=Uae,soe=Gae,ioe=Qae,aoe=toe;function ky(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}ky.prototype.clear=noe;ky.prototype.delete=roe;ky.prototype.get=soe;ky.prototype.has=ioe;ky.prototype.set=aoe;var ooe=ky,L$=ooe,loe=HC,coe=PM;function uoe(){this.size=0,this.__data__={hash:new L$,map:new(coe||loe),string:new L$}}var hoe=uoe;function doe(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}var foe=doe,poe=foe;function moe(n,e){var t=n.__data__;return poe(e)?t[typeof e=="string"?"string":"hash"]:t.map}var GC=moe,goe=GC;function yoe(n){var e=goe(this,n).delete(n);return this.size-=e?1:0,e}var voe=yoe,woe=GC;function boe(n){return woe(this,n).get(n)}var _oe=boe,xoe=GC;function Soe(n){return xoe(this,n).has(n)}var Eoe=Soe,Aoe=GC;function Toe(n,e){var t=Aoe(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}var Coe=Toe,koe=hoe,Noe=voe,Poe=_oe,Ioe=Eoe,Doe=Coe;function Ny(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}Ny.prototype.clear=koe;Ny.prototype.delete=Noe;Ny.prototype.get=Poe;Ny.prototype.has=Ioe;Ny.prototype.set=Doe;var IM=Ny,Roe=HC,Moe=PM,Ooe=IM,Loe=200;function joe(n,e){var t=this.__data__;if(t instanceof Roe){var r=t.__data__;if(!Moe||r.length<Loe-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new Ooe(r)}return t.set(n,e),this.size=t.size,this}var Foe=joe,$oe=HC,Uoe=Zie,Voe=tae,Boe=rae,zoe=iae,Hoe=Foe;function Py(n){var e=this.__data__=new $oe(n);this.size=e.size}Py.prototype.clear=Uoe;Py.prototype.delete=Voe;Py.prototype.get=Boe;Py.prototype.has=zoe;Py.prototype.set=Hoe;var DM=Py,Woe="__lodash_hash_undefined__";function Goe(n){return this.__data__.set(n,Woe),this}var qoe=Goe;function Yoe(n){return this.__data__.has(n)}var Koe=Yoe,Xoe=IM,Qoe=qoe,Joe=Koe;function $1(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new Xoe;++e<t;)this.add(n[e])}$1.prototype.add=$1.prototype.push=Qoe;$1.prototype.has=Joe;var Zoe=$1;function ele(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}var tle=ele;function nle(n,e){return n.has(e)}var rle=nle,sle=Zoe,ile=tle,ale=rle,ole=1,lle=2;function cle(n,e,t,r,s,i){var a=t&ole,o=n.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var u=i.get(n),h=i.get(e);if(u&&h)return u==e&&h==n;var f=-1,p=!0,g=t&lle?new sle:void 0;for(i.set(n,e),i.set(e,n);++f<o;){var v=n[f],y=e[f];if(r)var _=a?r(y,v,f,e,n,i):r(v,y,f,n,e,i);if(_!==void 0){if(_)continue;p=!1;break}if(g){if(!ile(e,function(w,b){if(!ale(g,b)&&(v===w||s(v,w,t,r,i)))return g.push(b)})){p=!1;break}}else if(!(v===y||s(v,y,t,r,i))){p=!1;break}}return i.delete(n),i.delete(e),p}var cz=cle,ule=ko,hle=ule.Uint8Array,uz=hle;function dle(n){var e=-1,t=Array(n.size);return n.forEach(function(r,s){t[++e]=[s,r]}),t}var fle=dle;function ple(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var mle=ple,j$=Ay,F$=uz,gle=ox,yle=cz,vle=fle,wle=mle,ble=1,_le=2,xle="[object Boolean]",Sle="[object Date]",Ele="[object Error]",Ale="[object Map]",Tle="[object Number]",Cle="[object RegExp]",kle="[object Set]",Nle="[object String]",Ple="[object Symbol]",Ile="[object ArrayBuffer]",Dle="[object DataView]",$$=j$?j$.prototype:void 0,CN=$$?$$.valueOf:void 0;function Rle(n,e,t,r,s,i,a){switch(t){case Dle:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case Ile:return!(n.byteLength!=e.byteLength||!i(new F$(n),new F$(e)));case xle:case Sle:case Tle:return gle(+n,+e);case Ele:return n.name==e.name&&n.message==e.message;case Cle:case Nle:return n==e+"";case Ale:var o=vle;case kle:var l=r&ble;if(o||(o=wle),n.size!=e.size&&!l)return!1;var u=a.get(n);if(u)return u==e;r|=_le,a.set(n,e);var h=yle(o(n),o(e),r,s,i,a);return a.delete(n),h;case Ple:if(CN)return CN.call(n)==CN.call(e)}return!1}var Mle=Rle;function Ole(n,e){for(var t=-1,r=e.length,s=n.length;++t<r;)n[s+t]=e[t];return n}var RM=Ole,Lle=Array.isArray,Wi=Lle,jle=RM,Fle=Wi;function $le(n,e,t){var r=e(n);return Fle(n)?r:jle(r,t(n))}var hz=$le;function Ule(n,e){for(var t=-1,r=n==null?0:n.length,s=0,i=[];++t<r;){var a=n[t];e(a,t,n)&&(i[s++]=a)}return i}var Vle=Ule;function Ble(){return[]}var dz=Ble,zle=Vle,Hle=dz,Wle=Object.prototype,Gle=Wle.propertyIsEnumerable,U$=Object.getOwnPropertySymbols,qle=U$?function(n){return n==null?[]:(n=Object(n),zle(U$(n),function(e){return Gle.call(n,e)}))}:Hle,MM=qle;function Yle(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var Kle=Yle,Xle=Ty,Qle=nh,Jle="[object Arguments]";function Zle(n){return Qle(n)&&Xle(n)==Jle}var ece=Zle,V$=ece,tce=nh,fz=Object.prototype,nce=fz.hasOwnProperty,rce=fz.propertyIsEnumerable,sce=V$(function(){return arguments}())?V$:function(n){return tce(n)&&nce.call(n,"callee")&&!rce.call(n,"callee")},OM=sce,U1={exports:{}};function ice(){return!1}var ace=ice;U1.exports;(function(n,e){var t=ko,r=ace,s=e&&!e.nodeType&&e,i=s&&!0&&n&&!n.nodeType&&n,a=i&&i.exports===s,o=a?t.Buffer:void 0,l=o?o.isBuffer:void 0,u=l||r;n.exports=u})(U1,U1.exports);var qC=U1.exports,oce=Ty,lce=gM,cce=nh,uce="[object Arguments]",hce="[object Array]",dce="[object Boolean]",fce="[object Date]",pce="[object Error]",mce="[object Function]",gce="[object Map]",yce="[object Number]",vce="[object Object]",wce="[object RegExp]",bce="[object Set]",_ce="[object String]",xce="[object WeakMap]",Sce="[object ArrayBuffer]",Ece="[object DataView]",Ace="[object Float32Array]",Tce="[object Float64Array]",Cce="[object Int8Array]",kce="[object Int16Array]",Nce="[object Int32Array]",Pce="[object Uint8Array]",Ice="[object Uint8ClampedArray]",Dce="[object Uint16Array]",Rce="[object Uint32Array]",Lt={};Lt[Ace]=Lt[Tce]=Lt[Cce]=Lt[kce]=Lt[Nce]=Lt[Pce]=Lt[Ice]=Lt[Dce]=Lt[Rce]=!0;Lt[uce]=Lt[hce]=Lt[Sce]=Lt[dce]=Lt[Ece]=Lt[fce]=Lt[pce]=Lt[mce]=Lt[gce]=Lt[yce]=Lt[vce]=Lt[wce]=Lt[bce]=Lt[_ce]=Lt[xce]=!1;function Mce(n){return cce(n)&&lce(n.length)&&!!Lt[oce(n)]}var Oce=Mce;function Lce(n){return function(e){return n(e)}}var YC=Lce,V1={exports:{}};V1.exports;(function(n,e){var t=W6,r=e&&!e.nodeType&&e,s=r&&!0&&n&&!n.nodeType&&n,i=s&&s.exports===r,a=i&&t.process,o=function(){try{var l=s&&s.require&&s.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();n.exports=o})(V1,V1.exports);var LM=V1.exports,jce=Oce,Fce=YC,B$=LM,z$=B$&&B$.isTypedArray,$ce=z$?Fce(z$):jce,jM=$ce,Uce=Kle,Vce=OM,Bce=Wi,zce=qC,Hce=yM,Wce=jM,Gce=Object.prototype,qce=Gce.hasOwnProperty;function Yce(n,e){var t=Bce(n),r=!t&&Vce(n),s=!t&&!r&&zce(n),i=!t&&!r&&!s&&Wce(n),a=t||r||s||i,o=a?Uce(n.length,String):[],l=o.length;for(var u in n)(e||qce.call(n,u))&&!(a&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Hce(u,l)))&&o.push(u);return o}var pz=Yce,Kce=Object.prototype;function Xce(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||Kce;return n===t}var FM=Xce;function Qce(n,e){return function(t){return n(e(t))}}var mz=Qce,Jce=mz,Zce=Jce(Object.keys,Object),eue=Zce,tue=FM,nue=eue,rue=Object.prototype,sue=rue.hasOwnProperty;function iue(n){if(!tue(n))return nue(n);var e=[];for(var t in Object(n))sue.call(n,t)&&t!="constructor"&&e.push(t);return e}var aue=iue,oue=pz,lue=aue,cue=lx;function uue(n){return cue(n)?oue(n):lue(n)}var fx=uue,hue=hz,due=MM,fue=fx;function pue(n){return hue(n,fue,due)}var gz=pue,H$=gz,mue=1,gue=Object.prototype,yue=gue.hasOwnProperty;function vue(n,e,t,r,s,i){var a=t&mue,o=H$(n),l=o.length,u=H$(e),h=u.length;if(l!=h&&!a)return!1;for(var f=l;f--;){var p=o[f];if(!(a?p in e:yue.call(e,p)))return!1}var g=i.get(n),v=i.get(e);if(g&&v)return g==e&&v==n;var y=!0;i.set(n,e),i.set(e,n);for(var _=a;++f<l;){p=o[f];var w=n[p],b=e[p];if(r)var S=a?r(b,w,p,e,n,i):r(w,b,p,n,e,i);if(!(S===void 0?w===b||s(w,b,t,r,i):S)){y=!1;break}_||(_=p=="constructor")}if(y&&!_){var T=n.constructor,P=e.constructor;T!=P&&"constructor"in n&&"constructor"in e&&!(typeof T=="function"&&T instanceof T&&typeof P=="function"&&P instanceof P)&&(y=!1)}return i.delete(n),i.delete(e),y}var wue=vue,bue=$f,_ue=ko,xue=bue(_ue,"DataView"),Sue=xue,Eue=$f,Aue=ko,Tue=Eue(Aue,"Promise"),Cue=Tue,kue=$f,Nue=ko,Pue=kue(Nue,"Set"),Iue=Pue,Due=$f,Rue=ko,Mue=Due(Rue,"WeakMap"),Oue=Mue,SI=Sue,EI=PM,AI=Cue,TI=Iue,CI=Oue,yz=Ty,Iy=lz,W$="[object Map]",Lue="[object Object]",G$="[object Promise]",q$="[object Set]",Y$="[object WeakMap]",K$="[object DataView]",jue=Iy(SI),Fue=Iy(EI),$ue=Iy(AI),Uue=Iy(TI),Vue=Iy(CI),fh=yz;(SI&&fh(new SI(new ArrayBuffer(1)))!=K$||EI&&fh(new EI)!=W$||AI&&fh(AI.resolve())!=G$||TI&&fh(new TI)!=q$||CI&&fh(new CI)!=Y$)&&(fh=function(n){var e=yz(n),t=e==Lue?n.constructor:void 0,r=t?Iy(t):"";if(r)switch(r){case jue:return K$;case Fue:return W$;case $ue:return G$;case Uue:return q$;case Vue:return Y$}return e});var KC=fh,kN=DM,Bue=cz,zue=Mle,Hue=wue,X$=KC,Q$=Wi,J$=qC,Wue=jM,Gue=1,Z$="[object Arguments]",e4="[object Array]",vS="[object Object]",que=Object.prototype,t4=que.hasOwnProperty;function Yue(n,e,t,r,s,i){var a=Q$(n),o=Q$(e),l=a?e4:X$(n),u=o?e4:X$(e);l=l==Z$?vS:l,u=u==Z$?vS:u;var h=l==vS,f=u==vS,p=l==u;if(p&&J$(n)){if(!J$(e))return!1;a=!0,h=!1}if(p&&!h)return i||(i=new kN),a||Wue(n)?Bue(n,e,t,r,s,i):zue(n,e,l,t,r,s,i);if(!(t&Gue)){var g=h&&t4.call(n,"__wrapped__"),v=f&&t4.call(e,"__wrapped__");if(g||v){var y=g?n.value():n,_=v?e.value():e;return i||(i=new kN),s(y,_,t,r,i)}}return p?(i||(i=new kN),Hue(n,e,t,r,s,i)):!1}var Kue=Yue,Xue=Kue,n4=nh;function vz(n,e,t,r,s){return n===e?!0:n==null||e==null||!n4(n)&&!n4(e)?n!==n&&e!==e:Xue(n,e,t,r,vz,s)}var $M=vz,Que=$M;function Jue(n,e){return Que(n,e)}var Zue=Jue;const ehe=Ps(Zue);function NN(n,e){var t=vM(n);return t?t.innerHeight:e?n.clientHeight:af(n).height}function wz(n,e,t){n.closest&&!t&&n.closest(e);var r=n;do{if(Xre(r,e))return r;r=r.parentElement}while(r&&r!==t&&r.nodeType===document.ELEMENT_NODE);return null}function the(n,e,t,r){for(var s=n.length,i=t+(r?1:-1);r?i--:++i<s;)if(e(n[i],i,n))return i;return-1}var nhe=the,rhe=DM,she=$M,ihe=1,ahe=2;function ohe(n,e,t,r){var s=t.length,i=s,a=!r;if(n==null)return!i;for(n=Object(n);s--;){var o=t[s];if(a&&o[2]?o[1]!==n[o[0]]:!(o[0]in n))return!1}for(;++s<i;){o=t[s];var l=o[0],u=n[l],h=o[1];if(a&&o[2]){if(u===void 0&&!(l in n))return!1}else{var f=new rhe;if(r)var p=r(u,h,l,n,e,f);if(!(p===void 0?she(h,u,ihe|ahe,r,f):p))return!1}}return!0}var lhe=ohe,che=ec;function uhe(n){return n===n&&!che(n)}var bz=uhe,hhe=bz,dhe=fx;function fhe(n){for(var e=dhe(n),t=e.length;t--;){var r=e[t],s=n[r];e[t]=[r,s,hhe(s)]}return e}var phe=fhe;function mhe(n,e){return function(t){return t==null?!1:t[n]===e&&(e!==void 0||n in Object(t))}}var _z=mhe,ghe=lhe,yhe=phe,vhe=_z;function whe(n){var e=yhe(n);return e.length==1&&e[0][2]?vhe(e[0][0],e[0][1]):function(t){return t===n||ghe(t,n,e)}}var bhe=whe,_he=Wi,xhe=cx,She=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ehe=/^\w*$/;function Ahe(n,e){if(_he(n))return!1;var t=typeof n;return t=="number"||t=="symbol"||t=="boolean"||n==null||xhe(n)?!0:Ehe.test(n)||!She.test(n)||e!=null&&n in Object(e)}var UM=Ahe,xz=IM,The="Expected a function";function VM(n,e){if(typeof n!="function"||e!=null&&typeof e!="function")throw new TypeError(The);var t=function(){var r=arguments,s=e?e.apply(this,r):r[0],i=t.cache;if(i.has(s))return i.get(s);var a=n.apply(this,r);return t.cache=i.set(s,a)||i,a};return t.cache=new(VM.Cache||xz),t}VM.Cache=xz;var Che=VM,khe=Che,Nhe=500;function Phe(n){var e=khe(n,function(r){return t.size===Nhe&&t.clear(),r}),t=e.cache;return e}var Ihe=Phe,Dhe=Ihe,Rhe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Mhe=/\\(\\)?/g,Ohe=Dhe(function(n){var e=[];return n.charCodeAt(0)===46&&e.push(""),n.replace(Rhe,function(t,r,s,i){e.push(s?i.replace(Mhe,"$1"):r||t)}),e}),Lhe=Ohe;function jhe(n,e){for(var t=-1,r=n==null?0:n.length,s=Array(r);++t<r;)s[t]=e(n[t],t,n);return s}var BM=jhe,r4=Ay,Fhe=BM,$he=Wi,Uhe=cx,Vhe=1/0,s4=r4?r4.prototype:void 0,i4=s4?s4.toString:void 0;function Sz(n){if(typeof n=="string")return n;if($he(n))return Fhe(n,Sz)+"";if(Uhe(n))return i4?i4.call(n):"";var e=n+"";return e=="0"&&1/n==-Vhe?"-0":e}var Bhe=Sz,zhe=Bhe;function Hhe(n){return n==null?"":zhe(n)}var Whe=Hhe,Ghe=Wi,qhe=UM,Yhe=Lhe,Khe=Whe;function Xhe(n,e){return Ghe(n)?n:qhe(n,e)?[n]:Yhe(Khe(n))}var XC=Xhe,Qhe=cx,Jhe=1/0;function Zhe(n){if(typeof n=="string"||Qhe(n))return n;var e=n+"";return e=="0"&&1/n==-Jhe?"-0":e}var px=Zhe,ede=XC,tde=px;function nde(n,e){e=ede(e,n);for(var t=0,r=e.length;n!=null&&t<r;)n=n[tde(e[t++])];return t&&t==r?n:void 0}var QC=nde,rde=QC;function sde(n,e,t){var r=n==null?void 0:rde(n,e);return r===void 0?t:r}var ide=sde;function ade(n,e){return n!=null&&e in Object(n)}var ode=ade,lde=XC,cde=OM,ude=Wi,hde=yM,dde=gM,fde=px;function pde(n,e,t){e=lde(e,n);for(var r=-1,s=e.length,i=!1;++r<s;){var a=fde(e[r]);if(!(i=n!=null&&t(n,a)))break;n=n[a]}return i||++r!=s?i:(s=n==null?0:n.length,!!s&&dde(s)&&hde(a,s)&&(ude(n)||cde(n)))}var mde=pde,gde=ode,yde=mde;function vde(n,e){return n!=null&&yde(n,e,gde)}var wde=vde,bde=$M,_de=ide,xde=wde,Sde=UM,Ede=bz,Ade=_z,Tde=px,Cde=1,kde=2;function Nde(n,e){return Sde(n)&&Ede(e)?Ade(Tde(n),e):function(t){var r=_de(t,n);return r===void 0&&r===e?xde(t,n):bde(e,r,Cde|kde)}}var Pde=Nde;function Ide(n){return n}var JC=Ide;function Dde(n){return function(e){return e==null?void 0:e[n]}}var Rde=Dde,Mde=QC;function Ode(n){return function(e){return Mde(e,n)}}var Lde=Ode,jde=Rde,Fde=Lde,$de=UM,Ude=px;function Vde(n){return $de(n)?jde(Ude(n)):Fde(n)}var Bde=Vde,zde=bhe,Hde=Pde,Wde=JC,Gde=Wi,qde=Bde;function Yde(n){return typeof n=="function"?n:n==null?Wde:typeof n=="object"?Gde(n)?Hde(n[0],n[1]):zde(n):qde(n)}var ZC=Yde,Kde=nhe,Xde=ZC,Qde=Y6,Jde=Math.max;function Zde(n,e,t){var r=n==null?0:n.length;if(!r)return-1;var s=t==null?0:Qde(t);return s<0&&(s=Jde(r+s,0)),Kde(n,Xde(e),s)}var efe=Zde;const tfe=Ps(efe);var nfe=Math.ceil,rfe=Math.max;function sfe(n,e,t,r){for(var s=-1,i=rfe(nfe((e-n)/(t||1)),0),a=Array(i);i--;)a[r?i:++s]=n,n+=t;return a}var ife=sfe,afe=ife,ofe=VC,PN=q6;function lfe(n){return function(e,t,r){return r&&typeof r!="number"&&ofe(e,t,r)&&(t=r=void 0),e=PN(e),t===void 0?(t=e,e=0):t=PN(t),r=r===void 0?e<t?1:-1:PN(r),afe(e,t,r,n)}}var cfe=lfe,ufe=cfe,hfe=ufe(),dfe=hfe;const ffe=Ps(dfe);var a4=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function pfe(n,e){return!!(n===e||a4(n)&&a4(e))}function mfe(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(!pfe(n[t],e[t]))return!1;return!0}function Ez(n,e){e===void 0&&(e=mfe);var t=null;function r(){for(var s=[],i=0;i<arguments.length;i++)s[i]=arguments[i];if(t&&t.lastThis===this&&e(s,t.lastArgs))return t.lastResult;var a=n.apply(this,s);return t={lastResult:a,lastArgs:s,lastThis:this},a}return r.clear=function(){t=null},r}function kI(n,e){var t=vM(n);return t?t.innerWidth:e?n.clientWidth:af(n).width}var o4=Ay,gfe=OM,yfe=Wi,l4=o4?o4.isConcatSpreadable:void 0;function vfe(n){return yfe(n)||gfe(n)||!!(l4&&n&&n[l4])}var wfe=vfe,bfe=RM,_fe=wfe;function Az(n,e,t,r,s){var i=-1,a=n.length;for(t||(t=_fe),s||(s=[]);++i<a;){var o=n[i];e>0&&t(o)?e>1?Az(o,e-1,t,r,s):bfe(s,o):r||(s[s.length]=o)}return s}var Tz=Az;function xfe(n){return function(e,t,r){for(var s=-1,i=Object(e),a=r(e),o=a.length;o--;){var l=a[n?o:++s];if(t(i[l],l,i)===!1)break}return e}}var Sfe=xfe,Efe=Sfe,Afe=Efe(),Tfe=Afe,Cfe=Tfe,kfe=fx;function Nfe(n,e){return n&&Cfe(n,e,kfe)}var zM=Nfe,Pfe=lx;function Ife(n,e){return function(t,r){if(t==null)return t;if(!Pfe(t))return n(t,r);for(var s=t.length,i=e?s:-1,a=Object(t);(e?i--:++i<s)&&r(a[i],i,a)!==!1;);return t}}var Dfe=Ife,Rfe=zM,Mfe=Dfe,Ofe=Mfe(Rfe),Lfe=Ofe,jfe=Lfe,Ffe=lx;function $fe(n,e){var t=-1,r=Ffe(n)?Array(n.length):[];return jfe(n,function(s,i,a){r[++t]=e(s,i,a)}),r}var Ufe=$fe;function Vfe(n,e){var t=n.length;for(n.sort(e);t--;)n[t]=n[t].value;return n}var Bfe=Vfe,c4=cx;function zfe(n,e){if(n!==e){var t=n!==void 0,r=n===null,s=n===n,i=c4(n),a=e!==void 0,o=e===null,l=e===e,u=c4(e);if(!o&&!u&&!i&&n>e||i&&a&&l&&!o&&!u||r&&a&&l||!t&&l||!s)return 1;if(!r&&!i&&!u&&n<e||u&&t&&s&&!r&&!i||o&&t&&s||!a&&s||!l)return-1}return 0}var Hfe=zfe,Wfe=Hfe;function Gfe(n,e,t){for(var r=-1,s=n.criteria,i=e.criteria,a=s.length,o=t.length;++r<a;){var l=Wfe(s[r],i[r]);if(l){if(r>=o)return l;var u=t[r];return l*(u=="desc"?-1:1)}}return n.index-e.index}var qfe=Gfe,IN=BM,Yfe=QC,Kfe=ZC,Xfe=Ufe,Qfe=Bfe,Jfe=YC,Zfe=qfe,epe=JC,tpe=Wi;function npe(n,e,t){e.length?e=IN(e,function(i){return tpe(i)?function(a){return Yfe(a,i.length===1?i[0]:i)}:i}):e=[epe];var r=-1;e=IN(e,Jfe(Kfe));var s=Xfe(n,function(i,a,o){var l=IN(e,function(u){return u(i)});return{criteria:l,index:++r,value:i}});return Qfe(s,function(i,a){return Zfe(i,a,t)})}var rpe=npe;function spe(n,e,t){switch(t.length){case 0:return n.call(e);case 1:return n.call(e,t[0]);case 2:return n.call(e,t[0],t[1]);case 3:return n.call(e,t[0],t[1],t[2])}return n.apply(e,t)}var ipe=spe,ape=ipe,u4=Math.max;function ope(n,e,t){return e=u4(e===void 0?n.length-1:e,0),function(){for(var r=arguments,s=-1,i=u4(r.length-e,0),a=Array(i);++s<i;)a[s]=r[e+s];s=-1;for(var o=Array(e+1);++s<e;)o[s]=r[s];return o[e]=t(a),ape(n,this,o)}}var Cz=ope;function lpe(n){return function(){return n}}var cpe=lpe,upe=$f,hpe=function(){try{var n=upe(Object,"defineProperty");return n({},"",{}),n}catch{}}(),kz=hpe,dpe=cpe,h4=kz,fpe=JC,ppe=h4?function(n,e){return h4(n,"toString",{configurable:!0,enumerable:!1,value:dpe(e),writable:!0})}:fpe,mpe=ppe,gpe=800,ype=16,vpe=Date.now;function wpe(n){var e=0,t=0;return function(){var r=vpe(),s=ype-(r-t);if(t=r,s>0){if(++e>=gpe)return arguments[0]}else e=0;return n.apply(void 0,arguments)}}var bpe=wpe,_pe=mpe,xpe=bpe,Spe=xpe(_pe),Nz=Spe,Epe=JC,Ape=Cz,Tpe=Nz;function Cpe(n,e){return Tpe(Ape(n,e,Epe),n+"")}var Pz=Cpe,kpe=Tz,Npe=rpe,Ppe=Pz,d4=VC,Ipe=Ppe(function(n,e){if(n==null)return[];var t=e.length;return t>1&&d4(n,e[0],e[1])?e=[]:t>2&&d4(e[0],e[1],e[2])&&(e=[e[0]]),Npe(n,kpe(e,1),[])}),Dpe=Ipe;const Rpe=Ps(Dpe);function Iz(n){return T6(n)||z6(n)||dM(n)||C6()}function Mpe(n){var e=[];if(n!=null)for(var t in Object(n))e.push(t);return e}var Ope=Mpe,Lpe=ec,jpe=FM,Fpe=Ope,$pe=Object.prototype,Upe=$pe.hasOwnProperty;function Vpe(n){if(!Lpe(n))return Fpe(n);var e=jpe(n),t=[];for(var r in n)r=="constructor"&&(e||!Upe.call(n,r))||t.push(r);return t}var Bpe=Vpe,zpe=pz,Hpe=Bpe,Wpe=lx;function Gpe(n){return Wpe(n)?zpe(n,!0):Hpe(n)}var ek=Gpe,qpe=Pz,Ype=ox,Kpe=VC,Xpe=ek,Dz=Object.prototype,Qpe=Dz.hasOwnProperty,Jpe=qpe(function(n,e){n=Object(n);var t=-1,r=e.length,s=r>2?e[2]:void 0;for(s&&Kpe(e[0],e[1],s)&&(r=1);++t<r;)for(var i=e[t],a=Xpe(i),o=-1,l=a.length;++o<l;){var u=a[o],h=n[u];(h===void 0||Ype(h,Dz[u])&&!Qpe.call(n,u))&&(n[u]=i[u])}return n}),Zpe=Jpe;const eme=Ps(Zpe);var f4=kz;function tme(n,e,t){e=="__proto__"&&f4?f4(n,e,{configurable:!0,enumerable:!0,value:t,writable:!0}):n[e]=t}var HM=tme,nme=HM,rme=zM,sme=ZC;function ime(n,e){var t={};return e=sme(e),rme(n,function(r,s,i){nme(t,s,e(r,s,i))}),t}var ame=ime;const ome=Ps(ame);function lme(n,e){for(var t=-1,r=n==null?0:n.length;++t<r&&e(n[t],t,n)!==!1;);return n}var Rz=lme,cme=HM,ume=ox,hme=Object.prototype,dme=hme.hasOwnProperty;function fme(n,e,t){var r=n[e];(!(dme.call(n,e)&&ume(r,t))||t===void 0&&!(e in n))&&cme(n,e,t)}var Mz=fme,pme=Mz,mme=HM;function gme(n,e,t,r){var s=!t;t||(t={});for(var i=-1,a=e.length;++i<a;){var o=e[i],l=r?r(t[o],n[o],o,t,n):void 0;l===void 0&&(l=n[o]),s?mme(t,o,l):pme(t,o,l)}return t}var mx=gme,yme=mx,vme=fx;function wme(n,e){return n&&yme(e,vme(e),n)}var bme=wme,_me=mx,xme=ek;function Sme(n,e){return n&&_me(e,xme(e),n)}var Eme=Sme,B1={exports:{}};B1.exports;(function(n,e){var t=ko,r=e&&!e.nodeType&&e,s=r&&!0&&n&&!n.nodeType&&n,i=s&&s.exports===r,a=i?t.Buffer:void 0,o=a?a.allocUnsafe:void 0;function l(u,h){if(h)return u.slice();var f=u.length,p=o?o(f):new u.constructor(f);return u.copy(p),p}n.exports=l})(B1,B1.exports);var Ame=B1.exports;function Tme(n,e){var t=-1,r=n.length;for(e||(e=Array(r));++t<r;)e[t]=n[t];return e}var Cme=Tme,kme=mx,Nme=MM;function Pme(n,e){return kme(n,Nme(n),e)}var Ime=Pme,Dme=mz,Rme=Dme(Object.getPrototypeOf,Object),tk=Rme,Mme=RM,Ome=tk,Lme=MM,jme=dz,Fme=Object.getOwnPropertySymbols,$me=Fme?function(n){for(var e=[];n;)Mme(e,Lme(n)),n=Ome(n);return e}:jme,Oz=$me,Ume=mx,Vme=Oz;function Bme(n,e){return Ume(n,Vme(n),e)}var zme=Bme,Hme=hz,Wme=Oz,Gme=ek;function qme(n){return Hme(n,Gme,Wme)}var Lz=qme,Yme=Object.prototype,Kme=Yme.hasOwnProperty;function Xme(n){var e=n.length,t=new n.constructor(e);return e&&typeof n[0]=="string"&&Kme.call(n,"index")&&(t.index=n.index,t.input=n.input),t}var Qme=Xme,p4=uz;function Jme(n){var e=new n.constructor(n.byteLength);return new p4(e).set(new p4(n)),e}var WM=Jme,Zme=WM;function ege(n,e){var t=e?Zme(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.byteLength)}var tge=ege,nge=/\w*$/;function rge(n){var e=new n.constructor(n.source,nge.exec(n));return e.lastIndex=n.lastIndex,e}var sge=rge,m4=Ay,g4=m4?m4.prototype:void 0,y4=g4?g4.valueOf:void 0;function ige(n){return y4?Object(y4.call(n)):{}}var age=ige,oge=WM;function lge(n,e){var t=e?oge(n.buffer):n.buffer;return new n.constructor(t,n.byteOffset,n.length)}var cge=lge,uge=WM,hge=tge,dge=sge,fge=age,pge=cge,mge="[object Boolean]",gge="[object Date]",yge="[object Map]",vge="[object Number]",wge="[object RegExp]",bge="[object Set]",_ge="[object String]",xge="[object Symbol]",Sge="[object ArrayBuffer]",Ege="[object DataView]",Age="[object Float32Array]",Tge="[object Float64Array]",Cge="[object Int8Array]",kge="[object Int16Array]",Nge="[object Int32Array]",Pge="[object Uint8Array]",Ige="[object Uint8ClampedArray]",Dge="[object Uint16Array]",Rge="[object Uint32Array]";function Mge(n,e,t){var r=n.constructor;switch(e){case Sge:return uge(n);case mge:case gge:return new r(+n);case Ege:return hge(n,t);case Age:case Tge:case Cge:case kge:case Nge:case Pge:case Ige:case Dge:case Rge:return pge(n,t);case yge:return new r;case vge:case _ge:return new r(n);case wge:return dge(n);case bge:return new r;case xge:return fge(n)}}var Oge=Mge,Lge=ec,v4=Object.create,jge=function(){function n(){}return function(e){if(!Lge(e))return{};if(v4)return v4(e);n.prototype=e;var t=new n;return n.prototype=void 0,t}}(),jz=jge,Fge=jz,$ge=tk,Uge=FM;function Vge(n){return typeof n.constructor=="function"&&!Uge(n)?Fge($ge(n)):{}}var Bge=Vge,zge=KC,Hge=nh,Wge="[object Map]";function Gge(n){return Hge(n)&&zge(n)==Wge}var qge=Gge,Yge=qge,Kge=YC,w4=LM,b4=w4&&w4.isMap,Xge=b4?Kge(b4):Yge,Qge=Xge,Jge=KC,Zge=nh,eye="[object Set]";function tye(n){return Zge(n)&&Jge(n)==eye}var nye=tye,rye=nye,sye=YC,_4=LM,x4=_4&&_4.isSet,iye=x4?sye(x4):rye,aye=iye,oye=DM,lye=Rz,cye=Mz,uye=bme,hye=Eme,dye=Ame,fye=Cme,pye=Ime,mye=zme,gye=gz,yye=Lz,vye=KC,wye=Qme,bye=Oge,_ye=Bge,xye=Wi,Sye=qC,Eye=Qge,Aye=ec,Tye=aye,Cye=fx,kye=ek,Nye=1,Pye=2,Iye=4,Fz="[object Arguments]",Dye="[object Array]",Rye="[object Boolean]",Mye="[object Date]",Oye="[object Error]",$z="[object Function]",Lye="[object GeneratorFunction]",jye="[object Map]",Fye="[object Number]",Uz="[object Object]",$ye="[object RegExp]",Uye="[object Set]",Vye="[object String]",Bye="[object Symbol]",zye="[object WeakMap]",Hye="[object ArrayBuffer]",Wye="[object DataView]",Gye="[object Float32Array]",qye="[object Float64Array]",Yye="[object Int8Array]",Kye="[object Int16Array]",Xye="[object Int32Array]",Qye="[object Uint8Array]",Jye="[object Uint8ClampedArray]",Zye="[object Uint16Array]",eve="[object Uint32Array]",Nt={};Nt[Fz]=Nt[Dye]=Nt[Hye]=Nt[Wye]=Nt[Rye]=Nt[Mye]=Nt[Gye]=Nt[qye]=Nt[Yye]=Nt[Kye]=Nt[Xye]=Nt[jye]=Nt[Fye]=Nt[Uz]=Nt[$ye]=Nt[Uye]=Nt[Vye]=Nt[Bye]=Nt[Qye]=Nt[Jye]=Nt[Zye]=Nt[eve]=!0;Nt[Oye]=Nt[$z]=Nt[zye]=!1;function sE(n,e,t,r,s,i){var a,o=e&Nye,l=e&Pye,u=e&Iye;if(t&&(a=s?t(n,r,s,i):t(n)),a!==void 0)return a;if(!Aye(n))return n;var h=xye(n);if(h){if(a=wye(n),!o)return fye(n,a)}else{var f=vye(n),p=f==$z||f==Lye;if(Sye(n))return dye(n,o);if(f==Uz||f==Fz||p&&!s){if(a=l||p?{}:_ye(n),!o)return l?mye(n,hye(a,n)):pye(n,uye(a,n))}else{if(!Nt[f])return s?n:{};a=bye(n,f,o)}}i||(i=new oye);var g=i.get(n);if(g)return g;i.set(n,a),Tye(n)?n.forEach(function(_){a.add(sE(_,e,t,_,n,i))}):Eye(n)&&n.forEach(function(_,w){a.set(w,sE(_,e,t,w,n,i))});var v=u?l?yye:gye:l?kye:Cye,y=h?void 0:v(n);return lye(y||n,function(_,w){y&&(w=_,_=n[w]),cye(a,w,sE(_,e,t,w,n,i))}),a}var tve=sE;function nve(n){var e=n==null?0:n.length;return e?n[e-1]:void 0}var rve=nve,sve=QC,ive=H6;function ave(n,e){return e.length<2?n:sve(n,ive(e,0,-1))}var ove=ave,lve=XC,cve=rve,uve=ove,hve=px;function dve(n,e){return e=lve(e,n),n=uve(n,e),n==null||delete n[hve(cve(e))]}var fve=dve,pve=Ty,mve=tk,gve=nh,yve="[object Object]",vve=Function.prototype,wve=Object.prototype,Vz=vve.toString,bve=wve.hasOwnProperty,_ve=Vz.call(Object);function xve(n){if(!gve(n)||pve(n)!=yve)return!1;var e=mve(n);if(e===null)return!0;var t=bve.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t instanceof t&&Vz.call(t)==_ve}var Sve=xve,Eve=Sve;function Ave(n){return Eve(n)?void 0:n}var Tve=Ave,Cve=Tz;function kve(n){var e=n==null?0:n.length;return e?Cve(n,1):[]}var Nve=kve,Pve=Nve,Ive=Cz,Dve=Nz;function Rve(n){return Dve(Ive(n,void 0,Pve),n+"")}var Mve=Rve,Ove=BM,Lve=tve,jve=fve,Fve=XC,$ve=mx,Uve=Tve,Vve=Mve,Bve=Lz,zve=1,Hve=2,Wve=4,Gve=Vve(function(n,e){var t={};if(n==null)return t;var r=!1;e=Ove(e,function(i){return i=Fve(i,n),r||(r=i.length>1),i}),$ve(n,Bve(n),t),r&&(t=Lve(t,zve|Hve|Wve,Uve));for(var s=e.length;s--;)jve(t,e[s]);return t}),qve=Gve;const Yve=Ps(qve);var Kve=Rz,Xve=jz,Qve=zM,Jve=ZC,Zve=tk,e0e=Wi,t0e=qC,n0e=mM,r0e=ec,s0e=jM;function i0e(n,e,t){var r=e0e(n),s=r||t0e(n)||s0e(n);if(e=Jve(e),t==null){var i=n&&n.constructor;s?t=r?new i:[]:r0e(n)?t=n0e(i)?Xve(Zve(n)):{}:t={}}return(s?Kve:Qve)(n,function(a,o,l){return e(t,a,o,l)}),t}var a0e=i0e;const o0e=Ps(a0e);var l0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){return function(t,r,s){r.prototype.isBetween=function(i,a,o,l){var u=s(i),h=s(a),f=(l=l||"()")[0]==="(",p=l[1]===")";return(f?this.isAfter(u,o):!this.isBefore(u,o))&&(p?this.isBefore(h,o):!this.isAfter(h,o))||(f?this.isBefore(u,o):!this.isAfter(u,o))&&(p?this.isAfter(h,o):!this.isBefore(h,o))}}})})(l0e);var c0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){return function(t,r){r.prototype.isSameOrAfter=function(s,i){return this.isSame(s,i)||this.isAfter(s,i)}}})})(c0e);var u0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){return function(t,r){r.prototype.isSameOrBefore=function(s,i){return this.isSame(s,i)||this.isBefore(s,i)}}})})(u0e);var h0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){return function(t,r,s){var i=r.prototype,a=function(f){return f&&(f.indexOf?f:f.s)},o=function(f,p,g,v,y){var _=f.name?f:f.$locale(),w=a(_[p]),b=a(_[g]),S=w||b.map(function(P){return P.slice(0,v)});if(!y)return S;var T=_.weekStart;return S.map(function(P,R){return S[(R+(T||0))%7]})},l=function(){return s.Ls[s.locale()]},u=function(f,p){return f.formats[p]||function(g){return g.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,y,_){return y||_.slice(1)})}(f.formats[p.toUpperCase()])},h=function(){var f=this;return{months:function(p){return p?p.format("MMMM"):o(f,"months")},monthsShort:function(p){return p?p.format("MMM"):o(f,"monthsShort","months",3)},firstDayOfWeek:function(){return f.$locale().weekStart||0},weekdays:function(p){return p?p.format("dddd"):o(f,"weekdays")},weekdaysMin:function(p){return p?p.format("dd"):o(f,"weekdaysMin","weekdays",2)},weekdaysShort:function(p){return p?p.format("ddd"):o(f,"weekdaysShort","weekdays",3)},longDateFormat:function(p){return u(f.$locale(),p)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};i.localeData=function(){return h.bind(this)()},s.localeData=function(){var f=l();return{firstDayOfWeek:function(){return f.weekStart||0},weekdays:function(){return s.weekdays()},weekdaysShort:function(){return s.weekdaysShort()},weekdaysMin:function(){return s.weekdaysMin()},months:function(){return s.months()},monthsShort:function(){return s.monthsShort()},longDateFormat:function(p){return u(f,p)},meridiem:f.meridiem,ordinal:f.ordinal}},s.months=function(){return o(l(),"months")},s.monthsShort=function(){return o(l(),"monthsShort","months",3)},s.weekdays=function(f){return o(l(),"weekdays",null,null,f)},s.weekdaysShort=function(f){return o(l(),"weekdaysShort","weekdays",3,f)},s.weekdaysMin=function(f){return o(l(),"weekdaysMin","weekdays",2,f)}}})})(h0e);var d0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){var t={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(r,s,i){var a=s.prototype,o=a.format;i.en.formats=t,a.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var u=this.$locale().formats,h=function(f,p){return f.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(g,v,y){var _=y&&y.toUpperCase();return v||p[y]||t[y]||p[_].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(w,b,S){return b||S.slice(1)})})}(l,u===void 0?{}:u);return o.call(this,h)}}})})(d0e);var f0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){return function(t,r,s){var i=function(a,o){if(!o||!o.length||o.length===1&&!o[0]||o.length===1&&Array.isArray(o[0])&&!o[0].length)return null;var l;o.length===1&&o[0].length>0&&(o=o[0]),l=(o=o.filter(function(h){return h}))[0];for(var u=1;u<o.length;u+=1)o[u].isValid()&&!o[u][a](l)||(l=o[u]);return l};s.max=function(){var a=[].slice.call(arguments,0);return i("isAfter",a)},s.min=function(){var a=[].slice.call(arguments,0);return i("isBefore",a)}}})})(f0e);var p0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){var t="minute",r=/[+-]\d\d(?::?\d\d)?/g,s=/([+-]|\d\d)/g;return function(i,a,o){var l=a.prototype;o.utc=function(y){var _={date:y,utc:!0,args:arguments};return new a(_)},l.utc=function(y){var _=o(this.toDate(),{locale:this.$L,utc:!0});return y?_.add(this.utcOffset(),t):_},l.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var u=l.parse;l.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),u.call(this,y)};var h=l.init;l.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else h.call(this)};var f=l.utcOffset;l.utcOffset=function(y,_){var w=this.$utils().u;if(w(y))return this.$u?0:w(this.$offset)?f.call(this):this.$offset;if(typeof y=="string"&&(y=function(P){P===void 0&&(P="");var R=P.match(r);if(!R)return null;var k=(""+R[0]).match(s)||["-",0,0],C=k[0],I=60*+k[1]+ +k[2];return I===0?0:C==="+"?I:-I}(y),y===null))return this;var b=Math.abs(y)<=16?60*y:y;if(b===0)return this.utc(_);var S=this.clone();if(_)return S.$offset=b,S.$u=!1,S;var T=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(S=this.local().add(b+T,t)).$offset=b,S.$x.$localOffset=T,S};var p=l.format;l.format=function(y){var _=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return p.call(this,_)},l.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var g=l.toDate;l.toDate=function(y){return y==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var v=l.diff;l.diff=function(y,_,w){if(y&&this.$u===y.$u)return v.call(this,y,_,w);var b=this.local(),S=o(y).local();return v.call(b,S,_,w)}}})})(p0e);var m0e={exports:{}};(function(n,e){(function(t,r){n.exports=r()})(Oi,function(){return function(t,r){r.prototype.isLeapYear=function(){return this.$y%4==0&&this.$y%100!=0||this.$y%400==0}}})})(m0e);function Fa(n){return n.children}var Ns={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},ts={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},S4=Object.keys(ts).map(function(n){return ts[n]});ue.oneOfType([ue.string,ue.func]);ue.any;ue.func;ue.oneOfType([ue.arrayOf(ue.oneOf(S4)),ue.objectOf(function(n,e){var t=S4.indexOf(e)!==-1&&typeof n[e]=="boolean";if(t)return null;for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i];return ue.elementType.apply(ue,[n,e].concat(s))})]);ue.oneOfType([ue.oneOf(["overlap","no-overlap"]),ue.func]);var E4={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function Bz(n,e){var t=vr(n,"month");return vr(t,"week",e.startOfWeek())}function zz(n,e){var t=L1(n,"month");return L1(t,"week",e.startOfWeek())}function g0e(n,e){for(var t=Bz(n,e),r=zz(n,e),s=[];Sy(t,r,"day");)s.push(t),t=Aa(t,1,"day");return s}function y0e(n,e){var t=vr(n,e);return ix(t,n)?t:Aa(t,1,e)}function v0e(n,e){for(var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",r=n,s=[];Sy(r,e,t);)s.push(r),r=Aa(r,1,t);return s}function w0e(n,e){return e==null&&n==null?null:(e==null&&(e=new Date),n==null&&(n=new Date),n=vr(n,"day"),n=q0(n,q0(e)),n=cy(n,cy(e)),n=G0(n,G0(e)),W0(n,W0(e)))}function A4(n){return q0(n)===0&&cy(n)===0&&G0(n)===0&&W0(n)===0}function b0e(n,e,t,r){return t==="day"&&(t="date"),Math.abs(o$[t](n,void 0,r)-o$[t](e,void 0,r))}function GM(n,e,t){return!t||t==="milliseconds"?Math.abs(+n-+e):Math.round(Math.abs(+vr(n,t)/E4[t]-+vr(e,t)/E4[t]))}var _0e=ue.oneOfType([ue.string,ue.func]);function x0e(n,e,t,r,s){var i=typeof r=="function"?r(t,s,n):e.call(n,t,r,s);return $0(i==null||typeof i=="string","`localizer format(..)` must return a string, null, or undefined"),i}function S0e(n,e,t){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,e+t,0,0)}function qM(n,e){return n.getTimezoneOffset()-e.getTimezoneOffset()}function E0e(n,e){return GM(n,e,"minutes")+qM(n,e)}function A0e(n){var e=vr(n,"day");return GM(e,n,"minutes")+qM(e,n)}function T0e(n,e){return pM(n,e,"day")}function C0e(n,e,t){var r=ix(n,e,"minutes");return r?ax(e,t,"minutes"):UC(e,t,"minutes")}function NI(n,e){return b0e(n,e,"day")}function k0e(n){var e=n.evtA,t=e.start,r=e.end,s=e.allDay,i=n.evtB,a=i.start,o=i.end,l=i.allDay,u=+vr(t,"day")-+vr(a,"day"),h=NI(t,r),f=NI(a,o);return u||f-h||!!l-!!s||+t-+a||+r-+o}function N0e(n){var e=n.event,t=e.start,r=e.end,s=n.range,i=s.start,a=s.end,o=vr(t,"day"),l=Sy(o,a,"day"),u=fM(o,r,"minutes"),h=u?UC(r,i,"minutes"):ax(r,i,"minutes");return l&&h}function P0e(n,e){return ix(n,e,"day")}function I0e(n,e){return A4(n)&&A4(e)}var D0e=Un(function n(e){var t=this;$n(this,n),$0(typeof e.format=="function","date localizer `format(..)` must be a function"),$0(typeof e.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=e.propType||_0e,this.formats=e.formats,this.format=function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return x0e.apply(void 0,[t,e.format].concat(s))},this.startOfWeek=e.firstOfWeek,this.merge=e.merge||w0e,this.inRange=e.inRange||$6,this.lt=e.lt||pM,this.lte=e.lte||Sy,this.gt=e.gt||UC,this.gte=e.gte||ax,this.eq=e.eq||ix,this.neq=e.neq||fM,this.startOf=e.startOf||vr,this.endOf=e.endOf||L1,this.add=e.add||Aa,this.range=e.range||v0e,this.diff=e.diff||GM,this.ceil=e.ceil||y0e,this.min=e.min||j6,this.max=e.max||F6,this.minutes=e.minutes||cy,this.daySpan=e.daySpan||NI,this.firstVisibleDay=e.firstVisibleDay||Bz,this.lastVisibleDay=e.lastVisibleDay||zz,this.visibleDays=e.visibleDays||g0e,this.getSlotDate=e.getSlotDate||S0e,this.getTimezoneOffset=e.getTimezoneOffset||function(r){return r.getTimezoneOffset()},this.getDstOffset=e.getDstOffset||qM,this.getTotalMin=e.getTotalMin||E0e,this.getMinutesFromMidnight=e.getMinutesFromMidnight||A0e,this.continuesPrior=e.continuesPrior||T0e,this.continuesAfter=e.continuesAfter||C0e,this.sortEvents=e.sortEvents||k0e,this.inEventRange=e.inEventRange||N0e,this.isSameDate=e.isSameDate||P0e,this.startAndEndAreDateOnly=e.startAndEndAreDateOnly||I0e,this.segmentOffset=e.browserTZOffset?e.browserTZOffset():0});function R0e(n,e,t,r){var s=At(At({},n.formats),t);return At(At({},n),{},{messages:r,startOfWeek:function(){return n.startOfWeek(e)},format:function(a,o){return n.format(a,s[o]||o,e)}})}var M0e=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.navigate=function(a){t.props.onNavigate(a)},t.view=function(a){t.props.onView(a)},t}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.localizer.messages,i=r.label;return H.createElement("div",{className:"rbc-toolbar"},H.createElement("span",{className:"rbc-btn-group"},H.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ns.TODAY)},s.today),H.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ns.PREVIOUS)},s.previous),H.createElement("button",{type:"button",onClick:this.navigate.bind(null,Ns.NEXT)},s.next)),H.createElement("span",{className:"rbc-toolbar-label"},i),H.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(s)))}},{key:"viewNamesGroup",value:function(r){var s=this,i=this.props.views,a=this.props.view;if(i.length>1)return i.map(function(o){return H.createElement("button",{type:"button",key:o,className:un({"rbc-active":a===o}),onClick:s.view.bind(null,o)},r[o])})}}])}(H.Component);function jt(n,e){n&&n.apply(null,[].concat(e))}var O0e={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(e){return"+".concat(e," more")}};function L0e(n){return At(At({},O0e),n)}function j0e(n){var e=n.ref,t=n.callback;B.useEffect(function(){var r=function(i){e.current&&!e.current.contains(i.target)&&t()};return document.addEventListener("mousedown",r),function(){document.removeEventListener("mousedown",r)}},[e,t])}var F0e=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],Hz=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.style,i=r.className,a=r.event,o=r.selected,l=r.isAllDay,u=r.onSelect,h=r.onDoubleClick,f=r.onKeyPress,p=r.localizer,g=r.continuesPrior,v=r.continuesAfter,y=r.accessors,_=r.getters,w=r.children,b=r.components,S=b.event,T=b.eventWrapper,P=r.slotStart,R=r.slotEnd,k=Ao(r,F0e);delete k.resizable;var C=y.title(a),I=y.tooltip(a),M=y.end(a),L=y.start(a),F=y.allDay(a),O=l||F||p.diff(L,p.ceil(M,"day"),"day")>1,Y=_.eventProp(a,L,M,o),Z=H.createElement("div",{className:"rbc-event-content",title:I||void 0},S?H.createElement(S,{event:a,continuesPrior:g,continuesAfter:v,title:C,isAllDay:F,localizer:p,slotStart:P,slotEnd:R}):C);return H.createElement(T,Object.assign({},this.props,{type:"date"}),H.createElement("div",Object.assign({},k,{style:At(At({},Y.style),s),className:un("rbc-event",i,Y.className,{"rbc-selected":o,"rbc-event-allday":O,"rbc-event-continues-prior":g,"rbc-event-continues-after":v}),onClick:function(J){return u&&u(a,J)},onDoubleClick:function(J){return h&&h(a,J)},onKeyDown:function(J){return f&&f(a,J)}}),typeof w=="function"?w(Z):Z))}}])}(H.Component);function nk(n,e){return!n||e==null?!1:ehe(n,e)}function Wz(n,e){var t=n.right-n.left,r=t/e;return r}function Gz(n,e,t,r){var s=Wz(n,r);return t?r-1-Math.floor((e-n.left)/s):Math.floor((e-n.left)/s)}function $0e(n,e){var t=e.x,r=e.y;return r>=n.top&&r<=n.bottom&&t>=n.left&&t<=n.right}function U0e(n,e,t,r,s){var i=-1,a=-1,o=r-1,l=Wz(e,r),u=Gz(e,t.x,s,r),h=e.top<t.y&&e.bottom>t.y,f=e.top<n.y&&e.bottom>n.y,p=n.y>e.bottom,g=e.top>n.y,v=t.top<e.top&&t.bottom>e.bottom;return v&&(i=0,a=o),h&&(g?(i=0,a=u):p&&(i=u,a=o)),f&&(i=a=s?o-Math.floor((n.x-e.left)/l):Math.floor((n.x-e.left)/l),h?u<i?i=u:a=u:n.y<t.y?a=o:i=0),{startIdx:i,endIdx:a}}function V0e(n){var e=n.target,t=n.offset,r=n.container,s=n.box,i=af(e),a=i.top,o=i.left,l=i.width,u=i.height,h=af(r),f=h.top,p=h.left,g=h.width,v=h.height,y=af(s),_=y.width,w=y.height,b=f+v,S=p+g,T=a+w,P=o+_,R=t.x,k=t.y,C=T>b?a-w-k:a+k+u,I=P>S?o+R-_+l:o+R;return{topOffset:C,leftOffset:I}}function B0e(n){var e=n.containerRef,t=n.accessors,r=n.getters,s=n.selected,i=n.components,a=n.localizer,o=n.position,l=n.show,u=n.events,h=n.slotStart,f=n.slotEnd,p=n.onSelect,g=n.onDoubleClick,v=n.onKeyPress,y=n.handleDragStart,_=n.popperRef,w=n.target,b=n.offset;j0e({ref:_,callback:l}),B.useLayoutEffect(function(){var P=V0e({target:w,offset:b,container:e.current,box:_.current}),R=P.topOffset,k=P.leftOffset;_.current.style.top="".concat(R,"px"),_.current.style.left="".concat(k,"px")},[b.x,b.y,w]);var S=o.width,T={minWidth:S+S/2};return H.createElement("div",{style:T,className:"rbc-overlay",ref:_},H.createElement("div",{className:"rbc-overlay-header"},a.format(h,"dayHeaderFormat")),u.map(function(P,R){return H.createElement(Hz,{key:R,type:"popup",localizer:a,event:P,getters:r,onSelect:p,accessors:t,components:i,onDoubleClick:g,onKeyPress:v,continuesPrior:a.lt(t.end(P),h,"day"),continuesAfter:a.gte(t.start(P),f,"day"),slotStart:h,slotEnd:f,selected:nk(P,s),draggable:!0,onDragStart:function(){return y(P)},onDragEnd:function(){return l()}})}))}var qz=H.forwardRef(function(n,e){return H.createElement(B0e,Object.assign({},n,{popperRef:e}))});qz.propTypes={accessors:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,components:ue.object.isRequired,localizer:ue.object.isRequired,position:ue.object.isRequired,show:ue.func.isRequired,events:ue.array.isRequired,slotStart:ue.instanceOf(Date).isRequired,slotEnd:ue.instanceOf(Date),onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func,handleDragStart:ue.func,style:ue.object,offset:ue.shape({x:ue.number,y:ue.number})};function z0e(n){var e=n.containerRef,t=n.popupOffset,r=t===void 0?5:t,s=n.overlay,i=n.accessors,a=n.localizer,o=n.components,l=n.getters,u=n.selected,h=n.handleSelectEvent,f=n.handleDoubleClickEvent,p=n.handleKeyPressEvent,g=n.handleDragStart,v=n.onHide,y=n.overlayDisplay,_=B.useRef(null);if(!s.position)return null;var w=r;isNaN(r)||(w={x:r,y:r});var b=s.position,S=s.events,T=s.date,P=s.end;return H.createElement(Cie,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:v,target:s.target},function(R){var k=R.props;return H.createElement(qz,Object.assign({},k,{containerRef:e,ref:_,target:s.target,offset:w,accessors:i,getters:l,selected:u,components:o,localizer:a,position:b,show:y,events:S,slotStart:T,slotEnd:P,onSelect:h,onDoubleClick:f,onKeyPress:p,handleDragStart:g}))})}var YM=H.forwardRef(function(n,e){return H.createElement(z0e,Object.assign({},n,{containerRef:e}))});YM.propTypes={popupOffset:ue.oneOfType([ue.number,ue.shape({x:ue.number,y:ue.number})]),overlay:ue.shape({position:ue.object,events:ue.array,date:ue.instanceOf(Date),end:ue.instanceOf(Date)}),accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,handleSelectEvent:ue.func,handleDoubleClickEvent:ue.func,handleKeyPressEvent:ue.func,handleDragStart:ue.func,onHide:ue.func,overlayDisplay:ue.func};function Tr(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Av(t,n,e,{passive:!1})}function H0e(n,e,t){return!n||Y0(n,document.elementFromPoint(e,t))}function W0e(n,e){var t=e.clientX,r=e.clientY,s=document.elementFromPoint(t,r);return wz(s,".rbc-event",n)}function G0e(n,e){var t=e.clientX,r=e.clientY,s=document.elementFromPoint(t,r);return wz(s,".rbc-show-more",n)}function z1(n,e){return!!W0e(n,e)}function q0e(n,e){return!!G0e(n,e)}function lv(n){var e=n;return n.touches&&n.touches.length&&(e=n.touches[0]),{clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var T4=5,Y0e=250,Yz=function(){function n(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.global,s=r===void 0?!1:r,i=t.longPressThreshold,a=i===void 0?250:i,o=t.validContainers,l=o===void 0?[]:o;$n(this,n),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=e,this.globalMouse=!e||s,this.longPressThreshold=a,this.validContainers=l,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=Tr("touchmove",function(){},window),this._removeKeyDownListener=Tr("keydown",this._keyListener),this._removeKeyUpListener=Tr("keyup",this._keyListener),this._removeDropFromOutsideListener=Tr("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=Tr("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return Un(n,[{key:"on",value:function(t,r){var s=this._listeners[t]||(this._listeners[t]=[]);return s.push(r),{remove:function(){var a=s.indexOf(r);a!==-1&&s.splice(a,1)}}}},{key:"emit",value:function(t){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];var a,o=this._listeners[t]||[];return o.forEach(function(l){a===void 0&&(a=l.apply(void 0,s))}),a}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(t){var r=this._selectRect;return!r||!this.selecting?!1:C4(r,kf(t))}},{key:"filter",value:function(t){var r=this._selectRect;return!r||!this.selecting?[]:t.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(t,r){var s=this,i=null,a=null,o=null,l=function(p){i=setTimeout(function(){h(),t(p)},s.longPressThreshold),a=Tr("touchmove",function(){return h()}),o=Tr("touchend",function(){return h()})},u=Tr("touchstart",l),h=function(){i&&clearTimeout(i),a&&a(),o&&o(),i=null,a=null,o=null};return r&&l(r),function(){h(),u()}}},{key:"_addInitialEventListener",value:function(){var t=this,r=Tr("mousedown",function(i){t._removeInitialEventListener(),t._handleInitialEvent(i),t._removeInitialEventListener=Tr("mousedown",t._handleInitialEvent)}),s=Tr("touchstart",function(i){t._removeInitialEventListener(),t._removeInitialEventListener=t._addLongPressListener(t._handleInitialEvent,i)});this._removeInitialEventListener=function(){r(),s()}}},{key:"_dropFromOutsideListener",value:function(t){var r=lv(t),s=r.pageX,i=r.pageY,a=r.clientX,o=r.clientY;this.emit("dropFromOutside",{x:s,y:i,clientX:a,clientY:o}),t.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(t){var r=lv(t),s=r.pageX,i=r.pageY,a=r.clientX,o=r.clientY;this.emit("dragOverFromOutside",{x:s,y:i,clientX:a,clientY:o}),t.preventDefault()}},{key:"_handleInitialEvent",value:function(t){if(this._initialEvent=t,!this.isDetached){var r=lv(t),s=r.clientX,i=r.clientY,a=r.pageX,o=r.pageY,l=this.container(),u,h;if(!(t.which===3||t.button===2||!H0e(l,s,i))){if(!this.globalMouse&&l&&!Y0(l,t.target)){var f=K0e(0),p=f.top,g=f.left,v=f.bottom,y=f.right;if(h=kf(l),u=C4({top:h.top-p,left:h.left-g,bottom:h.bottom+v,right:h.right+y},{top:o,left:a}),!u)return}var _=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(t.type),x:a,y:o,clientX:s,clientY:i});if(_!==!1)switch(t.type){case"mousedown":this._removeEndListener=Tr("mouseup",this._handleTerminatingEvent),this._onEscListener=Tr("keydown",this._handleTerminatingEvent),this._removeMoveListener=Tr("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(t),this._removeEndListener=Tr("touchend",this._handleTerminatingEvent),this._removeMoveListener=Tr("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(t){var r=t.target,s=this.validContainers;return!s||!s.length||!r?!0:s.some(function(i){return!!r.closest(i)})}},{key:"_handleTerminatingEvent",value:function(t){var r=this.selecting,s=this._selectRect;if(!r&&t.type.includes("key")&&(t=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!t){var i=!this.container||Y0(this.container(),t.target),a=this._isWithinValidContainer(t);return t.key==="Escape"||!a?this.emit("reset"):!r&&i?this._handleClickEvent(t):r?this.emit("select",s):this.emit("reset")}}},{key:"_handleClickEvent",value:function(t){var r=lv(t),s=r.pageX,i=r.pageY,a=r.clientX,o=r.clientY,l=new Date().getTime();return this._lastClickData&&l-this._lastClickData.timestamp<Y0e?(this._lastClickData=null,this.emit("doubleClick",{x:s,y:i,clientX:a,clientY:o})):(this._lastClickData={timestamp:l},this.emit("click",{x:s,y:i,clientX:a,clientY:o}))}},{key:"_handleMoveEvent",value:function(t){if(!(this._initialEventData===null||this.isDetached)){var r=this._initialEventData,s=r.x,i=r.y,a=lv(t),o=a.pageX,l=a.pageY,u=Math.abs(s-o),h=Math.abs(i-l),f=Math.min(o,s),p=Math.min(l,i),g=this.selecting,v=this.isClick(o,l);v&&!g&&!(u||h)||(!g&&!v&&this.emit("selectStart",this._initialEventData),v||(this.selecting=!0,this._selectRect={top:p,left:f,x:o,y:l,right:f+u,bottom:p+h},this.emit("selecting",this._selectRect)),t.preventDefault())}}},{key:"_keyListener",value:function(t){this.ctrl=t.metaKey||t.ctrlKey}},{key:"isClick",value:function(t,r){var s=this._initialEventData,i=s.x,a=s.y,o=s.isTouch;return!o&&Math.abs(t-i)<=T4&&Math.abs(r-a)<=T4}}])}();function K0e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return Kl(n)!=="object"&&(n={top:n,left:n,right:n,bottom:n}),n}function C4(n,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=kf(n),s=r.top,i=r.left,a=r.right,o=a===void 0?i:a,l=r.bottom,u=l===void 0?s:l,h=kf(e),f=h.top,p=h.left,g=h.right,v=g===void 0?p:g,y=h.bottom,_=y===void 0?f:y;return!(u-t<f||s+t>_||o-t<p||i+t>v)}function kf(n){if(!n.getBoundingClientRect)return n;var e=n.getBoundingClientRect(),t=e.left+k4("left"),r=e.top+k4("top");return{top:r,left:t,right:(n.offsetWidth||0)+t,bottom:(n.offsetHeight||0)+r}}function k4(n){if(n==="left")return window.pageXOffset||document.body.scrollLeft||0;if(n==="top")return window.pageYOffset||document.body.scrollTop||0}var X0e=function(n){function e(t,r){var s;return $n(this,e),s=Vr(this,e,[t,r]),s.state={selecting:!1},s.containerRef=B.createRef(),s}return Br(e,n),Un(e,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(r){!r.selectable&&this.props.selectable&&this._selectable(),r.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var r=this.props,s=r.range,i=r.getNow,a=r.getters,o=r.date,l=r.components.dateCellWrapper,u=r.localizer,h=this.state,f=h.selecting,p=h.startIdx,g=h.endIdx,v=i();return H.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},s.map(function(y,_){var w=f&&_>=p&&_<=g,b=a.dayProp(y),S=b.className,T=b.style;return H.createElement(l,{key:_,value:y,range:s},H.createElement("div",{style:T,className:un("rbc-day-bg",S,w&&"rbc-selected-cell",u.isSameDate(y,v)&&"rbc-today",o&&u.neq(o,y,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var r=this,s=this.containerRef.current,i=this._selector=new Yz(this.props.container,{longPressThreshold:this.props.longPressThreshold}),a=function(l,u){if(!z1(s,l)&&!q0e(s,l)){var h=kf(s),f=r.props,p=f.range,g=f.rtl;if($0e(h,l)){var v=Gz(h,l.x,g,p.length);r._selectSlot({startIdx:v,endIdx:v,action:u,box:l})}}r._initial={},r.setState({selecting:!1})};i.on("selecting",function(o){var l=r.props,u=l.range,h=l.rtl,f=-1,p=-1;if(r.state.selecting||(jt(r.props.onSelectStart,[o]),r._initial={x:o.x,y:o.y}),i.isSelected(s)){var g=kf(s),v=U0e(r._initial,g,o,u.length,h);f=v.startIdx,p=v.endIdx}r.setState({selecting:!0,startIdx:f,endIdx:p})}),i.on("beforeSelect",function(o){if(r.props.selectable==="ignoreEvents")return!z1(r.containerRef.current,o)}),i.on("click",function(o){return a(o,"click")}),i.on("doubleClick",function(o){return a(o,"doubleClick")}),i.on("select",function(o){r._selectSlot(At(At({},r.state),{},{action:"select",bounds:o})),r._initial={},r.setState({selecting:!1}),jt(r.props.onSelectEnd,[r.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(r){var s=r.endIdx,i=r.startIdx,a=r.action,o=r.bounds,l=r.box;s!==-1&&i!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:i,end:s,action:a,bounds:o,box:l,resourceId:this.props.resourceId})}}])}(H.Component),Pi={propTypes:{slotMetrics:ue.object.isRequired,selected:ue.object,isAllDay:ue.bool,accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func},defaultProps:{segments:[],selected:{}},renderEvent:function(e,t){var r=e.selected;e.isAllDay;var s=e.accessors,i=e.getters,a=e.onSelect,o=e.onDoubleClick,l=e.onKeyPress,u=e.localizer,h=e.slotMetrics,f=e.components,p=e.resizable,g=h.continuesPrior(t),v=h.continuesAfter(t);return H.createElement(Hz,{event:t,getters:i,localizer:u,accessors:s,components:f,onSelect:a,onDoubleClick:o,onKeyPress:l,continuesPrior:g,continuesAfter:v,slotStart:h.first,slotEnd:h.last,selected:nk(t,r),resizable:p})},renderSpan:function(e,t,r){var s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",i=Math.abs(t)/e*100+"%";return H.createElement("div",{key:r,className:"rbc-row-segment",style:{WebkitFlexBasis:i,flexBasis:i,maxWidth:i}},s)}},Kz=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this,s=this.props,i=s.segments,a=s.slotMetrics.slots,o=s.className,l=1;return H.createElement("div",{className:un(o,"rbc-row")},i.reduce(function(u,h,f){var p=h.event,g=h.left,v=h.right,y=h.span,_="_lvl_"+f,w=g-l,b=Pi.renderEvent(r.props,p);return w&&u.push(Pi.renderSpan(a,w,"".concat(_,"_gap"))),u.push(Pi.renderSpan(a,y,_,b)),l=v+1,u},[]))}}])}(H.Component);Kz.defaultProps=At({},Pi.defaultProps);function Xz(n){var e=n.dateRange,t=n.unit,r=t===void 0?"day":t,s=n.localizer;return{first:e[0],last:s.add(e[e.length-1],1,r)}}function Q0e(n,e,t,r){var s=Xz({dateRange:e,localizer:r}),i=s.first,a=s.last,o=r.diff(i,a,"day"),l=r.max(r.startOf(t.start(n),"day"),i),u=r.min(r.ceil(t.end(n),"day"),a),h=tfe(e,function(p){return r.isSameDate(p,l)}),f=r.diff(l,u,"day");return f=Math.min(f,o),f=Math.max(f-r.segmentOffset,1),{event:n,span:f,left:h+1,right:Math.max(h+f,1)}}function PI(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,t,r,s,i=[],a=[];for(t=0;t<n.length;t++){for(s=n[t],r=0;r<i.length&&J0e(s,i[r]);r++);r>=e?a.push(s):(i[r]||(i[r]=[])).push(s)}for(t=0;t<i.length;t++)i[t].sort(function(o,l){return o.left-l.left});return{levels:i,extra:a}}function Q0(n,e,t,r,s){var i={start:r.start(n),end:r.end(n)},a={start:e,end:t};return s.inEventRange({event:i,range:a})}function J0e(n,e){return e.some(function(t){return t.left<=n.right&&t.right>=n.left})}function Z0e(n,e,t){var r=nE(n),s=[],i=[];r.forEach(function(l){var u=e.start(l),h=e.end(l);t.daySpan(u,h)>1?s.push(l):i.push(l)});var a=s.sort(function(l,u){return II(l,u,e,t)}),o=i.sort(function(l,u){return II(l,u,e,t)});return[].concat(nE(a),nE(o))}function II(n,e,t,r){var s={start:t.start(n),end:t.end(n),allDay:t.allDay(n)},i={start:t.start(e),end:t.end(e),allDay:t.allDay(e)};return r.sortEvents({evtA:s,evtB:i})}var DI=function(e,t){return e.left<=t&&e.right>=t},DN=function(e,t){return e.filter(function(r){return DI(r,t)}).map(function(r){return r.event})},Qz=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){for(var r=this.props,s=r.segments,i=r.slotMetrics.slots,a=PI(s).levels[0],o=1,l=1,u=[];o<=i;){var h="_lvl_"+o,f=a.filter(function(T){return DI(T,o)})[0]||{},p=f.event,g=f.left,v=f.right,y=f.span;if(!p){var _=this.getHiddenEventsForSlot(s,o);if(_.length>0){var w=o-l;w&&u.push(Pi.renderSpan(i,w,h+"_gap")),u.push(Pi.renderSpan(i,1,h,this.renderShowMore(s,o))),l=o=o+1;continue}o++;continue}var b=Math.max(0,g-l);if(this.canRenderSlotEvent(g,y)){var S=Pi.renderEvent(this.props,p);b&&u.push(Pi.renderSpan(i,b,h+"_gap")),u.push(Pi.renderSpan(i,y,h,S)),l=o=v+1}else b&&u.push(Pi.renderSpan(i,b,h+"_gap")),u.push(Pi.renderSpan(i,1,h,this.renderShowMore(s,o))),l=o=o+1}return H.createElement("div",{className:"rbc-row"},u)}},{key:"getHiddenEventsForSlot",value:function(r,s){var i=DN(r,s),a=PI(r).levels[0],o=a.filter(function(l){return DI(l,s)}).map(function(l){return l.event});return i.filter(function(l){return!o.some(function(u){return u===l})})}},{key:"canRenderSlotEvent",value:function(r,s){var i=this.props.segments;return ffe(r,r+s).every(function(a){var o=DN(i,a).length;return o===1})}},{key:"renderShowMore",value:function(r,s){var i=this,a=this.props,o=a.localizer,l=a.slotMetrics,u=a.components,h=l.getEventsForSlot(s),f=DN(r,s),p=f.length;if(u!=null&&u.showMore){var g=u.showMore,v=l.getDateForSlot(s-1);return p?H.createElement(g,{localizer:o,slotDate:v,slot:s,count:p,events:h,remainingEvents:f}):!1}return p?H.createElement("button",{type:"button",key:"sm_"+s,className:un("rbc-button-link","rbc-show-more"),onClick:function(_){return i.showMore(s,_)}},o.messages.showMore(p,f,h)):!1}},{key:"showMore",value:function(r,s){s.preventDefault(),s.stopPropagation(),this.props.onShowMore(r,s.target)}}])}(H.Component);Qz.defaultProps=At({},Pi.defaultProps);var ewe=function(e){var t=e.children;return H.createElement("div",{className:"rbc-row-content-scroll-container"},t)},twe=function(e,t){return e.left<=t&&e.right>=t},nwe=function(e,t){return e[0].range===t[0].range&&e[0].events===t[0].events};function Jz(){return Ez(function(n){for(var e=n.range,t=n.events,r=n.maxRows,s=n.minRows,i=n.accessors,a=n.localizer,o=Xz({dateRange:e,localizer:a}),l=o.first,u=o.last,h=t.map(function(y){return Q0e(y,e,i,a)}),f=PI(h,Math.max(r-1,1)),p=f.levels,g=f.extra,v=g.length>0?s-1:s;p.length<v;)p.push([]);return{first:l,last:u,levels:p,extra:g,range:e,slots:e.length,clone:function(_){var w=Jz();return w(At(At({},n),_))},getDateForSlot:function(_){return e[_]},getSlotForDate:function(_){return e.find(function(w){return a.isSameDate(w,_)})},getEventsForSlot:function(_){return h.filter(function(w){return twe(w,_)}).map(function(w){return w.event})},continuesPrior:function(_){return a.continuesPrior(i.start(_),l)},continuesAfter:function(_){var w=i.start(_),b=i.end(_);return a.continuesAfter(w,b,u)}}},nwe)}var J0=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.handleSelectSlot=function(a){var o=t.props,l=o.range,u=o.onSelectSlot;u(l.slice(a.start,a.end+1),a)},t.handleShowMore=function(a,o){var l=t.props,u=l.range,h=l.onShowMore,f=t.slotMetrics(t.props),p=Jre(t.containerRef.current,".rbc-row-bg")[0],g;p&&(g=p.children[a-1]);var v=f.getEventsForSlot(a);h(v,u[a-1],g,a,o)},t.getContainer=function(){var a=t.props.container;return a?a():t.containerRef.current},t.renderHeadingCell=function(a,o){var l=t.props,u=l.renderHeader,h=l.getNow,f=l.localizer;return u({date:a,key:"header_".concat(o),className:un("rbc-date-cell",f.isSameDate(a,h())&&"rbc-now")})},t.renderDummy=function(){var a=t.props,o=a.className,l=a.range,u=a.renderHeader,h=a.showAllEvents;return H.createElement("div",{className:o,ref:t.containerRef},H.createElement("div",{className:un("rbc-row-content",h&&"rbc-row-content-scrollable")},u&&H.createElement("div",{className:"rbc-row",ref:t.headingRowRef},l.map(t.renderHeadingCell)),H.createElement("div",{className:"rbc-row",ref:t.eventRowRef},H.createElement("div",{className:"rbc-row-segment"},H.createElement("div",{className:"rbc-event"},H.createElement("div",{className:"rbc-event-content"},""))))))},t.containerRef=B.createRef(),t.headingRowRef=B.createRef(),t.eventRowRef=B.createRef(),t.slotMetrics=Jz(),t}return Br(e,n),Un(e,[{key:"getRowLimit",value:function(){var r,s=NN(this.eventRowRef.current),i=(r=this.headingRowRef)!==null&&r!==void 0&&r.current?NN(this.headingRowRef.current):0,a=NN(this.containerRef.current)-i;return Math.max(Math.floor(a/s),1)}},{key:"render",value:function(){var r=this.props,s=r.date,i=r.rtl,a=r.range,o=r.className,l=r.selected,u=r.selectable,h=r.renderForMeasure,f=r.accessors,p=r.getters,g=r.components,v=r.getNow,y=r.renderHeader,_=r.onSelect,w=r.localizer,b=r.onSelectStart,S=r.onSelectEnd,T=r.onDoubleClick,P=r.onKeyPress,R=r.resourceId,k=r.longPressThreshold,C=r.isAllDay,I=r.resizable,M=r.showAllEvents;if(h)return this.renderDummy();var L=this.slotMetrics(this.props),F=L.levels,O=L.extra,Y=M?ewe:Fa,Z=g.weekWrapper,X={selected:l,accessors:f,getters:p,localizer:w,components:g,onSelect:_,onDoubleClick:T,onKeyPress:P,resourceId:R,slotMetrics:L,resizable:I};return H.createElement("div",{className:o,role:"rowgroup",ref:this.containerRef},H.createElement(X0e,{localizer:w,date:s,getNow:v,rtl:i,range:a,selectable:u,container:this.getContainer,getters:p,onSelectStart:b,onSelectEnd:S,onSelectSlot:this.handleSelectSlot,components:g,longPressThreshold:k,resourceId:R}),H.createElement("div",{className:un("rbc-row-content",M&&"rbc-row-content-scrollable"),role:"row"},y&&H.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},a.map(this.renderHeadingCell)),H.createElement(Y,null,H.createElement(Z,Object.assign({isAllDay:C},X,{rtl:this.props.rtl}),F.map(function(J,K){return H.createElement(Kz,Object.assign({key:K,segments:J},X))}),!!O.length&&H.createElement(Qz,Object.assign({segments:O,onShowMore:this.handleShowMore},X))))))}}])}(H.Component);J0.defaultProps={minRows:0,maxRows:1/0};var KM=function(e){var t=e.label;return H.createElement("span",{role:"columnheader","aria-sort":"none"},t)},rwe=function(e){var t=e.label,r=e.drilldownView,s=e.onDrillDown;return r?H.createElement("button",{type:"button",className:"rbc-button-link",onClick:s},t):H.createElement("span",null,t)},swe=["date","className"],iwe=function(e,t,r,s,i){return e.filter(function(a){return Q0(a,t,r,s,i)})},rk=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.getContainer=function(){return t.containerRef.current},t.renderWeek=function(a,o){var l=t.props,u=l.events,h=l.components,f=l.selectable,p=l.getNow,g=l.selected,v=l.date,y=l.localizer,_=l.longPressThreshold,w=l.accessors,b=l.getters,S=l.showAllEvents,T=t.state,P=T.needLimitMeasure,R=T.rowLimit,k=iwe(nE(u),a[0],a[a.length-1],w,y),C=Z0e(k,w,y);return H.createElement(J0,{key:o,ref:o===0?t.slotRowRef:void 0,container:t.getContainer,className:"rbc-month-row",getNow:p,date:v,range:a,events:C,maxRows:S?1/0:R,selected:g,selectable:f,components:h,accessors:w,getters:b,localizer:y,renderHeader:t.readerDateHeading,renderForMeasure:P,onShowMore:t.handleShowMore,onSelect:t.handleSelectEvent,onDoubleClick:t.handleDoubleClickEvent,onKeyPress:t.handleKeyPressEvent,onSelectSlot:t.handleSelectSlot,longPressThreshold:_,rtl:t.props.rtl,resizable:t.props.resizable,showAllEvents:S})},t.readerDateHeading=function(a){var o=a.date,l=a.className,u=Ao(a,swe),h=t.props,f=h.date,p=h.getDrilldownView,g=h.localizer,v=g.neq(f,o,"month"),y=g.isSameDate(o,f),_=p(o),w=g.format(o,"dateFormat"),b=t.props.components.dateHeader||rwe;return H.createElement("div",Object.assign({},u,{className:un(l,v&&"rbc-off-range",y&&"rbc-current"),role:"cell"}),H.createElement(b,{label:w,date:o,drilldownView:_,isOffRange:v,onDrillDown:function(T){return t.handleHeadingClick(o,_,T)}}))},t.handleSelectSlot=function(a,o){t._pendingSelection=t._pendingSelection.concat(a),clearTimeout(t._selectTimer),t._selectTimer=setTimeout(function(){return t.selectDates(o)})},t.handleHeadingClick=function(a,o,l){l.preventDefault(),t.clearSelection(),jt(t.props.onDrillDown,[a,o])},t.handleSelectEvent=function(){t.clearSelection();for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onSelectEvent,o)},t.handleDoubleClickEvent=function(){t.clearSelection();for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onDoubleClickEvent,o)},t.handleKeyPressEvent=function(){t.clearSelection();for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onKeyPressEvent,o)},t.handleShowMore=function(a,o,l,u,h){var f=t.props,p=f.popup,g=f.onDrillDown,v=f.onShowMore,y=f.getDrilldownView,_=f.doShowMoreDrillDown;if(t.clearSelection(),p){var w=J6(l,t.containerRef.current);t.setState({overlay:{date:o,events:a,position:w,target:h}})}else _&&jt(g,[o,y(o)||ts.DAY]);jt(v,[a,o,u])},t.overlayDisplay=function(){t.setState({overlay:null})},t.state={rowLimit:5,needLimitMeasure:!0,date:null},t.containerRef=B.createRef(),t.slotRowRef=B.createRef(),t._bgRows=[],t._pendingSelection=[],t}return Br(e,n),Un(e,[{key:"componentDidMount",value:function(){var r=this,s;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){s||Z6(function(){s=!1,r.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var r=this.props,s=r.date,i=r.localizer,a=r.className,o=i.visibleDays(s,i),l=Lre(o,7);return this._weekCount=l.length,H.createElement("div",{className:un("rbc-month-view",a),role:"table","aria-label":"Month View",ref:this.containerRef},H.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(r){var s=this.props,i=s.localizer,a=s.components,o=r[0],l=r[r.length-1],u=a.header||KM;return i.range(o,l,"day").map(function(h,f){return H.createElement("div",{key:"header_"+f,className:"rbc-header"},H.createElement(u,{date:h,localizer:i,label:i.format(h,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var r,s,i=this,a=(r=(s=this.state)===null||s===void 0?void 0:s.overlay)!==null&&r!==void 0?r:{},o=this.props,l=o.accessors,u=o.localizer,h=o.components,f=o.getters,p=o.selected,g=o.popupOffset,v=o.handleDragStart,y=function(){return i.setState({overlay:null})};return H.createElement(YM,{overlay:a,accessors:l,localizer:u,components:h,getters:f,selected:p,popupOffset:g,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!a.position,overlayDisplay:this.overlayDisplay,onHide:y})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(r){var s=this._pendingSelection.slice();this._pendingSelection=[],s.sort(function(o,l){return+o-+l});var i=new Date(s[0]),a=new Date(s[s.length-1]);a.setDate(s[s.length-1].getDate()+1),jt(this.props.onSelectSlot,{slots:s,start:i,end:a,action:r.action,bounds:r.bounds,box:r.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(r,s){var i=r.date,a=r.localizer;return{date:i,needLimitMeasure:a.neq(i,s.date,"month")}}}])}(H.Component);rk.range=function(n,e){var t=e.localizer,r=t.firstVisibleDay(n,t),s=t.lastVisibleDay(n,t);return{start:r,end:s}};rk.navigate=function(n,e,t){var r=t.localizer;switch(e){case Ns.PREVIOUS:return r.add(n,-1,"month");case Ns.NEXT:return r.add(n,1,"month");default:return n}};rk.title=function(n,e){var t=e.localizer;return t.format(n,"monthHeaderFormat")};var N4=function(e){var t=e.min,r=e.max,s=e.step,i=e.slots,a=e.localizer;return"".concat(+a.startOf(t,"minutes"))+"".concat(+a.startOf(r,"minutes"))+"".concat(s,"-").concat(i)};function XM(n){for(var e=n.min,t=n.max,r=n.step,s=n.timeslots,i=n.localizer,a=N4({start:e,end:t,step:r,timeslots:s,localizer:i}),o=1+i.getTotalMin(e,t),l=i.getMinutesFromMidnight(e),u=Math.ceil((o-1)/(r*s)),h=u*s,f=new Array(u),p=new Array(h),g=0;g<u;g++){f[g]=new Array(s);for(var v=0;v<s;v++){var y=g*s+v,_=y*r;p[y]=f[g][v]=i.getSlotDate(e,l,_)}}var w=p.length*r;p.push(i.getSlotDate(e,l,w));function b(S){var T=i.diff(e,S,"minutes")+i.getDstOffset(e,S);return Math.min(T,o)}return{groups:f,update:function(T){return N4(T)!==a?XM(T):this},dateIsInGroup:function(T,P){var R=f[P+1];return i.inRange(T,f[P][0],R?R[0]:t,"minutes")},nextSlot:function(T){var P=p[Math.min(p.findIndex(function(R){return R===T||i.eq(R,T)})+1,p.length-1)];return i.eq(P,T)&&(P=i.add(T,r,"minutes")),P},closestSlotToPosition:function(T){var P=Math.min(p.length-1,Math.max(0,Math.floor(T*h)));return p[P]},closestSlotFromPoint:function(T,P){var R=Math.abs(P.top-P.bottom);return this.closestSlotToPosition((T.y-P.top)/R)},closestSlotFromDate:function(T){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(i.lt(T,e,"minutes"))return p[0];if(i.gt(T,t,"minutes"))return p[p.length-1];var R=i.diff(e,T,"minutes");return p[(R-R%r)/r+P]},startsBeforeDay:function(T){return i.lt(T,e,"day")},startsAfterDay:function(T){return i.gt(T,t,"day")},startsBefore:function(T){return i.lt(i.merge(e,T),e,"minutes")},startsAfter:function(T){return i.gt(i.merge(t,T),t,"minutes")},getRange:function(T,P,R,k){R||(T=i.min(t,i.max(e,T))),k||(P=i.min(t,i.max(e,P)));var C=b(T),I=b(P),M=I>r*h&&!i.eq(t,P)?(C-r)/(r*h)*100:C/(r*h)*100;return{top:M,height:I/(r*h)*100-M,start:b(T),startDate:T,end:b(P),endDate:P}},getCurrentTimePosition:function(T){var P=b(T),R=P/(r*h)*100;return R}}}var awe=function(){function n(e,t){var r=t.accessors,s=t.slotMetrics;$n(this,n);var i=s.getRange(r.start(e),r.end(e)),a=i.start,o=i.startDate,l=i.end,u=i.endDate,h=i.top,f=i.height;this.start=a,this.end=l,this.startMs=+o,this.endMs=+u,this.top=h,this.height=f,this.data=e}return Un(n,[{key:"_width",get:function(){if(this.rows){var t=this.rows.reduce(function(s,i){return Math.max(s,i.leaves.length+1)},0)+1;return 100/t}if(this.leaves){var r=100-this.container._width;return r/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var t=this._width,r=Math.min(100,this._width*1.7);if(this.rows)return r;if(this.leaves)return this.leaves.length>0?r:t;var s=this.row.leaves,i=s.indexOf(this);return i===s.length-1?t:r}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var t=this.row,r=t.leaves,s=t.xOffset,i=t._width,a=r.indexOf(this)+1;return s+a*i}}])}();function owe(n,e,t){return Math.abs(e.start-n.start)<t||e.start>n.start&&e.start<n.end}function lwe(n){for(var e=Rpe(n,["startMs",function(o){return-o.endMs}]),t=[];e.length>0;){var r=e.shift();t.push(r);for(var s=0;s<e.length;s++){var i=e[s];if(!(r.endMs>i.startMs)){if(s>0){var a=e.splice(s,1)[0];t.push(a)}break}}}return t}function Zz(n){for(var e=n.events,t=n.minimumStartDifference,r=n.slotMetrics,s=n.accessors,i=e.map(function(h){return new awe(h,{slotMetrics:r,accessors:s})}),a=lwe(i),o=[],l=function(){var f=a[u],p=o.find(function(y){return y.end>f.start||Math.abs(f.start-y.start)<t});if(!p)return f.rows=[],o.push(f),1;f.container=p;for(var g=null,v=p.rows.length-1;!g&&v>=0;v--)owe(p.rows[v],f,t)&&(g=p.rows[v]);g?(g.leaves.push(f),f.row=g):(f.leaves=[],p.rows.push(f))},u=0;u<a.length;u++)l();return a.map(function(h){return{event:h.data,style:{top:h.top,height:h.height,width:h.width,xOffset:Math.max(0,h.xOffset)}}})}function eH(n,e,t){for(var r=0;r<n.friends.length;++r)if(!(t.indexOf(n.friends[r])>-1)){e=e>n.friends[r].idx?e:n.friends[r].idx,t.push(n.friends[r]);var s=eH(n.friends[r],e,t);e=e>s?e:s}return e}function cwe(n){var e=n.events,t=n.minimumStartDifference,r=n.slotMetrics,s=n.accessors,i=Zz({events:e,minimumStartDifference:t,slotMetrics:r,accessors:s});i.sort(function(Z,X){return Z=Z.style,X=X.style,Z.top!==X.top?Z.top>X.top?1:-1:Z.height!==X.height?Z.top+Z.height<X.top+X.height?1:-1:0});for(var a=0;a<i.length;++a)i[a].friends=[],delete i[a].style.left,delete i[a].style.left,delete i[a].idx,delete i[a].size;for(var o=0;o<i.length-1;++o)for(var l=i[o],u=l.style.top,h=l.style.top+l.style.height,f=o+1;f<i.length;++f){var p=i[f],g=p.style.top,v=p.style.top+p.style.height;(g>=u&&v<=h||v>u&&v<=h||g>=u&&g<h)&&(l.friends.push(p),p.friends.push(l))}for(var y=0;y<i.length;++y){for(var _=i[y],w=[],b=0;b<100;++b)w.push(1);for(var S=0;S<_.friends.length;++S)_.friends[S].idx!==void 0&&(w[_.friends[S].idx]=0);_.idx=w.indexOf(1)}for(var T=0;T<i.length;++T){var P=0;if(!i[T].size){var R=[],k=eH(i[T],0,R);P=100/(k+1),i[T].size=P;for(var C=0;C<R.length;++C)R[C].size=P}}for(var I=0;I<i.length;++I){var M=i[I];M.style.left=M.idx*M.size;for(var L=0,F=0;F<M.friends.length;++F){var O=M.friends[F].idx;L=L>O?L:O}L<=M.idx&&(M.size=100-M.idx*M.size);var Y=M.idx===0?0:3;M.style.width="calc(".concat(M.size,"% - ").concat(Y,"px)"),M.style.height="calc(".concat(M.style.height,"% - 2px)"),M.style.xOffset="calc(".concat(M.style.left,"% + ").concat(Y,"px)")}return i}var P4={overlap:Zz,"no-overlap":cwe};function uwe(n){return!!(n&&n.constructor&&n.call&&n.apply)}function hwe(n){n.events,n.minimumStartDifference,n.slotMetrics,n.accessors;var e=n.dayLayoutAlgorithm,t=e;return e in P4&&(t=P4[e]),uwe(t)?t.apply(this,arguments):[]}var tH=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.renderSlot,i=r.resource,a=r.group,o=r.getters,l=r.components,u=l===void 0?{}:l,h=u.timeSlotWrapper,f=h===void 0?Fa:h,p=o?o.slotGroupProp(a):{};return H.createElement("div",Object.assign({className:"rbc-timeslot-group"},p),a.map(function(g,v){var y=o?o.slotProp(g,i):{};return H.createElement(f,{key:v,value:g,resource:i},H.createElement("div",Object.assign({},y,{className:un("rbc-time-slot",y.className)}),s&&s(g,v)))}))}}])}(B.Component);function wS(n){return typeof n=="string"?n:n+"%"}function dwe(n){var e=n.style,t=n.className,r=n.event,s=n.accessors,i=n.rtl,a=n.selected,o=n.label,l=n.continuesPrior,u=n.continuesAfter,h=n.getters,f=n.onClick,p=n.onDoubleClick,g=n.isBackgroundEvent,v=n.onKeyPress,y=n.components,_=y.event,w=y.eventWrapper,b=s.title(r),S=s.tooltip(r),T=s.end(r),P=s.start(r),R=h.eventProp(r,P,T,a),k=[H.createElement("div",{key:"1",className:"rbc-event-label"},o),H.createElement("div",{key:"2",className:"rbc-event-content"},_?H.createElement(_,{event:r,title:b}):b)],C=e.height,I=e.top,M=e.width,L=e.xOffset,F=At(At({},R.style),{},vh({top:wS(I),height:wS(C),width:wS(M)},i?"right":"left",wS(L)));return H.createElement(w,Object.assign({type:"time"},n),H.createElement("div",{role:"button",tabIndex:0,onClick:f,onDoubleClick:p,style:F,onKeyDown:v,title:S?(typeof o=="string"?o+": ":"")+S:void 0,className:un(g?"rbc-background-event":"rbc-event",t,R.className,{"rbc-selected":a,"rbc-event-continues-earlier":l,"rbc-event-continues-later":u})},k))}var fwe=function(e){var t=e.children,r=e.className,s=e.style,i=e.innerRef;return H.createElement("div",{className:r,style:s,ref:i},t)},pwe=H.forwardRef(function(n,e){return H.createElement(fwe,Object.assign({},n,{innerRef:e}))}),mwe=["dayProp"],gwe=["eventContainerWrapper","timeIndicatorWrapper"],nH=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.state={selecting:!1,timeIndicatorPosition:null},t.intervalTriggered=!1,t.renderEvents=function(a){var o=a.events,l=a.isBackgroundEvent,u=t.props,h=u.rtl,f=u.selected,p=u.accessors,g=u.localizer,v=u.getters,y=u.components,_=u.step,w=u.timeslots,b=u.dayLayoutAlgorithm,S=u.resizable,T=t,P=T.slotMetrics,R=g.messages,k=hwe({events:o,accessors:p,slotMetrics:P,minimumStartDifference:Math.ceil(_*w/2),dayLayoutAlgorithm:b});return k.map(function(C,I){var M,L=C.event,F=C.style,O=p.end(L),Y=p.start(L),Z=(M=p.eventId(L))!==null&&M!==void 0?M:"evt_"+I,X="eventTimeRangeFormat",J,K=P.startsBeforeDay(Y),te=P.startsAfterDay(O);K?X="eventTimeRangeEndFormat":te&&(X="eventTimeRangeStartFormat"),K&&te?J=R.allDay:J=g.format({start:Y,end:O},X);var ae=K||P.startsBefore(Y),q=te||P.startsAfter(O);return H.createElement(dwe,{style:F,event:L,label:J,key:Z,getters:v,rtl:h,components:y,continuesPrior:ae,continuesAfter:q,accessors:p,resource:t.props.resource,selected:nk(L,f),onClick:function(U){return t._select(At(At(At({},L),t.props.resource&&{sourceResource:t.props.resource}),l&&{isBackgroundEvent:!0}),U)},onDoubleClick:function(U){return t._doubleClick(L,U)},isBackgroundEvent:l,onKeyPress:function(U){return t._keyPress(L,U)},resizable:S})})},t._selectable=function(){var a=t.containerRef.current,o=t.props,l=o.longPressThreshold,u=o.localizer,h=t._selector=new Yz(function(){return a},{longPressThreshold:l}),f=function(y){var _=t.props.onSelecting,w=t.state||{},b=p(y),S=b.startDate,T=b.endDate;_&&(u.eq(w.startDate,S,"minutes")&&u.eq(w.endDate,T,"minutes")||_({start:S,end:T,resourceId:t.props.resource})===!1)||(t.state.start!==b.start||t.state.end!==b.end||t.state.selecting!==b.selecting)&&t.setState(b)},p=function(y){var _=t.slotMetrics.closestSlotFromPoint(y,kf(a));t.state.selecting||(t._initialSlot=_);var w=t._initialSlot;u.lte(w,_)?_=t.slotMetrics.nextSlot(_):u.gt(w,_)&&(w=t.slotMetrics.nextSlot(w));var b=t.slotMetrics.getRange(u.min(w,_),u.max(w,_));return At(At({},b),{},{selecting:!0,top:"".concat(b.top,"%"),height:"".concat(b.height,"%")})},g=function(y,_){if(!z1(t.containerRef.current,y)){var w=p(y),b=w.startDate,S=w.endDate;t._selectSlot({startDate:b,endDate:S,action:_,box:y})}t.setState({selecting:!1})};h.on("selecting",f),h.on("selectStart",f),h.on("beforeSelect",function(v){if(t.props.selectable==="ignoreEvents")return!z1(t.containerRef.current,v)}),h.on("click",function(v){return g(v,"click")}),h.on("doubleClick",function(v){return g(v,"doubleClick")}),h.on("select",function(v){t.state.selecting&&(t._selectSlot(At(At({},t.state),{},{action:"select",bounds:v})),t.setState({selecting:!1}))}),h.on("reset",function(){t.state.selecting&&t.setState({selecting:!1})})},t._teardownSelectable=function(){t._selector&&(t._selector.teardown(),t._selector=null)},t._selectSlot=function(a){for(var o=a.startDate,l=a.endDate,u=a.action,h=a.bounds,f=a.box,p=o,g=[];t.props.localizer.lte(p,l);)g.push(p),p=new Date(+p+t.props.step*60*1e3);jt(t.props.onSelectSlot,{slots:g,start:o,end:l,resourceId:t.props.resource,action:u,bounds:h,box:f})},t._select=function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onSelectEvent,o)},t._doubleClick=function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onDoubleClickEvent,o)},t._keyPress=function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onKeyPressEvent,o)},t.slotMetrics=XM(t.props),t.containerRef=B.createRef(),t}return Br(e,n),Un(e,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(r,s){this.props.selectable&&!r.selectable&&this._selectable(),!this.props.selectable&&r.selectable&&this._teardownSelectable();var i=this.props,a=i.getNow,o=i.isNow,l=i.localizer,u=i.date,h=i.min,f=i.max,p=l.neq(r.getNow(),a(),"minutes");if(r.isNow!==o||p){if(this.clearTimeIndicatorInterval(),o){var g=!p&&l.eq(r.date,u,"minutes")&&s.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(g)}}else o&&(l.neq(r.min,h,"minutes")||l.neq(r.max,f,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var r=this,s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!s&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){r.intervalTriggered=!0,r.positionTimeIndicator(),r.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var r=this.props,s=r.min,i=r.max,a=r.getNow,o=a();if(o>=s&&o<=i){var l=this.slotMetrics.getCurrentTimePosition(o);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:l})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var r=this.props,s=r.date,i=r.max,a=r.rtl,o=r.isNow,l=r.resource,u=r.accessors,h=r.localizer,f=r.getters,p=f.dayProp,g=Ao(f,mwe),v=r.components,y=v.eventContainerWrapper,_=v.timeIndicatorWrapper,w=Ao(v,gwe);this.slotMetrics=this.slotMetrics.update(this.props);var b=this.slotMetrics,S=this.state,T=S.selecting,P=S.top,R=S.height,k=S.startDate,C=S.endDate,I={start:k,end:C},M=p(i,l),L=M.className,F=M.style,O={className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}},Y=w.dayColumnWrapper||pwe;return H.createElement(Y,{ref:this.containerRef,date:s,style:F,className:un(L,"rbc-day-slot","rbc-time-column",o&&"rbc-now",o&&"rbc-today",T&&"rbc-slot-selecting"),slotMetrics:b,resource:l},b.groups.map(function(Z,X){return H.createElement(tH,{key:X,group:Z,resource:l,getters:g,components:w})}),H.createElement(y,{localizer:h,resource:l,accessors:u,getters:g,components:w,slotMetrics:b},H.createElement("div",{className:un("rbc-events-container",a&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),T&&H.createElement("div",{className:"rbc-slot-selection",style:{top:P,height:R}},H.createElement("span",null,h.format(I,"selectRangeFormat"))),o&&this.intervalTriggered&&H.createElement(_,O,H.createElement("div",O)))}}])}(H.Component);nH.defaultProps={dragThroughEvents:!0,timeslots:2};var rH=function(e){var t=e.label;return H.createElement(H.Fragment,null,t)},ywe=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.handleHeaderClick=function(a,o,l){l.preventDefault(),jt(t.props.onDrillDown,[a,o])},t.renderRow=function(a){var o=t.props,l=o.events,u=o.rtl,h=o.selectable,f=o.getNow,p=o.range,g=o.getters,v=o.localizer,y=o.accessors,_=o.components,w=o.resizable,b=y.resourceId(a),S=a?l.filter(function(T){return y.resource(T)===b}):l;return H.createElement(J0,{isAllDay:!0,rtl:u,getNow:f,minRows:2,maxRows:t.props.allDayMaxRows+1,range:p,events:S,resourceId:b,className:"rbc-allday-cell",selectable:h,selected:t.props.selected,components:_,accessors:y,getters:g,localizer:v,onSelect:t.props.onSelectEvent,onShowMore:t.props.onShowMore,onDoubleClick:t.props.onDoubleClickEvent,onKeyPress:t.props.onKeyPressEvent,onSelectSlot:t.props.onSelectSlot,longPressThreshold:t.props.longPressThreshold,resizable:w})},t}return Br(e,n),Un(e,[{key:"renderHeaderCells",value:function(r){var s=this,i=this.props,a=i.localizer,o=i.getDrilldownView,l=i.getNow,u=i.getters.dayProp,h=i.components.header,f=h===void 0?KM:h,p=l();return r.map(function(g,v){var y=o(g),_=a.format(g,"dayFormat"),w=u(g),b=w.className,S=w.style,T=H.createElement(f,{date:g,label:_,localizer:a});return H.createElement("div",{key:v,style:S,className:un("rbc-header",b,a.isSameDate(g,p)&&"rbc-today")},y?H.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(R){return s.handleHeaderClick(g,y,R)}},T):H.createElement("span",null,T))})}},{key:"render",value:function(){var r=this,s=this.props,i=s.width,a=s.rtl,o=s.resources,l=s.range,u=s.events,h=s.getNow,f=s.accessors,p=s.selectable,g=s.components,v=s.getters,y=s.scrollRef,_=s.localizer,w=s.isOverflowing,b=s.components,S=b.timeGutterHeader,T=b.resourceHeader,P=T===void 0?rH:T,R=s.resizable,k={};w&&(k[a?"marginLeft":"marginRight"]="".concat(kM()-1,"px"));var C=o.groupEvents(u);return H.createElement("div",{style:k,ref:y,className:un("rbc-time-header",w&&"rbc-overflowing")},H.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:i,minWidth:i,maxWidth:i}},S&&H.createElement(S,null)),o.map(function(I,M){var L=Mi(I,2),F=L[0],O=L[1];return H.createElement("div",{className:"rbc-time-header-content",key:F||M},O&&H.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(M)},H.createElement("div",{className:"rbc-header"},H.createElement(P,{index:M,label:f.resourceTitle(O),resource:O}))),H.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},r.renderHeaderCells(l)),H.createElement(J0,{isAllDay:!0,rtl:a,getNow:h,minRows:2,maxRows:r.props.allDayMaxRows+1,range:l,events:C.get(F)||[],resourceId:O&&F,className:"rbc-allday-cell",selectable:p,selected:r.props.selected,components:g,accessors:f,getters:v,localizer:_,onSelect:r.props.onSelectEvent,onShowMore:r.props.onShowMore,onDoubleClick:r.props.onDoubleClickEvent,onKeyDown:r.props.onKeyPressEvent,onSelectSlot:r.props.onSelectSlot,longPressThreshold:r.props.longPressThreshold,resizable:R}))}))}}])}(H.Component),vwe=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.handleHeaderClick=function(a,o,l){l.preventDefault(),jt(t.props.onDrillDown,[a,o])},t}return Br(e,n),Un(e,[{key:"renderHeaderCells",value:function(r){var s=this,i=this.props,a=i.localizer,o=i.getDrilldownView,l=i.getNow,u=i.getters.dayProp,h=i.components,f=h.header,p=f===void 0?KM:f,g=h.resourceHeader,v=g===void 0?rH:g,y=i.resources,_=i.accessors,w=i.events,b=i.rtl,S=i.selectable,T=i.components,P=i.getters,R=i.resizable,k=l(),C=y.groupEvents(w);return r.map(function(I,M){var L=o(I),F=a.format(I,"dayFormat"),O=u(I),Y=O.className,Z=O.style,X=H.createElement(p,{date:I,label:F,localizer:a});return H.createElement("div",{key:M,className:"rbc-time-header-content rbc-resource-grouping"},H.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(r.length<=1?" rbc-time-header-cell-single-day":"")},H.createElement("div",{style:Z,className:un("rbc-header",Y,a.isSameDate(I,k)&&"rbc-today")},L?H.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(K){return s.handleHeaderClick(I,L,K)}},X):H.createElement("span",null,X))),H.createElement("div",{className:"rbc-row"},y.map(function(J,K){var te=Mi(J,2),ae=te[0],q=te[1];return H.createElement("div",{key:"resource_".concat(ae,"_").concat(K),className:un("rbc-header",Y,a.isSameDate(I,k)&&"rbc-today")},H.createElement(v,{index:K,label:_.resourceTitle(q),resource:q}))})),H.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},y.map(function(J,K){var te=Mi(J,2),ae=te[0],q=te[1],$=(C.get(ae)||[]).filter(function(U){return a.isSameDate(U.start,I)||a.isSameDate(U.end,I)});return H.createElement(J0,{key:"resource_".concat(ae,"_").concat(K),isAllDay:!0,rtl:b,getNow:l,minRows:2,maxRows:s.props.allDayMaxRows+1,range:[I],events:$,resourceId:q&&ae,className:"rbc-allday-cell",selectable:S,selected:s.props.selected,components:T,accessors:_,getters:P,localizer:a,onSelect:s.props.onSelectEvent,onShowMore:s.props.onShowMore,onDoubleClick:s.props.onDoubleClickEvent,onKeyDown:s.props.onKeyPressEvent,onSelectSlot:s.props.onSelectSlot,longPressThreshold:s.props.longPressThreshold,resizable:R})})))})}},{key:"render",value:function(){var r=this.props,s=r.width,i=r.rtl,a=r.range,o=r.scrollRef,l=r.isOverflowing,u=r.components.timeGutterHeader,h={};return l&&(h[i?"marginLeft":"marginRight"]="".concat(kM()-1,"px")),H.createElement("div",{style:h,ref:o,className:un("rbc-time-header",l&&"rbc-overflowing")},H.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:s,minWidth:s,maxWidth:s}},u&&H.createElement(u,null)),this.renderHeaderCells(a))}}])}(H.Component);function wwe(n){var e=n.min,t=n.max,r=n.localizer;return r.getTimezoneOffset(e)!==r.getTimezoneOffset(t)?{start:r.add(e,-1,"day"),end:r.add(t,-1,"day")}:{start:e,end:t}}var bwe=function(e){var t=e.min,r=e.max,s=e.timeslots,i=e.step,a=e.localizer,o=e.getNow,l=e.resource,u=e.components,h=e.getters,f=e.gutterRef,p=u.timeGutterWrapper,g=B.useMemo(function(){return wwe({min:t,max:r,localizer:a})},[t==null?void 0:t.toISOString(),r==null?void 0:r.toISOString(),a]),v=g.start,y=g.end,_=B.useState(XM({min:v,max:y,timeslots:s,step:i,localizer:a})),w=Mi(_,2),b=w[0],S=w[1];B.useEffect(function(){b&&S(b.update({min:v,max:y,timeslots:s,step:i,localizer:a}))},[v==null?void 0:v.toISOString(),y==null?void 0:y.toISOString(),s,i]);var T=B.useCallback(function(P,R){if(R)return null;var k=b.dateIsInGroup(o(),R);return H.createElement("span",{className:un("rbc-label",k&&"rbc-now")},a.format(P,"timeGutterFormat"))},[b,a,o]);return H.createElement(p,{slotMetrics:b},H.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:f},b.groups.map(function(P,R){return H.createElement(tH,{key:R,group:P,resource:l,components:u,renderSlot:T,getters:h})})))},_we=H.forwardRef(function(n,e){return H.createElement(bwe,Object.assign({gutterRef:e},n))}),RN={};function xwe(n,e){return{map:function(r){return n?n.map(function(s,i){return r([e.resourceId(s),s],i)}):[r([RN,null],0)]},groupEvents:function(r){var s=new Map;return n?(r.forEach(function(i){var a=e.resource(i)||RN;if(Array.isArray(a))a.forEach(function(l){var u=s.get(l)||[];u.push(i),s.set(l,u)});else{var o=s.get(a)||[];o.push(i),s.set(a,o)}}),s):(s.set(RN,r),s)}}}var Dy=function(n){function e(t){var r;return $n(this,e),r=Vr(this,e,[t]),r.handleScroll=function(s){r.scrollRef.current&&(r.scrollRef.current.scrollLeft=s.target.scrollLeft)},r.handleResize=function(){g$(r.rafHandle),r.rafHandle=Z6(r.checkOverflow)},r.handleKeyPressEvent=function(){r.clearSelection();for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];jt(r.props.onKeyPressEvent,i)},r.handleSelectEvent=function(){r.clearSelection();for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];jt(r.props.onSelectEvent,i)},r.handleDoubleClickEvent=function(){r.clearSelection();for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];jt(r.props.onDoubleClickEvent,i)},r.handleShowMore=function(s,i,a,o,l){var u=r.props,h=u.popup,f=u.onDrillDown,p=u.onShowMore,g=u.getDrilldownView,v=u.doShowMoreDrillDown;if(r.clearSelection(),h){var y=J6(a,r.containerRef.current);r.setState({overlay:{date:i,events:s,position:At(At({},y),{},{width:"200px"}),target:l}})}else v&&jt(f,[i,g(i)||ts.DAY]);jt(p,[s,i,o])},r.handleSelectAllDaySlot=function(s,i){var a=r.props.onSelectSlot,o=new Date(s[0]),l=new Date(s[s.length-1]);l.setDate(s[s.length-1].getDate()+1),jt(a,{slots:s,start:o,end:l,action:i.action,resourceId:i.resourceId})},r.overlayDisplay=function(){r.setState({overlay:null})},r.checkOverflow=function(){if(!r._updatingOverflow){var s=r.contentRef.current;if(s!=null&&s.scrollHeight){var i=s.scrollHeight>s.clientHeight;r.state.isOverflowing!==i&&(r._updatingOverflow=!0,r.setState({isOverflowing:i},function(){r._updatingOverflow=!1}))}}},r.memoizedResources=Ez(function(s,i){return xwe(s,i)}),r.state={gutterWidth:void 0,isOverflowing:null},r.scrollRef=H.createRef(),r.contentRef=H.createRef(),r.containerRef=H.createRef(),r._scrollRatio=null,r.gutterRef=B.createRef(),r}return Br(e,n),Un(e,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),g$(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(r,s,i,a,o,l,u,h,f,p){var g=this.props,v=g.min,y=g.max,_=(a.get(s)||[]).filter(function(b){return l.inRange(r,u.start(b),u.end(b),"day")}),w=(o.get(s)||[]).filter(function(b){return l.inRange(r,u.start(b),u.end(b),"day")});return H.createElement(nH,Object.assign({},this.props,{localizer:l,min:l.merge(r,v),max:l.merge(r,y),resource:i&&s,components:h,isNow:l.isSameDate(r,p),key:"".concat(s,"-").concat(r),date:r,events:_,backgroundEvents:w,dayLayoutAlgorithm:f}))}},{key:"renderResourcesFirst",value:function(r,s,i,a,o,l,u,h,f){var p=this;return s.map(function(g){var v=Mi(g,2),y=v[0],_=v[1];return r.map(function(w){return p.renderDayColumn(w,y,_,i,a,o,l,h,f,u)})})}},{key:"renderRangeFirst",value:function(r,s,i,a,o,l,u,h,f){var p=this;return r.map(function(g){return H.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:g},s.map(function(v){var y=Mi(v,2),_=y[0],w=y[1];return H.createElement("div",{style:{flex:1},key:l.resourceId(w)},p.renderDayColumn(g,_,w,i,a,o,l,h,f,u))}))})}},{key:"renderEvents",value:function(r,s,i,a){var o=this.props,l=o.accessors,u=o.localizer,h=o.resourceGroupingLayout,f=o.components,p=o.dayLayoutAlgorithm,g=this.memoizedResources(this.props.resources,l),v=g.groupEvents(s),y=g.groupEvents(i);return h?this.renderRangeFirst(r,g,v,y,u,l,a,f,p):this.renderResourcesFirst(r,g,v,y,u,l,a,f,p)}},{key:"render",value:function(){var r,s=this.props,i=s.events,a=s.backgroundEvents,o=s.range,l=s.width,u=s.rtl,h=s.selected,f=s.getNow,p=s.resources,g=s.components,v=s.accessors,y=s.getters,_=s.localizer,w=s.min,b=s.max,S=s.showMultiDayTimes,T=s.longPressThreshold,P=s.resizable,R=s.resourceGroupingLayout;l=l||this.state.gutterWidth;var k=o[0],C=o[o.length-1];this.slots=o.length;var I=[],M=[],L=[];i.forEach(function(O){if(Q0(O,k,C,v,_)){var Y=v.start(O),Z=v.end(O);v.allDay(O)||_.startAndEndAreDateOnly(Y,Z)||!S&&!_.isSameDate(Y,Z)?I.push(O):M.push(O)}}),a.forEach(function(O){Q0(O,k,C,v,_)&&L.push(O)}),I.sort(function(O,Y){return II(O,Y,v,_)});var F={range:o,events:I,width:l,rtl:u,getNow:f,localizer:_,selected:h,allDayMaxRows:this.props.showAllEvents?1/0:(r=this.props.allDayMaxRows)!==null&&r!==void 0?r:1/0,resources:this.memoizedResources(p,v),selectable:this.props.selectable,accessors:v,getters:y,components:g,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:T,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:P};return H.createElement("div",{className:un("rbc-time-view",p&&"rbc-time-view-resources"),ref:this.containerRef},p&&p.length>1&&R?H.createElement(vwe,F):H.createElement(ywe,F),this.props.popup&&this.renderOverlay(),H.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},H.createElement(_we,{date:k,ref:this.gutterRef,localizer:_,min:_.merge(k,w),max:_.merge(k,b),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:g,className:"rbc-time-gutter",getters:y}),this.renderEvents(o,M,L,f())))}},{key:"renderOverlay",value:function(){var r,s,i=this,a=(r=(s=this.state)===null||s===void 0?void 0:s.overlay)!==null&&r!==void 0?r:{},o=this.props,l=o.accessors,u=o.localizer,h=o.components,f=o.getters,p=o.selected,g=o.popupOffset,v=o.handleDragStart,y=function(){return i.setState({overlay:null})};return H.createElement(YM,{overlay:a,accessors:l,localizer:u,components:h,getters:f,selected:p,popupOffset:g,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!a.position,overlayDisplay:this.overlayDisplay,onHide:y})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var r=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var s,i=(s=r.gutterRef)!==null&&s!==void 0&&s.current?kI(r.gutterRef.current):void 0;i&&r.state.gutterWidth!==i&&r.setState({gutterWidth:i})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var r=this.contentRef.current;r.scrollTop=r.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,s=r.min,i=r.max,a=r.scrollToTime,o=r.localizer,l=o.diff(o.merge(a,s),a,"milliseconds"),u=o.diff(s,i,"milliseconds");this._scrollRatio=l/u}}])}(B.Component);Dy.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var Swe=["date","localizer","min","max","scrollToTime","enableAutoScroll"],sk=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.date,i=r.localizer,a=r.min,o=a===void 0?i.startOf(new Date,"day"):a,l=r.max,u=l===void 0?i.endOf(new Date,"day"):l,h=r.scrollToTime,f=h===void 0?i.startOf(new Date,"day"):h,p=r.enableAutoScroll,g=p===void 0?!0:p,v=Ao(r,Swe),y=e.range(s,{localizer:i});return H.createElement(Dy,Object.assign({},v,{range:y,eventOffset:10,localizer:i,min:o,max:u,scrollToTime:f,enableAutoScroll:g}))}}])}(H.Component);sk.range=function(n,e){var t=e.localizer;return[t.startOf(n,"day")]};sk.navigate=function(n,e,t){var r=t.localizer;switch(e){case Ns.PREVIOUS:return r.add(n,-1,"day");case Ns.NEXT:return r.add(n,1,"day");default:return n}};sk.title=function(n,e){var t=e.localizer;return t.format(n,"dayHeaderFormat")};var Ewe=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Gu=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.date,i=r.localizer,a=r.min,o=a===void 0?i.startOf(new Date,"day"):a,l=r.max,u=l===void 0?i.endOf(new Date,"day"):l,h=r.scrollToTime,f=h===void 0?i.startOf(new Date,"day"):h,p=r.enableAutoScroll,g=p===void 0?!0:p,v=Ao(r,Ewe),y=e.range(s,this.props);return H.createElement(Dy,Object.assign({},v,{range:y,eventOffset:15,localizer:i,min:o,max:u,scrollToTime:f,enableAutoScroll:g}))}}])}(H.Component);Gu.defaultProps=Dy.defaultProps;Gu.navigate=function(n,e,t){var r=t.localizer;switch(e){case Ns.PREVIOUS:return r.add(n,-1,"week");case Ns.NEXT:return r.add(n,1,"week");default:return n}};Gu.range=function(n,e){var t=e.localizer,r=t.startOfWeek(),s=t.startOf(n,"week",r),i=t.endOf(n,"week",r);return t.range(s,i)};Gu.title=function(n,e){var t=e.localizer,r=Gu.range(n,{localizer:t}),s=Iz(r),i=s[0],a=s.slice(1);return t.format({start:i,end:a.pop()},"dayRangeHeaderFormat")};var Awe=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function QM(n,e){return Gu.range(n,e).filter(function(t){return[6,0].indexOf(t.getDay())===-1})}var gx=function(n){function e(){return $n(this,e),Vr(this,e,arguments)}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.date,i=r.localizer,a=r.min,o=a===void 0?i.startOf(new Date,"day"):a,l=r.max,u=l===void 0?i.endOf(new Date,"day"):l,h=r.scrollToTime,f=h===void 0?i.startOf(new Date,"day"):h,p=r.enableAutoScroll,g=p===void 0?!0:p,v=Ao(r,Awe),y=QM(s,this.props);return H.createElement(Dy,Object.assign({},v,{range:y,eventOffset:15,localizer:i,min:o,max:u,scrollToTime:f,enableAutoScroll:g}))}}])}(H.Component);gx.defaultProps=Dy.defaultProps;gx.range=QM;gx.navigate=Gu.navigate;gx.title=function(n,e){var t=e.localizer,r=QM(n,{localizer:t}),s=Iz(r),i=s[0],a=s.slice(1);return t.format({start:i,end:a.pop()},"dayRangeHeaderFormat")};var ik=30;function ak(n){var e=n.accessors,t=n.components,r=n.date,s=n.events,i=n.getters,a=n.length,o=a===void 0?ik:a,l=n.localizer,u=n.onDoubleClickEvent,h=n.onSelectEvent,f=n.selected,p=B.useRef(null),g=B.useRef(null),v=B.useRef(null),y=B.useRef(null),_=B.useRef(null);B.useEffect(function(){S()});var w=function(C,I,M){var L=t.event,F=t.date;return I=I.filter(function(O){return Q0(O,l.startOf(C,"day"),l.endOf(C,"day"),e,l)}),I.map(function(O,Y){var Z=e.title(O),X=e.end(O),J=e.start(O),K=i.eventProp(O,J,X,nk(O,f)),te=Y===0&&l.format(C,"agendaDateFormat"),ae=Y===0?H.createElement("td",{rowSpan:I.length,className:"rbc-agenda-date-cell"},F?H.createElement(F,{day:C,label:te}):te):!1;return H.createElement("tr",{key:M+"_"+Y,className:K.className,style:K.style},ae,H.createElement("td",{className:"rbc-agenda-time-cell"},b(C,O)),H.createElement("td",{className:"rbc-agenda-event-cell",onClick:function($){return h&&h(O,$)},onDoubleClick:function($){return u&&u(O,$)}},L?H.createElement(L,{event:O,title:Z}):Z))},[])},b=function(C,I){var M="",L=t.time,F=l.messages.allDay,O=e.end(I),Y=e.start(I);return e.allDay(I)||(l.eq(Y,O)?F=l.format(Y,"agendaTimeFormat"):l.isSameDate(Y,O)?F=l.format({start:Y,end:O},"agendaTimeRangeFormat"):l.isSameDate(C,Y)?F=l.format(Y,"agendaTimeFormat"):l.isSameDate(C,O)&&(F=l.format(O,"agendaTimeFormat"))),l.gt(C,Y,"day")&&(M="rbc-continues-prior"),l.lt(C,O,"day")&&(M+=" rbc-continues-after"),H.createElement("span",{className:M.trim()},L?H.createElement(L,{event:I,day:C,label:F}):F)},S=function(){if(_.current){var C=p.current,I=_.current.firstChild;if(I){var M=y.current.scrollHeight>y.current.clientHeight,L=[],F=L;L=[kI(I.children[0]),kI(I.children[1])],(F[0]!==L[0]||F[1]!==L[1])&&(g.current.style.width=L[0]+"px",v.current.style.width=L[1]+"px"),M?(Sie(C,"rbc-header-overflowing"),C.style.marginRight=kM()+"px"):Eie(C,"rbc-header-overflowing")}}},T=l.messages,P=l.add(r,o,"day"),R=l.range(r,P,"day");return s=s.filter(function(k){return Q0(k,l.startOf(r,"day"),l.endOf(P,"day"),e,l)}),s.sort(function(k,C){return+e.start(k)-+e.start(C)}),H.createElement("div",{className:"rbc-agenda-view"},s.length!==0?H.createElement(H.Fragment,null,H.createElement("table",{ref:p,className:"rbc-agenda-table"},H.createElement("thead",null,H.createElement("tr",null,H.createElement("th",{className:"rbc-header",ref:g},T.date),H.createElement("th",{className:"rbc-header",ref:v},T.time),H.createElement("th",{className:"rbc-header"},T.event)))),H.createElement("div",{className:"rbc-agenda-content",ref:y},H.createElement("table",{className:"rbc-agenda-table"},H.createElement("tbody",{ref:_},R.map(function(k,C){return w(k,s,C)}))))):H.createElement("span",{className:"rbc-agenda-empty"},T.noEventsInRange))}ak.range=function(n,e){var t=e.length,r=t===void 0?ik:t,s=e.localizer,i=s.add(n,r,"day");return{start:n,end:i}};ak.navigate=function(n,e,t){var r=t.length,s=r===void 0?ik:r,i=t.localizer;switch(e){case Ns.PREVIOUS:return i.add(n,-s,"day");case Ns.NEXT:return i.add(n,s,"day");default:return n}};ak.title=function(n,e){var t=e.length,r=t===void 0?ik:t,s=e.localizer,i=s.add(n,r,"day");return s.format({start:n,end:i},"agendaHeaderFormat")};var iE=vh(vh(vh(vh(vh({},ts.MONTH,rk),ts.WEEK,Gu),ts.WORK_WEEK,gx),ts.DAY,sk),ts.AGENDA,ak),Twe=["action","date","today"];function Cwe(n,e){var t=e.action,r=e.date,s=e.today,i=Ao(e,Twe);switch(n=typeof n=="string"?iE[n]:n,t){case Ns.TODAY:r=s||new Date;break;case Ns.DATE:break;default:$0(n&&typeof n.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),r=n.navigate(r,t,i)}return r}function kwe(n,e){var t=null;return typeof e=="function"?t=e(n):typeof e=="string"&&Kl(n)==="object"&&n!=null&&e in n&&(t=n[e]),t}var Mo=function(e){return function(t){return kwe(t,e)}},Nwe=["view","date","getNow","onNavigate"],Pwe=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function sH(n){if(Array.isArray(n))return n;for(var e=[],t=0,r=Object.entries(n);t<r.length;t++){var s=Mi(r[t],2),i=s[0],a=s[1];a&&e.push(i)}return e}function Iwe(n,e){var t=e.views,r=sH(t);return r.indexOf(n)!==-1}var iH=function(n){function e(){var t;$n(this,e);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return t=Vr(this,e,[].concat(s)),t.getViews=function(){var a=t.props.views;return Array.isArray(a)?o0e(a,function(o,l){return o[l]=iE[l]},{}):Kl(a)==="object"?ome(a,function(o,l){return o===!0?iE[l]:o}):iE},t.getView=function(){var a=t.getViews();return a[t.props.view]},t.getDrilldownView=function(a){var o=t.props,l=o.view,u=o.drilldownView,h=o.getDrilldownView;return h?h(a,l,Object.keys(t.getViews())):u},t.handleRangeChange=function(a,o,l){var u=t.props,h=u.onRangeChange,f=u.localizer;h&&o.range&&h(o.range(a,{localizer:f}),l)},t.handleNavigate=function(a,o){var l=t.props,u=l.view,h=l.date,f=l.getNow,p=l.onNavigate,g=Ao(l,Nwe),v=t.getView(),y=f();h=Cwe(v,At(At({},g),{},{action:a,date:o||h||y,today:y})),p(h,u,a),t.handleRangeChange(h,v)},t.handleViewChange=function(a){a!==t.props.view&&Iwe(a,t.props)&&t.props.onView(a);var o=t.getViews();t.handleRangeChange(t.props.date||t.props.getNow(),o[a],a)},t.handleSelectEvent=function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onSelectEvent,o)},t.handleDoubleClickEvent=function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onDoubleClickEvent,o)},t.handleKeyPressEvent=function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];jt(t.props.onKeyPressEvent,o)},t.handleSelectSlot=function(a){jt(t.props.onSelectSlot,a)},t.handleDrillDown=function(a,o){var l=t.props.onDrillDown;if(l){l(a,o,t.drilldownView);return}o&&t.handleViewChange(o),t.handleNavigate(Ns.DATE,a)},t.state={context:e.getContext(t.props)},t}return Br(e,n),Un(e,[{key:"render",value:function(){var r=this.props,s=r.view,i=r.toolbar,a=r.events,o=r.backgroundEvents,l=r.resourceGroupingLayout,u=r.style,h=r.className,f=r.elementProps,p=r.date,g=r.getNow,v=r.length,y=r.showMultiDayTimes,_=r.onShowMore,w=r.doShowMoreDrillDown;r.components,r.formats,r.messages,r.culture;var b=Ao(r,Pwe);p=p||g();var S=this.getView(),T=this.state.context,P=T.accessors,R=T.components,k=T.getters,C=T.localizer,I=T.viewNames,M=R.toolbar||M0e,L=S.title(p,{localizer:C,length:v});return H.createElement("div",Object.assign({},f,{className:un(h,"rbc-calendar",b.rtl&&"rbc-rtl"),style:u}),i&&H.createElement(M,{date:p,view:s,views:I,label:L,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:C}),H.createElement(S,Object.assign({},b,{events:a,backgroundEvents:o,date:p,getNow:g,length:v,localizer:C,getters:k,components:R,accessors:P,showMultiDayTimes:y,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:_,doShowMoreDrillDown:w,resourceGroupingLayout:l})))}}],[{key:"getDerivedStateFromProps",value:function(r){return{context:e.getContext(r)}}},{key:"getContext",value:function(r){var s=r.startAccessor,i=r.endAccessor,a=r.allDayAccessor,o=r.tooltipAccessor,l=r.titleAccessor,u=r.resourceAccessor,h=r.resourceIdAccessor,f=r.resourceTitleAccessor,p=r.eventIdAccessor,g=r.eventPropGetter,v=r.backgroundEventPropGetter,y=r.slotPropGetter,_=r.slotGroupPropGetter,w=r.dayPropGetter,b=r.view,S=r.views,T=r.localizer,P=r.culture,R=r.messages,k=R===void 0?{}:R,C=r.components,I=C===void 0?{}:C,M=r.formats,L=M===void 0?{}:M,F=sH(S),O=L0e(k);return{viewNames:F,localizer:R0e(T,P,L,O),getters:{eventProp:function(){return g&&g.apply(void 0,arguments)||{}},backgroundEventProp:function(){return v&&v.apply(void 0,arguments)||{}},slotProp:function(){return y&&y.apply(void 0,arguments)||{}},slotGroupProp:function(){return _&&_.apply(void 0,arguments)||{}},dayProp:function(){return w&&w.apply(void 0,arguments)||{}}},components:eme(I[b]||{},Yve(I,F),{eventWrapper:Fa,backgroundEventWrapper:Fa,eventContainerWrapper:Fa,dateCellWrapper:Fa,weekWrapper:Fa,timeSlotWrapper:Fa,timeGutterWrapper:Fa,timeIndicatorWrapper:Fa}),accessors:{start:Mo(s),end:Mo(i),allDay:Mo(a),tooltip:Mo(o),title:Mo(l),resource:Mo(u),resourceId:Mo(h),resourceTitle:Mo(f),eventId:Mo(p)}}}}])}(H.Component);iH.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:ts.MONTH,views:[ts.MONTH,ts.WEEK,ts.DAY,ts.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:ts.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var Dwe=D6(iH,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),Rwe=function(e,t,r){var s=e.start,i=e.end;return r.format(s,"MMMM DD",t)+"  "+r.format(i,r.eq(s,i,"month")?"DD":"MMMM DD",t)},Mwe=function(e,t,r){var s=e.start,i=e.end;return r.format(s,"L",t)+"  "+r.format(i,"L",t)},MN=function(e,t,r){var s=e.start,i=e.end;return r.format(s,"LT",t)+"  "+r.format(i,"LT",t)},Owe=function(e,t,r){var s=e.start;return r.format(s,"LT",t)+"  "},Lwe=function(e,t,r){var s=e.end;return"  "+r.format(s,"LT",t)},jwe={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:MN,eventTimeRangeFormat:MN,eventTimeRangeStartFormat:Owe,eventTimeRangeEndFormat:Lwe,timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:Rwe,agendaHeaderFormat:Mwe,agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:MN};function uc(n){var e=n&&n.toLowerCase();return e==="FullYear"?e="year":e||(e=void 0),e}function Fwe(n){var e=function($,U){return U?$.locale(U):$};function t(q){return n(q).toDate().getTimezoneOffset()}function r(q,$){var U,G,V=n(q).local(),ee=n($).local();if(!n.tz)return V.toDate().getTimezoneOffset()-ee.toDate().getTimezoneOffset();var re=(U=V==null||(G=V._z)===null||G===void 0?void 0:G.name)!==null&&U!==void 0?U:n.tz.guess(),ce=n.tz.zone(re).utcOffset(+V),Ae=n.tz.zone(re).utcOffset(+ee);return ce-Ae}function s(q){var $=n(q).startOf("day");return r($,q)}function i(q,$,U){var G=uc(U),V=G?n(q).startOf(G):n(q),ee=G?n($).startOf(G):n($);return[V,ee,G]}function a(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,$=arguments.length>1?arguments[1]:void 0,U=uc($);return U?n(q).startOf(U).toDate():n(q).toDate()}function o(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,$=arguments.length>1?arguments[1]:void 0,U=uc($);return U?n(q).endOf(U).toDate():n(q).toDate()}function l(q,$,U){var G=i(q,$,U),V=Mi(G,3),ee=V[0],re=V[1],ce=V[2];return ee.isSame(re,ce)}function u(q,$,U){return!l(q,$,U)}function h(q,$,U){var G=i(q,$,U),V=Mi(G,3),ee=V[0],re=V[1],ce=V[2];return ee.isAfter(re,ce)}function f(q,$,U){var G=i(q,$,U),V=Mi(G,3),ee=V[0],re=V[1],ce=V[2];return ee.isBefore(re,ce)}function p(q,$,U){var G=i(q,$,U),V=Mi(G,3),ee=V[0],re=V[1],ce=V[2];return ee.isSameOrBefore(re,ce)}function g(q,$,U){var G=i(q,$,U),V=Mi(G,3),ee=V[0],re=V[1],ce=V[2];return ee.isSameOrBefore(re,ce)}function v(q,$,U){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"day",V=uc(G),ee=n(q),re=n($),ce=n(U);return ee.isBetween(re,ce,V,"[]")}function y(q,$){var U=n(q),G=n($),V=n.min(U,G);return V.toDate()}function _(q,$){var U=n(q),G=n($),V=n.max(U,G);return V.toDate()}function w(q,$){if(!q&&!$)return null;var U=n($).format("HH:mm:ss"),G=n(q).startOf("day").format("MM/DD/YYYY");return n("".concat(G," ").concat(U),"MM/DD/YYYY HH:mm:ss").toDate()}function b(q,$,U){var G=uc(U);return n(q).add($,G).toDate()}function S(q,$){for(var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",G=uc(U),V=n(q).toDate(),ee=[];g(V,$);)ee.push(V),V=b(V,1,G);return ee}function T(q,$){var U=uc($),G=a(q,U);return l(G,q)?G:b(G,1,U)}function P(q,$){var U=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",G=uc(U),V=n(q),ee=n($);return ee.diff(V,G)}function R(q){var $=n(q);return $.minutes()}function k(q){var $=q?n.localeData(q):n.localeData();return $?$.firstDayOfWeek():0}function C(q){return n(q).startOf("month").startOf("week").toDate()}function I(q){return n(q).endOf("month").endOf("week").toDate()}function M(q){for(var $=C(q),U=I(q),G=[];g($,U);)G.push($),$=b($,1,"d");return G}function L(q,$,U){return n(q).startOf("day").minute($+U).toDate()}function F(q,$){return P(q,$,"minutes")}function O(q){var $=n(q).startOf("day"),U=n(q);return U.diff($,"minutes")+s(q)}function Y(q,$){var U=n(q),G=n($);return U.isBefore(G,"day")}function Z(q,$,U){var G=n($),V=n(U);return G.isSameOrAfter(V,"minutes")}function X(q,$){var U=n(q),G=n($),V=n.duration(G.diff(U));return V.days()}function J(q){var $=q.evtA,U=$.start,G=$.end,V=$.allDay,ee=q.evtB,re=ee.start,ce=ee.end,Ae=ee.allDay,_e=+a(U,"day")-+a(re,"day"),xe=X(U,G),ke=X(re,ce);return _e||ke-xe||!!Ae-!!V||+U-+re||+G-+ce}function K(q){var $=q.event,U=$.start,G=$.end,V=q.range,ee=V.start,re=V.end,ce=n(U).startOf("day"),Ae=n(G),_e=n(ee),xe=n(re),ke=ce.isSameOrBefore(xe,"day"),Ye=!ce.isSame(Ae,"minutes"),Ke=Ye?Ae.isAfter(_e,"minutes"):Ae.isSameOrAfter(_e,"minutes");return ke&&Ke}function te(q,$){var U=n(q),G=n($);return U.isSame(G,"day")}function ae(){var q=new Date,$=/-/.test(q.toString())?"-":"",U=q.getTimezoneOffset(),G=Number("".concat($).concat(Math.abs(U))),V=n().utcOffset();return V>G?1:0}return new D0e({formats:jwe,firstOfWeek:k,firstVisibleDay:C,lastVisibleDay:I,visibleDays:M,format:function($,U,G){return e(n($),G).format(U)},lt:f,lte:g,gt:h,gte:p,eq:l,neq:u,merge:w,inRange:v,startOf:a,endOf:o,range:S,add:b,diff:P,ceil:T,min:y,max:_,minutes:R,getSlotDate:L,getTimezoneOffset:t,getDstOffset:r,getTotalMin:F,getMinutesFromMidnight:O,continuesPrior:Y,continuesAfter:Z,sortEvents:J,inEventRange:K,isSameDate:te,daySpan:X,browserTZOffset:ae})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var aH;function pe(){return aH.apply(null,arguments)}function $we(n){aH=n}function Ta(n){return n instanceof Array||Object.prototype.toString.call(n)==="[object Array]"}function lf(n){return n!=null&&Object.prototype.toString.call(n)==="[object Object]"}function it(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function JM(n){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(n).length===0;var e;for(e in n)if(it(n,e))return!1;return!0}function us(n){return n===void 0}function Ql(n){return typeof n=="number"||Object.prototype.toString.call(n)==="[object Number]"}function yx(n){return n instanceof Date||Object.prototype.toString.call(n)==="[object Date]"}function oH(n,e){var t=[],r,s=n.length;for(r=0;r<s;++r)t.push(e(n[r],r));return t}function Au(n,e){for(var t in e)it(e,t)&&(n[t]=e[t]);return it(e,"toString")&&(n.toString=e.toString),it(e,"valueOf")&&(n.valueOf=e.valueOf),n}function No(n,e,t,r){return PH(n,e,t,r,!0).utc()}function Uwe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Ue(n){return n._pf==null&&(n._pf=Uwe()),n._pf}var RI;Array.prototype.some?RI=Array.prototype.some:RI=function(n){var e=Object(this),t=e.length>>>0,r;for(r=0;r<t;r++)if(r in e&&n.call(this,e[r],r,e))return!0;return!1};function ZM(n){var e=null,t=!1,r=n._d&&!isNaN(n._d.getTime());if(r&&(e=Ue(n),t=RI.call(e.parsedDateParts,function(s){return s!=null}),r=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&t),n._strict&&(r=r&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(n))n._isValid=r;else return r;return n._isValid}function ok(n){var e=No(NaN);return n!=null?Au(Ue(e),n):Ue(e).userInvalidated=!0,e}var I4=pe.momentProperties=[],ON=!1;function eO(n,e){var t,r,s,i=I4.length;if(us(e._isAMomentObject)||(n._isAMomentObject=e._isAMomentObject),us(e._i)||(n._i=e._i),us(e._f)||(n._f=e._f),us(e._l)||(n._l=e._l),us(e._strict)||(n._strict=e._strict),us(e._tzm)||(n._tzm=e._tzm),us(e._isUTC)||(n._isUTC=e._isUTC),us(e._offset)||(n._offset=e._offset),us(e._pf)||(n._pf=Ue(e)),us(e._locale)||(n._locale=e._locale),i>0)for(t=0;t<i;t++)r=I4[t],s=e[r],us(s)||(n[r]=s);return n}function vx(n){eO(this,n),this._d=new Date(n._d!=null?n._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ON===!1&&(ON=!0,pe.updateOffset(this),ON=!1)}function Ca(n){return n instanceof vx||n!=null&&n._isAMomentObject!=null}function lH(n){pe.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+n)}function Gi(n,e){var t=!0;return Au(function(){if(pe.deprecationHandler!=null&&pe.deprecationHandler(null,n),t){var r=[],s,i,a,o=arguments.length;for(i=0;i<o;i++){if(s="",typeof arguments[i]=="object"){s+=`
[`+i+"] ";for(a in arguments[0])it(arguments[0],a)&&(s+=a+": "+arguments[0][a]+", ");s=s.slice(0,-2)}else s=arguments[i];r.push(s)}lH(n+`
Arguments: `+Array.prototype.slice.call(r).join("")+`
`+new Error().stack),t=!1}return e.apply(this,arguments)},e)}var D4={};function cH(n,e){pe.deprecationHandler!=null&&pe.deprecationHandler(n,e),D4[n]||(lH(e),D4[n]=!0)}pe.suppressDeprecationWarnings=!1;pe.deprecationHandler=null;function Po(n){return typeof Function<"u"&&n instanceof Function||Object.prototype.toString.call(n)==="[object Function]"}function Vwe(n){var e,t;for(t in n)it(n,t)&&(e=n[t],Po(e)?this[t]=e:this["_"+t]=e);this._config=n,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function MI(n,e){var t=Au({},n),r;for(r in e)it(e,r)&&(lf(n[r])&&lf(e[r])?(t[r]={},Au(t[r],n[r]),Au(t[r],e[r])):e[r]!=null?t[r]=e[r]:delete t[r]);for(r in n)it(n,r)&&!it(e,r)&&lf(n[r])&&(t[r]=Au({},t[r]));return t}function tO(n){n!=null&&this.set(n)}var OI;Object.keys?OI=Object.keys:OI=function(n){var e,t=[];for(e in n)it(n,e)&&t.push(e);return t};var Bwe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function zwe(n,e,t){var r=this._calendar[n]||this._calendar.sameElse;return Po(r)?r.call(e,t):r}function To(n,e,t){var r=""+Math.abs(n),s=e-r.length,i=n>=0;return(i?t?"+":"":"-")+Math.pow(10,Math.max(0,s)).toString().substr(1)+r}var nO=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,bS=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,LN={},Hp={};function Te(n,e,t,r){var s=r;typeof r=="string"&&(s=function(){return this[r]()}),n&&(Hp[n]=s),e&&(Hp[e[0]]=function(){return To(s.apply(this,arguments),e[1],e[2])}),t&&(Hp[t]=function(){return this.localeData().ordinal(s.apply(this,arguments),n)})}function Hwe(n){return n.match(/\[[\s\S]/)?n.replace(/^\[|\]$/g,""):n.replace(/\\/g,"")}function Wwe(n){var e=n.match(nO),t,r;for(t=0,r=e.length;t<r;t++)Hp[e[t]]?e[t]=Hp[e[t]]:e[t]=Hwe(e[t]);return function(s){var i="",a;for(a=0;a<r;a++)i+=Po(e[a])?e[a].call(s,n):e[a];return i}}function aE(n,e){return n.isValid()?(e=uH(e,n.localeData()),LN[e]=LN[e]||Wwe(e),LN[e](n)):n.localeData().invalidDate()}function uH(n,e){var t=5;function r(s){return e.longDateFormat(s)||s}for(bS.lastIndex=0;t>=0&&bS.test(n);)n=n.replace(bS,r),bS.lastIndex=0,t-=1;return n}var Gwe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function qwe(n){var e=this._longDateFormat[n],t=this._longDateFormat[n.toUpperCase()];return e||!t?e:(this._longDateFormat[n]=t.match(nO).map(function(r){return r==="MMMM"||r==="MM"||r==="DD"||r==="dddd"?r.slice(1):r}).join(""),this._longDateFormat[n])}var Ywe="Invalid date";function Kwe(){return this._invalidDate}var Xwe="%d",Qwe=/\d{1,2}/;function Jwe(n){return this._ordinal.replace("%d",n)}var Zwe={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function ebe(n,e,t,r){var s=this._relativeTime[t];return Po(s)?s(n,e,t,r):s.replace(/%d/i,n)}function tbe(n,e){var t=this._relativeTime[n>0?"future":"past"];return Po(t)?t(e):t.replace(/%s/i,e)}var R4={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function qi(n){return typeof n=="string"?R4[n]||R4[n.toLowerCase()]:void 0}function rO(n){var e={},t,r;for(r in n)it(n,r)&&(t=qi(r),t&&(e[t]=n[r]));return e}var nbe={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function rbe(n){var e=[],t;for(t in n)it(n,t)&&e.push({unit:t,priority:nbe[t]});return e.sort(function(r,s){return r.priority-s.priority}),e}var hH=/\d/,pi=/\d\d/,dH=/\d{3}/,sO=/\d{4}/,lk=/[+-]?\d{6}/,Vt=/\d\d?/,fH=/\d\d\d\d?/,pH=/\d\d\d\d\d\d?/,ck=/\d{1,3}/,iO=/\d{1,4}/,uk=/[+-]?\d{1,6}/,Ry=/\d+/,hk=/[+-]?\d+/,sbe=/Z|[+-]\d\d:?\d\d/gi,dk=/Z|[+-]\d\d(?::?\d\d)?/gi,ibe=/[+-]?\d+(\.\d{1,3})?/,wx=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,My=/^[1-9]\d?/,aO=/^([1-9]\d|\d)/,H1;H1={};function ve(n,e,t){H1[n]=Po(e)?e:function(r,s){return r&&t?t:e}}function abe(n,e){return it(H1,n)?H1[n](e._strict,e._locale):new RegExp(obe(n))}function obe(n){return jl(n.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,r,s,i){return t||r||s||i}))}function jl(n){return n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Ri(n){return n<0?Math.ceil(n)||0:Math.floor(n)}function qe(n){var e=+n,t=0;return e!==0&&isFinite(e)&&(t=Ri(e)),t}var LI={};function _t(n,e){var t,r=e,s;for(typeof n=="string"&&(n=[n]),Ql(e)&&(r=function(i,a){a[e]=qe(i)}),s=n.length,t=0;t<s;t++)LI[n[t]]=r}function bx(n,e){_t(n,function(t,r,s,i){s._w=s._w||{},e(t,s._w,s,i)})}function lbe(n,e,t){e!=null&&it(LI,n)&&LI[n](e,t._a,t,n)}function fk(n){return n%4===0&&n%100!==0||n%400===0}var Fr=0,Dl=1,uo=2,jn=3,va=4,Rl=5,Th=6,cbe=7,ube=8;Te("Y",0,0,function(){var n=this.year();return n<=9999?To(n,4):"+"+n});Te(0,["YY",2],0,function(){return this.year()%100});Te(0,["YYYY",4],0,"year");Te(0,["YYYYY",5],0,"year");Te(0,["YYYYYY",6,!0],0,"year");ve("Y",hk);ve("YY",Vt,pi);ve("YYYY",iO,sO);ve("YYYYY",uk,lk);ve("YYYYYY",uk,lk);_t(["YYYYY","YYYYYY"],Fr);_t("YYYY",function(n,e){e[Fr]=n.length===2?pe.parseTwoDigitYear(n):qe(n)});_t("YY",function(n,e){e[Fr]=pe.parseTwoDigitYear(n)});_t("Y",function(n,e){e[Fr]=parseInt(n,10)});function u0(n){return fk(n)?366:365}pe.parseTwoDigitYear=function(n){return qe(n)+(qe(n)>68?1900:2e3)};var mH=Oy("FullYear",!0);function hbe(){return fk(this.year())}function Oy(n,e){return function(t){return t!=null?(gH(this,n,t),pe.updateOffset(this,e),this):Z0(this,n)}}function Z0(n,e){if(!n.isValid())return NaN;var t=n._d,r=n._isUTC;switch(e){case"Milliseconds":return r?t.getUTCMilliseconds():t.getMilliseconds();case"Seconds":return r?t.getUTCSeconds():t.getSeconds();case"Minutes":return r?t.getUTCMinutes():t.getMinutes();case"Hours":return r?t.getUTCHours():t.getHours();case"Date":return r?t.getUTCDate():t.getDate();case"Day":return r?t.getUTCDay():t.getDay();case"Month":return r?t.getUTCMonth():t.getMonth();case"FullYear":return r?t.getUTCFullYear():t.getFullYear();default:return NaN}}function gH(n,e,t){var r,s,i,a,o;if(!(!n.isValid()||isNaN(t))){switch(r=n._d,s=n._isUTC,e){case"Milliseconds":return void(s?r.setUTCMilliseconds(t):r.setMilliseconds(t));case"Seconds":return void(s?r.setUTCSeconds(t):r.setSeconds(t));case"Minutes":return void(s?r.setUTCMinutes(t):r.setMinutes(t));case"Hours":return void(s?r.setUTCHours(t):r.setHours(t));case"Date":return void(s?r.setUTCDate(t):r.setDate(t));case"FullYear":break;default:return}i=t,a=n.month(),o=n.date(),o=o===29&&a===1&&!fk(i)?28:o,s?r.setUTCFullYear(i,a,o):r.setFullYear(i,a,o)}}function dbe(n){return n=qi(n),Po(this[n])?this[n]():this}function fbe(n,e){if(typeof n=="object"){n=rO(n);var t=rbe(n),r,s=t.length;for(r=0;r<s;r++)this[t[r].unit](n[t[r].unit])}else if(n=qi(n),Po(this[n]))return this[n](e);return this}function pbe(n,e){return(n%e+e)%e}var gn;Array.prototype.indexOf?gn=Array.prototype.indexOf:gn=function(n){var e;for(e=0;e<this.length;++e)if(this[e]===n)return e;return-1};function oO(n,e){if(isNaN(n)||isNaN(e))return NaN;var t=pbe(e,12);return n+=(e-t)/12,t===1?fk(n)?29:28:31-t%7%2}Te("M",["MM",2],"Mo",function(){return this.month()+1});Te("MMM",0,0,function(n){return this.localeData().monthsShort(this,n)});Te("MMMM",0,0,function(n){return this.localeData().months(this,n)});ve("M",Vt,My);ve("MM",Vt,pi);ve("MMM",function(n,e){return e.monthsShortRegex(n)});ve("MMMM",function(n,e){return e.monthsRegex(n)});_t(["M","MM"],function(n,e){e[Dl]=qe(n)-1});_t(["MMM","MMMM"],function(n,e,t,r){var s=t._locale.monthsParse(n,r,t._strict);s!=null?e[Dl]=s:Ue(t).invalidMonth=n});var mbe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),yH="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),vH=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,gbe=wx,ybe=wx;function vbe(n,e){return n?Ta(this._months)?this._months[n.month()]:this._months[(this._months.isFormat||vH).test(e)?"format":"standalone"][n.month()]:Ta(this._months)?this._months:this._months.standalone}function wbe(n,e){return n?Ta(this._monthsShort)?this._monthsShort[n.month()]:this._monthsShort[vH.test(e)?"format":"standalone"][n.month()]:Ta(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bbe(n,e,t){var r,s,i,a=n.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)i=No([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(i,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(i,"").toLocaleLowerCase();return t?e==="MMM"?(s=gn.call(this._shortMonthsParse,a),s!==-1?s:null):(s=gn.call(this._longMonthsParse,a),s!==-1?s:null):e==="MMM"?(s=gn.call(this._shortMonthsParse,a),s!==-1?s:(s=gn.call(this._longMonthsParse,a),s!==-1?s:null)):(s=gn.call(this._longMonthsParse,a),s!==-1?s:(s=gn.call(this._shortMonthsParse,a),s!==-1?s:null))}function _be(n,e,t){var r,s,i;if(this._monthsParseExact)return bbe.call(this,n,e,t);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(s=No([2e3,r]),t&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(s,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(s,"").replace(".","")+"$","i")),!t&&!this._monthsParse[r]&&(i="^"+this.months(s,"")+"|^"+this.monthsShort(s,""),this._monthsParse[r]=new RegExp(i.replace(".",""),"i")),t&&e==="MMMM"&&this._longMonthsParse[r].test(n))return r;if(t&&e==="MMM"&&this._shortMonthsParse[r].test(n))return r;if(!t&&this._monthsParse[r].test(n))return r}}function wH(n,e){if(!n.isValid())return n;if(typeof e=="string"){if(/^\d+$/.test(e))e=qe(e);else if(e=n.localeData().monthsParse(e),!Ql(e))return n}var t=e,r=n.date();return r=r<29?r:Math.min(r,oO(n.year(),t)),n._isUTC?n._d.setUTCMonth(t,r):n._d.setMonth(t,r),n}function bH(n){return n!=null?(wH(this,n),pe.updateOffset(this,!0),this):Z0(this,"Month")}function xbe(){return oO(this.year(),this.month())}function Sbe(n){return this._monthsParseExact?(it(this,"_monthsRegex")||_H.call(this),n?this._monthsShortStrictRegex:this._monthsShortRegex):(it(this,"_monthsShortRegex")||(this._monthsShortRegex=gbe),this._monthsShortStrictRegex&&n?this._monthsShortStrictRegex:this._monthsShortRegex)}function Ebe(n){return this._monthsParseExact?(it(this,"_monthsRegex")||_H.call(this),n?this._monthsStrictRegex:this._monthsRegex):(it(this,"_monthsRegex")||(this._monthsRegex=ybe),this._monthsStrictRegex&&n?this._monthsStrictRegex:this._monthsRegex)}function _H(){function n(l,u){return u.length-l.length}var e=[],t=[],r=[],s,i,a,o;for(s=0;s<12;s++)i=No([2e3,s]),a=jl(this.monthsShort(i,"")),o=jl(this.months(i,"")),e.push(a),t.push(o),r.push(o),r.push(a);e.sort(n),t.sort(n),r.sort(n),this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Abe(n,e,t,r,s,i,a){var o;return n<100&&n>=0?(o=new Date(n+400,e,t,r,s,i,a),isFinite(o.getFullYear())&&o.setFullYear(n)):o=new Date(n,e,t,r,s,i,a),o}function ew(n){var e,t;return n<100&&n>=0?(t=Array.prototype.slice.call(arguments),t[0]=n+400,e=new Date(Date.UTC.apply(null,t)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(n)):e=new Date(Date.UTC.apply(null,arguments)),e}function W1(n,e,t){var r=7+e-t,s=(7+ew(n,0,r).getUTCDay()-e)%7;return-s+r-1}function xH(n,e,t,r,s){var i=(7+t-r)%7,a=W1(n,r,s),o=1+7*(e-1)+i+a,l,u;return o<=0?(l=n-1,u=u0(l)+o):o>u0(n)?(l=n+1,u=o-u0(n)):(l=n,u=o),{year:l,dayOfYear:u}}function tw(n,e,t){var r=W1(n.year(),e,t),s=Math.floor((n.dayOfYear()-r-1)/7)+1,i,a;return s<1?(a=n.year()-1,i=s+Fl(a,e,t)):s>Fl(n.year(),e,t)?(i=s-Fl(n.year(),e,t),a=n.year()+1):(a=n.year(),i=s),{week:i,year:a}}function Fl(n,e,t){var r=W1(n,e,t),s=W1(n+1,e,t);return(u0(n)-r+s)/7}Te("w",["ww",2],"wo","week");Te("W",["WW",2],"Wo","isoWeek");ve("w",Vt,My);ve("ww",Vt,pi);ve("W",Vt,My);ve("WW",Vt,pi);bx(["w","ww","W","WW"],function(n,e,t,r){e[r.substr(0,1)]=qe(n)});function Tbe(n){return tw(n,this._week.dow,this._week.doy).week}var Cbe={dow:0,doy:6};function kbe(){return this._week.dow}function Nbe(){return this._week.doy}function Pbe(n){var e=this.localeData().week(this);return n==null?e:this.add((n-e)*7,"d")}function Ibe(n){var e=tw(this,1,4).week;return n==null?e:this.add((n-e)*7,"d")}Te("d",0,"do","day");Te("dd",0,0,function(n){return this.localeData().weekdaysMin(this,n)});Te("ddd",0,0,function(n){return this.localeData().weekdaysShort(this,n)});Te("dddd",0,0,function(n){return this.localeData().weekdays(this,n)});Te("e",0,0,"weekday");Te("E",0,0,"isoWeekday");ve("d",Vt);ve("e",Vt);ve("E",Vt);ve("dd",function(n,e){return e.weekdaysMinRegex(n)});ve("ddd",function(n,e){return e.weekdaysShortRegex(n)});ve("dddd",function(n,e){return e.weekdaysRegex(n)});bx(["dd","ddd","dddd"],function(n,e,t,r){var s=t._locale.weekdaysParse(n,r,t._strict);s!=null?e.d=s:Ue(t).invalidWeekday=n});bx(["d","e","E"],function(n,e,t,r){e[r]=qe(n)});function Dbe(n,e){return typeof n!="string"?n:isNaN(n)?(n=e.weekdaysParse(n),typeof n=="number"?n:null):parseInt(n,10)}function Rbe(n,e){return typeof n=="string"?e.weekdaysParse(n)%7||7:isNaN(n)?null:n}function lO(n,e){return n.slice(e,7).concat(n.slice(0,e))}var Mbe="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),SH="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Obe="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Lbe=wx,jbe=wx,Fbe=wx;function $be(n,e){var t=Ta(this._weekdays)?this._weekdays:this._weekdays[n&&n!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return n===!0?lO(t,this._week.dow):n?t[n.day()]:t}function Ube(n){return n===!0?lO(this._weekdaysShort,this._week.dow):n?this._weekdaysShort[n.day()]:this._weekdaysShort}function Vbe(n){return n===!0?lO(this._weekdaysMin,this._week.dow):n?this._weekdaysMin[n.day()]:this._weekdaysMin}function Bbe(n,e,t){var r,s,i,a=n.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)i=No([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(i,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(i,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(i,"").toLocaleLowerCase();return t?e==="dddd"?(s=gn.call(this._weekdaysParse,a),s!==-1?s:null):e==="ddd"?(s=gn.call(this._shortWeekdaysParse,a),s!==-1?s:null):(s=gn.call(this._minWeekdaysParse,a),s!==-1?s:null):e==="dddd"?(s=gn.call(this._weekdaysParse,a),s!==-1||(s=gn.call(this._shortWeekdaysParse,a),s!==-1)?s:(s=gn.call(this._minWeekdaysParse,a),s!==-1?s:null)):e==="ddd"?(s=gn.call(this._shortWeekdaysParse,a),s!==-1||(s=gn.call(this._weekdaysParse,a),s!==-1)?s:(s=gn.call(this._minWeekdaysParse,a),s!==-1?s:null)):(s=gn.call(this._minWeekdaysParse,a),s!==-1||(s=gn.call(this._weekdaysParse,a),s!==-1)?s:(s=gn.call(this._shortWeekdaysParse,a),s!==-1?s:null))}function zbe(n,e,t){var r,s,i;if(this._weekdaysParseExact)return Bbe.call(this,n,e,t);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(s=No([2e3,1]).day(r),t&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(s,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(s,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(s,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[r]||(i="^"+this.weekdays(s,"")+"|^"+this.weekdaysShort(s,"")+"|^"+this.weekdaysMin(s,""),this._weekdaysParse[r]=new RegExp(i.replace(".",""),"i")),t&&e==="dddd"&&this._fullWeekdaysParse[r].test(n))return r;if(t&&e==="ddd"&&this._shortWeekdaysParse[r].test(n))return r;if(t&&e==="dd"&&this._minWeekdaysParse[r].test(n))return r;if(!t&&this._weekdaysParse[r].test(n))return r}}function Hbe(n){if(!this.isValid())return n!=null?this:NaN;var e=Z0(this,"Day");return n!=null?(n=Dbe(n,this.localeData()),this.add(n-e,"d")):e}function Wbe(n){if(!this.isValid())return n!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return n==null?e:this.add(n-e,"d")}function Gbe(n){if(!this.isValid())return n!=null?this:NaN;if(n!=null){var e=Rbe(n,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function qbe(n){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||cO.call(this),n?this._weekdaysStrictRegex:this._weekdaysRegex):(it(this,"_weekdaysRegex")||(this._weekdaysRegex=Lbe),this._weekdaysStrictRegex&&n?this._weekdaysStrictRegex:this._weekdaysRegex)}function Ybe(n){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||cO.call(this),n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(it(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=jbe),this._weekdaysShortStrictRegex&&n?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Kbe(n){return this._weekdaysParseExact?(it(this,"_weekdaysRegex")||cO.call(this),n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(it(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Fbe),this._weekdaysMinStrictRegex&&n?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function cO(){function n(h,f){return f.length-h.length}var e=[],t=[],r=[],s=[],i,a,o,l,u;for(i=0;i<7;i++)a=No([2e3,1]).day(i),o=jl(this.weekdaysMin(a,"")),l=jl(this.weekdaysShort(a,"")),u=jl(this.weekdays(a,"")),e.push(o),t.push(l),r.push(u),s.push(o),s.push(l),s.push(u);e.sort(n),t.sort(n),r.sort(n),s.sort(n),this._weekdaysRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+t.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function uO(){return this.hours()%12||12}function Xbe(){return this.hours()||24}Te("H",["HH",2],0,"hour");Te("h",["hh",2],0,uO);Te("k",["kk",2],0,Xbe);Te("hmm",0,0,function(){return""+uO.apply(this)+To(this.minutes(),2)});Te("hmmss",0,0,function(){return""+uO.apply(this)+To(this.minutes(),2)+To(this.seconds(),2)});Te("Hmm",0,0,function(){return""+this.hours()+To(this.minutes(),2)});Te("Hmmss",0,0,function(){return""+this.hours()+To(this.minutes(),2)+To(this.seconds(),2)});function EH(n,e){Te(n,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}EH("a",!0);EH("A",!1);function AH(n,e){return e._meridiemParse}ve("a",AH);ve("A",AH);ve("H",Vt,aO);ve("h",Vt,My);ve("k",Vt,My);ve("HH",Vt,pi);ve("hh",Vt,pi);ve("kk",Vt,pi);ve("hmm",fH);ve("hmmss",pH);ve("Hmm",fH);ve("Hmmss",pH);_t(["H","HH"],jn);_t(["k","kk"],function(n,e,t){var r=qe(n);e[jn]=r===24?0:r});_t(["a","A"],function(n,e,t){t._isPm=t._locale.isPM(n),t._meridiem=n});_t(["h","hh"],function(n,e,t){e[jn]=qe(n),Ue(t).bigHour=!0});_t("hmm",function(n,e,t){var r=n.length-2;e[jn]=qe(n.substr(0,r)),e[va]=qe(n.substr(r)),Ue(t).bigHour=!0});_t("hmmss",function(n,e,t){var r=n.length-4,s=n.length-2;e[jn]=qe(n.substr(0,r)),e[va]=qe(n.substr(r,2)),e[Rl]=qe(n.substr(s)),Ue(t).bigHour=!0});_t("Hmm",function(n,e,t){var r=n.length-2;e[jn]=qe(n.substr(0,r)),e[va]=qe(n.substr(r))});_t("Hmmss",function(n,e,t){var r=n.length-4,s=n.length-2;e[jn]=qe(n.substr(0,r)),e[va]=qe(n.substr(r,2)),e[Rl]=qe(n.substr(s))});function Qbe(n){return(n+"").toLowerCase().charAt(0)==="p"}var Jbe=/[ap]\.?m?\.?/i,Zbe=Oy("Hours",!0);function e_e(n,e,t){return n>11?t?"pm":"PM":t?"am":"AM"}var TH={calendar:Bwe,longDateFormat:Gwe,invalidDate:Ywe,ordinal:Xwe,dayOfMonthOrdinalParse:Qwe,relativeTime:Zwe,months:mbe,monthsShort:yH,week:Cbe,weekdays:Mbe,weekdaysMin:Obe,weekdaysShort:SH,meridiemParse:Jbe},Gt={},cv={},nw;function t_e(n,e){var t,r=Math.min(n.length,e.length);for(t=0;t<r;t+=1)if(n[t]!==e[t])return t;return r}function M4(n){return n&&n.toLowerCase().replace("_","-")}function n_e(n){for(var e=0,t,r,s,i;e<n.length;){for(i=M4(n[e]).split("-"),t=i.length,r=M4(n[e+1]),r=r?r.split("-"):null;t>0;){if(s=pk(i.slice(0,t).join("-")),s)return s;if(r&&r.length>=t&&t_e(i,r)>=t-1)break;t--}e++}return nw}function r_e(n){return!!(n&&n.match("^[^/\\\\]*$"))}function pk(n){var e=null,t;if(Gt[n]===void 0&&typeof module<"u"&&module&&module.exports&&r_e(n))try{e=nw._abbr,t=require,t("./locale/"+n),Fu(e)}catch{Gt[n]=null}return Gt[n]}function Fu(n,e){var t;return n&&(us(e)?t=tc(n):t=hO(n,e),t?nw=t:typeof console<"u"&&console.warn&&console.warn("Locale "+n+" not found. Did you forget to load it?")),nw._abbr}function hO(n,e){if(e!==null){var t,r=TH;if(e.abbr=n,Gt[n]!=null)cH("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=Gt[n]._config;else if(e.parentLocale!=null)if(Gt[e.parentLocale]!=null)r=Gt[e.parentLocale]._config;else if(t=pk(e.parentLocale),t!=null)r=t._config;else return cv[e.parentLocale]||(cv[e.parentLocale]=[]),cv[e.parentLocale].push({name:n,config:e}),null;return Gt[n]=new tO(MI(r,e)),cv[n]&&cv[n].forEach(function(s){hO(s.name,s.config)}),Fu(n),Gt[n]}else return delete Gt[n],null}function s_e(n,e){if(e!=null){var t,r,s=TH;Gt[n]!=null&&Gt[n].parentLocale!=null?Gt[n].set(MI(Gt[n]._config,e)):(r=pk(n),r!=null&&(s=r._config),e=MI(s,e),r==null&&(e.abbr=n),t=new tO(e),t.parentLocale=Gt[n],Gt[n]=t),Fu(n)}else Gt[n]!=null&&(Gt[n].parentLocale!=null?(Gt[n]=Gt[n].parentLocale,n===Fu()&&Fu(n)):Gt[n]!=null&&delete Gt[n]);return Gt[n]}function tc(n){var e;if(n&&n._locale&&n._locale._abbr&&(n=n._locale._abbr),!n)return nw;if(!Ta(n)){if(e=pk(n),e)return e;n=[n]}return n_e(n)}function i_e(){return OI(Gt)}function dO(n){var e,t=n._a;return t&&Ue(n).overflow===-2&&(e=t[Dl]<0||t[Dl]>11?Dl:t[uo]<1||t[uo]>oO(t[Fr],t[Dl])?uo:t[jn]<0||t[jn]>24||t[jn]===24&&(t[va]!==0||t[Rl]!==0||t[Th]!==0)?jn:t[va]<0||t[va]>59?va:t[Rl]<0||t[Rl]>59?Rl:t[Th]<0||t[Th]>999?Th:-1,Ue(n)._overflowDayOfYear&&(e<Fr||e>uo)&&(e=uo),Ue(n)._overflowWeeks&&e===-1&&(e=cbe),Ue(n)._overflowWeekday&&e===-1&&(e=ube),Ue(n).overflow=e),n}var a_e=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,o_e=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,l_e=/Z|[+-]\d\d(?::?\d\d)?/,_S=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],jN=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],c_e=/^\/?Date\((-?\d+)/i,u_e=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,h_e={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function CH(n){var e,t,r=n._i,s=a_e.exec(r)||o_e.exec(r),i,a,o,l,u=_S.length,h=jN.length;if(s){for(Ue(n).iso=!0,e=0,t=u;e<t;e++)if(_S[e][1].exec(s[1])){a=_S[e][0],i=_S[e][2]!==!1;break}if(a==null){n._isValid=!1;return}if(s[3]){for(e=0,t=h;e<t;e++)if(jN[e][1].exec(s[3])){o=(s[2]||" ")+jN[e][0];break}if(o==null){n._isValid=!1;return}}if(!i&&o!=null){n._isValid=!1;return}if(s[4])if(l_e.exec(s[4]))l="Z";else{n._isValid=!1;return}n._f=a+(o||"")+(l||""),pO(n)}else n._isValid=!1}function d_e(n,e,t,r,s,i){var a=[f_e(n),yH.indexOf(e),parseInt(t,10),parseInt(r,10),parseInt(s,10)];return i&&a.push(parseInt(i,10)),a}function f_e(n){var e=parseInt(n,10);return e<=49?2e3+e:e<=999?1900+e:e}function p_e(n){return n.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function m_e(n,e,t){if(n){var r=SH.indexOf(n),s=new Date(e[0],e[1],e[2]).getDay();if(r!==s)return Ue(t).weekdayMismatch=!0,t._isValid=!1,!1}return!0}function g_e(n,e,t){if(n)return h_e[n];if(e)return 0;var r=parseInt(t,10),s=r%100,i=(r-s)/100;return i*60+s}function kH(n){var e=u_e.exec(p_e(n._i)),t;if(e){if(t=d_e(e[4],e[3],e[2],e[5],e[6],e[7]),!m_e(e[1],t,n))return;n._a=t,n._tzm=g_e(e[8],e[9],e[10]),n._d=ew.apply(null,n._a),n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),Ue(n).rfc2822=!0}else n._isValid=!1}function y_e(n){var e=c_e.exec(n._i);if(e!==null){n._d=new Date(+e[1]);return}if(CH(n),n._isValid===!1)delete n._isValid;else return;if(kH(n),n._isValid===!1)delete n._isValid;else return;n._strict?n._isValid=!1:pe.createFromInputFallback(n)}pe.createFromInputFallback=Gi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(n){n._d=new Date(n._i+(n._useUTC?" UTC":""))});function sp(n,e,t){return n??e??t}function v_e(n){var e=new Date(pe.now());return n._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function fO(n){var e,t,r=[],s,i,a;if(!n._d){for(s=v_e(n),n._w&&n._a[uo]==null&&n._a[Dl]==null&&w_e(n),n._dayOfYear!=null&&(a=sp(n._a[Fr],s[Fr]),(n._dayOfYear>u0(a)||n._dayOfYear===0)&&(Ue(n)._overflowDayOfYear=!0),t=ew(a,0,n._dayOfYear),n._a[Dl]=t.getUTCMonth(),n._a[uo]=t.getUTCDate()),e=0;e<3&&n._a[e]==null;++e)n._a[e]=r[e]=s[e];for(;e<7;e++)n._a[e]=r[e]=n._a[e]==null?e===2?1:0:n._a[e];n._a[jn]===24&&n._a[va]===0&&n._a[Rl]===0&&n._a[Th]===0&&(n._nextDay=!0,n._a[jn]=0),n._d=(n._useUTC?ew:Abe).apply(null,r),i=n._useUTC?n._d.getUTCDay():n._d.getDay(),n._tzm!=null&&n._d.setUTCMinutes(n._d.getUTCMinutes()-n._tzm),n._nextDay&&(n._a[jn]=24),n._w&&typeof n._w.d<"u"&&n._w.d!==i&&(Ue(n).weekdayMismatch=!0)}}function w_e(n){var e,t,r,s,i,a,o,l,u;e=n._w,e.GG!=null||e.W!=null||e.E!=null?(i=1,a=4,t=sp(e.GG,n._a[Fr],tw(Ut(),1,4).year),r=sp(e.W,1),s=sp(e.E,1),(s<1||s>7)&&(l=!0)):(i=n._locale._week.dow,a=n._locale._week.doy,u=tw(Ut(),i,a),t=sp(e.gg,n._a[Fr],u.year),r=sp(e.w,u.week),e.d!=null?(s=e.d,(s<0||s>6)&&(l=!0)):e.e!=null?(s=e.e+i,(e.e<0||e.e>6)&&(l=!0)):s=i),r<1||r>Fl(t,i,a)?Ue(n)._overflowWeeks=!0:l!=null?Ue(n)._overflowWeekday=!0:(o=xH(t,r,s,i,a),n._a[Fr]=o.year,n._dayOfYear=o.dayOfYear)}pe.ISO_8601=function(){};pe.RFC_2822=function(){};function pO(n){if(n._f===pe.ISO_8601){CH(n);return}if(n._f===pe.RFC_2822){kH(n);return}n._a=[],Ue(n).empty=!0;var e=""+n._i,t,r,s,i,a,o=e.length,l=0,u,h;for(s=uH(n._f,n._locale).match(nO)||[],h=s.length,t=0;t<h;t++)i=s[t],r=(e.match(abe(i,n))||[])[0],r&&(a=e.substr(0,e.indexOf(r)),a.length>0&&Ue(n).unusedInput.push(a),e=e.slice(e.indexOf(r)+r.length),l+=r.length),Hp[i]?(r?Ue(n).empty=!1:Ue(n).unusedTokens.push(i),lbe(i,r,n)):n._strict&&!r&&Ue(n).unusedTokens.push(i);Ue(n).charsLeftOver=o-l,e.length>0&&Ue(n).unusedInput.push(e),n._a[jn]<=12&&Ue(n).bigHour===!0&&n._a[jn]>0&&(Ue(n).bigHour=void 0),Ue(n).parsedDateParts=n._a.slice(0),Ue(n).meridiem=n._meridiem,n._a[jn]=b_e(n._locale,n._a[jn],n._meridiem),u=Ue(n).era,u!==null&&(n._a[Fr]=n._locale.erasConvertYear(u,n._a[Fr])),fO(n),dO(n)}function b_e(n,e,t){var r;return t==null?e:n.meridiemHour!=null?n.meridiemHour(e,t):(n.isPM!=null&&(r=n.isPM(t),r&&e<12&&(e+=12),!r&&e===12&&(e=0)),e)}function __e(n){var e,t,r,s,i,a,o=!1,l=n._f.length;if(l===0){Ue(n).invalidFormat=!0,n._d=new Date(NaN);return}for(s=0;s<l;s++)i=0,a=!1,e=eO({},n),n._useUTC!=null&&(e._useUTC=n._useUTC),e._f=n._f[s],pO(e),ZM(e)&&(a=!0),i+=Ue(e).charsLeftOver,i+=Ue(e).unusedTokens.length*10,Ue(e).score=i,o?i<r&&(r=i,t=e):(r==null||i<r||a)&&(r=i,t=e,a&&(o=!0));Au(n,t||e)}function x_e(n){if(!n._d){var e=rO(n._i),t=e.day===void 0?e.date:e.day;n._a=oH([e.year,e.month,t,e.hour,e.minute,e.second,e.millisecond],function(r){return r&&parseInt(r,10)}),fO(n)}}function S_e(n){var e=new vx(dO(NH(n)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function NH(n){var e=n._i,t=n._f;return n._locale=n._locale||tc(n._l),e===null||t===void 0&&e===""?ok({nullInput:!0}):(typeof e=="string"&&(n._i=e=n._locale.preparse(e)),Ca(e)?new vx(dO(e)):(yx(e)?n._d=e:Ta(t)?__e(n):t?pO(n):E_e(n),ZM(n)||(n._d=null),n))}function E_e(n){var e=n._i;us(e)?n._d=new Date(pe.now()):yx(e)?n._d=new Date(e.valueOf()):typeof e=="string"?y_e(n):Ta(e)?(n._a=oH(e.slice(0),function(t){return parseInt(t,10)}),fO(n)):lf(e)?x_e(n):Ql(e)?n._d=new Date(e):pe.createFromInputFallback(n)}function PH(n,e,t,r,s){var i={};return(e===!0||e===!1)&&(r=e,e=void 0),(t===!0||t===!1)&&(r=t,t=void 0),(lf(n)&&JM(n)||Ta(n)&&n.length===0)&&(n=void 0),i._isAMomentObject=!0,i._useUTC=i._isUTC=s,i._l=t,i._i=n,i._f=e,i._strict=r,S_e(i)}function Ut(n,e,t,r){return PH(n,e,t,r,!1)}var A_e=Gi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ut.apply(null,arguments);return this.isValid()&&n.isValid()?n<this?this:n:ok()}),T_e=Gi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var n=Ut.apply(null,arguments);return this.isValid()&&n.isValid()?n>this?this:n:ok()});function IH(n,e){var t,r;if(e.length===1&&Ta(e[0])&&(e=e[0]),!e.length)return Ut();for(t=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][n](t))&&(t=e[r]);return t}function C_e(){var n=[].slice.call(arguments,0);return IH("isBefore",n)}function k_e(){var n=[].slice.call(arguments,0);return IH("isAfter",n)}var N_e=function(){return Date.now?Date.now():+new Date},uv=["year","quarter","month","week","day","hour","minute","second","millisecond"];function P_e(n){var e,t=!1,r,s=uv.length;for(e in n)if(it(n,e)&&!(gn.call(uv,e)!==-1&&(n[e]==null||!isNaN(n[e]))))return!1;for(r=0;r<s;++r)if(n[uv[r]]){if(t)return!1;parseFloat(n[uv[r]])!==qe(n[uv[r]])&&(t=!0)}return!0}function I_e(){return this._isValid}function D_e(){return Na(NaN)}function mk(n){var e=rO(n),t=e.year||0,r=e.quarter||0,s=e.month||0,i=e.week||e.isoWeek||0,a=e.day||0,o=e.hour||0,l=e.minute||0,u=e.second||0,h=e.millisecond||0;this._isValid=P_e(e),this._milliseconds=+h+u*1e3+l*6e4+o*1e3*60*60,this._days=+a+i*7,this._months=+s+r*3+t*12,this._data={},this._locale=tc(),this._bubble()}function oE(n){return n instanceof mk}function jI(n){return n<0?Math.round(-1*n)*-1:Math.round(n)}function R_e(n,e,t){var r=Math.min(n.length,e.length),s=Math.abs(n.length-e.length),i=0,a;for(a=0;a<r;a++)(t&&n[a]!==e[a]||!t&&qe(n[a])!==qe(e[a]))&&i++;return i+s}function DH(n,e){Te(n,0,0,function(){var t=this.utcOffset(),r="+";return t<0&&(t=-t,r="-"),r+To(~~(t/60),2)+e+To(~~t%60,2)})}DH("Z",":");DH("ZZ","");ve("Z",dk);ve("ZZ",dk);_t(["Z","ZZ"],function(n,e,t){t._useUTC=!0,t._tzm=mO(dk,n)});var M_e=/([\+\-]|\d\d)/gi;function mO(n,e){var t=(e||"").match(n),r,s,i;return t===null?null:(r=t[t.length-1]||[],s=(r+"").match(M_e)||["-",0,0],i=+(s[1]*60)+qe(s[2]),i===0?0:s[0]==="+"?i:-i)}function gO(n,e){var t,r;return e._isUTC?(t=e.clone(),r=(Ca(n)||yx(n)?n.valueOf():Ut(n).valueOf())-t.valueOf(),t._d.setTime(t._d.valueOf()+r),pe.updateOffset(t,!1),t):Ut(n).local()}function FI(n){return-Math.round(n._d.getTimezoneOffset())}pe.updateOffset=function(){};function O_e(n,e,t){var r=this._offset||0,s;if(!this.isValid())return n!=null?this:NaN;if(n!=null){if(typeof n=="string"){if(n=mO(dk,n),n===null)return this}else Math.abs(n)<16&&!t&&(n=n*60);return!this._isUTC&&e&&(s=FI(this)),this._offset=n,this._isUTC=!0,s!=null&&this.add(s,"m"),r!==n&&(!e||this._changeInProgress?OH(this,Na(n-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,pe.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?r:FI(this)}function L_e(n,e){return n!=null?(typeof n!="string"&&(n=-n),this.utcOffset(n,e),this):-this.utcOffset()}function j_e(n){return this.utcOffset(0,n)}function F_e(n){return this._isUTC&&(this.utcOffset(0,n),this._isUTC=!1,n&&this.subtract(FI(this),"m")),this}function $_e(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var n=mO(sbe,this._i);n!=null?this.utcOffset(n):this.utcOffset(0,!0)}return this}function U_e(n){return this.isValid()?(n=n?Ut(n).utcOffset():0,(this.utcOffset()-n)%60===0):!1}function V_e(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function B_e(){if(!us(this._isDSTShifted))return this._isDSTShifted;var n={},e;return eO(n,this),n=NH(n),n._a?(e=n._isUTC?No(n._a):Ut(n._a),this._isDSTShifted=this.isValid()&&R_e(n._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function z_e(){return this.isValid()?!this._isUTC:!1}function H_e(){return this.isValid()?this._isUTC:!1}function RH(){return this.isValid()?this._isUTC&&this._offset===0:!1}var W_e=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,G_e=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Na(n,e){var t=n,r=null,s,i,a;return oE(n)?t={ms:n._milliseconds,d:n._days,M:n._months}:Ql(n)||!isNaN(+n)?(t={},e?t[e]=+n:t.milliseconds=+n):(r=W_e.exec(n))?(s=r[1]==="-"?-1:1,t={y:0,d:qe(r[uo])*s,h:qe(r[jn])*s,m:qe(r[va])*s,s:qe(r[Rl])*s,ms:qe(jI(r[Th]*1e3))*s}):(r=G_e.exec(n))?(s=r[1]==="-"?-1:1,t={y:ch(r[2],s),M:ch(r[3],s),w:ch(r[4],s),d:ch(r[5],s),h:ch(r[6],s),m:ch(r[7],s),s:ch(r[8],s)}):t==null?t={}:typeof t=="object"&&("from"in t||"to"in t)&&(a=q_e(Ut(t.from),Ut(t.to)),t={},t.ms=a.milliseconds,t.M=a.months),i=new mk(t),oE(n)&&it(n,"_locale")&&(i._locale=n._locale),oE(n)&&it(n,"_isValid")&&(i._isValid=n._isValid),i}Na.fn=mk.prototype;Na.invalid=D_e;function ch(n,e){var t=n&&parseFloat(n.replace(",","."));return(isNaN(t)?0:t)*e}function O4(n,e){var t={};return t.months=e.month()-n.month()+(e.year()-n.year())*12,n.clone().add(t.months,"M").isAfter(e)&&--t.months,t.milliseconds=+e-+n.clone().add(t.months,"M"),t}function q_e(n,e){var t;return n.isValid()&&e.isValid()?(e=gO(e,n),n.isBefore(e)?t=O4(n,e):(t=O4(e,n),t.milliseconds=-t.milliseconds,t.months=-t.months),t):{milliseconds:0,months:0}}function MH(n,e){return function(t,r){var s,i;return r!==null&&!isNaN(+r)&&(cH(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),i=t,t=r,r=i),s=Na(t,r),OH(this,s,n),this}}function OH(n,e,t,r){var s=e._milliseconds,i=jI(e._days),a=jI(e._months);n.isValid()&&(r=r??!0,a&&wH(n,Z0(n,"Month")+a*t),i&&gH(n,"Date",Z0(n,"Date")+i*t),s&&n._d.setTime(n._d.valueOf()+s*t),r&&pe.updateOffset(n,i||a))}var Y_e=MH(1,"add"),K_e=MH(-1,"subtract");function LH(n){return typeof n=="string"||n instanceof String}function X_e(n){return Ca(n)||yx(n)||LH(n)||Ql(n)||J_e(n)||Q_e(n)||n===null||n===void 0}function Q_e(n){var e=lf(n)&&!JM(n),t=!1,r=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],s,i,a=r.length;for(s=0;s<a;s+=1)i=r[s],t=t||it(n,i);return e&&t}function J_e(n){var e=Ta(n),t=!1;return e&&(t=n.filter(function(r){return!Ql(r)&&LH(n)}).length===0),e&&t}function Z_e(n){var e=lf(n)&&!JM(n),t=!1,r=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],s,i;for(s=0;s<r.length;s+=1)i=r[s],t=t||it(n,i);return e&&t}function exe(n,e){var t=n.diff(e,"days",!0);return t<-6?"sameElse":t<-1?"lastWeek":t<0?"lastDay":t<1?"sameDay":t<2?"nextDay":t<7?"nextWeek":"sameElse"}function txe(n,e){arguments.length===1&&(arguments[0]?X_e(arguments[0])?(n=arguments[0],e=void 0):Z_e(arguments[0])&&(e=arguments[0],n=void 0):(n=void 0,e=void 0));var t=n||Ut(),r=gO(t,this).startOf("day"),s=pe.calendarFormat(this,r)||"sameElse",i=e&&(Po(e[s])?e[s].call(this,t):e[s]);return this.format(i||this.localeData().calendar(s,this,Ut(t)))}function nxe(){return new vx(this)}function rxe(n,e){var t=Ca(n)?n:Ut(n);return this.isValid()&&t.isValid()?(e=qi(e)||"millisecond",e==="millisecond"?this.valueOf()>t.valueOf():t.valueOf()<this.clone().startOf(e).valueOf()):!1}function sxe(n,e){var t=Ca(n)?n:Ut(n);return this.isValid()&&t.isValid()?(e=qi(e)||"millisecond",e==="millisecond"?this.valueOf()<t.valueOf():this.clone().endOf(e).valueOf()<t.valueOf()):!1}function ixe(n,e,t,r){var s=Ca(n)?n:Ut(n),i=Ca(e)?e:Ut(e);return this.isValid()&&s.isValid()&&i.isValid()?(r=r||"()",(r[0]==="("?this.isAfter(s,t):!this.isBefore(s,t))&&(r[1]===")"?this.isBefore(i,t):!this.isAfter(i,t))):!1}function axe(n,e){var t=Ca(n)?n:Ut(n),r;return this.isValid()&&t.isValid()?(e=qi(e)||"millisecond",e==="millisecond"?this.valueOf()===t.valueOf():(r=t.valueOf(),this.clone().startOf(e).valueOf()<=r&&r<=this.clone().endOf(e).valueOf())):!1}function oxe(n,e){return this.isSame(n,e)||this.isAfter(n,e)}function lxe(n,e){return this.isSame(n,e)||this.isBefore(n,e)}function cxe(n,e,t){var r,s,i;if(!this.isValid())return NaN;if(r=gO(n,this),!r.isValid())return NaN;switch(s=(r.utcOffset()-this.utcOffset())*6e4,e=qi(e),e){case"year":i=lE(this,r)/12;break;case"month":i=lE(this,r);break;case"quarter":i=lE(this,r)/3;break;case"second":i=(this-r)/1e3;break;case"minute":i=(this-r)/6e4;break;case"hour":i=(this-r)/36e5;break;case"day":i=(this-r-s)/864e5;break;case"week":i=(this-r-s)/6048e5;break;default:i=this-r}return t?i:Ri(i)}function lE(n,e){if(n.date()<e.date())return-lE(e,n);var t=(e.year()-n.year())*12+(e.month()-n.month()),r=n.clone().add(t,"months"),s,i;return e-r<0?(s=n.clone().add(t-1,"months"),i=(e-r)/(r-s)):(s=n.clone().add(t+1,"months"),i=(e-r)/(s-r)),-(t+i)||0}pe.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";pe.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function uxe(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function hxe(n){if(!this.isValid())return null;var e=n!==!0,t=e?this.clone().utc():this;return t.year()<0||t.year()>9999?aE(t,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Po(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",aE(t,"Z")):aE(t,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function dxe(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var n="moment",e="",t,r,s,i;return this.isLocal()||(n=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),t="["+n+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",s="-MM-DD[T]HH:mm:ss.SSS",i=e+'[")]',this.format(t+r+s+i)}function fxe(n){n||(n=this.isUtc()?pe.defaultFormatUtc:pe.defaultFormat);var e=aE(this,n);return this.localeData().postformat(e)}function pxe(n,e){return this.isValid()&&(Ca(n)&&n.isValid()||Ut(n).isValid())?Na({to:this,from:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function mxe(n){return this.from(Ut(),n)}function gxe(n,e){return this.isValid()&&(Ca(n)&&n.isValid()||Ut(n).isValid())?Na({from:this,to:n}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function yxe(n){return this.to(Ut(),n)}function jH(n){var e;return n===void 0?this._locale._abbr:(e=tc(n),e!=null&&(this._locale=e),this)}var FH=Gi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(n){return n===void 0?this.localeData():this.locale(n)});function $H(){return this._locale}var G1=1e3,Wp=60*G1,q1=60*Wp,UH=(365*400+97)*24*q1;function Gp(n,e){return(n%e+e)%e}function VH(n,e,t){return n<100&&n>=0?new Date(n+400,e,t)-UH:new Date(n,e,t).valueOf()}function BH(n,e,t){return n<100&&n>=0?Date.UTC(n+400,e,t)-UH:Date.UTC(n,e,t)}function vxe(n){var e,t;if(n=qi(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?BH:VH,n){case"year":e=t(this.year(),0,1);break;case"quarter":e=t(this.year(),this.month()-this.month()%3,1);break;case"month":e=t(this.year(),this.month(),1);break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=t(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Gp(e+(this._isUTC?0:this.utcOffset()*Wp),q1);break;case"minute":e=this._d.valueOf(),e-=Gp(e,Wp);break;case"second":e=this._d.valueOf(),e-=Gp(e,G1);break}return this._d.setTime(e),pe.updateOffset(this,!0),this}function wxe(n){var e,t;if(n=qi(n),n===void 0||n==="millisecond"||!this.isValid())return this;switch(t=this._isUTC?BH:VH,n){case"year":e=t(this.year()+1,0,1)-1;break;case"quarter":e=t(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=t(this.year(),this.month()+1,1)-1;break;case"week":e=t(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=t(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=t(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=q1-Gp(e+(this._isUTC?0:this.utcOffset()*Wp),q1)-1;break;case"minute":e=this._d.valueOf(),e+=Wp-Gp(e,Wp)-1;break;case"second":e=this._d.valueOf(),e+=G1-Gp(e,G1)-1;break}return this._d.setTime(e),pe.updateOffset(this,!0),this}function bxe(){return this._d.valueOf()-(this._offset||0)*6e4}function _xe(){return Math.floor(this.valueOf()/1e3)}function xxe(){return new Date(this.valueOf())}function Sxe(){var n=this;return[n.year(),n.month(),n.date(),n.hour(),n.minute(),n.second(),n.millisecond()]}function Exe(){var n=this;return{years:n.year(),months:n.month(),date:n.date(),hours:n.hours(),minutes:n.minutes(),seconds:n.seconds(),milliseconds:n.milliseconds()}}function Axe(){return this.isValid()?this.toISOString():null}function Txe(){return ZM(this)}function Cxe(){return Au({},Ue(this))}function kxe(){return Ue(this).overflow}function Nxe(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Te("N",0,0,"eraAbbr");Te("NN",0,0,"eraAbbr");Te("NNN",0,0,"eraAbbr");Te("NNNN",0,0,"eraName");Te("NNNNN",0,0,"eraNarrow");Te("y",["y",1],"yo","eraYear");Te("y",["yy",2],0,"eraYear");Te("y",["yyy",3],0,"eraYear");Te("y",["yyyy",4],0,"eraYear");ve("N",yO);ve("NN",yO);ve("NNN",yO);ve("NNNN",Uxe);ve("NNNNN",Vxe);_t(["N","NN","NNN","NNNN","NNNNN"],function(n,e,t,r){var s=t._locale.erasParse(n,r,t._strict);s?Ue(t).era=s:Ue(t).invalidEra=n});ve("y",Ry);ve("yy",Ry);ve("yyy",Ry);ve("yyyy",Ry);ve("yo",Bxe);_t(["y","yy","yyy","yyyy"],Fr);_t(["yo"],function(n,e,t,r){var s;t._locale._eraYearOrdinalRegex&&(s=n.match(t._locale._eraYearOrdinalRegex)),t._locale.eraYearOrdinalParse?e[Fr]=t._locale.eraYearOrdinalParse(n,s):e[Fr]=parseInt(n,10)});function Pxe(n,e){var t,r,s,i=this._eras||tc("en")._eras;for(t=0,r=i.length;t<r;++t){switch(typeof i[t].since){case"string":s=pe(i[t].since).startOf("day"),i[t].since=s.valueOf();break}switch(typeof i[t].until){case"undefined":i[t].until=1/0;break;case"string":s=pe(i[t].until).startOf("day").valueOf(),i[t].until=s.valueOf();break}}return i}function Ixe(n,e,t){var r,s,i=this.eras(),a,o,l;for(n=n.toUpperCase(),r=0,s=i.length;r<s;++r)if(a=i[r].name.toUpperCase(),o=i[r].abbr.toUpperCase(),l=i[r].narrow.toUpperCase(),t)switch(e){case"N":case"NN":case"NNN":if(o===n)return i[r];break;case"NNNN":if(a===n)return i[r];break;case"NNNNN":if(l===n)return i[r];break}else if([a,o,l].indexOf(n)>=0)return i[r]}function Dxe(n,e){var t=n.since<=n.until?1:-1;return e===void 0?pe(n.since).year():pe(n.since).year()+(e-n.offset)*t}function Rxe(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].name;return""}function Mxe(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].narrow;return""}function Oxe(){var n,e,t,r=this.localeData().eras();for(n=0,e=r.length;n<e;++n)if(t=this.clone().startOf("day").valueOf(),r[n].since<=t&&t<=r[n].until||r[n].until<=t&&t<=r[n].since)return r[n].abbr;return""}function Lxe(){var n,e,t,r,s=this.localeData().eras();for(n=0,e=s.length;n<e;++n)if(t=s[n].since<=s[n].until?1:-1,r=this.clone().startOf("day").valueOf(),s[n].since<=r&&r<=s[n].until||s[n].until<=r&&r<=s[n].since)return(this.year()-pe(s[n].since).year())*t+s[n].offset;return this.year()}function jxe(n){return it(this,"_erasNameRegex")||vO.call(this),n?this._erasNameRegex:this._erasRegex}function Fxe(n){return it(this,"_erasAbbrRegex")||vO.call(this),n?this._erasAbbrRegex:this._erasRegex}function $xe(n){return it(this,"_erasNarrowRegex")||vO.call(this),n?this._erasNarrowRegex:this._erasRegex}function yO(n,e){return e.erasAbbrRegex(n)}function Uxe(n,e){return e.erasNameRegex(n)}function Vxe(n,e){return e.erasNarrowRegex(n)}function Bxe(n,e){return e._eraYearOrdinalRegex||Ry}function vO(){var n=[],e=[],t=[],r=[],s,i,a,o,l,u=this.eras();for(s=0,i=u.length;s<i;++s)a=jl(u[s].name),o=jl(u[s].abbr),l=jl(u[s].narrow),e.push(a),n.push(o),t.push(l),r.push(a),r.push(o),r.push(l);this._erasRegex=new RegExp("^("+r.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+t.join("|")+")","i")}Te(0,["gg",2],0,function(){return this.weekYear()%100});Te(0,["GG",2],0,function(){return this.isoWeekYear()%100});function gk(n,e){Te(0,[n,n.length],0,e)}gk("gggg","weekYear");gk("ggggg","weekYear");gk("GGGG","isoWeekYear");gk("GGGGG","isoWeekYear");ve("G",hk);ve("g",hk);ve("GG",Vt,pi);ve("gg",Vt,pi);ve("GGGG",iO,sO);ve("gggg",iO,sO);ve("GGGGG",uk,lk);ve("ggggg",uk,lk);bx(["gggg","ggggg","GGGG","GGGGG"],function(n,e,t,r){e[r.substr(0,2)]=qe(n)});bx(["gg","GG"],function(n,e,t,r){e[r]=pe.parseTwoDigitYear(n)});function zxe(n){return zH.call(this,n,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Hxe(n){return zH.call(this,n,this.isoWeek(),this.isoWeekday(),1,4)}function Wxe(){return Fl(this.year(),1,4)}function Gxe(){return Fl(this.isoWeekYear(),1,4)}function qxe(){var n=this.localeData()._week;return Fl(this.year(),n.dow,n.doy)}function Yxe(){var n=this.localeData()._week;return Fl(this.weekYear(),n.dow,n.doy)}function zH(n,e,t,r,s){var i;return n==null?tw(this,r,s).year:(i=Fl(n,r,s),e>i&&(e=i),Kxe.call(this,n,e,t,r,s))}function Kxe(n,e,t,r,s){var i=xH(n,e,t,r,s),a=ew(i.year,0,i.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Te("Q",0,"Qo","quarter");ve("Q",hH);_t("Q",function(n,e){e[Dl]=(qe(n)-1)*3});function Xxe(n){return n==null?Math.ceil((this.month()+1)/3):this.month((n-1)*3+this.month()%3)}Te("D",["DD",2],"Do","date");ve("D",Vt,My);ve("DD",Vt,pi);ve("Do",function(n,e){return n?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});_t(["D","DD"],uo);_t("Do",function(n,e){e[uo]=qe(n.match(Vt)[0])});var HH=Oy("Date",!0);Te("DDD",["DDDD",3],"DDDo","dayOfYear");ve("DDD",ck);ve("DDDD",dH);_t(["DDD","DDDD"],function(n,e,t){t._dayOfYear=qe(n)});function Qxe(n){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return n==null?e:this.add(n-e,"d")}Te("m",["mm",2],0,"minute");ve("m",Vt,aO);ve("mm",Vt,pi);_t(["m","mm"],va);var Jxe=Oy("Minutes",!1);Te("s",["ss",2],0,"second");ve("s",Vt,aO);ve("ss",Vt,pi);_t(["s","ss"],Rl);var Zxe=Oy("Seconds",!1);Te("S",0,0,function(){return~~(this.millisecond()/100)});Te(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Te(0,["SSS",3],0,"millisecond");Te(0,["SSSS",4],0,function(){return this.millisecond()*10});Te(0,["SSSSS",5],0,function(){return this.millisecond()*100});Te(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Te(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Te(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Te(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});ve("S",ck,hH);ve("SS",ck,pi);ve("SSS",ck,dH);var Tu,WH;for(Tu="SSSS";Tu.length<=9;Tu+="S")ve(Tu,Ry);function eSe(n,e){e[Th]=qe(("0."+n)*1e3)}for(Tu="S";Tu.length<=9;Tu+="S")_t(Tu,eSe);WH=Oy("Milliseconds",!1);Te("z",0,0,"zoneAbbr");Te("zz",0,0,"zoneName");function tSe(){return this._isUTC?"UTC":""}function nSe(){return this._isUTC?"Coordinated Universal Time":""}var le=vx.prototype;le.add=Y_e;le.calendar=txe;le.clone=nxe;le.diff=cxe;le.endOf=wxe;le.format=fxe;le.from=pxe;le.fromNow=mxe;le.to=gxe;le.toNow=yxe;le.get=dbe;le.invalidAt=kxe;le.isAfter=rxe;le.isBefore=sxe;le.isBetween=ixe;le.isSame=axe;le.isSameOrAfter=oxe;le.isSameOrBefore=lxe;le.isValid=Txe;le.lang=FH;le.locale=jH;le.localeData=$H;le.max=T_e;le.min=A_e;le.parsingFlags=Cxe;le.set=fbe;le.startOf=vxe;le.subtract=K_e;le.toArray=Sxe;le.toObject=Exe;le.toDate=xxe;le.toISOString=hxe;le.inspect=dxe;typeof Symbol<"u"&&Symbol.for!=null&&(le[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});le.toJSON=Axe;le.toString=uxe;le.unix=_xe;le.valueOf=bxe;le.creationData=Nxe;le.eraName=Rxe;le.eraNarrow=Mxe;le.eraAbbr=Oxe;le.eraYear=Lxe;le.year=mH;le.isLeapYear=hbe;le.weekYear=zxe;le.isoWeekYear=Hxe;le.quarter=le.quarters=Xxe;le.month=bH;le.daysInMonth=xbe;le.week=le.weeks=Pbe;le.isoWeek=le.isoWeeks=Ibe;le.weeksInYear=qxe;le.weeksInWeekYear=Yxe;le.isoWeeksInYear=Wxe;le.isoWeeksInISOWeekYear=Gxe;le.date=HH;le.day=le.days=Hbe;le.weekday=Wbe;le.isoWeekday=Gbe;le.dayOfYear=Qxe;le.hour=le.hours=Zbe;le.minute=le.minutes=Jxe;le.second=le.seconds=Zxe;le.millisecond=le.milliseconds=WH;le.utcOffset=O_e;le.utc=j_e;le.local=F_e;le.parseZone=$_e;le.hasAlignedHourOffset=U_e;le.isDST=V_e;le.isLocal=z_e;le.isUtcOffset=H_e;le.isUtc=RH;le.isUTC=RH;le.zoneAbbr=tSe;le.zoneName=nSe;le.dates=Gi("dates accessor is deprecated. Use date instead.",HH);le.months=Gi("months accessor is deprecated. Use month instead",bH);le.years=Gi("years accessor is deprecated. Use year instead",mH);le.zone=Gi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",L_e);le.isDSTShifted=Gi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",B_e);function rSe(n){return Ut(n*1e3)}function sSe(){return Ut.apply(null,arguments).parseZone()}function GH(n){return n}var at=tO.prototype;at.calendar=zwe;at.longDateFormat=qwe;at.invalidDate=Kwe;at.ordinal=Jwe;at.preparse=GH;at.postformat=GH;at.relativeTime=ebe;at.pastFuture=tbe;at.set=Vwe;at.eras=Pxe;at.erasParse=Ixe;at.erasConvertYear=Dxe;at.erasAbbrRegex=Fxe;at.erasNameRegex=jxe;at.erasNarrowRegex=$xe;at.months=vbe;at.monthsShort=wbe;at.monthsParse=_be;at.monthsRegex=Ebe;at.monthsShortRegex=Sbe;at.week=Tbe;at.firstDayOfYear=Nbe;at.firstDayOfWeek=kbe;at.weekdays=$be;at.weekdaysMin=Vbe;at.weekdaysShort=Ube;at.weekdaysParse=zbe;at.weekdaysRegex=qbe;at.weekdaysShortRegex=Ybe;at.weekdaysMinRegex=Kbe;at.isPM=Qbe;at.meridiem=e_e;function Y1(n,e,t,r){var s=tc(),i=No().set(r,e);return s[t](i,n)}function qH(n,e,t){if(Ql(n)&&(e=n,n=void 0),n=n||"",e!=null)return Y1(n,e,t,"month");var r,s=[];for(r=0;r<12;r++)s[r]=Y1(n,r,t,"month");return s}function wO(n,e,t,r){typeof n=="boolean"?(Ql(e)&&(t=e,e=void 0),e=e||""):(e=n,t=e,n=!1,Ql(e)&&(t=e,e=void 0),e=e||"");var s=tc(),i=n?s._week.dow:0,a,o=[];if(t!=null)return Y1(e,(t+i)%7,r,"day");for(a=0;a<7;a++)o[a]=Y1(e,(a+i)%7,r,"day");return o}function iSe(n,e){return qH(n,e,"months")}function aSe(n,e){return qH(n,e,"monthsShort")}function oSe(n,e,t){return wO(n,e,t,"weekdays")}function lSe(n,e,t){return wO(n,e,t,"weekdaysShort")}function cSe(n,e,t){return wO(n,e,t,"weekdaysMin")}Fu("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(n){var e=n%10,t=qe(n%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return n+t}});pe.lang=Gi("moment.lang is deprecated. Use moment.locale instead.",Fu);pe.langData=Gi("moment.langData is deprecated. Use moment.localeData instead.",tc);var Oo=Math.abs;function uSe(){var n=this._data;return this._milliseconds=Oo(this._milliseconds),this._days=Oo(this._days),this._months=Oo(this._months),n.milliseconds=Oo(n.milliseconds),n.seconds=Oo(n.seconds),n.minutes=Oo(n.minutes),n.hours=Oo(n.hours),n.months=Oo(n.months),n.years=Oo(n.years),this}function YH(n,e,t,r){var s=Na(e,t);return n._milliseconds+=r*s._milliseconds,n._days+=r*s._days,n._months+=r*s._months,n._bubble()}function hSe(n,e){return YH(this,n,e,1)}function dSe(n,e){return YH(this,n,e,-1)}function L4(n){return n<0?Math.floor(n):Math.ceil(n)}function fSe(){var n=this._milliseconds,e=this._days,t=this._months,r=this._data,s,i,a,o,l;return n>=0&&e>=0&&t>=0||n<=0&&e<=0&&t<=0||(n+=L4($I(t)+e)*864e5,e=0,t=0),r.milliseconds=n%1e3,s=Ri(n/1e3),r.seconds=s%60,i=Ri(s/60),r.minutes=i%60,a=Ri(i/60),r.hours=a%24,e+=Ri(a/24),l=Ri(KH(e)),t+=l,e-=L4($I(l)),o=Ri(t/12),t%=12,r.days=e,r.months=t,r.years=o,this}function KH(n){return n*4800/146097}function $I(n){return n*146097/4800}function pSe(n){if(!this.isValid())return NaN;var e,t,r=this._milliseconds;if(n=qi(n),n==="month"||n==="quarter"||n==="year")switch(e=this._days+r/864e5,t=this._months+KH(e),n){case"month":return t;case"quarter":return t/3;case"year":return t/12}else switch(e=this._days+Math.round($I(this._months)),n){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return e*24+r/36e5;case"minute":return e*1440+r/6e4;case"second":return e*86400+r/1e3;case"millisecond":return Math.floor(e*864e5)+r;default:throw new Error("Unknown unit "+n)}}function nc(n){return function(){return this.as(n)}}var XH=nc("ms"),mSe=nc("s"),gSe=nc("m"),ySe=nc("h"),vSe=nc("d"),wSe=nc("w"),bSe=nc("M"),_Se=nc("Q"),xSe=nc("y"),SSe=XH;function ESe(){return Na(this)}function ASe(n){return n=qi(n),this.isValid()?this[n+"s"]():NaN}function Uf(n){return function(){return this.isValid()?this._data[n]:NaN}}var TSe=Uf("milliseconds"),CSe=Uf("seconds"),kSe=Uf("minutes"),NSe=Uf("hours"),PSe=Uf("days"),ISe=Uf("months"),DSe=Uf("years");function RSe(){return Ri(this.days()/7)}var Uo=Math.round,Tp={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function MSe(n,e,t,r,s){return s.relativeTime(e||1,!!t,n,r)}function OSe(n,e,t,r){var s=Na(n).abs(),i=Uo(s.as("s")),a=Uo(s.as("m")),o=Uo(s.as("h")),l=Uo(s.as("d")),u=Uo(s.as("M")),h=Uo(s.as("w")),f=Uo(s.as("y")),p=i<=t.ss&&["s",i]||i<t.s&&["ss",i]||a<=1&&["m"]||a<t.m&&["mm",a]||o<=1&&["h"]||o<t.h&&["hh",o]||l<=1&&["d"]||l<t.d&&["dd",l];return t.w!=null&&(p=p||h<=1&&["w"]||h<t.w&&["ww",h]),p=p||u<=1&&["M"]||u<t.M&&["MM",u]||f<=1&&["y"]||["yy",f],p[2]=e,p[3]=+n>0,p[4]=r,MSe.apply(null,p)}function LSe(n){return n===void 0?Uo:typeof n=="function"?(Uo=n,!0):!1}function jSe(n,e){return Tp[n]===void 0?!1:e===void 0?Tp[n]:(Tp[n]=e,n==="s"&&(Tp.ss=e-1),!0)}function FSe(n,e){if(!this.isValid())return this.localeData().invalidDate();var t=!1,r=Tp,s,i;return typeof n=="object"&&(e=n,n=!1),typeof n=="boolean"&&(t=n),typeof e=="object"&&(r=Object.assign({},Tp,e),e.s!=null&&e.ss==null&&(r.ss=e.s-1)),s=this.localeData(),i=OSe(this,!t,r,s),t&&(i=s.pastFuture(+this,i)),s.postformat(i)}var FN=Math.abs;function Jf(n){return(n>0)-(n<0)||+n}function yk(){if(!this.isValid())return this.localeData().invalidDate();var n=FN(this._milliseconds)/1e3,e=FN(this._days),t=FN(this._months),r,s,i,a,o=this.asSeconds(),l,u,h,f;return o?(r=Ri(n/60),s=Ri(r/60),n%=60,r%=60,i=Ri(t/12),t%=12,a=n?n.toFixed(3).replace(/\.?0+$/,""):"",l=o<0?"-":"",u=Jf(this._months)!==Jf(o)?"-":"",h=Jf(this._days)!==Jf(o)?"-":"",f=Jf(this._milliseconds)!==Jf(o)?"-":"",l+"P"+(i?u+i+"Y":"")+(t?u+t+"M":"")+(e?h+e+"D":"")+(s||r||n?"T":"")+(s?f+s+"H":"")+(r?f+r+"M":"")+(n?f+a+"S":"")):"P0D"}var et=mk.prototype;et.isValid=I_e;et.abs=uSe;et.add=hSe;et.subtract=dSe;et.as=pSe;et.asMilliseconds=XH;et.asSeconds=mSe;et.asMinutes=gSe;et.asHours=ySe;et.asDays=vSe;et.asWeeks=wSe;et.asMonths=bSe;et.asQuarters=_Se;et.asYears=xSe;et.valueOf=SSe;et._bubble=fSe;et.clone=ESe;et.get=ASe;et.milliseconds=TSe;et.seconds=CSe;et.minutes=kSe;et.hours=NSe;et.days=PSe;et.weeks=RSe;et.months=ISe;et.years=DSe;et.humanize=FSe;et.toISOString=yk;et.toString=yk;et.toJSON=yk;et.locale=jH;et.localeData=$H;et.toIsoString=Gi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",yk);et.lang=FH;Te("X",0,0,"unix");Te("x",0,0,"valueOf");ve("x",hk);ve("X",ibe);_t("X",function(n,e,t){t._d=new Date(parseFloat(n)*1e3)});_t("x",function(n,e,t){t._d=new Date(qe(n))});//! moment.js
pe.version="2.30.1";$we(Ut);pe.fn=le;pe.min=C_e;pe.max=k_e;pe.now=N_e;pe.utc=No;pe.unix=rSe;pe.months=iSe;pe.isDate=yx;pe.locale=Fu;pe.invalid=ok;pe.duration=Na;pe.isMoment=Ca;pe.weekdays=oSe;pe.parseZone=sSe;pe.localeData=tc;pe.isDuration=oE;pe.monthsShort=aSe;pe.weekdaysMin=cSe;pe.defineLocale=hO;pe.updateLocale=s_e;pe.locales=i_e;pe.weekdaysShort=lSe;pe.normalizeUnits=qi;pe.relativeTimeRounding=LSe;pe.relativeTimeThreshold=jSe;pe.calendarFormat=exe;pe.prototype=le;pe.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};const rw={_origin:"https://api.emailjs.com"},$Se=(n,e="https://api.emailjs.com")=>{rw._userID=n,rw._origin=e},QH=(n,e,t)=>{if(!n)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!e)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates";return!0};class j4{constructor(e){this.status=e?e.status:0,this.text=e?e.responseText:"Network Error"}}const JH=(n,e,t={})=>new Promise((r,s)=>{const i=new XMLHttpRequest;i.addEventListener("load",({target:a})=>{const o=new j4(a);o.status===200||o.text==="OK"?r(o):s(o)}),i.addEventListener("error",({target:a})=>{s(new j4(a))}),i.open("POST",rw._origin+n,!0),Object.keys(t).forEach(a=>{i.setRequestHeader(a,t[a])}),i.send(e)}),USe=(n,e,t,r)=>{const s=r||rw._userID;return QH(s,n,e),JH("/api/v1.0/email/send",JSON.stringify({lib_version:"3.12.1",user_id:s,service_id:n,template_id:e,template_params:t}),{"Content-type":"application/json"})},VSe=n=>{let e;if(typeof n=="string"?e=document.querySelector(n):e=n,!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of form";return e},BSe=(n,e,t,r)=>{const s=r||rw._userID,i=VSe(t);QH(s,n,e);const a=new FormData(i);return a.append("lib_version","3.12.1"),a.append("service_id",n),a.append("template_id",e),a.append("user_id",s),JH("/api/v1.0/email/send-form",a)},bO={init:$Se,send:USe,sendForm:BSe},zSe="modulepreload",HSe=function(n){return"/"+n},F4={},UI=function(e,t,r){if(!t||t.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=HSe(i),i in F4)return;F4[i]=!0;const a=i.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!r)for(let h=s.length-1;h>=0;h--){const f=s[h];if(f.href===i&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${o}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":zSe,a||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),a)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i})},Qr=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),VI=[.001,0,0,.001,0,0],$N=1.35,ti={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},_c={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},sw="pdfjs_internal_editor_",Fe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Qe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},WSe={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},nr={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},cE={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},_n={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},ip={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},vk={ERRORS:0,WARNINGS:1,INFOS:5},iw={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},xS={moveTo:0,lineTo:1,curveTo:2,closePath:3},GSe={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let wk=vk.WARNINGS;function qSe(n){Number.isInteger(n)&&(wk=n)}function YSe(){return wk}function bk(n){wk>=vk.INFOS&&console.info(`Info: ${n}`)}function Oe(n){wk>=vk.WARNINGS&&console.warn(`Warning: ${n}`)}function Tt(n){throw new Error(n)}function Je(n,e){n||Tt(e)}function KSe(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ZH(n,e=null,t=null){if(!n)return null;if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=eEe(n)}catch{}}const r=e?URL.parse(n,e):URL.parse(n);return KSe(r)?r:null}function e9(n,e,t=!1){const r=URL.parse(n);return r?(r.hash=e,r.href):t&&ZH(n,"http://example.com")?n.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ve(n,e,t,r=!1){return Object.defineProperty(n,e,{value:t,enumerable:!r,configurable:!0,writable:!1}),t}const Vf=function(){function e(t,r){this.message=t,this.name=r}return e.prototype=new Error,e.constructor=e,e}();class $4 extends Vf{constructor(e,t){super(e,"PasswordException"),this.code=t}}class UN extends Vf{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class BI extends Vf{constructor(e){super(e,"InvalidPDFException")}}class K1 extends Vf{constructor(e,t,r){super(e,"ResponseException"),this.status=t,this.missing=r}}class XSe extends Vf{constructor(e){super(e,"FormatError")}}class qu extends Vf{constructor(e){super(e,"AbortException")}}function t9(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Tt("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const r=[];for(let s=0;s<e;s+=t){const i=Math.min(s+t,e),a=n.subarray(s,i);r.push(String.fromCharCode.apply(null,a))}return r.join("")}function _x(n){typeof n!="string"&&Tt("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let r=0;r<e;++r)t[r]=n.charCodeAt(r)&255;return t}function QSe(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function JSe(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function ZSe(){try{return new Function(""),!0}catch{return!1}}class mr{static get isLittleEndian(){return Ve(this,"isLittleEndian",JSe())}static get isEvalSupported(){return Ve(this,"isEvalSupported",ZSe())}static get isOffscreenCanvasSupported(){return Ve(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ve(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ve(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){var e,t;return Ve(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const VN=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var Yp,uE,cw,zI;class ye{static makeHexColor(e,t,r){return`#${VN[e]}${VN[t]}${VN[r]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let r;e[0]?(e[0]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[3],t[3]*=e[3]):(r=t[0],t[0]=t[1],t[1]=r,r=t[2],t[2]=t[3],t[3]=r,e[1]<0&&(r=t[1],t[1]=t[3],t[3]=r),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(r=t[0],t[0]=t[2],t[2]=r),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,r=0){const s=e[r],i=e[r+1];e[r]=s*t[0]+i*t[2]+t[4],e[r+1]=s*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,r=0){const s=t[0],i=t[1],a=t[2],o=t[3],l=t[4],u=t[5];for(let h=0;h<6;h+=2){const f=e[r+h],p=e[r+h+1];e[r+h]=f*s+p*a+l,e[r+h+1]=f*i+p*o+u}}static applyInverseTransform(e,t){const r=e[0],s=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(r*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-r*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,r){const s=t[0],i=t[1],a=t[2],o=t[3],l=t[4],u=t[5],h=e[0],f=e[1],p=e[2],g=e[3];let v=s*h+l,y=v,_=s*p+l,w=_,b=o*f+u,S=b,T=o*g+u,P=T;if(i!==0||a!==0){const R=i*h,k=i*p,C=a*f,I=a*g;v+=C,w+=C,_+=I,y+=I,b+=R,P+=R,T+=k,S+=k}r[0]=Math.min(r[0],v,_,y,w),r[1]=Math.min(r[1],b,T,S,P),r[2]=Math.max(r[2],v,_,y,w),r[3]=Math.max(r[3],b,T,S,P)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const r=e[0],s=e[1],i=e[2],a=e[3],o=r**2+s**2,l=r*i+s*a,u=i**2+a**2,h=(o+u)/2,f=Math.sqrt(h**2-(o*u-l**2));t[0]=Math.sqrt(h+f||1),t[1]=Math.sqrt(h-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const r=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(r>s)return null;const i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[r,i,s,a]}static pointBoundingBox(e,t,r){r[0]=Math.min(r[0],e),r[1]=Math.min(r[1],t),r[2]=Math.max(r[2],e),r[3]=Math.max(r[3],t)}static rectBoundingBox(e,t,r,s,i){i[0]=Math.min(i[0],e,r),i[1]=Math.min(i[1],t,s),i[2]=Math.max(i[2],e,r),i[3]=Math.max(i[3],t,s)}static bezierBoundingBox(e,t,r,s,i,a,o,l,u){u[0]=Math.min(u[0],e,o),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,o),u[3]=Math.max(u[3],t,l),D(this,cw,zI).call(this,e,r,i,o,t,s,a,l,3*(-e+3*(r-i)+o),6*(e-2*r+i),3*(r-e),u),D(this,cw,zI).call(this,e,r,i,o,t,s,a,l,3*(-t+3*(s-a)+l),6*(t-2*s+a),3*(s-t),u)}}Yp=new WeakSet,uE=function(e,t,r,s,i,a,o,l,u,h){if(u<=0||u>=1)return;const f=1-u,p=u*u,g=p*u,v=f*(f*(f*e+3*u*t)+3*p*r)+g*s,y=f*(f*(f*i+3*u*a)+3*p*o)+g*l;h[0]=Math.min(h[0],v),h[1]=Math.min(h[1],y),h[2]=Math.max(h[2],v),h[3]=Math.max(h[3],y)},cw=new WeakSet,zI=function(e,t,r,s,i,a,o,l,u,h,f,p){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&D(this,Yp,uE).call(this,e,t,r,s,i,a,o,l,-f/h,p);return}const g=h**2-4*f*u;if(g<0)return;const v=Math.sqrt(g),y=2*u;D(this,Yp,uE).call(this,e,t,r,s,i,a,o,l,(-h+v)/y,p),D(this,Yp,uE).call(this,e,t,r,s,i,a,o,l,(-h-v)/y,p)},x(ye,Yp),x(ye,cw);function eEe(n){return decodeURIComponent(escape(n))}let BN=null,U4=null;function tEe(n){return BN||(BN=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,U4=new Map([["","t"]])),n.replaceAll(BN,(e,t,r)=>t?t.normalize("NFKC"):U4.get(r))}function n9(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),t9(n)}const _O="pdfjs_internal_id_";function nEe(n,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[r,s,...i]=t;if(!n(r)&&!Number.isInteger(r)||!e(s))return!1;const a=i.length;let o=!0;switch(s.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;o=!1;break;default:return!1}for(const l of i)if(!(typeof l=="number"||o&&l===null))return!1;return!0}function Jr(n,e,t){return Math.min(Math.max(n,e),t)}function r9(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(t9(n))}function rEe(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):_x(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((e,t)=>e+t,0)});class aw{static textContent(e){const t=[],r={items:t,styles:Object.create(null)};function s(i){var l;if(!i)return;let a=null;const o=i.name;if(o==="#text")a=i.value;else if(aw.shouldBuildText(o))(l=i==null?void 0:i.attributes)!=null&&l.textContent?a=i.attributes.textContent:i.value&&(a=i.value);else return;if(a!==null&&t.push({str:a}),!!i.children)for(const u of i.children)s(u)}return s(e),r}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class s9{static setupStorage(e,t,r,s,i){const a=s.getValue(t,{value:null});switch(r.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),i==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})});break;case"input":if(r.attributes.type==="radio"||r.attributes.type==="checkbox"){if(a.value===r.attributes.xfaOn?e.setAttribute("checked",!0):a.value===r.attributes.xfaOff&&e.removeAttribute("checked"),i==="print")break;e.addEventListener("change",o=>{s.setValue(t,{value:o.target.checked?o.target.getAttribute("xfaOn"):o.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),i==="print")break;e.addEventListener("input",o=>{s.setValue(t,{value:o.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const o of r.children)o.attributes.value===a.value?o.attributes.selected=!0:o.attributes.hasOwnProperty("selected")&&delete o.attributes.selected}e.addEventListener("input",o=>{const l=o.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:r=null,intent:s,linkService:i}){const{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${s}`);for(const[l,u]of Object.entries(a))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!o||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}o&&i.addLinkAttributes(e,a.href,a.newWindow),r&&a.dataId&&this.setupStorage(e,a.dataId,t,r)}static render(e){var f,p;const t=e.annotationStorage,r=e.linkService,s=e.xfaHtml,i=e.intent||"display",a=document.createElement(s.name);s.attributes&&this.setAttributes({html:a,element:s,intent:i,linkService:r});const o=i!=="richText",l=e.div;if(l.append(a),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=g}o&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);a.append(g),o&&aw.shouldBuildText(s.name)&&u.push(g)}return{textDivs:u}}const h=[[s,-1,a]];for(;h.length>0;){const[g,v,y]=h.at(-1);if(v+1===g.children.length){h.pop();continue}const _=g.children[++h.at(-1)[1]];if(_===null)continue;const{name:w}=_;if(w==="#text"){const S=document.createTextNode(_.value);u.push(S),y.append(S);continue}const b=(f=_==null?void 0:_.attributes)!=null&&f.xmlns?document.createElementNS(_.attributes.xmlns,w):document.createElement(w);if(y.append(b),_.attributes&&this.setAttributes({html:b,element:_,storage:t,intent:i,linkService:r}),((p=_.children)==null?void 0:p.length)>0)h.push([_,-1,b]);else if(_.value){const S=document.createTextNode(_.value);o&&aw.shouldBuildText(w)&&u.push(S),b.append(S)}}for(const g of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Lo="http://www.w3.org/2000/svg",wh=class wh{};ie(wh,"CSS",96),ie(wh,"PDF",72),ie(wh,"PDF_TO_CSS_UNITS",wh.CSS/wh.PDF);let Yu=wh;async function xx(n,e="text"){if(Tv(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,r)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}r(new Error(s.statusText))}},s.send(null)})}class Sx{constructor({viewBox:e,userUnit:t,scale:r,rotation:s,offsetX:i=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=r,this.rotation=s,this.offsetX=i,this.offsetY=a,r*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,f,p,g;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,f=0,p=0,g=1;break;case 90:h=0,f=1,p=1,g=0;break;case 270:h=0,f=-1,p=-1,g=0;break;case 0:h=1,f=0,p=0,g=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}o&&(p=-p,g=-g);let v,y,_,w;h===0?(v=Math.abs(u-e[1])*r+i,y=Math.abs(l-e[0])*r+a,_=(e[3]-e[1])*r,w=(e[2]-e[0])*r):(v=Math.abs(l-e[0])*r+i,y=Math.abs(u-e[1])*r+a,_=(e[2]-e[0])*r,w=(e[3]-e[1])*r),this.transform=[h*r,f*r,p*r,g*r,v-h*r*l-p*r*u,y-f*r*l-g*r*u],this.width=_,this.height=w}get rawDims(){const e=this.viewBox;return Ve(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:r=this.offsetX,offsetY:s=this.offsetY,dontFlip:i=!1}={}){return new Sx({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:s,dontFlip:i})}convertToViewportPoint(e,t){const r=[e,t];return ye.applyTransform(r,this.transform),r}convertToViewportRectangle(e){const t=[e[0],e[1]];ye.applyTransform(t,this.transform);const r=[e[2],e[3]];return ye.applyTransform(r,this.transform),[t[0],t[1],r[0],r[1]]}convertToPdfPoint(e,t){const r=[e,t];return ye.applyInverseTransform(r,this.transform),r}}class xO extends Vf{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function _k(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function SO(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function sEe(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function iEe(n,e="document.pdf"){if(typeof n!="string")return e;if(_k(n))return Oe('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const r=(o=>{try{return new URL(o)}catch{try{return new URL(decodeURIComponent(o))}catch{try{return new URL(o,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(o),"https://foo.bar")}catch{return null}}}}})(n);if(!r)return e;const s=o=>{try{let l=decodeURIComponent(o);return l.includes("/")?(l=l.split("/").at(-1),l.test(/^\.pdf$/i)?l:o):l}catch{return o}},i=/\.pdf$/i,a=r.pathname.split("/").at(-1);if(i.test(a))return s(a);if(r.searchParams.size>0){const o=Array.from(r.searchParams.values()).reverse();for(const u of o)if(i.test(u))return s(u);const l=Array.from(r.searchParams.keys()).reverse();for(const u of l)if(i.test(u))return s(u)}if(r.hash){const l=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(r.hash);if(l)return s(l[0])}return e}class V4{constructor(){ie(this,"started",Object.create(null));ie(this,"times",[])}time(e){e in this.started&&Oe(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Oe(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:r}of this.times)t=Math.max(r.length,t);for(const{name:r,start:s,end:i}of this.times)e.push(`${r.padEnd(t)} ${i-s}ms
`);return e.join("")}}function Tv(n,e){const t=e?URL.parse(n,e):URL.parse(n);return(t==null?void 0:t.protocol)==="http:"||(t==null?void 0:t.protocol)==="https:"}function Hi(n){n.preventDefault()}function cn(n){n.preventDefault(),n.stopPropagation()}function aEe(n){console.log("Deprecated API usage: "+n)}var uw;class X1{static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;c(this,uw)||A(this,uw,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,uw).exec(e);if(!t)return null;const r=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,u==="-"?(a+=h,o+=f):u==="+"&&(a-=h,o-=f),new Date(Date.UTC(r,s,i,a,o,l))}}uw=new WeakMap,x(X1,uw,void 0);function oEe(n,{scale:e=1,rotation:t=0}){const{width:r,height:s}=n.attributes.style,i=[0,0,parseInt(r),parseInt(s)];return new Sx({viewBox:i,userUnit:1,scale:e,rotation:t})}function Ex(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Oe(`Not a valid color format: "${n}"`),[0,0,0])}function lEe(n){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of n.keys()){e.style.color=t;const r=window.getComputedStyle(e).color;n.set(t,Ex(r))}e.remove()}function Kt(n){const{a:e,b:t,c:r,d:s,e:i,f:a}=n.getTransform();return[e,t,r,s,i,a]}function Ma(n){const{a:e,b:t,c:r,d:s,e:i,f:a}=n.getTransform().invertSelf();return[e,t,r,s,i,a]}function Nf(n,e,t=!1,r=!0){if(e instanceof Sx){const{pageWidth:s,pageHeight:i}=e.rawDims,{style:a}=n,o=mr.isCSSRoundSupported,l=`var(--total-scale-factor) * ${s}px`,u=`var(--total-scale-factor) * ${i}px`,h=o?`round(down, ${l}, var(--scale-round-x))`:`calc(${l})`,f=o?`round(down, ${u}, var(--scale-round-y))`:`calc(${u})`;!t||e.rotation%180===0?(a.width=h,a.height=f):(a.width=f,a.height=h)}r&&n.setAttribute("data-main-rotation",e.rotation)}class Co{constructor(){const{pixelRatio:e}=Co;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,r,s,i=-1){let a=1/0,o=1/0,l=1/0;r=Co.capPixels(r,i),r>0&&(a=Math.sqrt(r/(e*t))),s!==-1&&(o=s/e,l=s/t);const u=Math.min(a,o,l);return this.sx>u||this.sy>u?(this.sx=u,this.sy=u,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const r=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,r):r}return e}}const HI=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class cEe{static get isDarkMode(){var e;return Ve(this,"isDarkMode",!!((e=window==null?void 0:window.matchMedia)!=null&&e.call(window,"(prefers-color-scheme: dark)").matches))}}class uEe{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:r}=window.getComputedStyle(e);return e.remove(),Ve(this,"commentForegroundColor",Ex(r))}}function hEe(n,e,t,r){r=Math.min(Math.max(r??1,0),1);const s=255*(1-r);return n=Math.round(n*r+s),e=Math.round(e*r+s),t=Math.round(t*r+s),[n,e,t]}function B4(n,e){const t=n[0]/255,r=n[1]/255,s=n[2]/255,i=Math.max(t,r,s),a=Math.min(t,r,s),o=(i+a)/2;if(i===a)e[0]=e[1]=0;else{const l=i-a;switch(e[1]=o<.5?l/(i+a):l/(2-i-a),i){case t:e[0]=((r-s)/l+(r<s?6:0))*60;break;case r:e[0]=((s-t)/l+2)*60;break;case s:e[0]=((t-r)/l+4)*60;break}}e[2]=o}function WI(n,e){const t=n[0],r=n[1],s=n[2],i=(1-Math.abs(2*s-1))*r,a=i*(1-Math.abs(t/60%2-1)),o=s-i/2;switch(Math.floor(t/60)){case 0:e[0]=i+o,e[1]=a+o,e[2]=o;break;case 1:e[0]=a+o,e[1]=i+o,e[2]=o;break;case 2:e[0]=o,e[1]=i+o,e[2]=a+o;break;case 3:e[0]=o,e[1]=a+o,e[2]=i+o;break;case 4:e[0]=a+o,e[1]=o,e[2]=i+o;break;case 5:case 6:e[0]=i+o,e[1]=o,e[2]=a+o;break}}function z4(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function H4(n,e,t){WI(n,t),t.map(z4);const r=.2126*t[0]+.7152*t[1]+.0722*t[2];WI(e,t),t.map(z4);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return r>s?(r+.05)/(s+.05):(s+.05)/(r+.05)}const W4=new Map;function dEe(n,e){const t=n[0]+n[1]*256+n[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let r=W4.get(t);if(r)return r;const s=new Float32Array(9),i=s.subarray(0,3),a=s.subarray(3,6);B4(n,a);const o=s.subarray(6,9);B4(e,o);const l=o[2]<.5,u=l?12:4.5;if(a[2]=l?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),H4(a,o,i)<u){let h,f;l?(h=a[2],f=1):(h=0,f=a[2]);const p=.005;for(;f-h>p;){const g=a[2]=(h+f)/2;l===H4(a,o,i)<u?h=g:f=g}a[2]=l?f:h}return WI(a,i),r=ye.makeHexColor(Math.round(i[0]*255),Math.round(i[1]*255),Math.round(i[2]*255)),W4.set(t,r),r}function i9({html:n,dir:e,className:t},r){const s=document.createDocumentFragment();if(typeof n=="string"){const i=document.createElement("p");i.dir=e||"auto";const a=n.split(/(?:\r\n?|\n)/);for(let o=0,l=a.length;o<l;++o){const u=a[o];i.append(document.createTextNode(u)),o<l-1&&i.append(document.createElement("br"))}s.append(i)}else s9.render({xfaHtml:n,div:s,intent:"richText"});s.firstChild.classList.add("richText",t),r.append(s)}var xc,Sc,vi,wi,hw,Ec,Kp,Xp,dw,lA,a9,cA,o9,uA,l9,Ac,ap,Ch,Cv;const Vo=class Vo{constructor(e){x(this,cA);x(this,uA);x(this,Ac);x(this,Ch);x(this,xc,null);x(this,Sc,null);x(this,vi,void 0);x(this,wi,null);x(this,hw,null);x(this,Ec,null);x(this,Kp,null);x(this,Xp,null);A(this,vi,e),c(Vo,dw)||A(Vo,dw,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"}))}render(){const e=A(this,xc,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,vi)._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",Hi,{signal:t}),e.addEventListener("pointerdown",D(Vo,lA,a9),{signal:t}));const r=A(this,wi,document.createElement("div"));r.className="buttons",e.append(r);const s=c(this,vi).toolbarPosition;if(s){const{style:i}=e,a=c(this,vi)._uiManager.direction==="ltr"?1-s[0]:s[0];i.insetInlineEnd=`${100*a}%`,i.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return c(this,xc)}hide(){var e;c(this,xc).classList.add("hidden"),(e=c(this,Sc))==null||e.hideDropdown()}show(){var e,t;c(this,xc).classList.remove("hidden"),(e=c(this,hw))==null||e.shown(),(t=c(this,Ec))==null||t.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=c(this,vi),r=document.createElement("button");r.classList.add("basic","deleteButton"),r.tabIndex=0,r.setAttribute("data-l10n-id",c(Vo,dw)[e]),D(this,Ac,ap).call(this,r)&&r.addEventListener("click",s=>{t.delete()},{signal:t._signal}),c(this,wi).append(r)}async addAltText(e){const t=await e.render();D(this,Ac,ap).call(this,t),c(this,wi).append(t,c(this,Ch,Cv)),A(this,hw,e)}addComment(e,t=null){if(c(this,Ec))return;const r=e.renderForToolbar();if(!r)return;D(this,Ac,ap).call(this,r);const s=A(this,Kp,c(this,Ch,Cv));t?(c(this,wi).insertBefore(r,t),c(this,wi).insertBefore(s,t)):c(this,wi).append(r,s),A(this,Ec,e),e.toolbar=this}addColorPicker(e){if(c(this,Sc))return;A(this,Sc,e);const t=e.renderButton();D(this,Ac,ap).call(this,t),c(this,wi).append(t,c(this,Ch,Cv))}async addEditSignatureButton(e){const t=A(this,Xp,await e.renderEditButton(c(this,vi)));D(this,Ac,ap).call(this,t),c(this,wi).append(t,c(this,Ch,Cv))}removeButton(e){var t,r;switch(e){case"comment":(t=c(this,Ec))==null||t.removeToolbarCommentButton(),A(this,Ec,null),(r=c(this,Kp))==null||r.remove(),A(this,Kp,null);break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,r){const s=c(this,wi).querySelector(r);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){c(this,Xp)&&(c(this,Xp).title=e)}remove(){var e;c(this,xc).remove(),(e=c(this,Sc))==null||e.destroy(),A(this,Sc,null)}};xc=new WeakMap,Sc=new WeakMap,vi=new WeakMap,wi=new WeakMap,hw=new WeakMap,Ec=new WeakMap,Kp=new WeakMap,Xp=new WeakMap,dw=new WeakMap,lA=new WeakSet,a9=function(e){e.stopPropagation()},cA=new WeakSet,o9=function(e){c(this,vi)._focusEventsAllowed=!1,cn(e)},uA=new WeakSet,l9=function(e){c(this,vi)._focusEventsAllowed=!0,cn(e)},Ac=new WeakSet,ap=function(e){const t=c(this,vi)._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",D(this,cA,o9).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",D(this,uA,l9).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Hi,{signal:t}),!0)},Ch=new WeakSet,Cv=function(){const e=document.createElement("div");return e.className="divider",e},x(Vo,lA),x(Vo,dw,null);let GI=Vo;var fw,kh,Ho,hA,c9,dA,u9,pw,qI;class fEe{constructor(e){x(this,hA);x(this,dA);x(this,pw);x(this,fw,null);x(this,kh,null);x(this,Ho,void 0);A(this,Ho,e)}show(e,t,r){const[s,i]=D(this,dA,u9).call(this,t,r),{style:a}=c(this,kh)||A(this,kh,D(this,hA,c9).call(this));e.append(c(this,kh)),a.insetInlineEnd=`${100*s}%`,a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,kh).remove()}}fw=new WeakMap,kh=new WeakMap,Ho=new WeakMap,hA=new WeakSet,c9=function(){const e=A(this,kh,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar");const t=c(this,Ho)._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",Hi,{signal:t});const r=A(this,fw,document.createElement("div"));return r.className="buttons",e.append(r),c(this,Ho).hasCommentManager()&&D(this,pw,qI).call(this,"commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{c(this,Ho).commentSelection("floating_button")}),D(this,pw,qI).call(this,"highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{c(this,Ho).highlightSelection("floating_button")}),e},dA=new WeakSet,u9=function(e,t){let r=0,s=0;for(const i of e){const a=i.y+i.height;if(a<r)continue;const o=i.x+(t?i.width:0);if(a>r){s=o,r=a;continue}t?o>s&&(s=o):o<s&&(s=o)}return[t?1-s:s,r]},pw=new WeakSet,qI=function(e,t,r,s){const i=document.createElement("button");i.classList.add("basic",e),i.tabIndex=0,i.setAttribute("data-l10n-id",t);const a=document.createElement("span");i.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",r);const o=c(this,Ho)._signal;o instanceof AbortSignal&&!o.aborted&&(i.addEventListener("contextmenu",Hi,{signal:o}),i.addEventListener("click",s,{signal:o})),c(this,fw).append(i)};function h9(n,e,t){for(const r of t)e.addEventListener(r,n[r].bind(n))}var fA;class pEe{constructor(){x(this,fA,0)}get id(){return`${sw}${Cn(this,fA)._++}`}}fA=new WeakMap;var Qp,mw,kr,Jp,hE;const DO=class DO{constructor(){x(this,Jp);x(this,Qp,n9());x(this,mw,0);x(this,kr,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',r=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const i=s.decode().then(()=>(r.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(r.getImageData(0,0,1,1).data.buffer)[0]===0));return Ve(this,"_isSVGFittingCanvas",i)}async getFromFile(e){const{lastModified:t,name:r,size:s,type:i}=e;return D(this,Jp,hE).call(this,`${t}_${r}_${s}_${i}`,e)}async getFromUrl(e){return D(this,Jp,hE).call(this,e,e)}async getFromBlob(e,t){const r=await t;return D(this,Jp,hE).call(this,e,r)}async getFromId(e){c(this,kr)||A(this,kr,new Map);const t=c(this,kr).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:r}=t;return delete t.blobPromise,this.getFromBlob(t.id,r)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,kr)||A(this,kr,new Map);let r=c(this,kr).get(e);if(r!=null&&r.bitmap)return r.refCounter+=1,r;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),r={bitmap:s.transferToImageBitmap(),id:`image_${c(this,Qp)}_${Cn(this,mw)._++}`,refCounter:1,isSvg:!1},c(this,kr).set(e,r),c(this,kr).set(r.id,r),r}getSvgUrl(e){const t=c(this,kr).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;c(this,kr)||A(this,kr,new Map);const t=c(this,kr).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:r}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(r.width,r.height);i.getContext("bitmaprenderer").transferFromImageBitmap(r),t.blobPromise=i.convertToBlob()}(s=r.close)==null||s.call(r),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,Qp)}_`)}};Qp=new WeakMap,mw=new WeakMap,kr=new WeakMap,Jp=new WeakSet,hE=async function(e,t){c(this,kr)||A(this,kr,new Map);let r=c(this,kr).get(e);if(r===null)return null;if(r!=null&&r.bitmap)return r.refCounter+=1,r;try{r||(r={bitmap:null,id:`image_${c(this,Qp)}_${Cn(this,mw)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(r.url=t,s=await xx(t,"blob")):t instanceof File?s=r.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const i=DO._isSVGFittingCanvas,a=new FileReader,o=new Image,l=new Promise((u,h)=>{o.onload=()=>{r.bitmap=o,r.isSvg=!0,u()},a.onload=async()=>{const f=r.svgUrl=a.result;o.src=await i?`${f}#svgView(preserveAspectRatio(none))`:f},o.onerror=a.onerror=h});a.readAsDataURL(s),await l}else r.bitmap=await createImageBitmap(s);r.refCounter=1}catch(s){Oe(s),r=null}return c(this,kr).set(e,r),r&&c(this,kr).set(r.id,r),r};let YI=DO;var pn,Tc,gw,Yt;class mEe{constructor(e=128){x(this,pn,[]);x(this,Tc,!1);x(this,gw,void 0);x(this,Yt,-1);A(this,gw,e)}add({cmd:e,undo:t,post:r,mustExec:s,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(s&&e(),c(this,Tc))return;const l={cmd:e,undo:t,post:r,type:i};if(c(this,Yt)===-1){c(this,pn).length>0&&(c(this,pn).length=0),A(this,Yt,0),c(this,pn).push(l);return}if(a&&c(this,pn)[c(this,Yt)].type===i){o&&(l.undo=c(this,pn)[c(this,Yt)].undo),c(this,pn)[c(this,Yt)]=l;return}const u=c(this,Yt)+1;u===c(this,gw)?c(this,pn).splice(0,1):(A(this,Yt,u),u<c(this,pn).length&&c(this,pn).splice(u)),c(this,pn).push(l)}undo(){if(c(this,Yt)===-1)return;A(this,Tc,!0);const{undo:e,post:t}=c(this,pn)[c(this,Yt)];e(),t==null||t(),A(this,Tc,!1),A(this,Yt,c(this,Yt)-1)}redo(){if(c(this,Yt)<c(this,pn).length-1){A(this,Yt,c(this,Yt)+1),A(this,Tc,!0);const{cmd:e,post:t}=c(this,pn)[c(this,Yt)];e(),t==null||t(),A(this,Tc,!1)}}hasSomethingToUndo(){return c(this,Yt)!==-1}hasSomethingToRedo(){return c(this,Yt)<c(this,pn).length-1}cleanType(e){if(c(this,Yt)!==-1){for(let t=c(this,Yt);t>=0;t--)if(c(this,pn)[t].type!==e){c(this,pn).splice(t+1,c(this,Yt)-t),A(this,Yt,t);return}c(this,pn).length=0,A(this,Yt,-1)}}destroy(){A(this,pn,null)}}pn=new WeakMap,Tc=new WeakMap,gw=new WeakMap,Yt=new WeakMap;var pA,d9;class Ax{constructor(e){x(this,pA);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=mr.platform;for(const[r,s,i={}]of e)for(const a of r){const o=a.startsWith("mac+");t&&o?(this.callbacks.set(a.slice(4),{callback:s,options:i}),this.allKeys.add(a.split("+").at(-1))):!t&&!o&&(this.callbacks.set(a,{callback:s,options:i}),this.allKeys.add(a.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const r=this.callbacks.get(D(this,pA,d9).call(this,t));if(!r)return;const{callback:s,options:{bubbles:i=!1,args:a=[],checker:o=null}}=r;o&&!o(e,t)||(s.bind(e,...a,t)(),i||cn(t))}}pA=new WeakSet,d9=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const mA=class mA{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return lEe(e),Ve(this,"_colors",e)}convert(e){const t=Ex(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[r,s]of this._colors)if(s.every((i,a)=>i===t[a]))return mA._colorsMapping.get(r);return t}getHexCode(e){const t=this._colors.get(e);return t?ye.makeHexColor(...t):e}};ie(mA,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let KI=mA;var Zp,js,em,rn,Nn,tm,bi,nm,_i,Nr,Cc,kc,rm,Nc,$a,xi,Nh,yw,vw,sm,ww,Ua,Pc,im,Ic,Va,gA,Dc,am,bw,Rc,Ph,om,Mc,_w,Sn,ut,Wo,Oc,Lc,xw,lm,Sw,jc,Ba,Go,Ew,Aw,Si,cm,dE,Tw,XI,yA,f9,vA,p9,Ih,kv,wA,m9,bA,g9,_A,y9,Cw,QI,xA,v9,kw,JI,Nw,ZI,SA,w9,rr,Gr,ea,jo,EA,b9,AA,_9,Pw,eD,TA,x9,Dh,Nv,Iw,tD;const kp=class kp{constructor(e,t,r,s,i,a,o,l,u,h,f,p,g,v,y,_){x(this,cm);x(this,Tw);x(this,yA);x(this,vA);x(this,Ih);x(this,wA);x(this,bA);x(this,_A);x(this,Cw);x(this,xA);x(this,kw);x(this,Nw);x(this,SA);x(this,rr);x(this,ea);x(this,EA);x(this,AA);x(this,Pw);x(this,TA);x(this,Dh);x(this,Iw);x(this,Zp,new AbortController);x(this,js,null);x(this,em,null);x(this,rn,new Map);x(this,Nn,new Map);x(this,tm,null);x(this,bi,null);x(this,nm,null);x(this,_i,new mEe);x(this,Nr,null);x(this,Cc,null);x(this,kc,null);x(this,rm,0);x(this,Nc,new Set);x(this,$a,null);x(this,xi,null);x(this,Nh,new Set);ie(this,"_editorUndoBar",null);x(this,yw,!1);x(this,vw,!1);x(this,sm,!1);x(this,ww,null);x(this,Ua,null);x(this,Pc,null);x(this,im,null);x(this,Ic,!1);x(this,Va,null);x(this,gA,new pEe);x(this,Dc,!1);x(this,am,!1);x(this,bw,!1);x(this,Rc,null);x(this,Ph,null);x(this,om,null);x(this,Mc,null);x(this,_w,null);x(this,Sn,Fe.NONE);x(this,ut,new Set);x(this,Wo,null);x(this,Oc,null);x(this,Lc,null);x(this,xw,null);x(this,lm,null);x(this,Sw,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});x(this,jc,[0,0]);x(this,Ba,null);x(this,Go,null);x(this,Ew,null);x(this,Aw,null);x(this,Si,null);const w=this._signal=c(this,Zp).signal;A(this,Go,e),A(this,Ew,t),A(this,Aw,r),A(this,tm,s),A(this,Nr,i),A(this,Oc,a),A(this,lm,l),this._eventBus=o,o._on("editingaction",this.onEditingAction.bind(this),{signal:w}),o._on("pagechanging",this.onPageChanging.bind(this),{signal:w}),o._on("scalechanging",this.onScaleChanging.bind(this),{signal:w}),o._on("rotationchanging",this.onRotationChanging.bind(this),{signal:w}),o._on("setpreference",this.onSetPreference.bind(this),{signal:w}),o._on("switchannotationeditorparams",b=>this.updateParams(b.type,b.value),{signal:w}),window.addEventListener("pointerdown",()=>{A(this,am,!0)},{capture:!0,signal:w}),window.addEventListener("pointerup",()=>{A(this,am,!1)},{capture:!0,signal:w}),D(this,wA,m9).call(this),D(this,SA,w9).call(this),D(this,Cw,QI).call(this),A(this,bi,l.annotationStorage),A(this,ww,l.filterFactory),A(this,Lc,u),A(this,im,h||null),A(this,yw,f),A(this,vw,p),A(this,sm,g),A(this,_w,v||null),this.viewParameters={realScale:Yu.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=y||null,this._supportsPinchToZoom=_!==!1,i==null||i.setSidebarUiManager(this)}static get _keyboardManager(){const e=kp.prototype,t=a=>c(a,Go).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),r=(a,{target:o})=>{if(o instanceof HTMLInputElement){const{type:l}=o;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,i=this.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Ax([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:r}],[["ctrl+z","mac+meta+z"],e.undo,{checker:r}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:r}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:r}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,Go).contains(o)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:o})=>!(o instanceof HTMLButtonElement)&&c(a,Go).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}]]))}destroy(){var e,t,r,s,i,a,o,l,u;(e=c(this,Si))==null||e.resolve(),A(this,Si,null),(t=c(this,Zp))==null||t.abort(),A(this,Zp,null),this._signal=null;for(const h of c(this,Nn).values())h.destroy();c(this,Nn).clear(),c(this,rn).clear(),c(this,Nh).clear(),(r=c(this,Mc))==null||r.clear(),A(this,js,null),c(this,ut).clear(),c(this,_i).destroy(),(s=c(this,tm))==null||s.destroy(),(i=c(this,Nr))==null||i.destroy(),(a=c(this,Oc))==null||a.destroy(),(o=c(this,Va))==null||o.hide(),A(this,Va,null),(l=c(this,om))==null||l.destroy(),A(this,om,null),A(this,em,null),c(this,Ua)&&(clearTimeout(c(this,Ua)),A(this,Ua,null)),c(this,Ba)&&(clearTimeout(c(this,Ba)),A(this,Ba,null)),(u=this._editorUndoBar)==null||u.destroy(),A(this,lm,null)}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,_w)}get useNewAltTextFlow(){return c(this,vw)}get useNewAltTextWhenAddingImage(){return c(this,sm)}get hcmFilter(){return Ve(this,"hcmFilter",c(this,Lc)?c(this,ww).addHCMFilter(c(this,Lc).foreground,c(this,Lc).background):"none")}get direction(){return Ve(this,"direction",getComputedStyle(c(this,Go)).direction)}get _highlightColors(){return Ve(this,"_highlightColors",c(this,im)?new Map(c(this,im).split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ve(this,"highlightColors",null);const t=new Map,r=!!c(this,Lc);for(const[s,i]of e){const a=s.endsWith("_HCM");if(r&&a){t.set(s.replace("_HCM",""),i);continue}!r&&!a&&t.set(s,i)}return Ve(this,"highlightColors",t)}get highlightColorNames(){return Ve(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),A(this,kc,e)}setMainHighlightColorPicker(e){A(this,om,e)}editAltText(e,t=!1){var r;(r=c(this,tm))==null||r.editAltText(this,e,t)}hasCommentManager(){return!!c(this,Nr)}editComment(e,t,r,s){var i;(i=c(this,Nr))==null||i.showDialog(this,e,t,r,s)}selectComment(e,t){const r=c(this,Nn).get(e),s=r==null?void 0:r.getEditorByUID(t);s==null||s.toggleComment(!0,!0)}updateComment(e){var t;(t=c(this,Nr))==null||t.updateComment(e.getData())}updatePopupColor(e){var t;(t=c(this,Nr))==null||t.updatePopupColor(e)}removeComment(e){var t;(t=c(this,Nr))==null||t.removeComments([e.uid])}toggleComment(e,t,r=void 0){var s;(s=c(this,Nr))==null||s.toggleCommentPopup(e,t,r)}makeCommentColor(e,t){var r;return e&&((r=c(this,Nr))==null?void 0:r.makeCommentColor(e,t))||null}getCommentDialogElement(){var e;return((e=c(this,Nr))==null?void 0:e.dialogElement)||null}async waitForEditorsRendered(e){if(c(this,Nn).has(e-1))return;const{resolve:t,promise:r}=Promise.withResolvers(),s=i=>{i.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await r}getSignature(e){var t;(t=c(this,Oc))==null||t.getSignature({uiManager:this,editor:e})}get signatureManager(){return c(this,Oc)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":A(this,sm,t);break}}onPageChanging({pageNumber:e}){A(this,rm,e-1)}focusMainContainer(){c(this,Go).focus()}findParent(e,t){for(const r of c(this,Nn).values()){const{x:s,y:i,width:a,height:o}=r.div.getBoundingClientRect();if(e>=s&&e<=s+a&&t>=i&&t<=i+o)return r}return null}disableUserSelect(e=!1){c(this,Ew).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,Nh).add(e)}removeShouldRescale(e){c(this,Nh).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Yu.PDF_TO_CSS_UNITS;for(const r of c(this,Nh))r.onScaleChanging();(t=c(this,kc))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e="",t=!1){const r=document.getSelection();if(!r||r.isCollapsed)return;const{anchorNode:s,anchorOffset:i,focusNode:a,focusOffset:o}=r,l=r.toString(),h=D(this,cm,dE).call(this,r).closest(".textLayer"),f=this.getSelectionBoxes(h);if(!f)return;r.empty();const p=D(this,Tw,XI).call(this,h),g=c(this,Sn)===Fe.NONE,v=()=>{const y=p==null?void 0:p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:s,anchorOffset:i,focusNode:a,focusOffset:o,text:l});g&&this.showAllEditors("highlight",!0,!0),t&&(y==null||y.editComment())};if(g){this.switchToMode(Fe.HIGHLIGHT,v);return}v()}commentSelection(e=""){this.highlightSelection(e,!0)}getAndRemoveDataFromAnnotationStorage(e){if(!c(this,bi))return null;const t=`${sw}${e}`,r=c(this,bi).getRawValue(t);return r&&c(this,bi).remove(t),r}addToAnnotationStorage(e){!e.isEmpty()&&c(this,bi)&&!c(this,bi).has(e.id)&&c(this,bi).setValue(e.id,e)}a11yAlert(e,t=null){const r=c(this,Aw);r&&(r.setAttribute("data-l10n-id",e),t?r.setAttribute("data-l10n-args",JSON.stringify(t)):r.removeAttribute("data-l10n-args"))}blur(){if(this.isShiftKeyDown=!1,c(this,Ic)&&(A(this,Ic,!1),D(this,Ih,kv).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,ut))if(t.div.contains(e)){A(this,Ph,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,Ph))return;const[e,t]=c(this,Ph);A(this,Ph,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){D(this,Cw,QI).call(this),D(this,kw,JI).call(this)}removeEditListeners(){D(this,xA,v9).call(this),D(this,Nw,ZI).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const r of c(this,xi))if(r.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const r of c(this,xi))if(r.isHandlingMimeForPasting(t.type)){r.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var r;if(e.preventDefault(),(r=c(this,js))==null||r.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of c(this,ut)){const i=s.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const i of t.items)for(const a of c(this,xi))if(a.isHandlingMimeForPasting(i.type)){a.paste(i,this.currentLayer);return}let r=t.getData("application/pdfjs");if(!r)return;try{r=JSON.parse(r)}catch(i){Oe(`paste: "${i.message}".`);return}if(!Array.isArray(r))return;this.unselectAll();const s=this.currentLayer;try{const i=[];for(const l of r){const u=await s.deserialize(l);if(!u)return;i.push(u)}const a=()=>{for(const l of i)D(this,Pw,eD).call(this,l);D(this,Iw,tD).call(this,i)},o=()=>{for(const l of i)l.remove()};this.addCommands({cmd:a,undo:o,mustExec:!0})}catch(i){Oe(`paste: "${i.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,Sn)!==Fe.NONE&&!this.isEditorHandlingKeyboard&&kp._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,Ic)&&(A(this,Ic,!1),D(this,Ih,kv).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}setEditingState(e){e?(D(this,bA,g9).call(this),D(this,kw,JI).call(this),D(this,rr,Gr).call(this,{isEditing:c(this,Sn)!==Fe.NONE,isEmpty:D(this,Dh,Nv).call(this),hasSomethingToUndo:c(this,_i).hasSomethingToUndo(),hasSomethingToRedo:c(this,_i).hasSomethingToRedo(),hasSelectedEditor:!1})):(D(this,_A,y9).call(this),D(this,Nw,ZI).call(this),D(this,rr,Gr).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,xi)){A(this,xi,e);for(const t of c(this,xi))D(this,ea,jo).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,gA).id}get currentLayer(){return c(this,Nn).get(c(this,rm))}getLayer(e){return c(this,Nn).get(e)}get currentPageIndex(){return c(this,rm)}addLayer(e){c(this,Nn).set(e.pageIndex,e),c(this,Dc)?e.enable():e.disable()}removeLayer(e){c(this,Nn).delete(e.pageIndex)}async updateMode(e,t=null,r=!1,s=!1,i=!1){var a,o,l,u,h,f;if(c(this,Sn)!==e&&!(c(this,Si)&&(await c(this,Si).promise,!c(this,Si)))){if(A(this,Si,Promise.withResolvers()),(a=c(this,kc))==null||a.commitOrRemove(),c(this,Sn)===Fe.POPUP&&((o=c(this,Nr))==null||o.hideSidebar()),(l=c(this,Nr))==null||l.destroyPopup(),A(this,Sn,e),e===Fe.NONE){this.setEditingState(!1),D(this,AA,_9).call(this);for(const p of c(this,rn).values())p.hideStandaloneCommentButton();(u=this._editorUndoBar)==null||u.hide(),this.toggleComment(null),c(this,Si).resolve();return}for(const p of c(this,rn).values())p.addStandaloneCommentButton();e===Fe.SIGNATURE&&await((h=c(this,Oc))==null?void 0:h.loadSignatures()),this.setEditingState(!0),await D(this,EA,b9).call(this),this.unselectAll();for(const p of c(this,Nn).values())p.updateMode(e);if(e===Fe.POPUP){c(this,em)||A(this,em,await c(this,lm).getAnnotationsByType(new Set(c(this,xi).map(v=>v._editorType))));const p=new Set,g=[];for(const v of c(this,rn).values()){const{annotationElementId:y,hasComment:_,deleted:w}=v;y&&p.add(y),_&&!w&&g.push(v.getData())}for(const v of c(this,em)){const{id:y,popupRef:_,contentsObj:w}=v;_&&(w!=null&&w.str)&&!p.has(y)&&!c(this,Nc).has(y)&&g.push(v)}(f=c(this,Nr))==null||f.showSidebar(g)}if(!t){r&&this.addNewEditorFromKeyboard(),c(this,Si).resolve();return}for(const p of c(this,rn).values())p.uid===t?(this.setSelected(p),i?p.editComment():s?p.enterInEditMode():p.focus()):p.unselect();c(this,Si).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==c(this,Sn)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(c(this,xi)){switch(e){case Qe.CREATE:this.currentLayer.addNewEditor(t);return;case Qe.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,xw)||A(this,xw,new Map)).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const r of c(this,ut))r.updateParams(e,t);else for(const r of c(this,xi))r.updateDefaultParams(e,t)}}showAllEditors(e,t,r=!1){var i;for(const a of c(this,rn).values())a.editorType===e&&a.show(t);(((i=c(this,xw))==null?void 0:i.get(Qe.HIGHLIGHT_SHOW_ALL))??!0)!==t&&D(this,ea,jo).call(this,[[Qe.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,bw)!==e){A(this,bw,e);for(const t of c(this,Nn).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}*getEditors(e){for(const t of c(this,rn).values())t.pageIndex===e&&(yield t)}getEditor(e){return c(this,rn).get(e)}addEditor(e){c(this,rn).set(e.id,e)}removeEditor(e){var t,r;e.div.contains(document.activeElement)&&(c(this,Ua)&&clearTimeout(c(this,Ua)),A(this,Ua,setTimeout(()=>{this.focusMainContainer(),A(this,Ua,null)},0))),c(this,rn).delete(e.id),e.annotationElementId&&((t=c(this,Mc))==null||t.delete(e.annotationElementId)),this.unselect(e),(!e.annotationElementId||!c(this,Nc).has(e.annotationElementId))&&((r=c(this,bi))==null||r.remove(e.id))}addDeletedAnnotationElement(e){c(this,Nc).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,Nc).has(e)}removeDeletedAnnotationElement(e){c(this,Nc).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,js)!==e&&(A(this,js,e),e&&D(this,ea,jo).call(this,e.propertiesToUpdate))}updateUI(e){c(this,TA,x9)===e&&D(this,ea,jo).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){D(this,ea,jo).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,ut).has(e)){c(this,ut).delete(e),e.unselect(),D(this,rr,Gr).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,ut).add(e),e.select(),D(this,ea,jo).call(this,e.propertiesToUpdate),D(this,rr,Gr).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;this.updateToolbar({mode:e.mode,editId:e.id}),(t=c(this,kc))==null||t.commitOrRemove();for(const r of c(this,ut))r!==e&&r.unselect();c(this,ut).clear(),c(this,ut).add(e),e.select(),D(this,ea,jo).call(this,e.propertiesToUpdate),D(this,rr,Gr).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,ut).has(e)}get firstSelectedEditor(){return c(this,ut).values().next().value}unselect(e){e.unselect(),c(this,ut).delete(e),D(this,rr,Gr).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,ut).size!==0}get isEnterHandled(){return c(this,ut).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,_i).undo(),D(this,rr,Gr).call(this,{hasSomethingToUndo:c(this,_i).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:D(this,Dh,Nv).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,_i).redo(),D(this,rr,Gr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,_i).hasSomethingToRedo(),isEmpty:D(this,Dh,Nv).call(this)})}addCommands(e){c(this,_i).add(e),D(this,rr,Gr).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:D(this,Dh,Nv).call(this)})}cleanUndoStack(e){c(this,_i).cleanType(e)}delete(){var i;this.commitOrRemove();const e=(i=this.currentLayer)==null?void 0:i.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,ut)],r=()=>{var a;(a=this._editorUndoBar)==null||a.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const a of t)D(this,Pw,eD).call(this,a)};this.addCommands({cmd:r,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=c(this,js))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,js)||this.hasSelection}selectAll(){for(const e of c(this,ut))e.commit();D(this,Iw,tD).call(this,c(this,rn).values())}unselectAll(){var e;if(!(c(this,js)&&(c(this,js).commitOrRemove(),c(this,Sn)!==Fe.NONE))&&!((e=c(this,kc))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,ut))t.unselect();c(this,ut).clear(),D(this,rr,Gr).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,r=!1){if(r||this.commitOrRemove(),!this.hasSelection)return;c(this,jc)[0]+=e,c(this,jc)[1]+=t;const[s,i]=c(this,jc),a=[...c(this,ut)],o=1e3;c(this,Ba)&&clearTimeout(c(this,Ba)),A(this,Ba,setTimeout(()=>{A(this,Ba,null),c(this,jc)[0]=c(this,jc)[1]=0,this.addCommands({cmd:()=>{for(const l of a)c(this,rn).has(l.id)&&(l.translateInPage(s,i),l.translationDone())},undo:()=>{for(const l of a)c(this,rn).has(l.id)&&(l.translateInPage(-s,-i),l.translationDone())},mustExec:!1})},o));for(const l of a)l.translateInPage(e,t),l.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),A(this,$a,new Map);for(const e of c(this,ut))c(this,$a).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,$a))return!1;this.disableUserSelect(!1);const e=c(this,$a);A(this,$a,null);let t=!1;for(const[{x:s,y:i,pageIndex:a},o]of e)o.newX=s,o.newY=i,o.newPageIndex=a,t||(t=s!==o.savedX||i!==o.savedY||a!==o.savedPageIndex);if(!t)return!1;const r=(s,i,a,o)=>{if(c(this,rn).has(s.id)){const l=c(this,Nn).get(o);l?s._setParentAndPosition(l,i,a):(s.pageIndex=o,s.x=i,s.y=a)}};return this.addCommands({cmd:()=>{for(const[s,{newX:i,newY:a,newPageIndex:o}]of e)r(s,i,a,o)},undo:()=>{for(const[s,{savedX:i,savedY:a,savedPageIndex:o}]of e)r(s,i,a,o)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,$a))for(const r of c(this,$a).keys())r.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,ut).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,js)===e}getActive(){return c(this,js)}getMode(){return c(this,Sn)}isEditingMode(){return c(this,Sn)!==Fe.NONE}get imageManager(){return Ve(this,"imageManager",new YI)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:r,y:s,width:i,height:a}=e.getBoundingClientRect();let o;switch(e.getAttribute("data-main-rotation")){case"90":o=(u,h,f,p)=>({x:(h-s)/a,y:1-(u+f-r)/i,width:p/a,height:f/i});break;case"180":o=(u,h,f,p)=>({x:1-(u+f-r)/i,y:1-(h+p-s)/a,width:f/i,height:p/a});break;case"270":o=(u,h,f,p)=>({x:1-(h+p-s)/a,y:(u-r)/i,width:p/a,height:f/i});break;default:o=(u,h,f,p)=>({x:(u-r)/i,y:(h-s)/a,width:f/i,height:p/a});break}const l=[];for(let u=0,h=t.rangeCount;u<h;u++){const f=t.getRangeAt(u);if(!f.collapsed)for(const{x:p,y:g,width:v,height:y}of f.getClientRects())v===0||y===0||l.push(o(p,g,v,y))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,nm)||A(this,nm,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,nm))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=c(this,nm))==null?void 0:s.get(e.data.id);if(!t)return;const r=c(this,bi).getRawValue(t);r&&(c(this,Sn)===Fe.NONE&&!r.hasBeenModified||r.renderAnnotationElement(e))}setMissingCanvas(e,t,r){var i;const s=(i=c(this,Mc))==null?void 0:i.get(e);s&&(s.setCanvas(t,r),c(this,Mc).delete(e))}addMissingCanvas(e,t){(c(this,Mc)||A(this,Mc,new Map)).set(e,t)}};Zp=new WeakMap,js=new WeakMap,em=new WeakMap,rn=new WeakMap,Nn=new WeakMap,tm=new WeakMap,bi=new WeakMap,nm=new WeakMap,_i=new WeakMap,Nr=new WeakMap,Cc=new WeakMap,kc=new WeakMap,rm=new WeakMap,Nc=new WeakMap,$a=new WeakMap,xi=new WeakMap,Nh=new WeakMap,yw=new WeakMap,vw=new WeakMap,sm=new WeakMap,ww=new WeakMap,Ua=new WeakMap,Pc=new WeakMap,im=new WeakMap,Ic=new WeakMap,Va=new WeakMap,gA=new WeakMap,Dc=new WeakMap,am=new WeakMap,bw=new WeakMap,Rc=new WeakMap,Ph=new WeakMap,om=new WeakMap,Mc=new WeakMap,_w=new WeakMap,Sn=new WeakMap,ut=new WeakMap,Wo=new WeakMap,Oc=new WeakMap,Lc=new WeakMap,xw=new WeakMap,lm=new WeakMap,Sw=new WeakMap,jc=new WeakMap,Ba=new WeakMap,Go=new WeakMap,Ew=new WeakMap,Aw=new WeakMap,Si=new WeakMap,cm=new WeakSet,dE=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Tw=new WeakSet,XI=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const r of c(this,Nn).values())if(r.hasTextLayer(e))return r;return null},yA=new WeakSet,f9=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const r=D(this,cm,dE).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(r);s&&(c(this,Va)||A(this,Va,new fEe(this)),c(this,Va).show(r,s,this.direction==="ltr"))},vA=new WeakSet,p9=function(){var i,a,o;const e=document.getSelection();if(!e||e.isCollapsed){c(this,Wo)&&((i=c(this,Va))==null||i.hide(),A(this,Wo,null),D(this,rr,Gr).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,Wo))return;const s=D(this,cm,dE).call(this,e).closest(".textLayer");if(!s){c(this,Wo)&&((a=c(this,Va))==null||a.hide(),A(this,Wo,null),D(this,rr,Gr).call(this,{hasSelectedText:!1}));return}if((o=c(this,Va))==null||o.hide(),A(this,Wo,t),D(this,rr,Gr).call(this,{hasSelectedText:!0}),!(c(this,Sn)!==Fe.HIGHLIGHT&&c(this,Sn)!==Fe.NONE)&&(c(this,Sn)===Fe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),A(this,Ic,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,Sn)===Fe.HIGHLIGHT?D(this,Tw,XI).call(this,s):null;if(l==null||l.toggleDrawing(),c(this,am)){const u=new AbortController,h=this.combinedSignal(u),f=p=>{p.type==="pointerup"&&p.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),p.type==="pointerup"&&D(this,Ih,kv).call(this,"main_toolbar"))};window.addEventListener("pointerup",f,{signal:h}),window.addEventListener("blur",f,{signal:h})}else l==null||l.toggleDrawing(!0),D(this,Ih,kv).call(this,"main_toolbar")}},Ih=new WeakSet,kv=function(e=""){c(this,Sn)===Fe.HIGHLIGHT?this.highlightSelection(e):c(this,yw)&&D(this,yA,f9).call(this)},wA=new WeakSet,m9=function(){document.addEventListener("selectionchange",D(this,vA,p9).bind(this),{signal:this._signal})},bA=new WeakSet,g9=function(){if(c(this,Pc))return;A(this,Pc,new AbortController);const e=this.combinedSignal(c(this,Pc));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},_A=new WeakSet,y9=function(){var e;(e=c(this,Pc))==null||e.abort(),A(this,Pc,null)},Cw=new WeakSet,QI=function(){if(c(this,Rc))return;A(this,Rc,new AbortController);const e=this.combinedSignal(c(this,Rc));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},xA=new WeakSet,v9=function(){var e;(e=c(this,Rc))==null||e.abort(),A(this,Rc,null)},kw=new WeakSet,JI=function(){if(c(this,Cc))return;A(this,Cc,new AbortController);const e=this.combinedSignal(c(this,Cc));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Nw=new WeakSet,ZI=function(){var e;(e=c(this,Cc))==null||e.abort(),A(this,Cc,null)},SA=new WeakSet,w9=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},rr=new WeakSet,Gr=function(e){Object.entries(e).some(([r,s])=>c(this,Sw)[r]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,Sw),e)}),c(this,Sn)===Fe.HIGHLIGHT&&e.hasSelectedEditor===!1&&D(this,ea,jo).call(this,[[Qe.HIGHLIGHT_FREE,!0]]))},ea=new WeakSet,jo=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},EA=new WeakSet,b9=async function(){if(!c(this,Dc)){A(this,Dc,!0);const e=[];for(const t of c(this,Nn).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,rn).values())t.enable()}},AA=new WeakSet,_9=function(){if(this.unselectAll(),c(this,Dc)){A(this,Dc,!1);for(const e of c(this,Nn).values())e.disable();for(const e of c(this,rn).values())e.disable()}},Pw=new WeakSet,eD=function(e){const t=c(this,Nn).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},TA=new WeakSet,x9=function(){let e=null;for(e of c(this,ut));return e},Dh=new WeakSet,Nv=function(){if(c(this,rn).size===0)return!0;if(c(this,rn).size===1)for(const e of c(this,rn).values())return e.isEmpty();return!1},Iw=new WeakSet,tD=function(e){for(const t of c(this,ut))t.unselect();c(this,ut).clear();for(const t of e)t.isEmpty()||(c(this,ut).add(t),t.select());D(this,rr,Gr).call(this,{hasSelectedEditor:this.hasSelection})},ie(kp,"TRANSLATE_SMALL",1),ie(kp,"TRANSLATE_BIG",10);let Pf=kp;var Bn,za,ta,um,Ha,Fs,hm,Wa,hs,qo,Rh,Ga,Fc,Mh,Pv,dm,fE;const qr=class qr{constructor(e){x(this,Mh);x(this,dm);x(this,Bn,null);x(this,za,!1);x(this,ta,null);x(this,um,null);x(this,Ha,null);x(this,Fs,null);x(this,hm,!1);x(this,Wa,null);x(this,hs,null);x(this,qo,null);x(this,Rh,null);x(this,Ga,!1);A(this,hs,e),A(this,Ga,e._uiManager.useNewAltTextFlow),c(qr,Fc)||A(qr,Fc,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){qr._l10n??(qr._l10n=e)}async render(){const e=A(this,ta,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=A(this,um,document.createElement("span"));e.append(t),c(this,Ga)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(qr,Fc).missing),t.setAttribute("data-l10n-id",c(qr,Fc)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const r=c(this,hs)._uiManager._signal;e.addEventListener("contextmenu",Hi,{signal:r}),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:r});const s=i=>{i.preventDefault(),c(this,hs)._uiManager.editAltText(c(this,hs)),c(this,Ga)&&c(this,hs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,Mh,Pv)}})};return e.addEventListener("click",s,{capture:!0,signal:r}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(A(this,hm,!0),s(i))},{signal:r}),await D(this,dm,fE).call(this),e}finish(){c(this,ta)&&(c(this,ta).focus({focusVisible:c(this,hm)}),A(this,hm,!1))}isEmpty(){return c(this,Ga)?c(this,Bn)===null:!c(this,Bn)&&!c(this,za)}hasData(){return c(this,Ga)?c(this,Bn)!==null||!!c(this,qo):this.isEmpty()}get guessedText(){return c(this,qo)}async setGuessedText(e){c(this,Bn)===null&&(A(this,qo,e),A(this,Rh,await qr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),D(this,dm,fE).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Ga)||c(this,Bn)){(t=c(this,Wa))==null||t.remove(),A(this,Wa,null);return}if(!c(this,Wa)){const r=A(this,Wa,document.createElement("div"));r.className="noAltTextBadge",c(this,hs).div.append(r)}c(this,Wa).classList.toggle("hidden",!e)}serialize(e){let t=c(this,Bn);return!e&&c(this,qo)===t&&(t=c(this,Rh)),{altText:t,decorative:c(this,za),guessedText:c(this,qo),textWithDisclaimer:c(this,Rh)}}get data(){return{altText:c(this,Bn),decorative:c(this,za)}}set data({altText:e,decorative:t,guessedText:r,textWithDisclaimer:s,cancel:i=!1}){r&&(A(this,qo,r),A(this,Rh,s)),!(c(this,Bn)===e&&c(this,za)===t)&&(i||(A(this,Bn,e),A(this,za,t)),D(this,dm,fE).call(this))}toggle(e=!1){c(this,ta)&&(!e&&c(this,Fs)&&(clearTimeout(c(this,Fs)),A(this,Fs,null)),c(this,ta).disabled=!e)}shown(){c(this,hs)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,Mh,Pv)}})}destroy(){var e,t;(e=c(this,ta))==null||e.remove(),A(this,ta,null),A(this,um,null),A(this,Ha,null),(t=c(this,Wa))==null||t.remove(),A(this,Wa,null)}};Bn=new WeakMap,za=new WeakMap,ta=new WeakMap,um=new WeakMap,Ha=new WeakMap,Fs=new WeakMap,hm=new WeakMap,Wa=new WeakMap,hs=new WeakMap,qo=new WeakMap,Rh=new WeakMap,Ga=new WeakMap,Fc=new WeakMap,Mh=new WeakSet,Pv=function(){return c(this,Bn)&&"added"||c(this,Bn)===null&&this.guessedText&&"review"||"missing"},dm=new WeakSet,fE=async function(){var s,i,a;const e=c(this,ta);if(!e)return;if(c(this,Ga)){if(e.classList.toggle("done",!!c(this,Bn)),e.setAttribute("data-l10n-id",c(qr,Fc)[c(this,Mh,Pv)]),(s=c(this,um))==null||s.setAttribute("data-l10n-id",c(qr,Fc)[`${c(this,Mh,Pv)}-label`]),!c(this,Bn)){(i=c(this,Ha))==null||i.remove();return}}else{if(!c(this,Bn)&&!c(this,za)){e.classList.remove("done"),(a=c(this,Ha))==null||a.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,Ha);if(!t){A(this,Ha,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,hs).id}`;const o=100,l=c(this,hs)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,Fs)),A(this,Fs,null)},{once:!0}),e.addEventListener("mouseenter",()=>{A(this,Fs,setTimeout(()=>{A(this,Fs,null),c(this,Ha).classList.add("show"),c(this,hs)._reportTelemetry({action:"alt_text_tooltip"})},o))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;c(this,Fs)&&(clearTimeout(c(this,Fs)),A(this,Fs,null)),(u=c(this,Ha))==null||u.classList.remove("show")},{signal:l})}c(this,za)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,Bn)),t.parentNode||e.append(t);const r=c(this,hs).getElementForAltText();r==null||r.setAttribute("aria-describedby",t.id)},x(qr,Fc,null),ie(qr,"_l10n",null);let Q1=qr;var sr,Ei,Oh,kt,Dw,Lh,na,jh,Fh,$h,Rw,nD;class SS{constructor(e){x(this,Rw);x(this,sr,null);x(this,Ei,null);x(this,Oh,!1);x(this,kt,null);x(this,Dw,null);x(this,Lh,null);x(this,na,null);x(this,jh,null);x(this,Fh,!1);x(this,$h,null);A(this,kt,e)}renderForToolbar(){const e=A(this,Ei,document.createElement("button"));return e.className="comment",D(this,Rw,nD).call(this,e,!1)}renderForStandalone(){const e=A(this,sr,document.createElement("button"));e.className="annotationCommentButton";const t=c(this,kt).commentButtonPosition;if(t){const{style:r}=e;r.insetInlineEnd=`calc(${100*(c(this,kt)._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,r.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=c(this,kt).commentButtonColor;s&&(r.backgroundColor=s)}return D(this,Rw,nD).call(this,e,!0)}focusButton(){setTimeout(()=>{var e;(e=c(this,sr)??c(this,Ei))==null||e.focus()},0)}onUpdatedColor(){if(!c(this,sr))return;const e=c(this,kt).commentButtonColor;e&&(c(this,sr).style.backgroundColor=e),c(this,kt)._uiManager.updatePopupColor(c(this,kt))}get commentButtonWidth(){var e;return(((e=c(this,sr))==null?void 0:e.getBoundingClientRect().width)??0)/c(this,kt).parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(c(this,$h))return c(this,$h);if(!c(this,sr))return null;const{x:e,y:t,height:r}=c(this,sr).getBoundingClientRect(),{x:s,y:i,width:a,height:o}=c(this,kt).parent.boundingClientRect;return[(e-s)/a,(t+r-i)/o]}set commentPopupPositionInLayer(e){A(this,$h,e)}hasDefaultPopupPosition(){return c(this,$h)===null}removeStandaloneCommentButton(){var e;(e=c(this,sr))==null||e.remove(),A(this,sr,null)}removeToolbarCommentButton(){var e;(e=c(this,Ei))==null||e.remove(),A(this,Ei,null)}setCommentButtonStates({selected:e,hasPopup:t}){c(this,sr)&&(c(this,sr).classList.toggle("selected",e),c(this,sr).ariaExpanded=t)}edit(e){const t=this.commentPopupPositionInLayer;let r,s;if(t)[r,s]=t;else{[r,s]=c(this,kt).commentButtonPosition;const{width:h,height:f,x:p,y:g}=c(this,kt);r=p+r*h,s=g+s*f}const i=c(this,kt).parent.boundingClientRect,{x:a,y:o,width:l,height:u}=i;c(this,kt)._uiManager.editComment(c(this,kt),a+r*l,o+s*u,{...e,parentDimensions:i})}finish(){c(this,Ei)&&(c(this,Ei).focus({focusVisible:c(this,Oh)}),A(this,Oh,!1))}isDeleted(){return c(this,Fh)||c(this,na)===""}isEmpty(){return c(this,na)===null}hasBeenEdited(){return this.isDeleted()||c(this,na)!==c(this,Dw)}serialize(){return this.data}get data(){return{text:c(this,na),richText:c(this,Lh),date:c(this,jh),deleted:this.isDeleted()}}set data(e){if(e!==c(this,na)&&A(this,Lh,null),e===null){A(this,na,""),A(this,Fh,!0);return}A(this,na,e),A(this,jh,new Date),A(this,Fh,!1)}setInitialText(e,t=null){A(this,Dw,e),this.data=e,A(this,jh,null),A(this,Lh,t)}shown(){}destroy(){var e,t;(e=c(this,Ei))==null||e.remove(),A(this,Ei,null),(t=c(this,sr))==null||t.remove(),A(this,sr,null),A(this,na,""),A(this,Lh,null),A(this,jh,null),A(this,kt,null),A(this,Oh,!1),A(this,Fh,!1)}}sr=new WeakMap,Ei=new WeakMap,Oh=new WeakMap,kt=new WeakMap,Dw=new WeakMap,Lh=new WeakMap,na=new WeakMap,jh=new WeakMap,Fh=new WeakMap,$h=new WeakMap,Rw=new WeakSet,nD=function(e,t){if(!c(this,kt)._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[c(this,kt)._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const r=c(this,kt)._uiManager._signal;if(!(r instanceof AbortSignal)||r.aborted)return e;e.addEventListener("contextmenu",Hi,{signal:r}),t&&(e.addEventListener("focusin",i=>{c(this,kt)._focusEventsAllowed=!1,cn(i)},{capture:!0,signal:r}),e.addEventListener("focusout",i=>{c(this,kt)._focusEventsAllowed=!0,cn(i)},{capture:!0,signal:r})),e.addEventListener("pointerdown",i=>i.stopPropagation(),{signal:r});const s=i=>{i.preventDefault(),e===c(this,Ei)?this.edit():c(this,kt).toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:r}),e.addEventListener("keydown",i=>{i.target===e&&i.key==="Enter"&&(A(this,Oh,!0),s(i))},{signal:r}),e.addEventListener("pointerenter",()=>{c(this,kt).toggleComment(!1,!0)},{signal:r}),e.addEventListener("pointerleave",()=>{c(this,kt).toggleComment(!1,!1)},{signal:r}),e};var fm,Uh,Mw,Ow,Lw,jw,Fw,Yo,Vh,Ko,Bh,Xo,CA,S9,kA,E9,NA,A9;const RO=class RO{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:r=null,onPinchStart:s=null,onPinching:i=null,onPinchEnd:a=null,signal:o}){x(this,CA);x(this,kA);x(this,NA);x(this,fm,void 0);x(this,Uh,!1);x(this,Mw,null);x(this,Ow,void 0);x(this,Lw,void 0);x(this,jw,void 0);x(this,Fw,void 0);x(this,Yo,null);x(this,Vh,void 0);x(this,Ko,null);x(this,Bh,void 0);x(this,Xo,null);A(this,fm,e),A(this,Mw,r),A(this,Ow,t),A(this,Lw,s),A(this,jw,i),A(this,Fw,a),A(this,Bh,new AbortController),A(this,Vh,AbortSignal.any([o,c(this,Bh).signal])),e.addEventListener("touchstart",D(this,CA,S9).bind(this),{passive:!1,signal:c(this,Vh)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Co.pixelRatio}destroy(){var e,t;(e=c(this,Bh))==null||e.abort(),A(this,Bh,null),(t=c(this,Yo))==null||t.abort(),A(this,Yo,null)}};fm=new WeakMap,Uh=new WeakMap,Mw=new WeakMap,Ow=new WeakMap,Lw=new WeakMap,jw=new WeakMap,Fw=new WeakMap,Yo=new WeakMap,Vh=new WeakMap,Ko=new WeakMap,Bh=new WeakMap,Xo=new WeakMap,CA=new WeakSet,S9=function(e){var s,i,a;if((s=c(this,Ow))!=null&&s.call(this))return;if(e.touches.length===1){if(c(this,Yo))return;const o=A(this,Yo,new AbortController),l=AbortSignal.any([c(this,Vh),o.signal]),u=c(this,fm),h={capture:!0,signal:l,passive:!1},f=p=>{var g;p.pointerType==="touch"&&((g=c(this,Yo))==null||g.abort(),A(this,Yo,null))};u.addEventListener("pointerdown",p=>{p.pointerType==="touch"&&(cn(p),f(p))},h),u.addEventListener("pointerup",f,h),u.addEventListener("pointercancel",f,h);return}if(!c(this,Xo)){A(this,Xo,new AbortController);const o=AbortSignal.any([c(this,Vh),c(this,Xo).signal]),l=c(this,fm),u={signal:o,capture:!1,passive:!1};l.addEventListener("touchmove",D(this,kA,E9).bind(this),u);const h=D(this,NA,A9).bind(this);l.addEventListener("touchend",h,u),l.addEventListener("touchcancel",h,u),u.capture=!0,l.addEventListener("pointerdown",cn,u),l.addEventListener("pointermove",cn,u),l.addEventListener("pointercancel",cn,u),l.addEventListener("pointerup",cn,u),(i=c(this,Lw))==null||i.call(this)}if(cn(e),e.touches.length!==2||(a=c(this,Mw))!=null&&a.call(this)){A(this,Ko,null);return}let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]),A(this,Ko,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:r.screenX,touch1Y:r.screenY})},kA=new WeakSet,E9=function(e){var T;if(!c(this,Ko)||e.touches.length!==2)return;cn(e);let[t,r]=e.touches;t.identifier>r.identifier&&([t,r]=[r,t]);const{screenX:s,screenY:i}=t,{screenX:a,screenY:o}=r,l=c(this,Ko),{touch0X:u,touch0Y:h,touch1X:f,touch1Y:p}=l,g=f-u,v=p-h,y=a-s,_=o-i,w=Math.hypot(y,_)||1,b=Math.hypot(g,v)||1;if(!c(this,Uh)&&Math.abs(b-w)<=RO.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=i,l.touch1X=a,l.touch1Y=o,!c(this,Uh)){A(this,Uh,!0);return}const S=[(s+a)/2,(i+o)/2];(T=c(this,jw))==null||T.call(this,S,b,w)},NA=new WeakSet,A9=function(e){var t;e.touches.length>=2||(c(this,Xo)&&(c(this,Xo).abort(),A(this,Xo,null),(t=c(this,Fw))==null||t.call(this)),c(this,Ko)&&(cn(e),A(this,Ko,null),A(this,Uh,!1)))};let J1=RO;var zh,ra,Ht,St,Qo,pm,$c,$w,ir,Hh,Jo,qa,Uc,Uw,Wh,$s,Vw,Gh,Zo,Ya,mm,gm,Ai,qh,Bw,PA,zw,rD,Hw,sD,ym,pE,IA,T9,DA,C9,Ww,iD,vm,mE,Gw,aD,RA,k9,MA,N9,OA,P9,qw,oD,LA,I9,Yw,lD,jA,D9,FA,R9,$A,M9,Kw,cD,Yh,Iv;const je=class je{constructor(e){x(this,zw);x(this,ym);x(this,IA);x(this,DA);x(this,Ww);x(this,vm);x(this,Gw);x(this,RA);x(this,MA);x(this,OA);x(this,qw);x(this,LA);x(this,Yw);x(this,jA);x(this,FA);x(this,$A);x(this,Kw);x(this,Yh);x(this,zh,null);x(this,ra,null);x(this,Ht,null);x(this,St,null);x(this,Qo,null);x(this,pm,!1);x(this,$c,null);x(this,$w,"");x(this,ir,null);x(this,Hh,null);x(this,Jo,null);x(this,qa,null);x(this,Uc,null);x(this,Uw,"");x(this,Wh,!1);x(this,$s,null);x(this,Vw,!1);x(this,Gh,!1);x(this,Zo,!1);x(this,Ya,null);x(this,mm,0);x(this,gm,0);x(this,Ai,null);x(this,qh,null);ie(this,"isSelected",!1);ie(this,"_isCopy",!1);ie(this,"_editToolbar",null);ie(this,"_initialOptions",Object.create(null));ie(this,"_initialData",null);ie(this,"_isVisible",!0);ie(this,"_uiManager",null);ie(this,"_focusEventsAllowed",!0);x(this,Bw,!1);x(this,PA,je._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:r,pageHeight:s,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[r,s],this.pageTranslation=[i,a];const[o,l]=this.parentDimensions;this.x=e.x/o,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=je.prototype._resizeWithKeyboard,t=Pf.TRANSLATE_SMALL,r=Pf.TRANSLATE_BIG;return Ve(this,"_resizerKeyboardManager",new Ax([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-r,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[r,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-r]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,r]}],[["Escape","mac+Escape"],je.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ve(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new gEe({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(je._l10n??(je._l10n=e),je._l10nResizer||(je._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),je._borderLineWidth!==-1)return;const r=getComputedStyle(document.documentElement);je._borderLineWidth=parseFloat(r.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Tt("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,Bw)}set _isDraggable(e){var t;A(this,Bw,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,PA)}setParent(e){var t;e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(D(this,Yh,Iv).call(this),(t=c(this,qa))==null||t.remove(),A(this,qa,null)),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,Wh)?A(this,Wh,!1):this.parent.setSelected(this))}focusout(e){var r;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(r=this.parent)!=null&&r.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,r,s){const[i,a]=this.parentDimensions;[r,s]=this.screenToPageTranslation(r,s),this.x=(e+r)/i,this.y=(t+s)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[r,s]=this.parentDimensions;this.setAt(e*r,t*s,this.width*r,this.height*s),this._onTranslated()}translate(e,t){D(this,zw,rD).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,$s)||A(this,$s,[this.x,this.y,this.width,this.height]),D(this,zw,rD).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){c(this,$s)||A(this,$s,[this.x,this.y,this.width,this.height]);const{div:r,parentDimensions:[s,i]}=this;if(this.x+=e/s,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:p}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,p)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this;const[l,u]=this.getBaseTranslation();a+=l,o+=u;const{style:h}=r;h.left=`${(100*a).toFixed(2)}%`,h.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),r.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,$s)&&(c(this,$s)[0]!==this.x||c(this,$s)[1]!==this.y)}get _hasBeenResized(){return!!c(this,$s)&&(c(this,$s)[2]!==this.width||c(this,$s)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:r}=je,s=r/e,i=r/t;switch(this.rotation){case 90:return[-s,i];case 180:return[s,i];case 270:return[s,-i];default:return[-s,-i]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[r,s]}=this;let{x:i,y:a,width:o,height:l}=this;if(o*=r,l*=s,i*=r,a*=s,this._mustFixPosition)switch(e){case 0:i=Jr(i,0,r-o),a=Jr(a,0,s-l);break;case 90:i=Jr(i,0,r-l),a=Jr(a,o,s);break;case 180:i=Jr(i,o,r),a=Jr(a,l,s);break;case 270:i=Jr(i,l,r),a=Jr(a,0,s-o);break}this.x=i/=r,this.y=a/=s;const[u,h]=this.getBaseTranslation();i+=u,a+=h,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var r;return D(r=je,Hw,sD).call(r,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var r;return D(r=je,Hw,sD).call(r,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,r]}=this;return[t*e,r*e]}setDims(){const{div:{style:e},width:t,height:r}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*r).toFixed(2)}%`}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,Ht))==null||e.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||c(this,Gh))return this._editToolbar;this._editToolbar=new GI(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,r]of e)await this._editToolbar.addButton(t,r);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){var e;(e=this._editToolbar)==null||e.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){var e;(e=this._editToolbar)==null||e.removeButton("comment")}removeEditToolbar(){var e,t;(e=this._editToolbar)==null||e.remove(),this._editToolbar=null,(t=c(this,Ht))==null||t.destroy()}addContainer(e){var r;const t=(r=this._editToolbar)==null?void 0:r.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return c(this,Ht)||(Q1.initialize(je._l10n),A(this,Ht,new Q1(this)),c(this,zh)&&(c(this,Ht).data=c(this,zh),A(this,zh,null))),c(this,Ht)}get altTextData(){var e;return(e=c(this,Ht))==null?void 0:e.data}set altTextData(e){c(this,Ht)&&(c(this,Ht).data=e)}get guessedAltText(){var e;return(e=c(this,Ht))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,Ht))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,Ht))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,Ht)&&!c(this,Ht).isEmpty()}hasAltTextData(){var e;return((e=c(this,Ht))==null?void 0:e.hasData())??!1}focusCommentButton(){var e;(e=c(this,St))==null||e.focusButton()}addCommentButton(){return c(this,St)||A(this,St,new SS(this))}addStandaloneCommentButton(){if(c(this,Qo)){this._uiManager.isEditingMode()&&c(this,Qo).classList.remove("hidden");return}this.hasComment&&(A(this,Qo,c(this,St).renderForStandalone()),this.div.append(c(this,Qo)))}removeStandaloneCommentButton(){c(this,St).removeStandaloneCommentButton(),A(this,Qo,null)}hideStandaloneCommentButton(){var e;(e=c(this,Qo))==null||e.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:r,deleted:s}}=c(this,St);return{text:t,richText:e,date:r,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){c(this,St)||A(this,St,new SS(this)),c(this,St).data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:r}){if(!t||(c(this,St)||A(this,St,new SS(this)),c(this,St).setInitialText(e,r),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){var e;return(e=c(this,St))==null?void 0:e.hasBeenEdited()}get hasDeletedComment(){var e;return(e=c(this,St))==null?void 0:e.isDeleted()}get hasComment(){return!!c(this,St)&&!c(this,St).isEmpty()&&!c(this,St).isDeleted()}async editComment(e){c(this,St)||A(this,St,new SS(this)),c(this,St).edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){c(this,St).setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[i]=this.pageDimensions,[a]=this.pageTranslation,o=a+i+1,l=s-100,u=o+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[o,l,u,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){c(this,St).data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){var a;const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=c(this,pm)?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),D(this,Yw,lD).call(this);const[t,r]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*r/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/r).toFixed(2)}%`);const[s,i]=this.getInitialTranslation();return this.translate(s,i),h9(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,qh)||A(this,qh,new J1({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:D(this,RA,k9).bind(this),onPinching:D(this,MA,N9).bind(this),onPinchEnd:D(this,OA,P9).bind(this),signal:this._uiManager._signal}))),this.addStandaloneCommentButton(),(a=this._uiManager._editorUndoBar)==null||a.hide(),e}pointerdown(e){const{isMac:t}=mr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(A(this,Wh,!0),this._isDraggable){D(this,LA,I9).call(this,e);return}D(this,qw,oD).call(this,e)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Ya)&&clearTimeout(c(this,Ya)),A(this,Ya,setTimeout(()=>{var e;A(this,Ya,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,r){e.changeParent(this),this.x=t,this.y=r,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,r=this.rotation){const s=this.parentScale,[i,a]=this.pageDimensions,[o,l]=this.pageTranslation,u=e/s,h=t/s,f=this.x*i,p=this.y*a,g=this.width*i,v=this.height*a;switch(r){case 0:return[f+u+o,a-p-h-v+l,f+u+g+o,a-p-h+l];case 90:return[f+h+o,a-p+u+l,f+h+v+o,a-p+u+g+l];case 180:return[f-u-g+o,a-p+h+l,f-u+o,a-p+h+v+l];case 270:return[f-h-v+o,a-p-u-g+l,f-h+o,a-p-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[r,s,i,a]=e,o=i-r,l=a-s;switch(this.rotation){case 0:return[r,t-a,o,l];case 90:return[r,t-s,l,o];case 180:return[i,t-s,o,l];case 270:return[i,t-a,l,o];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&je._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){var e;(e=c(this,St))==null||e.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:r,opacity:s,deleted:i,richText:a},uid:o,pageIndex:l,creationDate:u,modificationDate:h}=this;return{id:o,pageIndex:l,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:u,modificationDate:r||h,popupRef:!i,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),A(this,Gh,!0),!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),A(this,Gh,!1),!0):!1}isInEditMode(){return c(this,Gh)}shouldGetKeyboardEvents(){return c(this,Zo)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:r,right:s}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&s>0&&e<i&&r>0}rebuild(){D(this,Yw,lD).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){var r;return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:((r=this._initialData)==null?void 0:r.popupRef)||""}}static async deserialize(e,t,r){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:r,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,A(s,zh,e.accessibilityData),s._isCopy=e.isCopy||!1;const[i,a]=s.pageDimensions,[o,l,u,h]=s.getRectInCurrentCoords(e.rect,a);return s.x=o/i,s.y=l/a,s.width=u/i,s.height=h/a,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=c(this,Uc))==null||e.abort(),A(this,Uc,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,Ya)&&(clearTimeout(c(this,Ya)),A(this,Ya,null)),D(this,Yh,Iv).call(this),this.removeEditToolbar(),c(this,Ai)){for(const r of c(this,Ai).values())clearTimeout(r);A(this,Ai,null)}this.parent=null,(t=c(this,qh))==null||t.destroy(),A(this,qh,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(D(this,IA,T9).call(this),c(this,ir).classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[r,s,i,a]=this.getPDFRect();return[je._round(r+(i-r)*e),je._round(s+(a-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return c(this,St).commentPopupPositionInLayer}set commentPopupPosition(e){c(this,St).commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return c(this,St).hasDefaultPopupPosition()}get commentButtonWidth(){return c(this,St).commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){c(this,St).setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),A(this,Jo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,ir).children;if(!c(this,ra)){A(this,ra,Array.from(t));const a=D(this,jA,D9).bind(this),o=D(this,FA,R9).bind(this),l=this._uiManager._signal;for(const u of c(this,ra)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",a,{signal:l}),u.addEventListener("blur",o,{signal:l}),u.addEventListener("focus",D(this,$A,M9).bind(this,h),{signal:l}),u.setAttribute("data-l10n-id",je._l10nResizer[h])}}const r=c(this,ra)[0];let s=0;for(const a of t){if(a===r)break;s++}const i=(360-this.rotation+this.parentRotation)%360/90*(c(this,ra).length/4);if(i!==s){if(i<s)for(let o=0;o<s-i;o++)c(this,ir).append(c(this,ir).firstChild);else if(i>s)for(let o=0;o<i-s;o++)c(this,ir).firstChild.before(c(this,ir).lastChild);let a=0;for(const o of t){const u=c(this,ra)[a++].getAttribute("data-resizer-name");o.setAttribute("data-l10n-id",je._l10nResizer[u])}}D(this,Kw,cD).call(this,0),A(this,Zo,!0),c(this,ir).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,Zo)&&D(this,Gw,aD).call(this,c(this,Uw),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){D(this,Yh,Iv).call(this),this.div.focus()}select(){var e,t,r;if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,i;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((i=this._editToolbar)==null||i.show())});return}(t=this._editToolbar)==null||t.show(),(r=c(this,Ht))==null||r.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>{var e;return(e=this.div)==null?void 0:e.focus({preventScroll:!0})},0)}unselect(){var e,t,r,s,i;this.isSelected&&(this.isSelected=!1,(e=c(this,ir))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(r=this.div)!=null&&r.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(i=c(this,Ht))==null||i.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return c(this,Vw)}set isEditing(e){A(this,Vw,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Ai)||A(this,Ai,new Map);const{action:r}=e;let s=c(this,Ai).get(r);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),c(this,Ai).delete(r),c(this,Ai).size===0&&A(this,Ai,null)},je._telemetryTimeout),c(this,Ai).set(r,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),A(this,pm,!1)}disable(){this.div&&(this.div.tabIndex=-1),A(this,pm,!0)}updateFakeAnnotationElement(e){if(!c(this,qa)&&!this.deleted){A(this,qa,e.addFakeAnnotation(this));return}if(this.deleted){c(this,qa).remove(),A(this,qa,null);return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&c(this,qa).updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const r=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),r.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};zh=new WeakMap,ra=new WeakMap,Ht=new WeakMap,St=new WeakMap,Qo=new WeakMap,pm=new WeakMap,$c=new WeakMap,$w=new WeakMap,ir=new WeakMap,Hh=new WeakMap,Jo=new WeakMap,qa=new WeakMap,Uc=new WeakMap,Uw=new WeakMap,Wh=new WeakMap,$s=new WeakMap,Vw=new WeakMap,Gh=new WeakMap,Zo=new WeakMap,Ya=new WeakMap,mm=new WeakMap,gm=new WeakMap,Ai=new WeakMap,qh=new WeakMap,Bw=new WeakMap,PA=new WeakMap,zw=new WeakSet,rD=function([e,t],r,s){[r,s]=this.screenToPageTranslation(r,s),this.x+=r/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},Hw=new WeakSet,sD=function(e,t,r){switch(r){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},ym=new WeakSet,pE=function(e){switch(e){case 90:{const[t,r]=this.pageDimensions;return[0,-t/r,r/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,r]=this.pageDimensions;return[0,t/r,-r/t,0]}default:return[1,0,0,1]}},IA=new WeakSet,T9=function(){if(c(this,ir))return;A(this,ir,document.createElement("div")),c(this,ir).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const r of e){const s=document.createElement("div");c(this,ir).append(s),s.classList.add("resizer",r),s.setAttribute("data-resizer-name",r),s.addEventListener("pointerdown",D(this,DA,C9).bind(this,r),{signal:t}),s.addEventListener("contextmenu",Hi,{signal:t}),s.tabIndex=-1}this.div.prepend(c(this,ir))},DA=new WeakSet,C9=function(e,t){var h;t.preventDefault();const{isMac:r}=mr.platform;if(t.button!==0||t.ctrlKey&&r)return;(h=c(this,Ht))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,A(this,Hh,[t.screenX,t.screenY]);const i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",D(this,Gw,aD).bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",cn,{passive:!1,signal:a}),window.addEventListener("contextmenu",Hi,{signal:a}),A(this,Jo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const o=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var f;i.abort(),this.parent.togglePointerEvents(!0),(f=c(this,Ht))==null||f.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=o,this.div.style.cursor=l,D(this,vm,mE).call(this)};window.addEventListener("pointerup",u,{signal:a}),window.addEventListener("blur",u,{signal:a})},Ww=new WeakSet,iD=function(e,t,r,s){this.width=r,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()},vm=new WeakSet,mE=function(){if(!c(this,Jo))return;const{savedX:e,savedY:t,savedWidth:r,savedHeight:s}=c(this,Jo);A(this,Jo,null);const i=this.x,a=this.y,o=this.width,l=this.height;i===e&&a===t&&o===r&&l===s||this.addCommands({cmd:D(this,Ww,iD).bind(this,i,a,o,l),undo:D(this,Ww,iD).bind(this,e,t,r,s),mustExec:!0})},Gw=new WeakSet,aD=function(e,t){const[r,s]=this.parentDimensions,i=this.x,a=this.y,o=this.width,l=this.height,u=je.MIN_SIZE/r,h=je.MIN_SIZE/s,f=D(this,ym,pE).call(this,this.rotation),p=(X,J)=>[f[0]*X+f[2]*J,f[1]*X+f[3]*J],g=D(this,ym,pE).call(this,360-this.rotation),v=(X,J)=>[g[0]*X+g[2]*J,g[1]*X+g[3]*J];let y,_,w=!1,b=!1;switch(e){case"topLeft":w=!0,y=(X,J)=>[0,0],_=(X,J)=>[X,J];break;case"topMiddle":y=(X,J)=>[X/2,0],_=(X,J)=>[X/2,J];break;case"topRight":w=!0,y=(X,J)=>[X,0],_=(X,J)=>[0,J];break;case"middleRight":b=!0,y=(X,J)=>[X,J/2],_=(X,J)=>[0,J/2];break;case"bottomRight":w=!0,y=(X,J)=>[X,J],_=(X,J)=>[0,0];break;case"bottomMiddle":y=(X,J)=>[X/2,J],_=(X,J)=>[X/2,0];break;case"bottomLeft":w=!0,y=(X,J)=>[0,J],_=(X,J)=>[X,0];break;case"middleLeft":b=!0,y=(X,J)=>[0,J/2],_=(X,J)=>[X,J/2];break}const S=y(o,l),T=_(o,l);let P=p(...T);const R=je._round(i+P[0]),k=je._round(a+P[1]);let C=1,I=1,M,L;if(t.fromKeyboard)({deltaX:M,deltaY:L}=t);else{const{screenX:X,screenY:J}=t,[K,te]=c(this,Hh);[M,L]=this.screenToPageTranslation(X-K,J-te),c(this,Hh)[0]=X,c(this,Hh)[1]=J}if([M,L]=v(M/r,L/s),w){const X=Math.hypot(o,l);C=I=Math.max(Math.min(Math.hypot(T[0]-S[0]-M,T[1]-S[1]-L)/X,1/o,1/l),u/o,h/l)}else b?C=Jr(Math.abs(T[0]-S[0]-M),u,1)/o:I=Jr(Math.abs(T[1]-S[1]-L),h,1)/l;const F=je._round(o*C),O=je._round(l*I);P=p(..._(F,O));const Y=R-P[0],Z=k-P[1];c(this,$s)||A(this,$s,[this.x,this.y,this.width,this.height]),this.width=F,this.height=O,this.x=Y,this.y=Z,this.setDims(),this.fixAndSetPosition(),this._onResizing()},RA=new WeakSet,k9=function(){var e;A(this,Jo,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,Ht))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},MA=new WeakSet,N9=function(e,t,r){let i=.7*(r/t)+1-.7;if(i===1)return;const a=D(this,ym,pE).call(this,this.rotation),o=(R,k)=>[a[0]*R+a[2]*k,a[1]*R+a[3]*k],[l,u]=this.parentDimensions,h=this.x,f=this.y,p=this.width,g=this.height,v=je.MIN_SIZE/l,y=je.MIN_SIZE/u;i=Math.max(Math.min(i,1/p,1/g),v/p,y/g);const _=je._round(p*i),w=je._round(g*i);if(_===p&&w===g)return;c(this,$s)||A(this,$s,[h,f,p,g]);const b=o(p/2,g/2),S=je._round(h+b[0]),T=je._round(f+b[1]),P=o(_/2,w/2);this.x=S-P[0],this.y=T-P[1],this.width=_,this.height=w,this.setDims(),this.fixAndSetPosition(),this._onResizing()},OA=new WeakSet,P9=function(){var e;(e=c(this,Ht))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),D(this,vm,mE).call(this)},qw=new WeakSet,oD=function(e){const{isMac:t}=mr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},LA=new WeakSet,I9=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let r=!1;const s=new AbortController,i=this._uiManager.combinedSignal(s),a={capture:!0,passive:!1,signal:i},o=u=>{s.abort(),A(this,$c,null),A(this,Wh,!1),this._uiManager.endDragSession()||D(this,qw,oD).call(this,u),r&&this._onStopDragging()};t&&(A(this,mm,e.clientX),A(this,gm,e.clientY),A(this,$c,e.pointerId),A(this,$w,e.pointerType),window.addEventListener("pointermove",u=>{r||(r=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:h,clientY:f,pointerId:p}=u;if(p!==c(this,$c)){cn(u);return}const[g,v]=this.screenToPageTranslation(h-c(this,mm),f-c(this,gm));A(this,mm,h),A(this,gm,f),this._uiManager.dragSelectedEditors(g,v)},a),window.addEventListener("touchmove",cn,a),window.addEventListener("pointerdown",u=>{u.pointerType===c(this,$w)&&(c(this,qh)||u.isPrimary)&&o(u),cn(u)},a));const l=u=>{if(!c(this,$c)||c(this,$c)===u.pointerId){o(u);return}cn(u)};window.addEventListener("pointerup",l,{signal:i}),window.addEventListener("blur",l,{signal:i})},Yw=new WeakSet,lD=function(){if(c(this,Uc)||!this.div)return;A(this,Uc,new AbortController);const e=this._uiManager.combinedSignal(c(this,Uc));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},jA=new WeakSet,D9=function(e){je._resizerKeyboardManager.exec(this,e)},FA=new WeakSet,R9=function(e){var t;c(this,Zo)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,ir)&&D(this,Yh,Iv).call(this)},$A=new WeakSet,M9=function(e){A(this,Uw,c(this,Zo)?e:"")},Kw=new WeakSet,cD=function(e){if(c(this,ra))for(const t of c(this,ra))t.tabIndex=e},Yh=new WeakSet,Iv=function(){A(this,Zo,!1),D(this,Kw,cD).call(this,-1),D(this,vm,mE).call(this)},x(je,Hw),ie(je,"_l10n",null),ie(je,"_l10nResizer",null),ie(je,"_borderLineWidth",-1),ie(je,"_colorManager",new KI),ie(je,"_zIndex",1),ie(je,"_telemetryTimeout",1e3);let It=je;class gEe extends It{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const G4=3285377520,gi=4294901760,Oa=65535;class O9{constructor(e){this.h1=e?e&4294967295:G4,this.h2=e?e&4294967295:G4}update(e){let t,r;if(typeof e=="string"){t=new Uint8Array(e.length*2),r=0;for(let y=0,_=e.length;y<_;y++){const w=e.charCodeAt(y);w<=255?t[r++]=w:(t[r++]=w>>>8,t[r++]=w&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),r=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=r>>2,i=r-s*4,a=new Uint32Array(t.buffer,0,s);let o=0,l=0,u=this.h1,h=this.h2;const f=3432918353,p=461845907,g=f&Oa,v=p&Oa;for(let y=0;y<s;y++)y&1?(o=a[y],o=o*f&gi|o*g&Oa,o=o<<15|o>>>17,o=o*p&gi|o*v&Oa,u^=o,u=u<<13|u>>>19,u=u*5+3864292196):(l=a[y],l=l*f&gi|l*g&Oa,l=l<<15|l>>>17,l=l*p&gi|l*v&Oa,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(o=0,i){case 3:o^=t[s*4+2]<<16;case 2:o^=t[s*4+1]<<8;case 1:o^=t[s*4],o=o*f&gi|o*g&Oa,o=o<<15|o>>>17,o=o*p&gi|o*v&Oa,s&1?u^=o:h^=o}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&gi|e*36045&Oa,t=t*4283543511&gi|((t<<16|e>>>16)*2950163797&gi)>>>16,e^=t>>>1,e=e*444984403&gi|e*60499&Oa,t=t*3301882366&gi|((t<<16|e>>>16)*3120437893&gi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const uD=Object.freeze({map:null,hash:"",transfer:void 0});var Kh,Xh,el,ar,UA,L9;class EO{constructor(){x(this,UA);x(this,Kh,!1);x(this,Xh,null);x(this,el,null);x(this,ar,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const r=c(this,ar).get(e);return r===void 0?t:Object.assign(t,r)}getRawValue(e){return c(this,ar).get(e)}remove(e){const t=c(this,ar).get(e);if(t!==void 0&&(t instanceof It&&c(this,el).delete(t.annotationElementId),c(this,ar).delete(e),c(this,ar).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const r of c(this,ar).values())if(r instanceof It)return;this.onAnnotationEditor(null)}}setValue(e,t){const r=c(this,ar).get(e);let s=!1;if(r!==void 0)for(const[i,a]of Object.entries(t))r[i]!==a&&(s=!0,r[i]=a);else s=!0,c(this,ar).set(e,t);s&&D(this,UA,L9).call(this),t instanceof It&&((c(this,el)||A(this,el,new Map)).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return c(this,ar).has(e)}get size(){return c(this,ar).size}resetModified(){c(this,Kh)&&(A(this,Kh,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new j9(this)}get serializable(){if(c(this,ar).size===0)return uD;const e=new Map,t=new O9,r=[],s=Object.create(null);let i=!1;for(const[a,o]of c(this,ar)){const l=o instanceof It?o.serialize(!1,s):o;l&&(e.set(a,l),t.update(`${a}:${JSON.stringify(l)}`),i||(i=!!l.bitmap))}if(i)for(const a of e.values())a.bitmap&&r.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:r}:uD}get editorStats(){let e=null;const t=new Map;let r=0,s=0;for(const i of c(this,ar).values()){if(!(i instanceof It)){i.popup&&(i.popup.deleted?s+=1:r+=1);continue}i.isCommentDeleted?s+=1:i.hasEditedComment&&(r+=1);const a=i.telemetryFinalData;if(!a)continue;const{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const l=e[o]||(e[o]=new Map);for(const[u,h]of Object.entries(a)){if(u==="type")continue;let f=l.get(u);f||(f=new Map,l.set(u,f));const p=f.get(h)??0;f.set(h,p+1)}}if((s>0||r>0)&&(e||(e=Object.create(null)),e.comments={deleted:s,edited:r}),!e)return null;for(const[i,a]of t)e[i]=a.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){A(this,Xh,null)}updateEditor(e,t){var s;const r=(s=c(this,el))==null?void 0:s.get(e);return r?(r.updateFromAnnotationLayer(t),!0):!1}getEditor(e){var t;return((t=c(this,el))==null?void 0:t.get(e))||null}get modifiedIds(){if(c(this,Xh))return c(this,Xh);const e=[];if(c(this,el))for(const t of c(this,el).values())t.serialize()&&e.push(t.annotationElementId);return A(this,Xh,{ids:new Set(e),hash:e.join(",")})}[Symbol.iterator](){return c(this,ar).entries()}}Kh=new WeakMap,Xh=new WeakMap,el=new WeakMap,ar=new WeakMap,UA=new WeakSet,L9=function(){c(this,Kh)||(A(this,Kh,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var Xw;class j9 extends EO{constructor(t){super();x(this,Xw,void 0);const{map:r,hash:s,transfer:i}=t.serializable,a=structuredClone(r,i?{transfer:i}:null);A(this,Xw,{map:a,hash:s,transfer:i})}get print(){Tt("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,Xw)}get modifiedIds(){return Ve(this,"modifiedIds",{ids:new Set,hash:""})}}Xw=new WeakMap;var wm;class yEe{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){x(this,wm,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,wm).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:r}){if(!(!e||c(this,wm).has(e.loadedName))){if(Je(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:i,style:a}=e,o=new FontFace(s,i,a);this.addNativeFontFace(o);try{await o.load(),c(this,wm).add(s),r==null||r(e)}catch{Oe(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Tt("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const r=e.createNativeFontFace();if(r){this.addNativeFontFace(r);try{await r.loaded}catch(s){throw Oe(`Failed to load font '${r.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(r=>{const s=this._queueLoadingCallback(r);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return Ve(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ve(this,"isSyncFontLoadingSupported",Qr||mr.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Je(!s.done,"completeRequest() cannot be called twice."),s.done=!0;r.length>0&&r[0].done;){const i=r.shift();setTimeout(i.callback,0)}}const{loadingRequests:r}=this,s={done:!1,complete:t,callback:e};return r.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ve(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function r(T,P){return T.charCodeAt(P)<<24|T.charCodeAt(P+1)<<16|T.charCodeAt(P+2)<<8|T.charCodeAt(P+3)&255}function s(T,P,R,k){const C=T.substring(0,P),I=T.substring(P+R);return C+k+I}let i,a;const o=this._document.createElement("canvas");o.width=1,o.height=1;const l=o.getContext("2d");let u=0;function h(T,P){if(++u>30){Oe("Load test font never loaded."),P();return}if(l.font="30px "+T,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){P();return}setTimeout(h.bind(null,T,P))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let p=this._loadTestFont;p=s(p,976,f.length,f);const v=16,y=1482184792;let _=r(p,v);for(i=0,a=f.length-3;i<a;i+=4)_=_-y+r(f,i)|0;i<f.length&&(_=_-y+r(f+"XXX",i)|0),p=s(p,v,4,QSe(_));const w=`url(data:font/opentype;base64,${btoa(p)});`,b=`@font-face {font-family:"${f}";src:${w}}`;this.insertRule(b);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const T of[e.loadedName,f]){const P=this._document.createElement("span");P.textContent="Hi",P.style.fontFamily=T,S.append(P)}this._document.body.append(S),h(f,()=>{S.remove(),t.complete()})}}wm=new WeakMap;var yt;class vEe{constructor(e,t=null,r,s){x(this,yt,void 0);this.compiledGlyphs=Object.create(null),A(this,yt,e),this._inspectFont=t,r&&Object.assign(this,r),s&&(this.charProcOperatorList=s)}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const r={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(r.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,r)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var r;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${r9(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(r=this._inspectFont)==null||r.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const r=this.loadedName+"_path_"+t;let s;try{s=e.get(r)}catch(a){Oe(`getPathGenerator - ignoring character: "${a}".`)}const i=new Path2D(s||"");return this.fontExtraProperties||e.delete(r),this.compiledGlyphs[t]=i}get black(){return c(this,yt).black}get bold(){return c(this,yt).bold}get disableFontFace(){return c(this,yt).disableFontFace??!1}get fontExtraProperties(){return c(this,yt).fontExtraProperties??!1}get isInvalidPDFjsFont(){return c(this,yt).isInvalidPDFjsFont}get isType3Font(){return c(this,yt).isType3Font}get italic(){return c(this,yt).italic}get missingFile(){return c(this,yt).missingFile}get remeasure(){return c(this,yt).remeasure}get vertical(){return c(this,yt).vertical}get ascent(){return c(this,yt).ascent}get defaultWidth(){return c(this,yt).defaultWidth}get descent(){return c(this,yt).descent}get bbox(){return c(this,yt).bbox}get fontMatrix(){return c(this,yt).fontMatrix}get fallbackName(){return c(this,yt).fallbackName}get loadedName(){return c(this,yt).loadedName}get mimetype(){return c(this,yt).mimetype}get name(){return c(this,yt).name}get data(){return c(this,yt).data}clearData(){c(this,yt).clearData()}get cssFontInfo(){return c(this,yt).cssFontInfo}get systemFontInfo(){return c(this,yt).systemFontInfo}get defaultVMetrics(){return c(this,yt).defaultVMetrics}}yt=new WeakMap;function wEe(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Qr)return n;const e=URL.parse(n,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function bEe(n){if(Qr&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return _x(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function ES(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const hD=n=>typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0,_Ee=n=>typeof n=="object"&&typeof(n==null?void 0:n.name)=="string",xEe=nEe.bind(null,hD,_Ee);var tl,VA;class SEe{constructor(){x(this,tl,new Map);x(this,VA,Promise.resolve())}postMessage(e,t){const r={data:structuredClone(e,t?{transfer:t}:null)};c(this,VA).then(()=>{for(const[s]of c(this,tl))s.call(this,r)})}addEventListener(e,t,r=null){let s=null;if((r==null?void 0:r.signal)instanceof AbortSignal){const{signal:i}=r;if(i.aborted){Oe("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);s=()=>i.removeEventListener("abort",a),i.addEventListener("abort",a)}c(this,tl).set(t,s)}removeEventListener(e,t){const r=c(this,tl).get(t);r==null||r(),c(this,tl).delete(t)}terminate(){for(const[,e]of c(this,tl))e==null||e();c(this,tl).clear()}}tl=new WeakMap,VA=new WeakMap;const AS={DATA:1,ERROR:2},bn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function q4(){}function ls(n){if(n instanceof qu||n instanceof BI||n instanceof $4||n instanceof K1||n instanceof UN)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Tt('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new qu(n.message);case"InvalidPDFException":return new BI(n.message);case"PasswordException":return new $4(n.message,n.code);case"ResponseException":return new K1(n.message,n.status,n.missing);case"UnknownErrorException":return new UN(n.message,n.details)}return new UN(n.message,n.toString())}var bm,BA,F9,zA,$9,HA,U9,_m,gE;class Dv{constructor(e,t,r){x(this,BA);x(this,zA);x(this,HA);x(this,_m);x(this,bm,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=r,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),r.addEventListener("message",D(this,BA,F9).bind(this),{signal:c(this,bm).signal})}on(e,t){const r=this.actionHandler;if(r[e])throw new Error(`There is already an actionName called "${e}"`);r[e]=t}send(e,t,r){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},r)}sendWithPromise(e,t,r){const s=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[s]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},r)}catch(a){i.reject(a)}return i.promise}sendWithStream(e,t,r,s){const i=this.streamId++,a=this.sourceName,o=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[i]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:a,targetName:o,action:e,streamId:i,data:t,desiredSize:u.desiredSize},s),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[i].pullCall=h,l.postMessage({sourceName:a,targetName:o,stream:bn.PULL,streamId:i,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Je(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[i].cancelCall=h,this.streamControllers[i].isClosed=!0,l.postMessage({sourceName:a,targetName:o,stream:bn.CANCEL,streamId:i,reason:ls(u)}),h.promise}},r)}destroy(){var e;(e=c(this,bm))==null||e.abort(),A(this,bm,null)}}bm=new WeakMap,BA=new WeakSet,F9=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){D(this,HA,U9).call(this,e);return}if(e.callback){const r=e.callbackId,s=this.callbackCapabilities[r];if(!s)throw new Error(`Cannot resolve callback ${r}`);if(delete this.callbackCapabilities[r],e.callback===AS.DATA)s.resolve(e.data);else if(e.callback===AS.ERROR)s.reject(ls(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const r=this.sourceName,s=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(a){i.postMessage({sourceName:r,targetName:s,callback:AS.DATA,callbackId:e.callbackId,data:a})},function(a){i.postMessage({sourceName:r,targetName:s,callback:AS.ERROR,callbackId:e.callbackId,reason:ls(a)})});return}if(e.streamId){D(this,zA,$9).call(this,e);return}t(e.data)},zA=new WeakSet,$9=function(e){const t=e.streamId,r=this.sourceName,s=e.sourceName,i=this.comObj,a=this,o=this.actionHandler[e.action],l={enqueue(u,h=1,f){if(this.isCancelled)return;const p=this.desiredSize;this.desiredSize-=h,p>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:r,targetName:s,stream:bn.ENQUEUE,streamId:t,chunk:u},f)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:r,targetName:s,stream:bn.CLOSE,streamId:t}),delete a.streamSinks[t])},error(u){Je(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:r,targetName:s,stream:bn.ERROR,streamId:t,reason:ls(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(o,e.data,l).then(function(){i.postMessage({sourceName:r,targetName:s,stream:bn.START_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:r,targetName:s,stream:bn.START_COMPLETE,streamId:t,reason:ls(u)})})},HA=new WeakSet,U9=function(e){const t=e.streamId,r=this.sourceName,s=e.sourceName,i=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case bn.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ls(e.reason));break;case bn.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ls(e.reason));break;case bn.PULL:if(!o){i.postMessage({sourceName:r,targetName:s,stream:bn.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||q4).then(function(){i.postMessage({sourceName:r,targetName:s,stream:bn.PULL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:r,targetName:s,stream:bn.PULL_COMPLETE,streamId:t,reason:ls(u)})});break;case bn.ENQUEUE:if(Je(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case bn.CLOSE:if(Je(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),D(this,_m,gE).call(this,a,t);break;case bn.ERROR:Je(a,"error should have stream controller"),a.controller.error(ls(e.reason)),D(this,_m,gE).call(this,a,t);break;case bn.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ls(e.reason)),D(this,_m,gE).call(this,a,t);break;case bn.CANCEL:if(!o)break;const l=ls(e.reason);Promise.try(o.onCancel||q4,l).then(function(){i.postMessage({sourceName:r,targetName:s,stream:bn.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){i.postMessage({sourceName:r,targetName:s,stream:bn.CANCEL_COMPLETE,streamId:t,reason:ls(u)})}),o.sinkCapability.reject(l),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},_m=new WeakSet,gE=async function(e,t){var r,s,i;await Promise.allSettled([(r=e.startCall)==null?void 0:r.promise,(s=e.pullCall)==null?void 0:s.promise,(i=e.cancelCall)==null?void 0:i.promise]),delete this.streamControllers[t]};var Qw;class V9{constructor({enableHWA:e=!1}){x(this,Qw,!1);A(this,Qw,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const r=this._createCanvas(e,t);return{canvas:r,context:r.getContext("2d",{willReadFrequently:!c(this,Qw)})}}reset(e,t,r){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||r<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=r}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Tt("Abstract method `_createCanvas` called.")}}Qw=new WeakMap;class EEe extends V9{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const r=this._document.createElement("canvas");return r.width=e,r.height=t,r}}class B9{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(r=>({cMapData:r,isCompressed:this.isCompressed})).catch(r=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Tt("Abstract method `_fetch` called.")}}class Y4 extends B9{async _fetch(e){const t=await xx(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):_x(t)}}class z9{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,r,s,i){return"none"}destroy(e=!1){}}var Qh,xm,nl,rl,Pr,Jh,Zh,zn,Cr,ed,Rv,Vc,op,Sm,yE,Bc,lp,WA,H9,Jw,dD,zc,cp,td,Mv,nd,Ov,Zw,fD,rd,Lv;class AEe extends z9{constructor({docId:t,ownerDocument:r=globalThis.document}){super();x(this,zn);x(this,ed);x(this,Vc);x(this,Sm);x(this,Bc);x(this,WA);x(this,Jw);x(this,zc);x(this,td);x(this,nd);x(this,Zw);x(this,rd);x(this,Qh,void 0);x(this,xm,void 0);x(this,nl,void 0);x(this,rl,void 0);x(this,Pr,void 0);x(this,Jh,void 0);x(this,Zh,0);A(this,rl,t),A(this,Pr,r)}addFilter(t){if(!t)return"none";let r=c(this,zn,Cr).get(t);if(r)return r;const[s,i,a]=D(this,Sm,yE).call(this,t),o=t.length===1?s:`${s}${i}${a}`;if(r=c(this,zn,Cr).get(o),r)return c(this,zn,Cr).set(t,r),r;const l=`g_${c(this,rl)}_transfer_map_${Cn(this,Zh)._++}`,u=D(this,Bc,lp).call(this,l);c(this,zn,Cr).set(t,u),c(this,zn,Cr).set(o,u);const h=D(this,zc,cp).call(this,l);return D(this,nd,Ov).call(this,s,i,a,h),u}addHCMFilter(t,r){var v;const s=`${t}-${r}`,i="base";let a=c(this,ed,Rv).get(i);if((a==null?void 0:a.key)===s||(a?((v=a.filter)==null||v.remove(),a.key=s,a.url="none",a.filter=null):(a={key:s,url:"none",filter:null},c(this,ed,Rv).set(i,a)),!t||!r))return a.url;const o=D(this,rd,Lv).call(this,t);t=ye.makeHexColor(...o);const l=D(this,rd,Lv).call(this,r);if(r=ye.makeHexColor(...l),c(this,Vc,op).style.color="",t==="#000000"&&r==="#ffffff"||t===r)return a.url;const u=new Array(256);for(let y=0;y<=255;y++){const _=y/255;u[y]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const h=u.join(","),f=`g_${c(this,rl)}_hcm_filter`,p=a.filter=D(this,zc,cp).call(this,f);D(this,nd,Ov).call(this,h,h,h,p),D(this,Jw,dD).call(this,p);const g=(y,_)=>{const w=o[y]/255,b=l[y]/255,S=new Array(_+1);for(let T=0;T<=_;T++)S[T]=w+T/_*(b-w);return S.join(",")};return D(this,nd,Ov).call(this,g(0,5),g(1,5),g(2,5),p),a.url=D(this,Bc,lp).call(this,f),a.url}addAlphaFilter(t){let r=c(this,zn,Cr).get(t);if(r)return r;const[s]=D(this,Sm,yE).call(this,[t]),i=`alpha_${s}`;if(r=c(this,zn,Cr).get(i),r)return c(this,zn,Cr).set(t,r),r;const a=`g_${c(this,rl)}_alpha_map_${Cn(this,Zh)._++}`,o=D(this,Bc,lp).call(this,a);c(this,zn,Cr).set(t,o),c(this,zn,Cr).set(i,o);const l=D(this,zc,cp).call(this,a);return D(this,Zw,fD).call(this,s,l),o}addLuminosityFilter(t){let r=c(this,zn,Cr).get(t||"luminosity");if(r)return r;let s,i;if(t?([s]=D(this,Sm,yE).call(this,[t]),i=`luminosity_${s}`):i="luminosity",r=c(this,zn,Cr).get(i),r)return c(this,zn,Cr).set(t,r),r;const a=`g_${c(this,rl)}_luminosity_map_${Cn(this,Zh)._++}`,o=D(this,Bc,lp).call(this,a);c(this,zn,Cr).set(t,o),c(this,zn,Cr).set(i,o);const l=D(this,zc,cp).call(this,a);return D(this,WA,H9).call(this,l),t&&D(this,Zw,fD).call(this,s,l),o}addHighlightHCMFilter(t,r,s,i,a){var b;const o=`${r}-${s}-${i}-${a}`;let l=c(this,ed,Rv).get(t);if((l==null?void 0:l.key)===o||(l?((b=l.filter)==null||b.remove(),l.key=o,l.url="none",l.filter=null):(l={key:o,url:"none",filter:null},c(this,ed,Rv).set(t,l)),!r||!s))return l.url;const[u,h]=[r,s].map(D(this,rd,Lv).bind(this));let f=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[g,v]=[i,a].map(D(this,rd,Lv).bind(this));p<f&&([f,p,g,v]=[p,f,v,g]),c(this,Vc,op).style.color="";const y=(S,T,P)=>{const R=new Array(256),k=(p-f)/P,C=S/255,I=(T-S)/(255*P);let M=0;for(let L=0;L<=P;L++){const F=Math.round(f+L*k),O=C+L*I;for(let Y=M;Y<=F;Y++)R[Y]=O;M=F+1}for(let L=M;L<256;L++)R[L]=R[M-1];return R.join(",")},_=`g_${c(this,rl)}_hcm_${t}_filter`,w=l.filter=D(this,zc,cp).call(this,_);return D(this,Jw,dD).call(this,w),D(this,nd,Ov).call(this,y(g[0],v[0],5),y(g[1],v[1],5),y(g[2],v[2],5),w),l.url=D(this,Bc,lp).call(this,_),l.url}destroy(t=!1){var r,s,i,a;t&&((r=c(this,Jh))!=null&&r.size)||((s=c(this,nl))==null||s.parentNode.parentNode.remove(),A(this,nl,null),(i=c(this,xm))==null||i.clear(),A(this,xm,null),(a=c(this,Jh))==null||a.clear(),A(this,Jh,null),A(this,Zh,0))}}Qh=new WeakMap,xm=new WeakMap,nl=new WeakMap,rl=new WeakMap,Pr=new WeakMap,Jh=new WeakMap,Zh=new WeakMap,zn=new WeakSet,Cr=function(){return c(this,xm)||A(this,xm,new Map)},ed=new WeakSet,Rv=function(){return c(this,Jh)||A(this,Jh,new Map)},Vc=new WeakSet,op=function(){if(!c(this,nl)){const t=c(this,Pr).createElement("div"),{style:r}=t;r.visibility="hidden",r.contain="strict",r.width=r.height=0,r.position="absolute",r.top=r.left=0,r.zIndex=-1;const s=c(this,Pr).createElementNS(Lo,"svg");s.setAttribute("width",0),s.setAttribute("height",0),A(this,nl,c(this,Pr).createElementNS(Lo,"defs")),t.append(s),s.append(c(this,nl)),c(this,Pr).body.append(t)}return c(this,nl)},Sm=new WeakSet,yE=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let p=0;p<256;p++)h[p]=u[p]/255;const f=h.join(",");return[f,f,f]}const[r,s,i]=t,a=new Array(256),o=new Array(256),l=new Array(256);for(let u=0;u<256;u++)a[u]=r[u]/255,o[u]=s[u]/255,l[u]=i[u]/255;return[a.join(","),o.join(","),l.join(",")]},Bc=new WeakSet,lp=function(t){if(c(this,Qh)===void 0){A(this,Qh,"");const r=c(this,Pr).URL;r!==c(this,Pr).baseURI&&(_k(r)?Oe('#createUrl: ignore "data:"-URL for performance reasons.'):A(this,Qh,e9(r,"")))}return`url(${c(this,Qh)}#${t})`},WA=new WeakSet,H9=function(t){const r=c(this,Pr).createElementNS(Lo,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(r)},Jw=new WeakSet,dD=function(t){const r=c(this,Pr).createElementNS(Lo,"feColorMatrix");r.setAttribute("type","matrix"),r.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(r)},zc=new WeakSet,cp=function(t){const r=c(this,Pr).createElementNS(Lo,"filter");return r.setAttribute("color-interpolation-filters","sRGB"),r.setAttribute("id",t),c(this,Vc,op).append(r),r},td=new WeakSet,Mv=function(t,r,s){const i=c(this,Pr).createElementNS(Lo,r);i.setAttribute("type","discrete"),i.setAttribute("tableValues",s),t.append(i)},nd=new WeakSet,Ov=function(t,r,s,i){const a=c(this,Pr).createElementNS(Lo,"feComponentTransfer");i.append(a),D(this,td,Mv).call(this,a,"feFuncR",t),D(this,td,Mv).call(this,a,"feFuncG",r),D(this,td,Mv).call(this,a,"feFuncB",s)},Zw=new WeakSet,fD=function(t,r){const s=c(this,Pr).createElementNS(Lo,"feComponentTransfer");r.append(s),D(this,td,Mv).call(this,s,"feFuncA",t)},rd=new WeakSet,Lv=function(t){return c(this,Vc,op).style.color=t,Ex(getComputedStyle(c(this,Vc,op)).getPropertyValue("color"))};class W9{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Tt("Abstract method `_fetch` called.")}}class K4 extends W9{async _fetch(e){const t=await xx(e,"arraybuffer");return new Uint8Array(t)}}class G9{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(r=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Tt("Abstract method `_fetch` called.")}}class X4 extends G9{async _fetch(e){const t=await xx(e,"arraybuffer");return new Uint8Array(t)}}Qr&&Oe("Please use the `legacy` build in Node.js environments.");async function AO(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class TEe extends z9{}class CEe extends V9{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class kEe extends B9{async _fetch(e){return AO(e)}}class NEe extends W9{async _fetch(e){return AO(e)}}class PEe extends G9{async _fetch(e){return AO(e)}}const Zf="__forcedDependency",{floor:Q4,ceil:J4}=Math;function TS(n,e,t,r,s,i){n[e*4+0]=Math.min(n[e*4+0],t),n[e*4+1]=Math.min(n[e*4+1],r),n[e*4+2]=Math.max(n[e*4+2],s),n[e*4+3]=Math.max(n[e*4+3],i)}const pD=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];var Em,Hc;class IEe{constructor(e,t){x(this,Em,void 0);x(this,Hc,void 0);A(this,Em,e),A(this,Hc,t)}get length(){return c(this,Em).length}isEmpty(e){return c(this,Em)[e]===pD}minX(e){return c(this,Hc)[e*4+0]/256}minY(e){return c(this,Hc)[e*4+1]/256}maxX(e){return(c(this,Hc)[e*4+2]+1)/256}maxY(e){return(c(this,Hc)[e*4+3]+1)/256}}Em=new WeakMap,Hc=new WeakMap;const CS=(n,e)=>{if(!n)return;let t=n.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},n.set(e,t)),t};var ds,fs,sd,sa,id,sl,ht,vt,il,ps,eb,Am,ad,od,al,Ir,Ka,tb,mD;class DEe{constructor(e,t,r=!1){x(this,tb);x(this,ds,{__proto__:null});x(this,fs,{__proto__:null,transform:[],moveText:[],sameLineText:[],[Zf]:[]});x(this,sd,new Map);x(this,sa,[]);x(this,id,[]);x(this,sl,[[1,0,0,1,0,0]]);x(this,ht,[-1/0,-1/0,1/0,1/0]);x(this,vt,new Float64Array([1/0,1/0,-1/0,-1/0]));x(this,il,-1);x(this,ps,new Set);x(this,eb,new Map);x(this,Am,new Map);x(this,ad,void 0);x(this,od,void 0);x(this,al,void 0);x(this,Ir,void 0);x(this,Ka,void 0);A(this,ad,e.width),A(this,od,e.height),D(this,tb,mD).call(this,t),r&&A(this,Ka,new Map)}growOperationsCount(e){e>=c(this,Ir).length&&D(this,tb,mD).call(this,e,c(this,Ir))}save(e){return A(this,ds,{__proto__:c(this,ds)}),A(this,fs,{__proto__:c(this,fs),transform:{__proto__:c(this,fs).transform},moveText:{__proto__:c(this,fs).moveText},sameLineText:{__proto__:c(this,fs).sameLineText},[Zf]:{__proto__:c(this,fs)[Zf]}}),A(this,ht,{__proto__:c(this,ht)}),c(this,sa).push(e),this}restore(e){var s;const t=Object.getPrototypeOf(c(this,ds));if(t===null)return this;A(this,ds,t),A(this,fs,Object.getPrototypeOf(c(this,fs))),A(this,ht,Object.getPrototypeOf(c(this,ht)));const r=c(this,sa).pop();return r!==void 0&&((s=CS(c(this,Ka),e))==null||s.dependencies.add(r),c(this,Ir)[e]=c(this,Ir)[r]),this}recordOpenMarker(e){return c(this,sa).push(e),this}getOpenMarker(){return c(this,sa).length===0?null:c(this,sa).at(-1)}recordCloseMarker(e){var r;const t=c(this,sa).pop();return t!==void 0&&((r=CS(c(this,Ka),e))==null||r.dependencies.add(t),c(this,Ir)[e]=c(this,Ir)[t]),this}beginMarkedContent(e){return c(this,id).push(e),this}endMarkedContent(e){var r;const t=c(this,id).pop();return t!==void 0&&((r=CS(c(this,Ka),e))==null||r.dependencies.add(t),c(this,Ir)[e]=c(this,Ir)[t]),this}pushBaseTransform(e){return c(this,sl).push(ye.multiplyByDOMMatrix(c(this,sl).at(-1),e.getTransform())),this}popBaseTransform(){return c(this,sl).length>1&&c(this,sl).pop(),this}recordSimpleData(e,t){return c(this,ds)[e]=t,this}recordIncrementalData(e,t){return c(this,fs)[e].push(t),this}resetIncrementalData(e,t){return c(this,fs)[e].length=0,this}recordNamedData(e,t){return c(this,sd).set(e,t),this}recordSimpleDataFromNamed(e,t,r){c(this,ds)[e]=c(this,sd).get(t)??r}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Zf,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in c(this,ds)&&this.recordFutureForcedDependency(t,c(this,ds)[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of c(this,ps))this.recordFutureForcedDependency(Zf,e);return this}resetBBox(e){return c(this,il)!==e&&(A(this,il,e),c(this,vt)[0]=1/0,c(this,vt)[1]=1/0,c(this,vt)[2]=-1/0,c(this,vt)[3]=-1/0),this}recordClipBox(e,t,r,s,i,a){const o=ye.multiplyByDOMMatrix(c(this,sl).at(-1),t.getTransform()),l=[1/0,1/0,-1/0,-1/0];ye.axialAlignedBoundingBox([r,i,s,a],o,l);const u=ye.intersect(c(this,ht),l);return u?(c(this,ht)[0]=u[0],c(this,ht)[1]=u[1],c(this,ht)[2]=u[2],c(this,ht)[3]=u[3]):(c(this,ht)[0]=c(this,ht)[1]=1/0,c(this,ht)[2]=c(this,ht)[3]=-1/0),this}recordBBox(e,t,r,s,i,a){const o=c(this,ht);if(o[0]===1/0)return this;const l=ye.multiplyByDOMMatrix(c(this,sl).at(-1),t.getTransform());if(o[0]===-1/0)return ye.axialAlignedBoundingBox([r,i,s,a],l,c(this,vt)),this;const u=[1/0,1/0,-1/0,-1/0];return ye.axialAlignedBoundingBox([r,i,s,a],l,u),c(this,vt)[0]=Math.min(c(this,vt)[0],Math.max(u[0],o[0])),c(this,vt)[1]=Math.min(c(this,vt)[1],Math.max(u[1],o[1])),c(this,vt)[2]=Math.max(c(this,vt)[2],Math.min(u[2],o[2])),c(this,vt)[3]=Math.max(c(this,vt)[3],Math.min(u[3],o[3])),this}recordCharacterBBox(e,t,r,s=1,i=0,a=0,o){const l=r.bbox;let u,h;if(l&&(u=l[2]!==l[0]&&l[3]!==l[1]&&c(this,Am).get(r),u!==!1&&(h=[0,0,0,0],ye.axialAlignedBoundingBox(l,r.fontMatrix,h),(s!==1||i!==0||a!==0)&&ye.scaleMinMax([s,0,0,-s,i,a],h),u)))return this.recordBBox(e,t,h[0],h[2],h[1],h[3]);if(!o)return this.recordFullPageBBox(e);const f=o();return l&&h&&u===void 0&&(u=h[0]<=i-f.actualBoundingBoxLeft&&h[2]>=i+f.actualBoundingBoxRight&&h[1]<=a-f.actualBoundingBoxAscent&&h[3]>=a+f.actualBoundingBoxDescent,c(this,Am).set(r,u),u)?this.recordBBox(e,t,h[0],h[2],h[1],h[3]):this.recordBBox(e,t,i-f.actualBoundingBoxLeft,i+f.actualBoundingBoxRight,a-f.actualBoundingBoxAscent,a+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return c(this,vt)[0]=Math.max(0,c(this,ht)[0]),c(this,vt)[1]=Math.max(0,c(this,ht)[1]),c(this,vt)[2]=Math.min(c(this,ad),c(this,ht)[2]),c(this,vt)[3]=Math.min(c(this,od),c(this,ht)[3]),this}getSimpleIndex(e){return c(this,ds)[e]}recordDependencies(e,t){const r=c(this,ps),s=c(this,ds),i=c(this,fs);for(const a of t)a in c(this,ds)?r.add(s[a]):a in i&&i[a].forEach(r.add,r);return this}recordNamedDependency(e,t){return c(this,sd).has(t)&&c(this,ps).add(c(this,sd).get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Zf]),c(this,Ka)){const r=CS(c(this,Ka),e),{dependencies:s}=r;c(this,ps).forEach(s.add,s),c(this,sa).forEach(s.add,s),c(this,id).forEach(s.add,s),s.delete(e),r.isRenderingOperation=!0}if(c(this,il)===e){const r=Q4(c(this,vt)[0]*256/c(this,ad)),s=Q4(c(this,vt)[1]*256/c(this,od)),i=J4(c(this,vt)[2]*256/c(this,ad)),a=J4(c(this,vt)[3]*256/c(this,od));TS(c(this,al),e,r,s,i,a);for(const o of c(this,ps))o!==e&&TS(c(this,al),o,r,s,i,a);for(const o of c(this,sa))o!==e&&TS(c(this,al),o,r,s,i,a);for(const o of c(this,id))o!==e&&TS(c(this,al),o,r,s,i,a);t||(c(this,ps).clear(),A(this,il,-1))}return this}recordShowTextOperation(e,t=!1){const r=Array.from(c(this,ps));this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of r)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return c(this,il)===e&&(A(this,il,-1),c(this,ht)[0]=Math.max(c(this,ht)[0],c(this,vt)[0]),c(this,ht)[1]=Math.max(c(this,ht)[1],c(this,vt)[1]),c(this,ht)[2]=Math.min(c(this,ht)[2],c(this,vt)[2]),c(this,ht)[3]=Math.min(c(this,ht)[3],c(this,vt)[3]),t||c(this,ps).clear()),this}_takePendingDependencies(){const e=c(this,ps);return A(this,ps,new Set),e}_extractOperation(e){const t=c(this,eb).get(e);return c(this,eb).delete(e),t}_pushPendingDependencies(e){for(const t of e)c(this,ps).add(t)}take(){return c(this,Am).clear(),new IEe(c(this,Ir),c(this,al))}takeDebugMetadata(){return c(this,Ka)}}ds=new WeakMap,fs=new WeakMap,sd=new WeakMap,sa=new WeakMap,id=new WeakMap,sl=new WeakMap,ht=new WeakMap,vt=new WeakMap,il=new WeakMap,ps=new WeakMap,eb=new WeakMap,Am=new WeakMap,ad=new WeakMap,od=new WeakMap,al=new WeakMap,Ir=new WeakMap,Ka=new WeakMap,tb=new WeakSet,mD=function(e,t){const r=new ArrayBuffer(e*4);A(this,al,new Uint8ClampedArray(r)),A(this,Ir,new Uint32Array(r)),t&&t.length>0?(c(this,Ir).set(t),c(this,Ir).fill(pD,t.length)):c(this,Ir).fill(pD)};var Et,sn,ia,Tm,Cm;const MO=class MO{constructor(e,t,r){x(this,Et,void 0);x(this,sn,void 0);x(this,ia,void 0);x(this,Tm,0);x(this,Cm,0);if(e instanceof MO&&c(e,ia)===!!r)return e;A(this,Et,e),A(this,sn,t),A(this,ia,!!r)}growOperationsCount(){throw new Error("Unreachable")}save(e){return Cn(this,Cm)._++,c(this,Et).save(c(this,sn)),this}restore(e){return c(this,Cm)>0&&(c(this,Et).restore(c(this,sn)),Cn(this,Cm)._--),this}recordOpenMarker(e){return Cn(this,Tm)._++,this}getOpenMarker(){return c(this,Tm)>0?c(this,sn):c(this,Et).getOpenMarker()}recordCloseMarker(e){return Cn(this,Tm)._--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return c(this,Et).pushBaseTransform(e),this}popBaseTransform(){return c(this,Et).popBaseTransform(),this}recordSimpleData(e,t){return c(this,Et).recordSimpleData(e,c(this,sn)),this}recordIncrementalData(e,t){return c(this,Et).recordIncrementalData(e,c(this,sn)),this}resetIncrementalData(e,t){return c(this,Et).resetIncrementalData(e,c(this,sn)),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,r){return c(this,Et).recordSimpleDataFromNamed(e,t,c(this,sn)),this}recordFutureForcedDependency(e,t){return c(this,Et).recordFutureForcedDependency(e,c(this,sn)),this}inheritSimpleDataAsFutureForcedDependencies(e){return c(this,Et).inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return c(this,Et).inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return c(this,ia)||c(this,Et).resetBBox(c(this,sn)),this}recordClipBox(e,t,r,s,i,a){return c(this,ia)||c(this,Et).recordClipBox(c(this,sn),t,r,s,i,a),this}recordBBox(e,t,r,s,i,a){return c(this,ia)||c(this,Et).recordBBox(c(this,sn),t,r,s,i,a),this}recordCharacterBBox(e,t,r,s,i,a,o){return c(this,ia)||c(this,Et).recordCharacterBBox(c(this,sn),t,r,s,i,a,o),this}recordFullPageBBox(e){return c(this,ia)||c(this,Et).recordFullPageBBox(c(this,sn)),this}getSimpleIndex(e){return c(this,Et).getSimpleIndex(e)}recordDependencies(e,t){return c(this,Et).recordDependencies(c(this,sn),t),this}recordNamedDependency(e,t){return c(this,Et).recordNamedDependency(c(this,sn),t),this}recordOperation(e){return c(this,Et).recordOperation(c(this,sn),!0),this}recordShowTextOperation(e){return c(this,Et).recordShowTextOperation(c(this,sn),!0),this}bboxToClipBoxDropOperation(e){return c(this,ia)||c(this,Et).bboxToClipBoxDropOperation(c(this,sn),!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}};Et=new WeakMap,sn=new WeakMap,ia=new WeakMap,Tm=new WeakMap,Cm=new WeakMap;let Z1=MO;const yi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},hr={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function gD(n,e){if(!e)return;const t=e[2]-e[0],r=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,r),n.clip(s)}class TO{isModifyingCurrentTransform(){return!1}getPattern(){Tt("Abstract method `getPattern` called.")}}class REe extends TO{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const r of this._colorStops)t.addColorStop(r[0],r[1]);return t}getPattern(e,t,r,s){let i;if(s===hr.STROKE||s===hr.FILL){const a=t.current.getClippedPathBoundingBox(s,Kt(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,l=Math.ceil(a[3]-a[1])||1,u=t.cachedCanvases.getCanvas("pattern",o,l),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-a[0],-a[1]),r=ye.transform(r,[1,0,0,1,a[0],a[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),gD(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),i=e.createPattern(u.canvas,"no-repeat");const f=new DOMMatrix(r);i.setTransform(f)}else gD(e,this._bbox),i=this._createGradient(e);return i}}function zN(n,e,t,r,s,i,a,o){const l=e.coords,u=e.colors,h=n.data,f=n.width*4;let p;l[t+1]>l[r+1]&&(p=t,t=r,r=p,p=i,i=a,a=p),l[r+1]>l[s+1]&&(p=r,r=s,s=p,p=a,a=o,o=p),l[t+1]>l[r+1]&&(p=t,t=r,r=p,p=i,i=a,a=p);const g=(l[t]+e.offsetX)*e.scaleX,v=(l[t+1]+e.offsetY)*e.scaleY,y=(l[r]+e.offsetX)*e.scaleX,_=(l[r+1]+e.offsetY)*e.scaleY,w=(l[s]+e.offsetX)*e.scaleX,b=(l[s+1]+e.offsetY)*e.scaleY;if(v>=b)return;const S=u[i],T=u[i+1],P=u[i+2],R=u[a],k=u[a+1],C=u[a+2],I=u[o],M=u[o+1],L=u[o+2],F=Math.round(v),O=Math.round(b);let Y,Z,X,J,K,te,ae,q;for(let $=F;$<=O;$++){if($<_){const re=$<v?0:(v-$)/(v-_);Y=g-(g-y)*re,Z=S-(S-R)*re,X=T-(T-k)*re,J=P-(P-C)*re}else{let re;$>b?re=1:_===b?re=0:re=(_-$)/(_-b),Y=y-(y-w)*re,Z=R-(R-I)*re,X=k-(k-M)*re,J=C-(C-L)*re}let U;$<v?U=0:$>b?U=1:U=(v-$)/(v-b),K=g-(g-w)*U,te=S-(S-I)*U,ae=T-(T-M)*U,q=P-(P-L)*U;const G=Math.round(Math.min(Y,K)),V=Math.round(Math.max(Y,K));let ee=f*$+G*4;for(let re=G;re<=V;re++)U=(Y-re)/(Y-K),U<0?U=0:U>1&&(U=1),h[ee++]=Z-(Z-te)*U|0,h[ee++]=X-(X-ae)*U|0,h[ee++]=J-(J-q)*U|0,h[ee++]=255}}function MEe(n,e,t){const r=e.coords,s=e.colors;let i,a;switch(e.type){case"lattice":const o=e.verticesPerRow,l=Math.floor(r.length/o)-1,u=o-1;for(i=0;i<l;i++){let h=i*o;for(let f=0;f<u;f++,h++)zN(n,t,r[h],r[h+1],r[h+o],s[h],s[h+1],s[h+o]),zN(n,t,r[h+o+1],r[h+1],r[h+o],s[h+o+1],s[h+1],s[h+o])}break;case"triangles":for(i=0,a=r.length;i<a;i+=3)zN(n,t,r[i],r[i+1],r[i+2],s[i],s[i+1],s[i+2]);break;default:throw new Error("illegal figure")}}class OEe extends TO{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,r){const o=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-o,h=Math.ceil(this._bounds[3])-l,f=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),p=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),g=u/f,v=h/p,y={coords:this._coords,colors:this._colors,offsetX:-o,offsetY:-l,scaleX:1/g,scaleY:1/v},_=f+2*2,w=p+2*2,b=r.getCanvas("mesh",_,w),S=b.context,T=S.createImageData(f,p);if(t){const R=T.data;for(let k=0,C=R.length;k<C;k+=4)R[k]=t[0],R[k+1]=t[1],R[k+2]=t[2],R[k+3]=255}for(const R of this._figures)MEe(T,R,y);return S.putImageData(T,2,2),{canvas:b.canvas,offsetX:o-2*g,offsetY:l-2*v,scaleX:g,scaleY:v}}isModifyingCurrentTransform(){return!0}getPattern(e,t,r,s){gD(e,this._bbox);const i=new Float32Array(2);if(s===hr.SHADING)ye.singularValueDecompose2dScale(Kt(e),i);else if(this.matrix){ye.singularValueDecompose2dScale(this.matrix,i);const[o,l]=i;ye.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=o,i[1]*=l}else ye.singularValueDecompose2dScale(t.baseTransform,i);const a=this._createMeshCanvas(i,s===hr.SHADING?null:this._background,t.cachedCanvases);return s!==hr.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class LEe extends TO{getPattern(){return"hotpink"}}function jEe(n){switch(n[0]){case"RadialAxial":return new REe(n);case"Mesh":return new OEe(n);case"Dummy":return new LEe}throw new Error(`Unknown IR type: ${n[0]}`)}const Z4={COLORED:1,UNCOLORED:2},GA=class GA{constructor(e,t,r,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=r,this.baseTransform=s}createPatternCanvas(e,t){var te,ae;const{bbox:r,operatorList:s,paintType:i,tilingType:a,color:o,canvasGraphicsFactory:l}=this;let{xstep:u,ystep:h}=this;u=Math.abs(u),h=Math.abs(h),bk("TilingType: "+a);const f=r[0],p=r[1],g=r[2],v=r[3],y=g-f,_=v-p,w=new Float32Array(2);ye.singularValueDecompose2dScale(this.matrix,w);const[b,S]=w;ye.singularValueDecompose2dScale(this.baseTransform,w);const T=b*w[0],P=S*w[1];let R=y,k=_,C=!1,I=!1;const M=Math.ceil(u*T),L=Math.ceil(h*P),F=Math.ceil(y*T),O=Math.ceil(_*P);M>=F?R=u:C=!0,L>=O?k=h:I=!0;const Y=this.getSizeAndScale(R,this.ctx.canvas.width,T),Z=this.getSizeAndScale(k,this.ctx.canvas.height,P),X=e.cachedCanvases.getCanvas("pattern",Y.size,Z.size),J=X.context,K=l.createCanvasGraphics(J,t);if(K.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(K,i,o),J.translate(-Y.scale*f,-Z.scale*p),K.transform(0,Y.scale,0,0,Z.scale,0,0),J.save(),(te=K.dependencyTracker)==null||te.save(),this.clipBbox(K,f,p,g,v),K.baseTransform=Kt(K.ctx),K.executeOperatorList(s),K.endDrawing(),(ae=K.dependencyTracker)==null||ae.restore(),J.restore(),C||I){const q=X.canvas;C&&(R=u),I&&(k=h);const $=this.getSizeAndScale(R,this.ctx.canvas.width,T),U=this.getSizeAndScale(k,this.ctx.canvas.height,P),G=$.size,V=U.size,ee=e.cachedCanvases.getCanvas("pattern-workaround",G,V),re=ee.context,ce=C?Math.floor(y/u):0,Ae=I?Math.floor(_/h):0;for(let _e=0;_e<=ce;_e++)for(let xe=0;xe<=Ae;xe++)re.drawImage(q,G*_e,V*xe,G,V,0,0,G,V);return{canvas:ee.canvas,scaleX:$.scale,scaleY:U.scale,offsetX:f,offsetY:p}}return{canvas:X.canvas,scaleX:Y.scale,scaleY:Z.scale,offsetX:f,offsetY:p}}getSizeAndScale(e,t,r){const s=Math.max(GA.MAX_PATTERN_SIZE,t);let i=Math.ceil(e*r);return i>=s?i=s:r=i/e,{scale:r,size:i}}clipBbox(e,t,r,s,i){const a=s-t,o=i-r;e.ctx.rect(t,r,a,o),ye.axialAlignedBoundingBox([t,r,s,i],Kt(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,r){const s=e.ctx,i=e.current;switch(t){case Z4.COLORED:const{fillStyle:a,strokeStyle:o}=this.ctx;s.fillStyle=i.fillColor=a,s.strokeStyle=i.strokeColor=o;break;case Z4.UNCOLORED:s.fillStyle=s.strokeStyle=r,i.fillColor=i.strokeColor=r;break;default:throw new XSe(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,r,s,i){let a=r;s!==hr.SHADING&&(a=ye.transform(a,t.baseTransform),this.matrix&&(a=ye.transform(a,this.matrix)));const o=this.createPatternCanvas(t,i);let l=new DOMMatrix(a);l=l.translate(o.offsetX,o.offsetY),l=l.scale(1/o.scaleX,1/o.scaleY);const u=e.createPattern(o.canvas,"repeat");return u.setTransform(l),u}};ie(GA,"MAX_PATTERN_SIZE",3e3);let yD=GA;function FEe({src:n,srcPos:e=0,dest:t,width:r,height:s,nonBlackColor:i=4294967295,inverseDecode:a=!1}){const o=mr.isLittleEndian?4278190080:255,[l,u]=a?[i,o]:[o,i],h=r>>3,f=r&7,p=n.length;t=new Uint32Array(t.buffer);let g=0;for(let v=0;v<s;v++){for(const _=e+h;e<_;e++){const w=e<p?n[e]:255;t[g++]=w&128?u:l,t[g++]=w&64?u:l,t[g++]=w&32?u:l,t[g++]=w&16?u:l,t[g++]=w&8?u:l,t[g++]=w&4?u:l,t[g++]=w&2?u:l,t[g++]=w&1?u:l}if(f===0)continue;const y=e<p?n[e++]:255;for(let _=0;_<f;_++)t[g++]=y&1<<7-_?u:l}return{srcPos:e,destPos:g}}const eU=16,tU=100,$Ee=15,nU=10,vs=16,HN=new DOMMatrix,ri=new Float32Array(2),Cp=new Float32Array([1/0,1/0,-1/0,-1/0]);function UEe(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(t,r){e.translate(t,r),this.__originalTranslate(t,r)},n.scale=function(t,r){e.scale(t,r),this.__originalScale(t,r)},n.transform=function(t,r,s,i,a,o){e.transform(t,r,s,i,a,o),this.__originalTransform(t,r,s,i,a,o)},n.setTransform=function(t,r,s,i,a,o){e.setTransform(t,r,s,i,a,o),this.__originalSetTransform(t,r,s,i,a,o)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(t){e.rotate(t),this.__originalRotate(t)},n.clip=function(t){e.clip(t),this.__originalClip(t)},n.moveTo=function(t,r){e.moveTo(t,r),this.__originalMoveTo(t,r)},n.lineTo=function(t,r){e.lineTo(t,r),this.__originalLineTo(t,r)},n.bezierCurveTo=function(t,r,s,i,a,o){e.bezierCurveTo(t,r,s,i,a,o),this.__originalBezierCurveTo(t,r,s,i,a,o)},n.rect=function(t,r,s,i){e.rect(t,r,s,i),this.__originalRect(t,r,s,i)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class VEe{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,r){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,r)):(s=this.canvasFactory.create(t,r),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function kS(n,e,t,r,s,i,a,o,l,u){const[h,f,p,g,v,y]=Kt(n);if(f===0&&p===0){const b=a*h+v,S=Math.round(b),T=o*g+y,P=Math.round(T),R=(a+l)*h+v,k=Math.abs(Math.round(R)-S)||1,C=(o+u)*g+y,I=Math.abs(Math.round(C)-P)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(g),S,P),n.drawImage(e,t,r,s,i,0,0,k,I),n.setTransform(h,f,p,g,v,y),[k,I]}if(h===0&&g===0){const b=o*p+v,S=Math.round(b),T=a*f+y,P=Math.round(T),R=(o+u)*p+v,k=Math.abs(Math.round(R)-S)||1,C=(a+l)*f+y,I=Math.abs(Math.round(C)-P)||1;return n.setTransform(0,Math.sign(f),Math.sign(p),0,S,P),n.drawImage(e,t,r,s,i,0,0,I,k),n.setTransform(h,f,p,g,v,y),[I,k]}n.drawImage(e,t,r,s,i,a,o,l,u);const _=Math.hypot(h,f),w=Math.hypot(p,g);return[_*l,w*u]}class rU{constructor(e,t,r){ie(this,"alphaIsShape",!1);ie(this,"fontSize",0);ie(this,"fontSizeScale",1);ie(this,"textMatrix",null);ie(this,"textMatrixScale",1);ie(this,"fontMatrix",VI);ie(this,"leading",0);ie(this,"x",0);ie(this,"y",0);ie(this,"lineX",0);ie(this,"lineY",0);ie(this,"charSpacing",0);ie(this,"wordSpacing",0);ie(this,"textHScale",1);ie(this,"textRenderingMode",nr.FILL);ie(this,"textRise",0);ie(this,"fillColor","#000000");ie(this,"strokeColor","#000000");ie(this,"patternFill",!1);ie(this,"patternStroke",!1);ie(this,"fillAlpha",1);ie(this,"strokeAlpha",1);ie(this,"lineWidth",1);ie(this,"activeSMask",null);ie(this,"transferMaps","none");r==null||r(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=Cp.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=hr.FILL,t=null){const r=this.minMax.slice();if(e===hr.STROKE){t||Tt("Stroke bounding box must include transform."),ye.singularValueDecompose2dScale(t,ri);const s=ri[0]*this.lineWidth/2,i=ri[1]*this.lineWidth/2;r[0]-=s,r[1]-=i,r[2]+=s,r[3]+=i}return r}updateClipFromPath(){const e=ye.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(Cp,0)}getClippedPathBoundingBox(e=hr.FILL,t=null){return ye.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function sU(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,r=e.width,s=t%vs,i=(t-s)/vs,a=s===0?i:i+1,o=n.createImageData(r,vs);let l=0,u;const h=e.data,f=o.data;let p,g,v,y;if(e.kind===cE.GRAYSCALE_1BPP){const _=h.byteLength,w=new Uint32Array(f.buffer,0,f.byteLength>>2),b=w.length,S=r+7>>3,T=4294967295,P=mr.isLittleEndian?4278190080:255;for(p=0;p<a;p++){for(v=p<i?vs:s,u=0,g=0;g<v;g++){const R=_-l;let k=0;const C=R>S?r:R*8-7,I=C&-8;let M=0,L=0;for(;k<I;k+=8)L=h[l++],w[u++]=L&128?T:P,w[u++]=L&64?T:P,w[u++]=L&32?T:P,w[u++]=L&16?T:P,w[u++]=L&8?T:P,w[u++]=L&4?T:P,w[u++]=L&2?T:P,w[u++]=L&1?T:P;for(;k<C;k++)M===0&&(L=h[l++],M=128),w[u++]=L&M?T:P,M>>=1}for(;u<b;)w[u++]=0;n.putImageData(o,0,p*vs)}}else if(e.kind===cE.RGBA_32BPP){for(g=0,y=r*vs*4,p=0;p<i;p++)f.set(h.subarray(l,l+y)),l+=y,n.putImageData(o,0,g),g+=vs;p<a&&(y=r*s*4,f.set(h.subarray(l,l+y)),n.putImageData(o,0,g))}else if(e.kind===cE.RGB_24BPP)for(v=vs,y=r*v,p=0;p<a;p++){for(p>=i&&(v=s,y=r*v),u=0,g=y;g--;)f[u++]=h[l++],f[u++]=h[l++],f[u++]=h[l++],f[u++]=255;n.putImageData(o,0,p*vs)}else throw new Error(`bad image kind: ${e.kind}`)}function iU(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,r=e.width,s=t%vs,i=(t-s)/vs,a=s===0?i:i+1,o=n.createImageData(r,vs);let l=0;const u=e.data,h=o.data;for(let f=0;f<a;f++){const p=f<i?vs:s;({srcPos:l}=FEe({src:u,srcPos:l,dest:h,width:r,height:p,nonBlackColor:0})),n.putImageData(o,0,f*vs)}}function hv(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const r of t)n[r]!==void 0&&(e[r]=n[r]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function NS(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}function aU(n,e){if(e)return!0;ye.singularValueDecompose2dScale(n,ri);const t=Math.fround(Co.pixelRatio*Yu.PDF_TO_CSS_UNITS);return ri[0]<=t&&ri[1]<=t}const BEe=["butt","round","square"],zEe=["miter","round","bevel"],HEe={},oU={};var nb,vD,rb,wD,sb,bD;const OO=class OO{constructor(e,t,r,s,i,{optionalContentConfig:a,markedContentStack:o=null},l,u,h){x(this,nb);x(this,rb);x(this,sb);this.ctx=e,this.current=new rU(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=r,this.canvasFactory=s,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new VEe(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=h??null}getObject(e,t,r=null){var s;return typeof t=="string"?((s=this.dependencyTracker)==null||s.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):r}beginDrawing({transform:e,viewport:t,transparency:r=!1,background:s=null}){const i=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,i,a),this.ctx.fillStyle=o,r){const l=this.cachedCanvases.getCanvas("transparent",i,a);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...Kt(this.compositeCtx))}this.ctx.save(),NS(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Kt(this.ctx)}executeOperatorList(e,t,r,s,i){var w;const a=e.argsArray,o=e.fnArray;let l=t||0;const u=a.length;if(u===l)return l;const h=u-l>nU&&typeof r=="function",f=h?Date.now()+$Ee:0;let p=0;const g=this.commonObjs,v=this.objs;let y,_;for(;;){if(s!==void 0&&l===s.nextBreakPoint)return s.breakIt(l,r),l;if(!i||i(l))if(y=o[l],_=a[l]??null,y!==iw.dependency)_===null?this[y](l):this[y](l,..._);else for(const b of _){(w=this.dependencyTracker)==null||w.recordNamedData(b,l);const S=b.startsWith("g_")?g:v;if(!S.has(b))return S.get(b,r),l}if(l++,l===u)return l;if(h&&++p>nU){if(Date.now()>f)return r(),l;p=0}}}endDrawing(){D(this,nb,vD).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),D(this,rb,wD).call(this)}_scaleImage(e,t){const r=e.width??e.displayWidth,s=e.height??e.displayHeight;let i=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=r,l=s,u="prescale1",h,f;for(;i>2&&o>1||a>2&&l>1;){let p=o,g=l;i>2&&o>1&&(p=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/p),a>2&&l>1&&(g=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,a/=l/g),h=this.cachedCanvases.getCanvas(u,p,g),f=h.context,f.clearRect(0,0,p,g),f.drawImage(e,0,0,o,l,0,0,p,g),e=h.canvas,o=p,l=g,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:o,paintHeight:l}}_createMaskCanvas(e,t){var M,L;const r=this.ctx,{width:s,height:i}=t,a=this.current.fillColor,o=this.current.patternFill,l=Kt(r);let u,h,f,p;if((t.bitmap||t.data)&&t.count>1){const F=t.bitmap||t.data.buffer;h=JSON.stringify(o?l:[l.slice(0,4),a]),u=this._cachedBitmapsMap.get(F),u||(u=new Map,this._cachedBitmapsMap.set(F,u));const O=u.get(h);if(O&&!o){const Y=Math.round(Math.min(l[0],l[2])+l[4]),Z=Math.round(Math.min(l[1],l[3])+l[5]);return(M=this.dependencyTracker)==null||M.recordDependencies(e,yi.transformAndFill),{canvas:O,offsetX:Y,offsetY:Z}}f=O}f||(p=this.cachedCanvases.getCanvas("maskCanvas",s,i),iU(p.context,t));let g=ye.transform(l,[1/s,0,0,-1/i,0,0]);g=ye.transform(g,[1,0,0,1,0,-i]);const v=Cp.slice();ye.axialAlignedBoundingBox([0,0,s,i],g,v);const[y,_,w,b]=v,S=Math.round(w-y)||1,T=Math.round(b-_)||1,P=this.cachedCanvases.getCanvas("fillCanvas",S,T),R=P.context,k=y,C=_;R.translate(-k,-C),R.transform(...g),f||(f=this._scaleImage(p.canvas,Ma(R)),f=f.img,u&&o&&u.set(h,f)),R.imageSmoothingEnabled=aU(Kt(R),t.interpolate),kS(R,f,0,0,f.width,f.height,0,0,s,i),R.globalCompositeOperation="source-in";const I=ye.transform(Ma(R),[1,0,0,1,-k,-C]);return R.fillStyle=o?a.getPattern(r,this,I,hr.FILL,e):a,R.fillRect(0,0,s,i),u&&!o&&(this.cachedCanvases.delete("fillCanvas"),u.set(h,P.canvas)),(L=this.dependencyTracker)==null||L.recordDependencies(e,yi.transformAndFill),{canvas:P.canvas,offsetX:Math.round(k),offsetY:Math.round(C)}}setLineWidth(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineCap",e),this.ctx.lineCap=BEe[t]}setLineJoin(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("lineJoin",e),this.ctx.lineJoin=zEe[t]}setMiterLimit(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,r){var i;(i=this.dependencyTracker)==null||i.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=r)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){var r,s,i,a,o;for(const[l,u]of t)switch(l){case"LW":this.setLineWidth(e,u);break;case"LC":this.setLineCap(e,u);break;case"LJ":this.setLineJoin(e,u);break;case"ML":this.setMiterLimit(e,u);break;case"D":this.setDash(e,u[0],u[1]);break;case"RI":this.setRenderingIntent(e,u);break;case"FL":this.setFlatness(e,u);break;case"Font":this.setFont(e,u[0],u[1]);break;case"CA":(r=this.dependencyTracker)==null||r.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=u;break;case"ca":(s=this.dependencyTracker)==null||s.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=u;break;case"BM":(i=this.dependencyTracker)==null||i.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=u;break;case"SMask":(a=this.dependencyTracker)==null||a.recordSimpleData("SMask",e),this.current.activeSMask=u?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":(o=this.dependencyTracker)==null||o.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(u);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,r=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,i=this.cachedCanvases.getCanvas(s,t,r);this.suspendedCtx=this.ctx;const a=this.ctx=i.context;a.setTransform(this.suspendedCtx.getTransform()),hv(this.suspendedCtx,a),UEe(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),hv(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,r=this.suspendedCtx;this.composeSMask(r,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,r,s){const i=s[0],a=s[1],o=s[2]-i,l=s[3]-a;o===0||l===0||(this.genericComposeSMask(t.context,r,o,l,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(r.canvas,0,0),e.restore())}genericComposeSMask(e,t,r,s,i,a,o,l,u,h,f){let p=e.canvas,g=l-h,v=u-f;if(a)if(g<0||v<0||g+r>p.width||v+s>p.height){const _=this.cachedCanvases.getCanvas("maskExtension",r,s),w=_.context;w.drawImage(p,-g,-v),w.globalCompositeOperation="destination-atop",w.fillStyle=a,w.fillRect(0,0,r,s),w.globalCompositeOperation="source-over",p=_.canvas,g=v=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const _=new Path2D;_.rect(g,v,r,s),e.clip(_),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(g,v,r,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i==="Alpha"&&o?t.filter=this.filterFactory.addAlphaFilter(o):i==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(o));const y=new Path2D;y.rect(l,u,r,s),t.clip(y),t.globalCompositeOperation="destination-in",t.drawImage(p,g,v,r,s,l,u,r,s),t.restore()}save(e){var r;this.inSMaskMode&&hv(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),(r=this.dependencyTracker)==null||r.save(e)}restore(e){var t;if((t=this.dependencyTracker)==null||t.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&hv(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,r,s,i,a,o){var l;(l=this.dependencyTracker)==null||l.recordIncrementalData("transform",e),this.ctx.transform(t,r,s,i,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,r,s){let[i]=r;if(!s){i||(i=r[0]=new Path2D),this[t](e,i);return}if(this.dependencyTracker!==null){const a=t===iw.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-a,s[2]+a,s[1]-a,s[3]+a).recordDependencies(e,["transform"])}if(!(i instanceof Path2D)){const a=r[0]=new Path2D;for(let o=0,l=i.length;o<l;)switch(i[o++]){case xS.moveTo:a.moveTo(i[o++],i[o++]);break;case xS.lineTo:a.lineTo(i[o++],i[o++]);break;case xS.curveTo:a.bezierCurveTo(i[o++],i[o++],i[o++],i[o++],i[o++],i[o++]);break;case xS.closePath:a.closePath();break;default:Oe(`Unrecognized drawing path operator: ${i[o-1]}`);break}i=a}ye.axialAlignedBoundingBox(s,Kt(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,r=!0){var a;const s=this.ctx,i=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const o=i.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=i.getPattern(s,this,Ma(s),hr.STROKE,e),o){const l=new Path2D;l.addPath(t,s.getTransform().invertSelf().multiplySelf(o)),t=l}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);(a=this.dependencyTracker)==null||a.recordDependencies(e,yi.stroke),r&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(hr.STROKE,Kt(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,r=!0){var u,h,f;const s=this.ctx,i=this.current.fillColor,a=this.current.patternFill;let o=!1;if(a){const p=i.isModifyingCurrentTransform()?s.getTransform():null;if((u=this.dependencyTracker)==null||u.save(e),s.save(),s.fillStyle=i.getPattern(s,this,Ma(s),hr.FILL,e),p){const g=new Path2D;g.addPath(t,s.getTransform().invertSelf().multiplySelf(p)),t=g}o=!0}const l=this.current.getClippedPathBoundingBox();this.contentVisible&&l!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),(h=this.dependencyTracker)==null||h.recordDependencies(e,yi.fill),o&&(s.restore(),(f=this.dependencyTracker)==null||f.restore(e)),r&&this.consumePath(e,t,l)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){var r;this.ctx.fill(t),(r=this.dependencyTracker)==null||r.recordDependencies(e,yi.rawFillPath).recordOperation(e)}clip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=HEe}eoClip(e){var t;(t=this.dependencyTracker)==null||t.recordFutureForcedDependency("clipMode",e),this.pendingClip=oU}beginText(e){var t;this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,(t=this.dependencyTracker)==null||t.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,r=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,i=r.getTransform().invertSelf();for(const{transform:a,x:o,y:l,fontSize:u,path:h}of t)h&&s.addPath(h,new DOMMatrix(a).preMultiplySelf(i).translate(o,l).scale(u,-u));r.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,r){var f,p;(f=this.dependencyTracker)==null||f.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),i=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(i.fontMatrix=s.fontMatrix||VI,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&Oe("Invalid font matrix for font "+t),r<0?(r=-r,i.fontDirection=-1):i.fontDirection=1,this.current.font=s,this.current.fontSize=r,s.isType3Font)return;const a=s.loadedName||"sans-serif",o=((p=s.systemFontInfo)==null?void 0:p.css)||`"${a}", ${s.fallbackName}`;let l="normal";s.black?l="900":s.bold&&(l="bold");const u=s.italic?"italic":"normal";let h=r;r<eU?h=eU:r>tU&&(h=tU),this.current.fontSizeScale=r/h,this.ctx.font=`${u} ${l} ${h}px ${o}`}setTextRenderingMode(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,r){var s;(s=this.dependencyTracker)==null||s.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=r}setLeadingMoveText(e,t,r){this.setLeading(e,-r),this.moveText(e,t,r)}setTextMatrix(e,t){var s;(s=this.dependencyTracker)==null||s.recordSimpleData("textMatrix",e);const{current:r}=this;r.textMatrix=t,r.textMatrixScale=Math.hypot(t[0],t[1]),r.x=r.lineX=0,r.y=r.lineY=0}nextLine(e){var t;this.moveText(e,0,this.current.leading),(t=this.dependencyTracker)==null||t.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}paintChar(e,t,r,s,i,a){var w,b,S,T;const o=this.ctx,l=this.current,u=l.font,h=l.textRenderingMode,f=l.fontSize/l.fontSizeScale,p=h&nr.FILL_STROKE_MASK,g=!!(h&nr.ADD_TO_PATH_FLAG),v=l.patternFill&&!u.missingFile,y=l.patternStroke&&!u.missingFile;let _;if((u.disableFontFace||g||v||y)&&!u.missingFile&&(_=u.getPathGenerator(this.commonObjs,t)),_&&(u.disableFontFace||v||y)){o.save(),o.translate(r,s),o.scale(f,-f),(w=this.dependencyTracker)==null||w.recordCharacterBBox(e,o,u);let P;if(p===nr.FILL||p===nr.FILL_STROKE)if(i){P=o.getTransform(),o.setTransform(...i);const R=D(this,sb,bD).call(this,_,P,i);o.fill(R)}else o.fill(_);if(p===nr.STROKE||p===nr.FILL_STROKE)if(a){P||(P=o.getTransform()),o.setTransform(...a);const{a:R,b:k,c:C,d:I}=P,M=ye.inverseTransform(a),L=ye.transform([R,k,C,I,0,0],M);ye.singularValueDecompose2dScale(L,ri),o.lineWidth*=Math.max(ri[0],ri[1])/f,o.stroke(D(this,sb,bD).call(this,_,P,a))}else o.lineWidth/=f,o.stroke(_);o.restore()}else(p===nr.FILL||p===nr.FILL_STROKE)&&(o.fillText(t,r,s),(b=this.dependencyTracker)==null||b.recordCharacterBBox(e,o,u,f,r,s,()=>o.measureText(t))),(p===nr.STROKE||p===nr.FILL_STROKE)&&(this.dependencyTracker&&((S=this.dependencyTracker)==null||S.recordCharacterBBox(e,o,u,f,r,s,()=>o.measureText(t)).recordDependencies(e,yi.stroke)),o.strokeText(t,r,s));g&&((this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:Kt(o),x:r,y:s,fontSize:f,path:_}),(T=this.dependencyTracker)==null||T.recordCharacterBBox(e,o,u,f,r,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let r=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){r=!0;break}return Ve(this,"isFontSubpixelAAEnabled",r)}showText(e,t){var C,I,M,L;this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,yi.showText).resetBBox(e),this.current.textRenderingMode&nr.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const r=this.current,s=r.font;if(s.isType3Font){this.showType3Text(e,t),(C=this.dependencyTracker)==null||C.recordShowTextOperation(e);return}const i=r.fontSize;if(i===0){(I=this.dependencyTracker)==null||I.recordOperation(e);return}const a=this.ctx,o=r.fontSizeScale,l=r.charSpacing,u=r.wordSpacing,h=r.fontDirection,f=r.textHScale*h,p=t.length,g=s.vertical,v=g?1:-1,y=s.defaultVMetrics,_=i*r.fontMatrix[0],w=r.textRenderingMode===nr.FILL&&!s.disableFontFace&&!r.patternFill;a.save(),r.textMatrix&&a.transform(...r.textMatrix),a.translate(r.x,r.y+r.textRise),h>0?a.scale(f,-1):a.scale(f,1);let b,S;if(r.patternFill){a.save();const F=r.fillColor.getPattern(a,this,Ma(a),hr.FILL,e);b=Kt(a),a.restore(),a.fillStyle=F}if(r.patternStroke){a.save();const F=r.strokeColor.getPattern(a,this,Ma(a),hr.STROKE,e);S=Kt(a),a.restore(),a.strokeStyle=F}let T=r.lineWidth;const P=r.textMatrixScale;if(P===0||T===0){const F=r.textRenderingMode&nr.FILL_STROKE_MASK;(F===nr.STROKE||F===nr.FILL_STROKE)&&(T=this.getSinglePixelWidth())}else T/=P;if(o!==1&&(a.scale(o,o),T/=o),a.lineWidth=T,s.isInvalidPDFjsFont){const F=[];let O=0;for(const Z of t)F.push(Z.unicode),O+=Z.width;const Y=F.join("");if(a.fillText(Y,0,0),this.dependencyTracker!==null){const Z=a.measureText(Y);this.dependencyTracker.recordBBox(e,this.ctx,-Z.actualBoundingBoxLeft,Z.actualBoundingBoxRight,-Z.actualBoundingBoxAscent,Z.actualBoundingBoxDescent).recordShowTextOperation(e)}r.x+=O*_*f,a.restore(),this.compose();return}let R=0,k;for(k=0;k<p;++k){const F=t[k];if(typeof F=="number"){R+=v*F*i/1e3;continue}let O=!1;const Y=(F.isSpace?u:0)+l,Z=F.fontChar,X=F.accent;let J,K,te=F.width;if(g){const $=F.vmetric||y,U=-(F.vmetric?$[1]:te*.5)*_,G=$[2]*_;te=$?-$[0]:te,J=U/o,K=(R+G)/o}else J=R/o,K=0;let ae;if(s.remeasure&&te>0){ae=a.measureText(Z);const $=ae.width*1e3/i*o;if(te<$&&this.isFontSubpixelAAEnabled){const U=te/$;O=!0,a.save(),a.scale(U,1),J/=U}else te!==$&&(J+=(te-$)/2e3*i/o)}if(this.contentVisible&&(F.isInFont||s.missingFile)){if(w&&!X)a.fillText(Z,J,K),(M=this.dependencyTracker)==null||M.recordCharacterBBox(e,a,ae?{bbox:null}:s,i/o,J,K,()=>ae??a.measureText(Z));else if(this.paintChar(e,Z,J,K,b,S),X){const $=J+i*X.offset.x/o,U=K-i*X.offset.y/o;this.paintChar(e,X.fontChar,$,U,b,S)}}const q=g?te*_-Y*h:te*_+Y*h;R+=q,O&&a.restore()}g?r.y-=R:r.x+=R*f,a.restore(),this.compose(),(L=this.dependencyTracker)==null||L.recordShowTextOperation(e)}showType3Text(e,t){const r=this.ctx,s=this.current,i=s.font,a=s.fontSize,o=s.fontDirection,l=i.vertical?1:-1,u=s.charSpacing,h=s.wordSpacing,f=s.textHScale*o,p=s.fontMatrix||VI,g=t.length,v=s.textRenderingMode===nr.INVISIBLE;let y,_,w,b;if(v||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,r.save(),s.textMatrix&&r.transform(...s.textMatrix),r.translate(s.x,s.y+s.textRise),r.scale(f,o);const S=this.dependencyTracker;for(this.dependencyTracker=S?new Z1(S,e):null,y=0;y<g;++y){if(_=t[y],typeof _=="number"){b=l*_*a/1e3,this.ctx.translate(b,0),s.x+=b*f;continue}const T=(_.isSpace?h:0)+u,P=i.charProcOperatorList[_.operatorListId];P?this.contentVisible&&(this.save(),r.scale(a,a),r.transform(...p),this.executeOperatorList(P),this.restore()):Oe(`Type3 character "${_.operatorListId}" is not available.`);const R=[_.width,0];ye.applyTransform(R,p),w=R[0]*a+T,r.translate(w,0),s.x+=w*f}r.restore(),S&&(this.dependencyTracker=S)}setCharWidth(e,t,r){}setCharWidthAndBounds(e,t,r,s,i,a,o){var u;const l=new Path2D;l.rect(s,i,a-s,o-i),this.ctx.clip(l),(u=this.dependencyTracker)==null||u.recordBBox(e,this.ctx,s,a,i,o).recordClipBox(e,this.ctx,s,a,i,o),this.endPath(e)}getColorN_Pattern(e,t){let r;if(t[0]==="TilingPattern"){const s=this.baseTransform||Kt(this.ctx),i={createCanvasGraphics:(a,o)=>new OO(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Z1(this.dependencyTracker,o,!0):null)};r=new yD(t,this.ctx,i,s)}else r=this._getPattern(e,t[1],t[2]);return r}setStrokeColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){var r;(r=this.dependencyTracker)==null||r.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){var t;(t=this.dependencyTracker)==null||t.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,r=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=jEe(this.getObject(e,t)),this.cachedPatterns.set(t,s)),r&&(s.matrix=r),s}shadingFill(e,t){var a;if(!this.contentVisible)return;const r=this.ctx;this.save(e);const s=this._getPattern(e,t);r.fillStyle=s.getPattern(r,this,Ma(r),hr.SHADING,e);const i=Ma(r);if(i){const{width:o,height:l}=r.canvas,u=Cp.slice();ye.axialAlignedBoundingBox([0,0,o,l],i,u);const[h,f,p,g]=u;this.ctx.fillRect(h,f,p-h,g-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);(a=this.dependencyTracker)==null||a.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,yi.transform).recordDependencies(e,yi.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Tt("Should not call beginInlineImage")}beginImageData(){Tt("Should not call beginImageData")}paintFormXObjectBegin(e,t,r){var s;if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Kt(this.ctx),r)){ye.axialAlignedBoundingBox(r,this.baseTransform,this.current.minMax);const[i,a,o,l]=r,u=new Path2D;u.rect(i,a,o-i,l-a),this.ctx.clip(u),(s=this.dependencyTracker)==null||s.recordClipBox(e,this.ctx,i,o,a,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){var S;if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const r=this.ctx;t.isolated||bk("TODO: Support non-isolated groups."),t.knockout&&Oe("Knockout groups not supported.");const s=Kt(r);if(t.matrix&&r.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let i=Cp.slice();ye.axialAlignedBoundingBox(t.bbox,Kt(r),i);const a=[0,0,r.canvas.width,r.canvas.height];i=ye.intersect(i,a)||[0,0,0,0];const o=Math.floor(i[0]),l=Math.floor(i[1]),u=Math.max(Math.ceil(i[2])-o,1),h=Math.max(Math.ceil(i[3])-l,1);this.current.startNewPathAndClipBox([0,0,u,h]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(f,u,h),g=p.context;g.translate(-o,-l),g.transform(...s);let v=new Path2D;const[y,_,w,b]=t.bbox;if(v.rect(y,_,w-y,b-_),t.matrix){const T=new Path2D;T.addPath(v,new DOMMatrix(t.matrix)),v=T}g.clip(v),t.smask&&this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:l,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(r.setTransform(1,0,0,1,0,0),r.translate(o,l),r.save()),hv(r,g),this.ctx=g,(S=this.dependencyTracker)==null||S.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(r),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(r),this.groupLevel++}endGroup(e,t){var i;if(!this.contentVisible)return;this.groupLevel--;const r=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,(i=this.dependencyTracker)==null||i.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Kt(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...a);const o=Cp.slice();ye.axialAlignedBoundingBox([0,0,r.canvas.width,r.canvas.height],a,o),this.ctx.drawImage(r.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(e,t,r,s,i,a){if(D(this,nb,vD).call(this),NS(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),r){const o=r[2]-r[0],l=r[3]-r[1];if(a&&this.annotationCanvasMap){s=s.slice(),s[4]-=r[0],s[5]-=r[1],r=r.slice(),r[0]=r[1]=0,r[2]=o,r[3]=l,ye.singularValueDecompose2dScale(Kt(this.ctx),ri);const{viewportScale:u}=this,h=Math.ceil(o*this.outputScaleX*u),f=Math.ceil(l*this.outputScaleY*u);this.annotationCanvas=this.canvasFactory.create(h,f);const{canvas:p,context:g}=this.annotationCanvas;this.annotationCanvasMap.set(t,p),this.annotationCanvas.savedCtx=this.ctx,this.ctx=g,this.ctx.save(),this.ctx.setTransform(ri[0],0,0,-ri[1],0,l*ri[1]),NS(this.ctx)}else{NS(this.ctx),this.endPath(e);const u=new Path2D;u.rect(r[0],r[1],o,l),this.ctx.clip(u)}}this.current=new rU(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),D(this,rb,wD).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){var o;if(!this.contentVisible)return;const r=t.count;t=this.getObject(e,t.data,t),t.count=r;const s=this.ctx,i=this._createMaskCanvas(e,t),a=i.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(a,i.offsetX,i.offsetY),(o=this.dependencyTracker)==null||o.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+a.width,i.offsetY,i.offsetY+a.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,r,s=0,i=0,a,o){var f,p,g;if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const l=this.ctx;l.save();const u=Kt(l);l.transform(r,s,i,a,0,0);const h=this._createMaskCanvas(e,t);l.setTransform(1,0,0,1,h.offsetX-u[4],h.offsetY-u[5]),(f=this.dependencyTracker)==null||f.resetBBox(e);for(let v=0,y=o.length;v<y;v+=2){const _=ye.transform(u,[r,s,i,a,o[v],o[v+1]]);l.drawImage(h.canvas,_[4],_[5]),(p=this.dependencyTracker)==null||p.recordBBox(e,this.ctx,_[4],_[4]+h.canvas.width,_[5],_[5]+h.canvas.height)}l.restore(),this.compose(),(g=this.dependencyTracker)==null||g.recordOperation(e)}paintImageMaskXObjectGroup(e,t){var a,o,l;if(!this.contentVisible)return;const r=this.ctx,s=this.current.fillColor,i=this.current.patternFill;(a=this.dependencyTracker)==null||a.resetBBox(e).recordDependencies(e,yi.transformAndFill);for(const u of t){const{data:h,width:f,height:p,transform:g}=u,v=this.cachedCanvases.getCanvas("maskCanvas",f,p),y=v.context;y.save();const _=this.getObject(e,h,u);iU(y,_),y.globalCompositeOperation="source-in",y.fillStyle=i?s.getPattern(y,this,Ma(r),hr.FILL,e):s,y.fillRect(0,0,f,p),y.restore(),r.save(),r.transform(...g),r.scale(1,-1),kS(r,v.canvas,0,0,f,p,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,r,0,f,0,p),r.restore()}this.compose(),(l=this.dependencyTracker)==null||l.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const r=this.getObject(e,t);if(!r){Oe("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,r)}paintImageXObjectRepeat(e,t,r,s,i){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){Oe("Dependent image isn't ready yet");return}const o=a.width,l=a.height,u=[];for(let h=0,f=i.length;h<f;h+=2)u.push({transform:[r,0,0,s,i[h],i[h+1]],x:0,y:0,w:o,h:l});this.paintInlineImageXObjectGroup(e,a,u)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:r,height:s}=e,i=this.cachedCanvases.getCanvas("inlineImage",r,s),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",i.canvas}paintInlineImageXObject(e,t){var u;if(!this.contentVisible)return;const r=t.width,s=t.height,i=this.ctx;this.save(e);const{filter:a}=i;a!=="none"&&a!==""&&(i.filter="none"),i.scale(1/r,-1/s);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)o=t;else{const f=this.cachedCanvases.getCanvas("inlineImage",r,s).context;sU(f,t),o=this.applyTransferMapsToCanvas(f)}const l=this._scaleImage(o,Ma(i));i.imageSmoothingEnabled=aU(Kt(i),t.interpolate),(u=this.dependencyTracker)==null||u.resetBBox(e).recordBBox(e,i,0,r,-s,0).recordDependencies(e,yi.imageXObject).recordOperation(e),kS(i,l.img,0,0,l.paintWidth,l.paintHeight,0,-s,r,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,r){var a,o,l;if(!this.contentVisible)return;const s=this.ctx;let i;if(t.bitmap)i=t.bitmap;else{const u=t.width,h=t.height,p=this.cachedCanvases.getCanvas("inlineImage",u,h).context;sU(p,t),i=this.applyTransferMapsToCanvas(p)}(a=this.dependencyTracker)==null||a.resetBBox(e);for(const u of r)s.save(),s.transform(...u.transform),s.scale(1,-1),kS(s,i,u.x,u.y,u.w,u.h,0,-1,1,1),(o=this.dependencyTracker)==null||o.recordBBox(e,s,0,1,-1,0),s.restore();(l=this.dependencyTracker)==null||l.recordOperation(e),this.compose()}paintSolidColorImageMask(e){var t;this.contentVisible&&((t=this.dependencyTracker)==null||t.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,yi.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,r){}beginMarkedContent(e,t){var r;(r=this.dependencyTracker)==null||r.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,r){var s;(s=this.dependencyTracker)==null||s.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){var t;(t=this.dependencyTracker)==null||t.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,r){var a,o;const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(r);const i=this.ctx;this.pendingClip?(s||(this.pendingClip===oU?i.clip(t,"evenodd"):i.clip(t)),this.pendingClip=null,(a=this.dependencyTracker)==null||a.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):(o=this.dependencyTracker)==null||o.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Kt(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),r=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(r,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:r,c:s,d:i}=this.ctx.getTransform();let a,o;if(r===0&&s===0){const l=Math.abs(t),u=Math.abs(i);if(l===u)if(e===0)a=o=1/l;else{const h=l*e;a=o=h<1?1/h:1}else if(e===0)a=1/l,o=1/u;else{const h=l*e,f=u*e;a=h<1?1/h:1,o=f<1?1/f:1}}else{const l=Math.abs(t*i-r*s),u=Math.hypot(t,r),h=Math.hypot(s,i);if(e===0)a=h/l,o=u/l;else{const f=e*l;a=h>f?h/f:1,o=u>f?u/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:r,current:{lineWidth:s}}=this,[i,a]=this.getScaleForStroking();if(i===a){r.lineWidth=(s||1)*i,r.stroke(e);return}const o=r.getLineDash();t&&r.save(),r.scale(i,a),HN.a=1/i,HN.d=1/a;const l=new Path2D;if(l.addPath(e,HN),o.length>0){const u=Math.max(i,a);r.setLineDash(o.map(h=>h/u)),r.lineDashOffset/=u}r.lineWidth=s||1,r.stroke(l),t&&r.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};nb=new WeakSet,vD=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},rb=new WeakSet,wD=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},sb=new WeakSet,bD=function(e,t,r){const s=new Path2D;return s.addPath(e,new DOMMatrix(r).invertSelf().multiplySelf(t)),s};let qp=OO;for(const n in iw)qp.prototype[n]!==void 0&&(qp.prototype[iw[n]]=qp.prototype[n]);var km,Nm,ib,Pm,vE;const Np=class Np{constructor(e){x(this,Pm);x(this,km,void 0);x(this,Nm,void 0);x(this,ib,void 0);A(this,km,e),A(this,Nm,new DataView(c(this,km))),A(this,ib,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let s=0;for(const u of Np.strings){const h=t.encode(e[u]);r[u]=h,s+=4+h.length}const i=new ArrayBuffer(s),a=new Uint8Array(i),o=new DataView(i);let l=0;for(const u of Np.strings){const h=r[u],f=h.length;o.setUint32(l,f),a.set(h,l+4),l+=4+f}return Je(l===i.byteLength,"CssFontInfo.write: Buffer overflow"),i}get fontFamily(){return D(this,Pm,vE).call(this,0)}get fontWeight(){return D(this,Pm,vE).call(this,1)}get italicAngle(){return D(this,Pm,vE).call(this,2)}};km=new WeakMap,Nm=new WeakMap,ib=new WeakMap,Pm=new WeakSet,vE=function(e){Je(e<Np.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=c(this,Nm).getUint32(t)+4;const r=c(this,Nm).getUint32(t);return c(this,ib).decode(new Uint8Array(c(this,km),t+4,r))},ie(Np,"strings",["fontFamily","fontWeight","italicAngle"]);let eA=Np;var Wc,Xa,ld,cd,jv;const Pp=class Pp{constructor(e){x(this,cd);x(this,Wc,void 0);x(this,Xa,void 0);x(this,ld,void 0);A(this,Wc,e),A(this,Xa,new DataView(c(this,Wc))),A(this,ld,new TextDecoder)}static write(e){const t=new TextEncoder,r={};let s=0;for(const p of Pp.strings){const g=t.encode(e[p]);r[p]=g,s+=4+g.length}s+=4;let i,a,o=1+s;e.style&&(i=t.encode(e.style.style),a=t.encode(e.style.weight),o+=4+i.length+4+a.length);const l=new ArrayBuffer(o),u=new Uint8Array(l),h=new DataView(l);let f=0;h.setUint8(f++,e.guessFallback?1:0),h.setUint32(f,0),f+=4,s=0;for(const p of Pp.strings){const g=r[p],v=g.length;s+=4+v,h.setUint32(f,v),u.set(g,f+4),f+=4+v}return h.setUint32(f-s-4,s),e.style&&(h.setUint32(f,i.length),u.set(i,f+4),f+=4+i.length,h.setUint32(f,a.length),u.set(a,f+4),f+=4+a.length),Je(f<=l.byteLength,"SubstitionInfo.write: Buffer overflow"),l.transferToFixedLength(f)}get guessFallback(){return c(this,Xa).getUint8(0)!==0}get css(){return D(this,cd,jv).call(this,0)}get loadedName(){return D(this,cd,jv).call(this,1)}get baseFontName(){return D(this,cd,jv).call(this,2)}get src(){return D(this,cd,jv).call(this,3)}get style(){let e=1;e+=4+c(this,Xa).getUint32(e);const t=c(this,Xa).getUint32(e),r=c(this,ld).decode(new Uint8Array(c(this,Wc),e+4,t));e+=4+t;const s=c(this,Xa).getUint32(e),i=c(this,ld).decode(new Uint8Array(c(this,Wc),e+4,s));return{style:r,weight:i}}};Wc=new WeakMap,Xa=new WeakMap,ld=new WeakMap,cd=new WeakSet,jv=function(e){Je(e<Pp.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=c(this,Xa).getUint32(t)+4;const r=c(this,Xa).getUint32(t);return c(this,ld).decode(new Uint8Array(c(this,Wc),t+4,r))},ie(Pp,"strings",["css","loadedName","baseFontName","src"]);let tA=Pp;var Im,Dm,Rm,Mm,Us,Qa,ab,wt,Vs,Qi,Om,wE,ud,Fv;const $e=class $e{constructor({data:e,extra:t}){x(this,Vs);x(this,Om);x(this,ud);x(this,Qa,void 0);x(this,ab,void 0);x(this,wt,void 0);A(this,Qa,e),A(this,ab,new TextDecoder),A(this,wt,new DataView(c(this,Qa))),t&&Object.assign(this,t)}get black(){return D(this,Vs,Qi).call(this,0)}get bold(){return D(this,Vs,Qi).call(this,1)}get disableFontFace(){return D(this,Vs,Qi).call(this,2)}get fontExtraProperties(){return D(this,Vs,Qi).call(this,3)}get isInvalidPDFjsFont(){return D(this,Vs,Qi).call(this,4)}get isType3Font(){return D(this,Vs,Qi).call(this,5)}get italic(){return D(this,Vs,Qi).call(this,6)}get missingFile(){return D(this,Vs,Qi).call(this,7)}get remeasure(){return D(this,Vs,Qi).call(this,8)}get vertical(){return D(this,Vs,Qi).call(this,9)}get ascent(){return D(this,Om,wE).call(this,0)}get defaultWidth(){return D(this,Om,wE).call(this,1)}get descent(){return D(this,Om,wE).call(this,2)}get bbox(){let e=c($e,Dm);if(c(this,wt).getUint8(e)===0)return;e+=1;const r=[];for(let s=0;s<4;s++)r.push(c(this,wt).getInt16(e,!0)),e+=2;return r}get fontMatrix(){let e=c($e,Rm);if(c(this,wt).getUint8(e)===0)return;e+=1;const r=[];for(let s=0;s<6;s++)r.push(c(this,wt).getFloat64(e,!0)),e+=8;return r}get defaultVMetrics(){let e=c($e,Mm);if(c(this,wt).getUint8(e)===0)return;e+=1;const r=[];for(let s=0;s<3;s++)r.push(c(this,wt).getInt16(e,!0)),e+=2;return r}get fallbackName(){return D(this,ud,Fv).call(this,0)}get loadedName(){return D(this,ud,Fv).call(this,1)}get mimetype(){return D(this,ud,Fv).call(this,2)}get name(){return D(this,ud,Fv).call(this,3)}get data(){let e=c($e,Us);const t=c(this,wt).getUint32(e);e+=4+t;const r=c(this,wt).getUint32(e);e+=4+r;const s=c(this,wt).getUint32(e);e+=4+s;const i=c(this,wt).getUint32(e);if(i!==0)return new Uint8Array(c(this,Qa),e+4,i)}clearData(){let e=c($e,Us);const t=c(this,wt).getUint32(e);e+=4+t;const r=c(this,wt).getUint32(e);e+=4+r;const s=c(this,wt).getUint32(e);e+=4+s;const i=c(this,wt).getUint32(e);new Uint8Array(c(this,Qa),e+4,i).fill(0),c(this,wt).setUint32(e,0)}get cssFontInfo(){let e=c($e,Us);const t=c(this,wt).getUint32(e);e+=4+t;const r=c(this,wt).getUint32(e);e+=4+r;const s=c(this,wt).getUint32(e);if(s===0)return null;const i=new Uint8Array(s);return i.set(new Uint8Array(c(this,Qa),e+4,s)),new eA(i.buffer)}get systemFontInfo(){let e=c($e,Us);const t=c(this,wt).getUint32(e);e+=4+t;const r=c(this,wt).getUint32(e);if(r===0)return null;const s=new Uint8Array(r);return s.set(new Uint8Array(c(this,Qa),e+4,r)),new tA(s.buffer)}static write(e){const t=e.systemFontInfo?tA.write(e.systemFontInfo):null,r=e.cssFontInfo?eA.write(e.cssFontInfo):null,s=new TextEncoder,i={};let a=0;for(const y of $e.strings)i[y]=s.encode(e[y]),a+=4+i[y].length;const o=c($e,Us)+4+a+4+(t?t.byteLength:0)+4+(r?r.byteLength:0)+4+(e.data?e.data.length:0),l=new ArrayBuffer(o),u=new Uint8Array(l),h=new DataView(l);let f=0;const p=$e.bools.length;let g=0,v=0;for(let y=0;y<p;y++){const _=e[$e.bools[y]];g|=(_===void 0?0:_?2:1)<<v,v+=2,(v===8||y===p-1)&&(h.setUint8(f++,g),g=0,v=0)}Je(f===c($e,Im),"FontInfo.write: Boolean properties offset mismatch");for(const y of $e.numbers)h.setFloat64(f,e[y]),f+=8;if(Je(f===c($e,Dm),"FontInfo.write: Number properties offset mismatch"),e.bbox){h.setUint8(f++,4);for(const y of e.bbox)h.setInt16(f,y,!0),f+=2}else h.setUint8(f++,0),f+=2*4;if(Je(f===c($e,Rm),"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){h.setUint8(f++,6);for(const y of e.fontMatrix)h.setFloat64(f,y,!0),f+=8}else h.setUint8(f++,0),f+=8*6;if(Je(f===c($e,Mm),"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){h.setUint8(f++,1);for(const y of e.defaultVMetrics)h.setInt16(f,y,!0),f+=2}else h.setUint8(f++,0),f+=3*2;Je(f===c($e,Us),"FontInfo.write: DefaultVMetrics properties offset mismatch"),h.setUint32(c($e,Us),0),f+=4;for(const y of $e.strings){const _=i[y],w=_.length;h.setUint32(f,w),u.set(_,f+4),f+=4+w}if(h.setUint32(c($e,Us),f-c($e,Us)-4),!t)h.setUint32(f,0),f+=4;else{const y=t.byteLength;h.setUint32(f,y),Je(f+4+y<=l.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),u.set(new Uint8Array(t),f+4),f+=4+y}if(!r)h.setUint32(f,0),f+=4;else{const y=r.byteLength;h.setUint32(f,y),Je(f+4+y<=l.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),u.set(new Uint8Array(r),f+4),f+=4+y}return e.data===void 0?(h.setUint32(f,0),f+=4):(h.setUint32(f,e.data.length),u.set(e.data,f+4),f+=4+e.data.length),Je(f<=l.byteLength,"FontInfo.write: Buffer overflow"),l.transferToFixedLength(f)}};Im=new WeakMap,Dm=new WeakMap,Rm=new WeakMap,Mm=new WeakMap,Us=new WeakMap,Qa=new WeakMap,ab=new WeakMap,wt=new WeakMap,Vs=new WeakSet,Qi=function(e){Je(e<$e.bools.length,"Invalid boolean index");const t=Math.floor(e/4),r=e*2%8,s=c(this,wt).getUint8(t)>>r&3;return s===0?void 0:s===2},Om=new WeakSet,wE=function(e){return Je(e<$e.numbers.length,"Invalid number index"),c(this,wt).getFloat64(c($e,Im)+e*8)},ud=new WeakSet,Fv=function(e){Je(e<$e.strings.length,"Invalid string index");let t=c($e,Us)+4;for(let i=0;i<e;i++)t+=c(this,wt).getUint32(t)+4;const r=c(this,wt).getUint32(t),s=new Uint8Array(r);return s.set(new Uint8Array(c(this,Qa),t+4,r)),c(this,ab).decode(s)},ie($e,"bools",["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"]),ie($e,"numbers",["ascent","defaultWidth","descent"]),ie($e,"strings",["fallbackName","loadedName","mimetype","name"]),x($e,Im,Math.ceil($e.bools.length*2/8)),x($e,Dm,c($e,Im)+$e.numbers.length*8),x($e,Rm,c($e,Dm)+1+2*4),x($e,Mm,c($e,Rm)+1+8*6),x($e,Us,c($e,Mm)+1+2*3);let _D=$e;var ob,lb;class ga{static get workerPort(){return c(this,ob)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");A(this,ob,e)}static get workerSrc(){return c(this,lb)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");A(this,lb,e)}}ob=new WeakMap,lb=new WeakMap,x(ga,ob,null),x(ga,lb,"");var Lm,cb;class WEe{constructor({parsedData:e,rawData:t}){x(this,Lm,void 0);x(this,cb,void 0);A(this,Lm,e),A(this,cb,t)}getRaw(){return c(this,cb)}get(e){return c(this,Lm).get(e)??null}[Symbol.iterator](){return c(this,Lm).entries()}}Lm=new WeakMap,cb=new WeakMap;const up=Symbol("INTERNAL");var ub,hb,db,jm;class GEe{constructor(e,{name:t,intent:r,usage:s,rbGroups:i}){x(this,ub,!1);x(this,hb,!1);x(this,db,!1);x(this,jm,!0);A(this,ub,!!(e&ti.DISPLAY)),A(this,hb,!!(e&ti.PRINT)),this.name=t,this.intent=r,this.usage=s,this.rbGroups=i}get visible(){if(c(this,db))return c(this,jm);if(!c(this,jm))return!1;const{print:e,view:t}=this.usage;return c(this,ub)?(t==null?void 0:t.viewState)!=="OFF":c(this,hb)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,r=!1){e!==up&&Tt("Internal method `_setVisible` called."),A(this,db,r),A(this,jm,t)}}ub=new WeakMap,hb=new WeakMap,db=new WeakMap,jm=new WeakMap;var Gc,bt,Fm,$m,fb,xD;class qEe{constructor(e,t=ti.DISPLAY){x(this,fb);x(this,Gc,null);x(this,bt,new Map);x(this,Fm,null);x(this,$m,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,A(this,$m,e.order);for(const r of e.groups)c(this,bt).set(r.id,new GEe(t,r));if(e.baseState==="OFF")for(const r of c(this,bt).values())r._setVisible(up,!1);for(const r of e.on)c(this,bt).get(r)._setVisible(up,!0);for(const r of e.off)c(this,bt).get(r)._setVisible(up,!1);A(this,Fm,this.getHash())}}isVisible(e){if(c(this,bt).size===0)return!0;if(!e)return bk("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,bt).has(e.id)?c(this,bt).get(e.id).visible:(Oe(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return D(this,fb,xD).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,bt).has(t))return Oe(`Optional content group not found: ${t}`),!0;if(c(this,bt).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,bt).has(t))return Oe(`Optional content group not found: ${t}`),!0;if(!c(this,bt).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,bt).has(t))return Oe(`Optional content group not found: ${t}`),!0;if(!c(this,bt).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,bt).has(t))return Oe(`Optional content group not found: ${t}`),!0;if(c(this,bt).get(t).visible)return!1}return!0}return Oe(`Unknown optional content policy ${e.policy}.`),!0}return Oe(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,r=!0){var i;const s=c(this,bt).get(e);if(!s){Oe(`Optional content group not found: ${e}`);return}if(r&&t&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==e&&((i=c(this,bt).get(o))==null||i._setVisible(up,!1,!0));s._setVisible(up,!!t,!0),A(this,Gc,null)}setOCGState({state:e,preserveRB:t}){let r;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":r=s;continue}const i=c(this,bt).get(s);if(i)switch(r){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!i.visible,t);break}}A(this,Gc,null)}get hasInitialVisibility(){return c(this,Fm)===null||this.getHash()===c(this,Fm)}getOrder(){return c(this,bt).size?c(this,$m)?c(this,$m).slice():[...c(this,bt).keys()]:null}getGroup(e){return c(this,bt).get(e)||null}getHash(){if(c(this,Gc)!==null)return c(this,Gc);const e=new O9;for(const[t,r]of c(this,bt))e.update(`${t}:${r.visible}`);return A(this,Gc,e.hexdigest())}[Symbol.iterator](){return c(this,bt).entries()}}Gc=new WeakMap,bt=new WeakMap,Fm=new WeakMap,$m=new WeakMap,fb=new WeakSet,xD=function(e){const t=e.length;if(t<2)return!0;const r=e[0];for(let s=1;s<t;s++){const i=e[s];let a;if(Array.isArray(i))a=D(this,fb,xD).call(this,i);else if(c(this,bt).has(i))a=c(this,bt).get(i).visible;else return Oe(`Optional content group not found: ${i}`),!0;switch(r){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return r==="And"};class YEe{constructor(e,{disableRange:t=!1,disableStream:r=!1}){Je(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:i,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,(i==null?void 0:i.length)>0){const l=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!r,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const r=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(r):this._queuedChunks.push(r);else{const s=this._rangeReaders.some(function(i){return i._begin!==e?!1:(i._enqueue(r),!0)});Je(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,r,s,i;e.total===void 0?(r=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||r.call(t,{loaded:e.loaded}):(i=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||i.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Je(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new KEe(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new XEe(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeReaders.slice(0))r.cancel(e);this._pdfDataRangeTransport.abort()}}class KEe{constructor(e,t,r=!1,s=null){this._stream=e,this._done=r||!1,this._filename=SO(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const i of this._queuedChunks)this._loaded+=i.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class XEe{constructor(e,t,r){this._stream=e,this._begin=t,this._end=r,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function QEe(n){let e=!0,t=r("filename\\*","i").exec(n);if(t){t=t[1];let h=o(t);return h=unescape(h),h=l(h),h=u(h),i(h)}if(t=a(n),t){const h=u(t);return i(h)}if(t=r("filename","i").exec(n),t){t=t[1];let h=o(t);return h=u(h),i(h)}function r(h,f){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function s(h,f){if(h){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const p=new TextDecoder(h,{fatal:!0}),g=_x(f);f=p.decode(g),e=!1}catch{}}return f}function i(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function a(h){const f=[];let p;const g=r("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(p=g.exec(h))!==null;){let[,y,_,w]=p;if(y=parseInt(y,10),y in f){if(y===0)break;continue}f[y]=[_,w]}const v=[];for(let y=0;y<f.length&&y in f;++y){let[_,w]=f[y];w=o(w),_&&(w=unescape(w),y===0&&(w=l(w))),v.push(w)}return v.join("")}function o(h){if(h.startsWith('"')){const f=h.slice(1).split('\\"');for(let p=0;p<f.length;++p){const g=f[p].indexOf('"');g!==-1&&(f[p]=f[p].slice(0,g),f.length=p+1),f[p]=f[p].replaceAll(/\\(.)/g,"$1")}h=f.join('"')}return h}function l(h){const f=h.indexOf("'");if(f===-1)return h;const p=h.slice(0,f),v=h.slice(f+1).replace(/^[^']*'/,"");return s(p,v)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,p,g,v){if(g==="q"||g==="Q")return v=v.replaceAll("_"," "),v=v.replaceAll(/=([0-9a-fA-F]{2})/g,function(y,_){return String.fromCharCode(parseInt(_,16))}),s(p,v);try{v=atob(v)}catch{}return s(p,v)})}return""}function q9(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const r in e){const s=e[r];s!==void 0&&t.append(r,s)}return t}function xk(n){var e;return((e=URL.parse(n))==null?void 0:e.origin)??null}function Y9({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:r}){const s={allowRangeRequests:!1,suggestedLength:void 0},i=parseInt(n.get("Content-Length"),10);return!Number.isInteger(i)||(s.suggestedLength=i,i<=2*t)||r||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function K9(n){const e=n.get("Content-Disposition");if(e){let t=QEe(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(SO(t))return t}return null}function Tx(n,e){return new K1(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n,n===404||n===0&&e.startsWith("file:"))}function X9(n){return n===200||n===206}function Q9(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function J9(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(Oe(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class JEe{constructor(e){ie(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=q9(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Je(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new ZEe(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new e1e(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class ZEe{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const r=new Headers(e.headers),s=t.url;fetch(s,Q9(r,this._withCredentials,this._abortController)).then(i=>{if(e._responseOrigin=xk(i.url),!X9(i.status))throw Tx(i.status,s);this._reader=i.body.getReader(),this._headersCapability.resolve();const a=i.headers,{allowRangeRequests:o,suggestedLength:l}=Y9({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=o,this._contentLength=l||this._contentLength,this._filename=K9(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new qu("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:J9(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class e1e{constructor(e,t,r){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const i=new Headers(e.headers);i.append("Range",`bytes=${t}-${r-1}`);const a=s.url;fetch(a,Q9(i,this._withCredentials,this._abortController)).then(o=>{const l=xk(o.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!X9(o.status))throw Tx(o.status,a);this._readCapability.resolve(),this._reader=o.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:J9(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const WN=200,GN=206;function t1e(n){const e=n.response;return typeof e!="string"?e:_x(e).buffer}class n1e{constructor({url:e,httpHeaders:t,withCredentials:r}){ie(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=q9(this.isHttp,t),this.withCredentials=r||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,r=this.currXhrId++,s=this.pendingRequests[r]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[i,a]of this.headers)t.setRequestHeader(i,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=GN):s.expectedStatus=WN,t.responseType="arraybuffer",Je(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,r),t.onprogress=this.onProgress.bind(this,r),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),r}onProgress(e,t){var s;const r=this.pendingRequests[e];r&&((s=r.onProgress)==null||s.call(r,t))}onStateChange(e,t){const r=this.pendingRequests[e];if(!r)return;const s=r.xhr;if(s.readyState>=2&&r.onHeadersReceived&&(r.onHeadersReceived(),delete r.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){r.onError(s.status);return}const i=s.status||WN;if(!(i===WN&&r.expectedStatus===GN)&&i!==r.expectedStatus){r.onError(s.status);return}const o=t1e(s);if(i===GN){const l=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?r.onDone({begin:parseInt(u[1],10),chunk:o}):(Oe('Missing or invalid "Content-Range" header.'),r.onError(0))}else o?r.onDone({begin:0,chunk:o}):r.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class r1e{constructor(e){this._source=e,this._manager=new n1e(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Je(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new s1e(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const r=new i1e(this._manager,e,t);return r.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class s1e{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=xk(t.responseURL);const r=t.getAllResponseHeaders(),s=new Headers(r?r.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(o=>{const[l,...u]=o.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:i,suggestedLength:a}=Y9({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=K9(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Tx(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class i1e{constructor(e,t,r){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:r,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=xk((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const r of this._requests)r.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Tx(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const a1e=/^[a-z][a-z0-9\-+.]+:/i;function o1e(n){if(a1e.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class l1e{constructor(e){this.source=e,this.url=o1e(e.url),Je(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Je(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new c1e(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const r=new u1e(this,e,t);return this._rangeRequestReaders.push(r),r}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const r of this._rangeRequestReaders.slice(0))r.cancel(e)}}class c1e{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const r=process.getBuiltinModule("fs");r.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(r.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=Tx(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new qu("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class u1e{constructor(e,t,r){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const i=process.getBuiltinModule("fs");this._setReadableStream(i.createReadStream(this._url,{start:t,end:r-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var r;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(r=this.onProgress)==null||r.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const dv=Symbol("INITIAL_DATA");var Bs,pb,SD;class Z9{constructor(){x(this,pb);x(this,Bs,Object.create(null))}get(e,t=null){if(t){const s=D(this,pb,SD).call(this,e);return s.promise.then(()=>t(s.data)),null}const r=c(this,Bs)[e];if(!r||r.data===dv)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return r.data}has(e){const t=c(this,Bs)[e];return!!t&&t.data!==dv}delete(e){const t=c(this,Bs)[e];return!t||t.data===dv?!1:(delete c(this,Bs)[e],!0)}resolve(e,t=null){const r=D(this,pb,SD).call(this,e);r.data=t,r.resolve()}clear(){var e;for(const t in c(this,Bs)){const{data:r}=c(this,Bs)[t];(e=r==null?void 0:r.bitmap)==null||e.close()}A(this,Bs,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,Bs)){const{data:t}=c(this,Bs)[e];t!==dv&&(yield[e,t])}}}Bs=new WeakMap,pb=new WeakSet,SD=function(e){var t;return(t=c(this,Bs))[e]||(t[e]={...Promise.withResolvers(),data:dv})};const h1e=1e5,lU=30;var dU,qc,ms,mb,gb,hd,ol,yb,vb,dd,Um,Vm,Yc,Bm,wb,zm,fd,bb,_b,Hm,pd,xb,Kc,Wm,qA,eW,YA,tW,Sb,ED,Gm,bE,Eb,AD,KA,nW,XA,rW;const nn=class nn{constructor({textContentSource:e,container:t,viewport:r}){x(this,qA);x(this,YA);x(this,Sb);x(this,qc,Promise.withResolvers());x(this,ms,null);x(this,mb,!1);x(this,gb,!!((dU=globalThis.FontInspector)!=null&&dU.enabled));x(this,hd,null);x(this,ol,null);x(this,yb,0);x(this,vb,0);x(this,dd,null);x(this,Um,null);x(this,Vm,0);x(this,Yc,0);x(this,Bm,Object.create(null));x(this,wb,[]);x(this,zm,null);x(this,fd,[]);x(this,bb,new WeakMap);x(this,_b,null);var l;if(e instanceof ReadableStream)A(this,zm,e);else if(typeof e=="object")A(this,zm,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');A(this,ms,A(this,Um,t)),A(this,Yc,r.scale*Co.pixelRatio),A(this,Vm,r.rotation),A(this,ol,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:i,pageX:a,pageY:o}=r.rawDims;A(this,_b,[1,0,0,-1,-a,o+i]),A(this,vb,s),A(this,yb,i),D(l=nn,KA,nW).call(l),Nf(t,r),c(this,qc).promise.finally(()=>{c(nn,Wm).delete(this),A(this,ol,null),A(this,Bm,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=mr.platform;return Ve(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,dd).read().then(({value:t,done:r})=>{if(r){c(this,qc).resolve();return}c(this,hd)??A(this,hd,t.lang),Object.assign(c(this,Bm),t.styles),D(this,qA,eW).call(this,t.items),e()},c(this,qc).reject)};return A(this,dd,c(this,zm).getReader()),c(nn,Wm).add(this),e(),c(this,qc).promise}update({viewport:e,onBefore:t=null}){var i;const r=e.scale*Co.pixelRatio,s=e.rotation;if(s!==c(this,Vm)&&(t==null||t(),A(this,Vm,s),Nf(c(this,Um),{rotation:s})),r!==c(this,Yc)){t==null||t(),A(this,Yc,r);const a={div:null,properties:null,ctx:D(i=nn,Gm,bE).call(i,c(this,hd))};for(const o of c(this,fd))a.properties=c(this,bb).get(o),a.div=o,D(this,Sb,ED).call(this,a)}}cancel(){var t;const e=new qu("TextLayer task cancelled.");(t=c(this,dd))==null||t.cancel(e).catch(()=>{}),A(this,dd,null),c(this,qc).reject(e)}get textDivs(){return c(this,fd)}get textContentItemsStr(){return c(this,wb)}static cleanup(){if(!(c(this,Wm).size>0)){c(this,Hm).clear();for(const{canvas:e}of c(this,pd).values())e.remove();c(this,pd).clear()}}};qc=new WeakMap,ms=new WeakMap,mb=new WeakMap,gb=new WeakMap,hd=new WeakMap,ol=new WeakMap,yb=new WeakMap,vb=new WeakMap,dd=new WeakMap,Um=new WeakMap,Vm=new WeakMap,Yc=new WeakMap,Bm=new WeakMap,wb=new WeakMap,zm=new WeakMap,fd=new WeakMap,bb=new WeakMap,_b=new WeakMap,Hm=new WeakMap,pd=new WeakMap,xb=new WeakMap,Kc=new WeakMap,Wm=new WeakMap,qA=new WeakSet,eW=function(e){var s,i;if(c(this,mb))return;(i=c(this,ol)).ctx??(i.ctx=D(s=nn,Gm,bE).call(s,c(this,hd)));const t=c(this,fd),r=c(this,wb);for(const a of e){if(t.length>h1e){Oe("Ignoring additional textDivs for performance reasons."),A(this,mb,!0);return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const o=c(this,ms);A(this,ms,document.createElement("span")),c(this,ms).classList.add("markedContent"),a.id&&c(this,ms).setAttribute("id",`${a.id}`),o.append(c(this,ms))}else a.type==="endMarkedContent"&&A(this,ms,c(this,ms).parentNode);continue}r.push(a.str),D(this,YA,tW).call(this,a)}},YA=new WeakSet,tW=function(e){var y;const t=document.createElement("span"),r={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,fd).push(t);const s=ye.transform(c(this,_b),e.transform);let i=Math.atan2(s[1],s[0]);const a=c(this,Bm)[e.fontName];a.vertical&&(i+=Math.PI/2);let o=c(this,gb)&&a.fontSubstitution||a.fontFamily;o=nn.fontFamilyMap.get(o)||o;const l=Math.hypot(s[2],s[3]),u=l*D(y=nn,XA,rW).call(y,o,a,c(this,hd));let h,f;i===0?(h=s[4],f=s[5]-u):(h=s[4]+u*Math.sin(i),f=s[5]-u*Math.cos(i));const p="calc(var(--total-scale-factor) *",g=t.style;c(this,ms)===c(this,Um)?(g.left=`${(100*h/c(this,vb)).toFixed(2)}%`,g.top=`${(100*f/c(this,yb)).toFixed(2)}%`):(g.left=`${p}${h.toFixed(2)}px)`,g.top=`${p}${f.toFixed(2)}px)`),g.fontSize=`${p}${(c(nn,Kc)*l).toFixed(2)}px)`,g.fontFamily=o,r.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,gb)&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),i!==0&&(r.angle=i*(180/Math.PI));let v=!1;if(e.str.length>1)v=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),w=Math.abs(e.transform[3]);_!==w&&Math.max(_,w)/Math.min(_,w)>1.5&&(v=!0)}if(v&&(r.canvasWidth=a.vertical?e.height:e.width),c(this,bb).set(t,r),c(this,ol).div=t,c(this,ol).properties=r,D(this,Sb,ED).call(this,c(this,ol)),r.hasText&&c(this,ms).append(t),r.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),c(this,ms).append(_)}},Sb=new WeakSet,ED=function(e){var o;const{div:t,properties:r,ctx:s}=e,{style:i}=t;let a="";if(c(nn,Kc)>1&&(a=`scale(${1/c(nn,Kc)})`),r.canvasWidth!==0&&r.hasText){const{fontFamily:l}=i,{canvasWidth:u,fontSize:h}=r;D(o=nn,Eb,AD).call(o,s,h*c(this,Yc),l);const{width:f}=s.measureText(t.textContent);f>0&&(a=`scaleX(${u*c(this,Yc)/f}) ${a}`)}r.angle!==0&&(a=`rotate(${r.angle}deg) ${a}`),a.length>0&&(i.transform=a)},Gm=new WeakSet,bE=function(e=null){let t=c(this,pd).get(e||(e=""));if(!t){const r=document.createElement("canvas");r.className="hiddenCanvasElement",r.lang=e,document.body.append(r),t=r.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,pd).set(e,t),c(this,xb).set(t,{size:0,family:""})}return t},Eb=new WeakSet,AD=function(e,t,r){const s=c(this,xb).get(e);t===s.size&&r===s.family||(e.font=`${t}px ${r}`,s.size=t,s.family=r)},KA=new WeakSet,nW=function(){if(c(this,Kc)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),A(this,Kc,e.getBoundingClientRect().height),e.remove()},XA=new WeakSet,rW=function(e,t,r){const s=c(this,Hm).get(e);if(s)return s;const i=D(this,Gm,bE).call(this,r);i.canvas.width=i.canvas.height=lU,D(this,Eb,AD).call(this,i,lU,e);const a=i.measureText(""),o=a.fontBoundingBoxAscent,l=Math.abs(a.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let u=.8;return o?u=o/(o+l):(mr.platform.isFirefox&&Oe("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?u=t.ascent:t.descent&&(u=1+t.descent)),c(this,Hm).set(e,u),u},x(nn,Gm),x(nn,Eb),x(nn,KA),x(nn,XA),x(nn,Hm,new Map),x(nn,pd,new Map),x(nn,xb,new WeakMap),x(nn,Kc,null),x(nn,Wm,new Set);let ow=nn;const d1e=100;function CO(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new TD,{docId:t}=e,r=n.url?wEe(n.url):null,s=n.data?bEe(n.data):null,i=n.httpHeaders||null,a=n.withCredentials===!0,o=n.password??null,l=n.range instanceof sW?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let h=n.worker instanceof lw?n.worker:null;const f=n.verbosity,p=typeof n.docBaseUrl=="string"&&!_k(n.docBaseUrl)?n.docBaseUrl:null,g=ES(n.cMapUrl),v=n.cMapPacked!==!1,y=n.CMapReaderFactory||(Qr?kEe:Y4),_=ES(n.iccUrl),w=ES(n.standardFontDataUrl),b=n.StandardFontDataFactory||(Qr?NEe:K4),S=ES(n.wasmUrl),T=n.WasmFactory||(Qr?PEe:X4),P=n.stopAtErrors!==!0,R=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,k=n.isEvalSupported!==!1,C=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Qr,I=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Qr&&(mr.platform.isFirefox||!globalThis.chrome),M=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,L=typeof n.disableFontFace=="boolean"?n.disableFontFace:Qr,F=n.fontExtraProperties===!0,O=n.enableXfa===!0,Y=n.ownerDocument||globalThis.document,Z=n.disableRange===!0,X=n.disableStream===!0,J=n.disableAutoFetch===!0,K=n.pdfBug===!0,te=n.CanvasFactory||(Qr?CEe:EEe),ae=n.FilterFactory||(Qr?TEe:AEe),q=n.enableHWA===!0,$=n.useWasm!==!1,U=l?l.length:n.length??NaN,G=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Qr&&!L,V=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(y===Y4&&b===K4&&T===X4&&g&&w&&S&&Tv(g,document.baseURI)&&Tv(w,document.baseURI)&&Tv(S,document.baseURI)),ee=null;qSe(f);const re={canvasFactory:new te({ownerDocument:Y,enableHWA:q}),filterFactory:new ae({docId:t,ownerDocument:Y}),cMapReaderFactory:V?null:new y({baseUrl:g,isCompressed:v}),standardFontDataFactory:V?null:new b({baseUrl:w}),wasmFactory:V?null:new T({baseUrl:S})};h||(h=lw.create({verbosity:f,port:ga.workerPort}),e._worker=h);const ce={docId:t,apiVersion:"5.4.296",data:s,password:o,disableAutoFetch:J,rangeChunkSize:u,length:U,docBaseUrl:p,enableXfa:O,evaluatorOptions:{maxImageSize:R,disableFontFace:L,ignoreErrors:P,isEvalSupported:k,isOffscreenCanvasSupported:C,isImageDecoderSupported:I,canvasMaxAreaInBytes:M,fontExtraProperties:F,useSystemFonts:G,useWasm:$,useWorkerFetch:V,cMapUrl:g,iccUrl:_,standardFontDataUrl:w,wasmUrl:S}},Ae={ownerDocument:Y,pdfBug:K,styleElement:ee,loadingParams:{disableAutoFetch:J,enableXfa:O}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const _e=h.messageHandler.sendWithPromise("GetDocRequest",ce,s?[s.buffer]:null);let xe;if(l)xe=new YEe(l,{disableRange:Z,disableStream:X});else if(!s){if(!r)throw new Error("getDocument - no `url` parameter provided.");const ke=Tv(r)?JEe:Qr?l1e:r1e;xe=new ke({url:r,length:U,httpHeaders:i,withCredentials:a,rangeChunkSize:u,disableRange:Z,disableStream:X})}return _e.then(ke=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ye=new Dv(t,ke,h.port),Ke=new m1e(Ye,e,xe,Ae,re,q);e._transport=Ke,Ye.send("Ready",null)})}).catch(e._capability.reject),e}var QA;const JA=class JA{constructor(){ie(this,"_capability",Promise.withResolvers());ie(this,"_transport",null);ie(this,"_worker",null);ie(this,"docId",`d${Cn(JA,QA)._++}`);ie(this,"destroyed",!1);ie(this,"onPassword",null);ie(this,"onProgress",null)}get promise(){return this._capability.promise}async destroy(){var e,t,r,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(i){throw(r=this._worker)!=null&&r.port&&delete this._worker._pendingDestroy,i}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}async getData(){return this._transport.getData()}};QA=new WeakMap,x(JA,QA,0);let TD=JA;var md,Ab,Tb,Cb,kb;class sW{constructor(e,t,r=!1,s=null){x(this,md,Promise.withResolvers());x(this,Ab,[]);x(this,Tb,[]);x(this,Cb,[]);x(this,kb,[]);this.length=e,this.initialData=t,this.progressiveDone=r,this.contentDispositionFilename=s}addRangeListener(e){c(this,kb).push(e)}addProgressListener(e){c(this,Cb).push(e)}addProgressiveReadListener(e){c(this,Tb).push(e)}addProgressiveDoneListener(e){c(this,Ab).push(e)}onDataRange(e,t){for(const r of c(this,kb))r(e,t)}onDataProgress(e,t){c(this,md).promise.then(()=>{for(const r of c(this,Cb))r(e,t)})}onDataProgressiveRead(e){c(this,md).promise.then(()=>{for(const t of c(this,Tb))t(e)})}onDataProgressiveDone(){c(this,md).promise.then(()=>{for(const e of c(this,Ab))e()})}transportReady(){c(this,md).resolve()}requestDataRange(e,t){Tt("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}md=new WeakMap,Ab=new WeakMap,Tb=new WeakMap,Cb=new WeakMap,kb=new WeakMap;class f1e{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var ll,gd,$v;class p1e{constructor(e,t,r,s=!1){x(this,gd);x(this,ll,!1);this._pageIndex=e,this._pageInfo=t,this._transport=r,this._stats=s?new V4:null,this._pdfBug=s,this.commonObjs=r.commonObjs,this.objs=new Z9,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:r=0,offsetY:s=0,dontFlip:i=!1}={}){return new Sx({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:r,offsetY:s,dontFlip:i})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ve(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,canvas:t=e.canvas,viewport:r,intent:s="display",annotationMode:i=_c.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:l=null,annotationCanvasMap:u=null,pageColors:h=null,printAnnotationStorage:f=null,isEditing:p=!1,recordOperations:g=!1,operationsFilter:v=null}){var I,M,L;(I=this._stats)==null||I.time("Overall");const y=this._transport.getRenderingIntent(s,i,f,p),{renderingIntent:_,cacheKey:w}=y;A(this,ll,!1),l||(l=this._transport.getOptionalContentConfig(_));let b=this._intentStates.get(w);b||(b=Object.create(null),this._intentStates.set(w,b)),b.streamReaderCancelTimeout&&(clearTimeout(b.streamReaderCancelTimeout),b.streamReaderCancelTimeout=null);const S=!!(_&ti.PRINT);b.displayReadyCapability||(b.displayReadyCapability=Promise.withResolvers(),b.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(M=this._stats)==null||M.time("Page Request"),this._pumpOperatorList(y));const T=!!(this._pdfBug&&((L=globalThis.StepperManager)!=null&&L.enabled)),P=!this.recordedBBoxes&&(g||T),R=F=>{var O,Y;if(b.renderTasks.delete(k),P){const Z=(O=k.gfx)==null?void 0:O.dependencyTracker.take();Z&&(k.stepper&&k.stepper.setOperatorBBoxes(Z,k.gfx.dependencyTracker.takeDebugMetadata()),g&&(this.recordedBBoxes=Z))}S&&A(this,ll,!0),D(this,gd,$v).call(this),F?(k.capability.reject(F),this._abortOperatorList({intentState:b,reason:F instanceof Error?F:new Error(F)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(Y=globalThis.Stats)!=null&&Y.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new CD({callback:R,params:{canvas:t,canvasContext:e,dependencyTracker:P?new DEe(t,b.operatorList.length,T):null,viewport:r,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:u,operatorList:b.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:h,enableHWA:this._transport.enableHWA,operationsFilter:v});(b.renderTasks||(b.renderTasks=new Set)).add(k);const C=k.task;return Promise.all([b.displayReadyCapability.promise,l]).then(([F,O])=>{var Y;if(this.destroyed){R();return}if((Y=this._stats)==null||Y.time("Rendering"),!(O.renderingIntent&_))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:F,optionalContentConfig:O}),k.operatorListChanged()}).catch(R),C}getOperatorList({intent:e="display",annotationMode:t=_c.ENABLE,printAnnotationStorage:r=null,isEditing:s=!1}={}){var u;function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(l))}const a=this._transport.getRenderingIntent(e,t,r,s,!0);let o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let l;return o.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||(o.renderTasks=new Set)).add(l),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(r=>aw.textContent(r));const t=this.streamTextContent(e);return new Promise(function(r,s){function i(){a.read().then(function({value:l,done:u}){if(u){r(o);return}o.lang??(o.lang=l.lang),Object.assign(o.styles,l.styles),o.items.push(...l.items),i()},s)}const a=t.getReader(),o={items:[],styles:Object.create(null),lang:null};i()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const r of t.renderTasks)e.push(r.completed),r.cancel();return this.objs.clear(),A(this,ll,!1),Promise.all(e)}cleanup(e=!1){A(this,ll,!0);const t=D(this,gd,$v).call(this);return e&&t&&this._stats&&(this._stats=new V4),t}_startRenderPage(e,t){var s,i;const r=this._intentStates.get(t);r&&((s=this._stats)==null||s.timeEnd("Page Request"),(i=r.displayReadyCapability)==null||i.resolve(e))}_renderPageChunk(e,t){for(let r=0,s=e.length;r<s;r++)t.operatorList.fnArray.push(e.fnArray[r]),t.operatorList.argsArray.push(e.argsArray[r]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const r of t.renderTasks)r.operatorListChanged();e.lastChunk&&D(this,gd,$v).call(this)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:r,modifiedIds:s}){const{map:i,transfer:a}=r,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:s},a).getReader(),u=this._intentStates.get(t);u.streamReader=l;const h=()=>{l.read().then(({value:f,done:p})=>{if(p){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,u),h())},f=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const p of u.renderTasks)p.operatorListChanged();D(this,gd,$v).call(this)}if(u.displayReadyCapability)u.displayReadyCapability.reject(f);else if(u.opListReadCapability)u.opListReadCapability.reject(f);else throw f}})};h()}_abortOperatorList({intentState:e,reason:t,force:r=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!r){if(e.renderTasks.size>0)return;if(t instanceof xO){let s=d1e;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new qu(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,i]of this._intentStates)if(i===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}ll=new WeakMap,gd=new WeakSet,$v=function(){if(!c(this,ll)||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),A(this,ll,!1),!0};var Xc,aa,cl,yd,ZA,vd,wd,qm,_E,eT,iW,tT,aW,bd,Uv,Ym,xE;const zt=class zt{constructor({name:e=null,port:t=null,verbosity:r=YSe()}={}){x(this,qm);x(this,eT);x(this,tT);x(this,bd);x(this,Xc,Promise.withResolvers());x(this,aa,null);x(this,cl,null);x(this,yd,null);if(this.name=e,this.destroyed=!1,this.verbosity=r,t){if(c(zt,wd).has(t))throw new Error("Cannot use more than one PDFWorker per port.");c(zt,wd).set(t,this),D(this,eT,iW).call(this,t)}else D(this,tT,aW).call(this)}get promise(){return c(this,Xc).promise}get port(){return c(this,cl)}get messageHandler(){return c(this,aa)}destroy(){var e,t;this.destroyed=!0,(e=c(this,yd))==null||e.terminate(),A(this,yd,null),c(zt,wd).delete(c(this,cl)),A(this,cl,null),(t=c(this,aa))==null||t.destroy(),A(this,aa,null)}static create(e){const t=c(this,wd).get(e==null?void 0:e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new zt(e)}static get workerSrc(){if(ga.workerSrc)return ga.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ve(this,"_setupFakeWorkerGlobal",(async()=>c(this,Ym,xE)?c(this,Ym,xE):(await UI(()=>import(this.workerSrc),[])).WorkerMessageHandler)())}};Xc=new WeakMap,aa=new WeakMap,cl=new WeakMap,yd=new WeakMap,ZA=new WeakMap,vd=new WeakMap,wd=new WeakMap,qm=new WeakSet,_E=function(){c(this,Xc).resolve(),c(this,aa).send("configure",{verbosity:this.verbosity})},eT=new WeakSet,iW=function(e){A(this,cl,e),A(this,aa,new Dv("main","worker",e)),c(this,aa).on("ready",()=>{}),D(this,qm,_E).call(this)},tT=new WeakSet,aW=function(){if(c(zt,vd)||c(zt,Ym,xE)){D(this,bd,Uv).call(this);return}let{workerSrc:e}=zt;try{zt._isSameOrigin(window.location,e)||(e=zt._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),r=new Dv("main","worker",t),s=()=>{i.abort(),r.destroy(),t.terminate(),this.destroyed?c(this,Xc).reject(new Error("Worker was destroyed")):D(this,bd,Uv).call(this)},i=new AbortController;t.addEventListener("error",()=>{c(this,yd)||s()},{signal:i.signal}),r.on("test",o=>{if(i.abort(),this.destroyed||!o){s();return}A(this,aa,r),A(this,cl,t),A(this,yd,t),D(this,qm,_E).call(this)}),r.on("ready",o=>{if(i.abort(),this.destroyed){s();return}try{a()}catch{D(this,bd,Uv).call(this)}});const a=()=>{const o=new Uint8Array;r.send("test",o,[o.buffer])};a();return}catch{bk("The worker has been disabled.")}D(this,bd,Uv).call(this)},bd=new WeakSet,Uv=function(){c(zt,vd)||(Oe("Setting up fake worker."),A(zt,vd,!0)),zt._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){c(this,Xc).reject(new Error("Worker was destroyed"));return}const t=new SEe;A(this,cl,t);const r=`fake${Cn(zt,ZA)._++}`,s=new Dv(r+"_worker",r,t);e.setup(s,t),A(this,aa,new Dv(r,r+"_worker",t)),D(this,qm,_E).call(this)}).catch(e=>{c(this,Xc).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Ym=new WeakSet,xE=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},x(zt,Ym),x(zt,ZA,0),x(zt,vd,!1),x(zt,wd,new WeakMap),Qr&&(A(zt,vd,!0),ga.workerSrc||(ga.workerSrc="./pdf.worker.mjs")),zt._isSameOrigin=(e,t)=>{const r=URL.parse(e);if(!(r!=null&&r.origin)||r.origin==="null")return!1;const s=new URL(t,r);return r.origin===s.origin},zt._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},zt.fromPort=e=>{if(aEe("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return zt.create(e)};let lw=zt;var ul,Ja,Km,Xm,hl,_d,Vv;class m1e{constructor(e,t,r,s,i,a){x(this,_d);x(this,ul,new Map);x(this,Ja,new Map);x(this,Km,new Map);x(this,Xm,new Map);x(this,hl,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new Z9,this.fontLoader=new yEe({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=r,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}get annotationStorage(){return Ve(this,"annotationStorage",new EO)}getRenderingIntent(e,t=_c.ENABLE,r=null,s=!1,i=!1){let a=ti.DISPLAY,o=uD;switch(e){case"any":a=ti.ANY;break;case"display":break;case"print":a=ti.PRINT;break;default:Oe(`getRenderingIntent - invalid intent: ${e}`)}const l=a&ti.PRINT&&r instanceof j9?r:this.annotationStorage;switch(t){case _c.DISABLE:a+=ti.ANNOTATIONS_DISABLE;break;case _c.ENABLE:break;case _c.ENABLE_FORMS:a+=ti.ANNOTATIONS_FORMS;break;case _c.ENABLE_STORAGE:a+=ti.ANNOTATIONS_STORAGE,o=l.serializable;break;default:Oe(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(a+=ti.IS_EDITING),i&&(a+=ti.OPLIST);const{ids:u,hash:h}=l.modifiedIds,f=[a,o.hash,h];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:o,modifiedIds:u}}destroy(){var r;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(r=c(this,hl))==null||r.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of c(this,Ja).values())e.push(s._destroy());c(this,Ja).clear(),c(this,Km).clear(),c(this,Xm).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,i;this.commonObjs.clear(),this.fontLoader.clear(),c(this,ul).clear(),this.filterFactory.destroy(),ow.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new qu("Worker was terminated.")),(i=this.messageHandler)==null||i.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(r,s)=>{Je(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=i=>{this._lastProgress={loaded:i.loaded,total:i.total}},s.onPull=()=>{this._fullReader.read().then(function({value:i,done:a}){if(a){s.close();return}Je(i instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(i),1,[i])}).catch(i=>{s.error(i)})},s.onCancel=i=>{this._fullReader.cancel(i),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async r=>{var o;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:i,contentLength:a}=this._fullReader;return(!s||!i)&&(this._lastProgress&&((o=t.onProgress)==null||o.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:i,contentLength:a}}),e.on("GetRangeReader",(r,s)=>{Je(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const i=this._networkStream.getRangeReader(r.begin,r.end);if(!i){s.close();return}s.onPull=()=>{i.read().then(function({value:a,done:o}){if(o){s.close();return}Je(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{i.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("GetDoc",({pdfInfo:r})=>{this._numPages=r.numPages,this._htmlForXfa=r.htmlForXfa,delete r.htmlForXfa,t._capability.resolve(new f1e(r,this))}),e.on("DocException",r=>{t._capability.reject(ls(r))}),e.on("PasswordRequest",r=>{A(this,hl,Promise.withResolvers());try{if(!t.onPassword)throw ls(r);const s=i=>{i instanceof Error?c(this,hl).reject(i):c(this,hl).resolve({password:i})};t.onPassword(s,r.code)}catch(s){c(this,hl).reject(s)}return c(this,hl).promise}),e.on("DataLoaded",r=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:r.length,total:r.length}),this.downloadInfoCapability.resolve(r)}),e.on("StartRenderPage",r=>{if(this.destroyed)return;c(this,Ja).get(r.pageIndex)._startRenderPage(r.transparency,r.cacheKey)}),e.on("commonobj",([r,s,i])=>{var a;if(this.destroyed||this.commonObjs.has(r))return null;switch(s){case"Font":if("error"in i){const f=i.error;Oe(`Error during font loading: ${f}`),this.commonObjs.resolve(r,f);break}const o=new _D(i),l=this._params.pdfBug&&((a=globalThis.FontInspector)!=null&&a.enabled)?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,u=new vEe(o,l,i.extra,i.charProcOperatorList);this.fontLoader.bind(u).catch(()=>e.sendWithPromise("FontFallback",{id:r})).finally(()=>{!u.fontExtraProperties&&u.data&&u.clearData(),this.commonObjs.resolve(r,u)});break;case"CopyLocalImage":const{imageRef:h}=i;Je(h,"The imageRef must be defined.");for(const f of c(this,Ja).values())for(const[,p]of f.objs)if((p==null?void 0:p.ref)===h)return p.dataLen?(this.commonObjs.resolve(r,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(r,i);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([r,s,i,a])=>{var l;if(this.destroyed)return;const o=c(this,Ja).get(s);if(!o.objs.has(r)){if(o._intentStates.size===0){(l=a==null?void 0:a.bitmap)==null||l.close();return}switch(i){case"Image":case"Pattern":o.objs.resolve(r,a);break;default:throw new Error(`Got unknown object type ${i}`)}}}),e.on("DocProgress",r=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:r.loaded,total:r.total})}),e.on("FetchBinaryData",async r=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[r.type];if(!s)throw new Error(`${r.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(r)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var r;this.annotationStorage.size<=0&&Oe("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((r=this._fullReader)==null?void 0:r.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,r=c(this,Km).get(t);if(r)return r;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(i=>{if(this.destroyed)throw new Error("Transport destroyed");i.refStr&&c(this,Xm).set(i.refStr,e);const a=new p1e(t,i,this,this._params.pdfBug);return c(this,Ja).set(t,a),a});return c(this,Km).set(t,s),s}getPageIndex(e){return hD(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return D(this,_d,Vv).call(this,"GetFieldObjects")}hasJSActions(){return D(this,_d,Vv).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return D(this,_d,Vv).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return D(this,_d,Vv).call(this,"GetOptionalContentConfig").then(t=>new qEe(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,ul).get(e);if(t)return t;const r=this.messageHandler.sendWithPromise(e,null).then(s=>{var i,a;return{info:s[0],metadata:s[1]?new WEe(s[1]):null,contentDispositionFilename:((i=this._fullReader)==null?void 0:i.filename)??null,contentLength:((a=this._fullReader)==null?void 0:a.contentLength)??null}});return c(this,ul).set(e,r),r}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,Ja).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,ul).clear(),this.filterFactory.destroy(!0),ow.cleanup()}}cachedPageNumber(e){if(!hD(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,Xm).get(t)??null}}ul=new WeakMap,Ja=new WeakMap,Km=new WeakMap,Xm=new WeakMap,hl=new WeakMap,_d=new WeakSet,Vv=function(e,t=null){const r=c(this,ul).get(e);if(r)return r;const s=this.messageHandler.sendWithPromise(e,t);return c(this,ul).set(e,s),s};var Qc;class g1e{constructor(e){x(this,Qc,null);ie(this,"onContinue",null);ie(this,"onError",null);A(this,Qc,e)}get promise(){return c(this,Qc).capability.promise}cancel(e=0){c(this,Qc).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,Qc).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,Qc);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}Qc=new WeakMap;var Jc,xd;const bh=class bh{constructor({callback:e,params:t,objs:r,commonObjs:s,annotationCanvasMap:i,operatorList:a,pageIndex:o,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:f=!1,pageColors:p=null,enableHWA:g=!1,operationsFilter:v=null}){x(this,Jc,null);this.callback=e,this.params=t,this.objs=r,this.commonObjs=s,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=f,this.pageColors=p,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new g1e(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=g,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=v}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var l,u;if(this.cancelled)return;if(this._canvas){if(c(bh,xd).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(bh,xd).add(this._canvas)}this._pdfBug&&((l=globalThis.StepperManager)!=null&&l.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:r,transform:s,background:i,dependencyTracker:a}=this.params,o=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new qp(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:s,viewport:r,transparency:e,background:i}),this.operatorListIdx=0,this.graphicsReady=!0,(u=this.graphicsReadyCallback)==null||u.call(this)}cancel(e=null,t=0){var r,s,i;this.running=!1,this.cancelled=!0,(r=this.gfx)==null||r.endDrawing(),c(this,Jc)&&(window.cancelAnimationFrame(c(this,Jc)),A(this,Jc,null)),c(bh,xd).delete(this._canvas),e||(e=new xO(`Rendering cancelled, page ${this._pageIndex+1}`,t)),this.callback(e),(i=(s=this.task).onError)==null||i.call(s,e)}operatorListChanged(){var e,t;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.gfx.dependencyTracker)==null||e.growOperationsCount(this.operatorList.fnArray.length),(t=this.stepper)==null||t.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?A(this,Jc,window.requestAnimationFrame(()=>{A(this,Jc,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(bh,xd).delete(this._canvas),this.callback())))}};Jc=new WeakMap,xd=new WeakMap,x(bh,xd,new WeakSet);let CD=bh;const y1e="5.4.296",v1e="f56dc8601";var zs,Sd,Qm,Pn,Nb,Jm,dl,Pb,Zc,oa,Ib,Db,kD,Rb,ND,Mb,PD,fl,ph,nT,oW,Za,hc;const cs=class cs{constructor({editor:e=null,uiManager:t=null}){x(this,Db);x(this,Rb);x(this,Mb);x(this,fl);x(this,nT);x(this,Za);x(this,zs,null);x(this,Sd,null);x(this,Qm,void 0);x(this,Pn,null);x(this,Nb,!1);x(this,Jm,!1);x(this,dl,null);x(this,Pb,void 0);x(this,Zc,null);x(this,oa,null);var r,s;e?(A(this,Jm,!1),A(this,dl,e)):A(this,Jm,!0),A(this,oa,(e==null?void 0:e._uiManager)||t),A(this,Pb,c(this,oa)._eventBus),A(this,Qm,((r=e==null?void 0:e.color)==null?void 0:r.toUpperCase())||((s=c(this,oa))==null?void 0:s.highlightColors.values().next().value)||"#FFFF98"),c(cs,Ib)||A(cs,Ib,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return Ve(this,"_keyboardManager",new Ax([[["Escape","mac+Escape"],cs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],cs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],cs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],cs.prototype._moveToPrevious],[["Home","mac+Home"],cs.prototype._moveToBeginning],[["End","mac+End"],cs.prototype._moveToEnd]]))}renderButton(){const e=A(this,zs,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",c(this,dl)&&(e.ariaControls=`${c(this,dl).id}_colorpicker_dropdown`);const t=c(this,oa)._signal;e.addEventListener("click",D(this,fl,ph).bind(this),{signal:t}),e.addEventListener("keydown",D(this,Mb,PD).bind(this),{signal:t});const r=A(this,Sd,document.createElement("span"));return r.className="swatch",r.ariaHidden="true",r.style.backgroundColor=c(this,Qm),e.append(r),e}renderMainDropdown(){const e=A(this,Pn,D(this,Db,kD).call(this));return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}_colorSelectFromKeyboard(e){if(e.target===c(this,zs)){D(this,fl,ph).call(this,e);return}const t=e.target.getAttribute("data-color");t&&D(this,Rb,ND).call(this,t,e)}_moveToNext(e){var t,r;if(!c(this,Za,hc)){D(this,fl,ph).call(this,e);return}if(e.target===c(this,zs)){(t=c(this,Pn).firstChild)==null||t.focus();return}(r=e.target.nextSibling)==null||r.focus()}_moveToPrevious(e){var t,r;if(e.target===((t=c(this,Pn))==null?void 0:t.firstChild)||e.target===c(this,zs)){c(this,Za,hc)&&this._hideDropdownFromKeyboard();return}c(this,Za,hc)||D(this,fl,ph).call(this,e),(r=e.target.previousSibling)==null||r.focus()}_moveToBeginning(e){var t;if(!c(this,Za,hc)){D(this,fl,ph).call(this,e);return}(t=c(this,Pn).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Za,hc)){D(this,fl,ph).call(this,e);return}(t=c(this,Pn).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,Pn))==null||e.classList.add("hidden"),c(this,zs).ariaExpanded="false",(t=c(this,Zc))==null||t.abort(),A(this,Zc,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,Jm)){if(!c(this,Za,hc)){(e=c(this,dl))==null||e.unselect();return}this.hideDropdown(),c(this,zs).focus({preventScroll:!0,focusVisible:c(this,Nb)})}}updateColor(e){if(c(this,Sd)&&(c(this,Sd).style.backgroundColor=e),!c(this,Pn))return;const t=c(this,oa).highlightColors.values();for(const r of c(this,Pn).children)r.ariaSelected=t.next().value===e.toUpperCase()}destroy(){var e,t;(e=c(this,zs))==null||e.remove(),A(this,zs,null),A(this,Sd,null),(t=c(this,Pn))==null||t.remove(),A(this,Pn,null)}};zs=new WeakMap,Sd=new WeakMap,Qm=new WeakMap,Pn=new WeakMap,Nb=new WeakMap,Jm=new WeakMap,dl=new WeakMap,Pb=new WeakMap,Zc=new WeakMap,oa=new WeakMap,Ib=new WeakMap,Db=new WeakSet,kD=function(){const e=document.createElement("div"),t=c(this,oa)._signal;e.addEventListener("contextmenu",Hi,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),c(this,dl)&&(e.id=`${c(this,dl).id}_colorpicker_dropdown`);for(const[r,s]of c(this,oa).highlightColors){const i=document.createElement("button");i.tabIndex="0",i.role="option",i.setAttribute("data-color",s),i.title=r,i.setAttribute("data-l10n-id",c(cs,Ib)[r]);const a=document.createElement("span");i.append(a),a.className="swatch",a.style.backgroundColor=s,i.ariaSelected=s===c(this,Qm),i.addEventListener("click",D(this,Rb,ND).bind(this,s),{signal:t}),e.append(i)}return e.addEventListener("keydown",D(this,Mb,PD).bind(this),{signal:t}),e},Rb=new WeakSet,ND=function(e,t){t.stopPropagation(),c(this,Pb).dispatch("switchannotationeditorparams",{source:this,type:Qe.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)},Mb=new WeakSet,PD=function(e){cs._keyboardManager.exec(this,e)},fl=new WeakSet,ph=function(e){if(c(this,Za,hc)){this.hideDropdown();return}if(A(this,Nb,e.detail===0),c(this,Zc)||(A(this,Zc,new AbortController),window.addEventListener("pointerdown",D(this,nT,oW).bind(this),{signal:c(this,oa).combinedSignal(c(this,Zc))})),c(this,zs).ariaExpanded="true",c(this,Pn)){c(this,Pn).classList.remove("hidden");return}const t=A(this,Pn,D(this,Db,kD).call(this));c(this,zs).append(t)},nT=new WeakSet,oW=function(e){var t;(t=c(this,Pn))!=null&&t.contains(e.target)||this.hideDropdown()},Za=new WeakSet,hc=function(){return c(this,Pn)&&!c(this,Pn).classList.contains("hidden")},x(cs,Ib,null);let nA=cs;var eo,Ob,Zm,Lb;const _h=class _h{constructor(e){x(this,eo,null);x(this,Ob,null);x(this,Zm,null);A(this,Ob,e),A(this,Zm,e._uiManager),c(_h,Lb)||A(_h,Lb,Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"}))}renderButton(){if(c(this,eo))return c(this,eo);const{editorType:e,colorType:t,colorValue:r}=c(this,Ob),s=A(this,eo,document.createElement("input"));return s.type="color",s.value=r||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",c(_h,Lb)[e]),s.addEventListener("input",()=>{c(this,Zm).updateParams(t,s.value)},{signal:c(this,Zm)._signal}),s}update(e){c(this,eo)&&(c(this,eo).value=e)}destroy(){var e;(e=c(this,eo))==null||e.remove(),A(this,eo,null)}hideDropdown(){}};eo=new WeakMap,Ob=new WeakMap,Zm=new WeakMap,Lb=new WeakMap,x(_h,Lb,null);let rA=_h;function cU(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function fv(n){return Math.max(0,Math.min(255,255*n))}class uU{static CMYK_G([e,t,r,s]){return["G",1-Math.min(1,.3*e+.59*r+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=fv(e),[e,e,e]}static G_HTML([e]){const t=cU(e);return`#${t}${t}${t}`}static RGB_G([e,t,r]){return["G",.3*e+.59*t+.11*r]}static RGB_rgb(e){return e.map(fv)}static RGB_HTML(e){return`#${e.map(cU).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,r,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,r+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,r,s]){return[fv(1-Math.min(1,e+s)),fv(1-Math.min(1,r+s)),fv(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,r]){const s=1-e,i=1-t,a=1-r,o=Math.min(s,i,a);return["CMYK",s,i,a,o]}}class w1e{create(e,t,r=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),r||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Tt("Abstract method `_createSVG` called.")}}class sA extends w1e{_createSVG(e){return document.createElementNS(Lo,e)}}const b1e=9,If=new WeakSet,_1e=new Date().getTimezoneOffset()*60*1e3;class hU{static create(e){switch(e.data.annotationType){case _n.LINK:return new kO(e);case _n.TEXT:return new S1e(e);case _n.WIDGET:switch(e.data.fieldType){case"Tx":return new E1e(e);case"Btn":return e.data.radioButton?new uW(e):e.data.checkBox?new T1e(e):new C1e(e);case"Ch":return new k1e(e);case"Sig":return new A1e(e)}return new Bf(e);case _n.POPUP:return new DD(e);case _n.FREETEXT:return new mW(e);case _n.LINE:return new P1e(e);case _n.SQUARE:return new I1e(e);case _n.CIRCLE:return new D1e(e);case _n.POLYLINE:return new gW(e);case _n.CARET:return new M1e(e);case _n.INK:return new NO(e);case _n.POLYGON:return new R1e(e);case _n.HIGHLIGHT:return new yW(e);case _n.UNDERLINE:return new O1e(e);case _n.SQUIGGLY:return new L1e(e);case _n.STRIKEOUT:return new j1e(e);case _n.STAMP:return new vW(e);case _n.FILEATTACHMENT:return new F1e(e);default:return new Jt(e)}}}var Ed,eg,Ti,jb,ID;const LO=class LO{constructor(e,{isRenderable:t=!1,ignoreBorder:r=!1,createQuadrilaterals:s=!1}={}){x(this,jb);x(this,Ed,null);x(this,eg,!1);x(this,Ti,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(r)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e!=null&&e.str||t!=null&&t.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return LO._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){var r;const{data:e}=this,t=(r=this.annotationStorage)==null?void 0:r.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){var o;const e=(o=this.annotationStorage)==null?void 0:o.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:r,rect:s}=this.data;let i=-1/0,a=-1/0;if((t==null?void 0:t.length)>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],i=t[l+2]):t[l+1]===a&&(i=Math.max(i,t[l+2]));return[i,a]}if((r==null?void 0:r.length)>=1){for(const l of r)for(let u=0,h=l.length;u<h;u+=2)l[u+1]>a?(a=l[u+1],i=l[u]):l[u+1]===a&&(i=Math.max(i,l[u]));if(i!==1/0)return[i,a]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:r,pageHeight:s,pageX:i,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/r,e[1]=100*(e[1]-a)/s,e}get commentText(){var t,r,s;const{data:e}=this;return((r=(t=this.annotationStorage.getRawValue(`${sw}${e.id}`))==null?void 0:t.popup)==null?void 0:r.contents)||((s=e.contentsObj)==null?void 0:s.str)||""}set commentText(e){const{data:t}=this,r={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:r})||this.annotationStorage.setValue(`${sw}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:r,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){var e,t;(t=((e=c(this,Ti))==null?void 0:e.popup)||this.popup)==null||t.remove(),A(this,Ti,this.popup=null)}updateEdited(e){var i;if(!this.container)return;e.rect&&(c(this,Ed)||A(this,Ed,{rect:this.data.rect.slice(0)}));const{rect:t,popup:r}=e;t&&D(this,jb,ID).call(this,t);let s=((i=c(this,Ti))==null?void 0:i.popup)||this.popup;!s&&(r!=null&&r.text)&&(this._createPopup(r),s=c(this,Ti).popup),s&&(s.updateEdited(e),r!=null&&r.deleted&&(s.remove(),A(this,Ti,null),this.popup=null))}resetEdited(){var e;c(this,Ed)&&(D(this,jb,ID).call(this,c(this,Ed).rect),(e=c(this,Ti))==null||e.popup.resetEdited(),A(this,Ed,null))}_createContainer(e){const{data:t,parent:{page:r,viewport:s}}=this,i=document.createElement("section");i.setAttribute("data-annotation-id",t.id),!(this instanceof Bf)&&!(this instanceof kO)&&(i.tabIndex=0);const{style:a}=i;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add("norotate"),!t.rect||this instanceof DD){const{rotation:y}=t;return!t.hasOwnCanvas&&y!==0&&this.setRotation(y,i),i}const{width:o,height:l}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const y=t.borderStyle.horizontalCornerRadius,_=t.borderStyle.verticalCornerRadius;if(y>0||_>0){const b=`calc(${y}px * var(--total-scale-factor)) / calc(${_}px * var(--total-scale-factor))`;a.borderRadius=b}else if(this instanceof uW){const b=`calc(${o}px * var(--total-scale-factor)) / calc(${l}px * var(--total-scale-factor))`;a.borderRadius=b}switch(t.borderStyle.style){case ip.SOLID:a.borderStyle="solid";break;case ip.DASHED:a.borderStyle="dashed";break;case ip.BEVELED:Oe("Unimplemented border style: beveled");break;case ip.INSET:Oe("Unimplemented border style: inset");break;case ip.UNDERLINE:a.borderBottomStyle="solid";break}const w=t.borderColor||null;w?(A(this,eg,!0),a.borderColor=ye.makeHexColor(w[0]|0,w[1]|0,w[2]|0)):a.borderWidth=0}const u=ye.normalizeRect([t.rect[0],r.view[3]-t.rect[1]+r.view[1],t.rect[2],r.view[3]-t.rect[3]+r.view[1]]),{pageWidth:h,pageHeight:f,pageX:p,pageY:g}=s.rawDims;a.left=`${100*(u[0]-p)/h}%`,a.top=`${100*(u[1]-g)/f}%`;const{rotation:v}=t;return t.hasOwnCanvas||v===0?(a.width=`${100*o/h}%`,a.height=`${100*l/f}%`):this.setRotation(v,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:r,pageHeight:s}=this.parent.viewport.rawDims;let{width:i,height:a}=this;e%180!==0&&([i,a]=[a,i]),t.style.width=`${100*i/r}%`,t.style.height=`${100*a/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,r,s)=>{const i=s.detail[t],a=i[0],o=i.slice(1);s.target.style[r]=uU[`${a}_HTML`](o),this.annotationStorage.setValue(this.data.id,{[r]:uU[`${a}_rgb`](o)})};return Ve(this,"_commonActions",{display:t=>{const{display:r}=t.detail,s=r%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:r===1||r===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:r}=t.detail;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:r,noView:r})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const r=t.detail.rotation;this.setRotation(r),this.annotationStorage.setValue(this.data.id,{rotation:r})}})}_dispatchEventFromSandbox(e,t){const r=this._commonActions;for(const s of Object.keys(t.detail)){const i=e[s]||r[s];i==null||i(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const r=this._commonActions;for(const[s,i]of Object.entries(t)){const a=r[s];if(a){const o={detail:{[s]:i},target:e};a(o),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,r,s,i]=this.data.rect.map(y=>Math.fround(y));if(e.length===8){const[y,_,w,b]=e.subarray(2,6);if(s===y&&i===_&&t===w&&r===b)return}const{style:a}=this.container;let o;if(c(this,eg)){const{borderColor:y,borderWidth:_}=a;a.borderWidth=0,o=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${y}" stroke-width="${_}">`],this.container.classList.add("hasBorder")}const l=s-t,u=i-r,{svgFactory:h}=this,f=h.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const p=h.createElement("defs");f.append(p);const g=h.createElement("clipPath"),v=`clippath_${this.data.id}`;g.setAttribute("id",v),g.setAttribute("clipPathUnits","objectBoundingBox"),p.append(g);for(let y=2,_=e.length;y<_;y+=8){const w=e[y],b=e[y+1],S=e[y+2],T=e[y+3],P=h.createElement("rect"),R=(S-t)/l,k=(i-b)/u,C=(w-S)/l,I=(b-T)/u;P.setAttribute("x",R),P.setAttribute("y",k),P.setAttribute("width",C),P.setAttribute("height",I),g.append(P),o==null||o.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${k}" width="${C}" height="${I}"/>`)}c(this,eg)&&(o.push("</g></svg>')"),a.backgroundImage=o.join("")),this.container.append(f),this.container.style.clipPath=`url(#${v})`}_createPopup(e=null){const{data:t}=this;let r,s;e?(r={str:e.text},s=e.date):(r=t.contentsObj,s=t.modificationDate);const i=A(this,Ti,new DD({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:r,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]}));this.parent._commentManager||this.parent.div.append(i.render())}get hasPopupElement(){return!!(c(this,Ti)||this.popup||this.data.popupRef)}get extraPopupElement(){return c(this,Ti)}render(){Tt("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const r=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:i,id:a,exportValues:o}of s){if(i===-1||a===t)continue;const l=typeof o=="string"?o:null,u=document.querySelector(`[data-element-id="${a}"]`);if(u&&!If.has(u)){Oe(`_getElementsByName - element not allowed: ${a}`);continue}r.push({id:a,exportValue:l,domElement:u})}return r}for(const s of document.getElementsByName(e)){const{exportValue:i}=s,a=s.getAttribute("data-element-id");a!==t&&If.has(s)&&r.push({id:a,exportValue:i,domElement:s})}return r}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var r;(r=this.linkService.eventBus)==null||r.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}};Ed=new WeakMap,eg=new WeakMap,Ti=new WeakMap,jb=new WeakSet,ID=function(e){const{container:{style:t},data:{rect:r,rotation:s},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}}}=this;r==null||r.splice(0,4,...e),t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(a-e[3]+l)/a}%`,s===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(s)};let Jt=LO;class x1e extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}var pl,mh,rT,lW,sT,cW;class kO extends Jt{constructor(t,r=null){super(t,{isRenderable:!0,ignoreBorder:!!(r!=null&&r.ignoreBorder),createQuadrilaterals:!0});x(this,pl);x(this,rT);x(this,sT);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:r}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let i=!1;return t.url?(r.addLinkAttributes(s,t.url,t.newWindow),i=!0):t.action?(this._bindNamedAction(s,t.action,t.overlaidText),i=!0):t.attachment?(D(this,rT,lW).call(this,s,t.attachment,t.overlaidText,t.attachmentDest),i=!0):t.setOCGState?(D(this,sT,cW).call(this,s,t.setOCGState,t.overlaidText),i=!0):t.dest?(this._bindLink(s,t.dest,t.overlaidText),i=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),i=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(s,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(s),this.container}_bindLink(t,r,s=""){t.href=this.linkService.getDestinationHash(r),t.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&D(this,pl,mh).call(this),s&&(t.title=s)}_bindNamedAction(t,r,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(r),!1),s&&(t.title=s),D(this,pl,mh).call(this)}_bindJSAction(t,r){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(r.actions)){const a=s.get(i);a&&(t[a]=()=>{var o;return(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:i}}),!1})}r.overlaidText&&(t.title=r.overlaidText),t.onclick||(t.onclick=()=>!1),D(this,pl,mh).call(this)}_bindResetFormAction(t,r){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),D(this,pl,mh).call(this),!this._fieldObjects){Oe('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var f;s==null||s();const{fields:i,refs:a,include:o}=r,l=[];if(i.length!==0||a.length!==0){const p=new Set(a);for(const g of i){const v=this._fieldObjects[g]||[];for(const{id:y}of v)p.add(y)}for(const g of Object.values(this._fieldObjects))for(const v of g)p.has(v.id)===o&&l.push(v)}else for(const p of Object.values(this._fieldObjects))l.push(...p);const u=this.annotationStorage,h=[];for(const p of l){const{id:g}=p;switch(h.push(g),p.type){case"text":{const y=p.defaultValue||"";u.setValue(g,{value:y});break}case"checkbox":case"radiobutton":{const y=p.defaultValue===p.exportValues;u.setValue(g,{value:y});break}case"combobox":case"listbox":{const y=p.defaultValue||"";u.setValue(g,{value:y});break}default:continue}const v=document.querySelector(`[data-element-id="${g}"]`);if(v){if(!If.has(v)){Oe(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((f=this.linkService.eventBus)==null||f.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}pl=new WeakSet,mh=function(){this.container.setAttribute("data-internal-link","")},rT=new WeakSet,lW=function(t,r,s="",i=null){t.href=this.linkService.getAnchorUrl(""),r.description?t.title=r.description:s&&(t.title=s),t.onclick=()=>{var a;return(a=this.downloadManager)==null||a.openOrDownloadData(r.content,r.filename,i),!1},D(this,pl,mh).call(this)},sT=new WeakSet,cW=function(t,r,s=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(r),!1),s&&(t.title=s),D(this,pl,mh).call(this)};class S1e extends Jt{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Bf extends Jt{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return mr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,r,s,i){r.includes("mouse")?e.addEventListener(r,a=>{var o;(o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(r,a=>{var o;if(r==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(r==="focus"){if(t.focused)return;t.focused=!0}i&&((o=this.linkService.eventBus)==null||o.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:i(a)}}))})}_setEventListeners(e,t,r,s){var i,a,o;for(const[l,u]of r)(u==="Action"||(i=this.data.actions)!=null&&i[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,s),u==="Focus"&&!((a=this.data.actions)!=null&&a.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((o=this.data.actions)!=null&&o.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":ye.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:r}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||b1e,i=e.style;let a;const o=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o),h=Math.round(u/($N*s))||1,f=u/h;a=Math.min(s,l(f/$N))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-o);a=Math.min(s,l(u/$N))}i.fontSize=`calc(${a}px * var(--total-scale-factor))`,i.color=ye.makeHexColor(r[0],r[1],r[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class E1e extends Bf{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,r,s){const i=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=r),i.setValue(a.id,{[s]:r})}render(){var s,i;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let r=null;if(this.renderForms){const a=e.getValue(t,{value:this.data.fieldValue});let o=a.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let u=a.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=u??o,this.data.doNotScroll&&(r.style.overflowY="hidden")):(r=document.createElement("input"),r.type=this.data.password?"password":"text",r.setAttribute("value",u??o),this.data.doNotScroll&&(r.style.overflowX="hidden")),this.data.hasOwnCanvas&&(r.hidden=!0),If.add(r),r.setAttribute("data-element-id",t),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:g}=this.data,v=!!p&&this.enableScripting;f&&(r.title=f),this._setRequired(r,this.data.required),l&&(r.maxLength=l),r.addEventListener("input",_=>{e.setValue(t,{value:_.target.value}),this.setPropertyOnSiblings(r,"value",_.target.value,"value"),h.formattedValue=null}),r.addEventListener("resetform",_=>{const w=this.data.defaultFieldValue??"";r.value=h.userValue=w,h.formattedValue=null});let y=_=>{const{formattedValue:w}=h;w!=null&&(_.target.value=w),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",w=>{var S;if(h.focused)return;const{target:b}=w;if(v&&(b.type=p,g&&(b.step=g)),h.userValue){const T=h.userValue;if(v)if(p==="time"){const P=new Date(T),R=[P.getHours(),P.getMinutes(),P.getSeconds()];b.value=R.map(k=>k.toString().padStart(2,"0")).join(":")}else b.value=new Date(T-_1e).toISOString().split(p==="date"?"T":".",1)[0];else b.value=T}h.lastCommittedValue=b.value,h.commitKey=1,(S=this.data.actions)!=null&&S.Focus||(h.focused=!0)}),r.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const b={value(S){h.userValue=S.detail.value??"",v||e.setValue(t,{value:h.userValue.toString()}),S.target.value=h.userValue},formattedValue(S){const{formattedValue:T}=S.detail;h.formattedValue=T,T!=null&&S.target!==document.activeElement&&(S.target.value=T);const P={formattedValue:T};v&&(P.value=T),e.setValue(t,P)},selRange(S){S.target.setSelectionRange(...S.detail.selRange)},charLimit:S=>{var k;const{charLimit:T}=S.detail,{target:P}=S;if(T===0){P.removeAttribute("maxLength");return}P.setAttribute("maxLength",T);let R=h.userValue;!R||R.length<=T||(R=R.slice(0,T),P.value=h.userValue=R,e.setValue(t,{value:R}),(k=this.linkService.eventBus)==null||k.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:P.selectionStart,selEnd:P.selectionEnd}}))}};this._dispatchEventFromSandbox(b,w)}),r.addEventListener("keydown",w=>{var T;h.commitKey=1;let b=-1;if(w.key==="Escape"?b=0:w.key==="Enter"&&!this.data.multiLine?b=2:w.key==="Tab"&&(h.commitKey=3),b===-1)return;const{value:S}=w.target;h.lastCommittedValue!==S&&(h.lastCommittedValue=S,h.userValue=S,(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:b,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const _=y;y=null,r.addEventListener("blur",w=>{var T,P;if(!h.focused||!w.relatedTarget)return;(T=this.data.actions)!=null&&T.Blur||(h.focused=!1);const{target:b}=w;let{value:S}=b;if(v){if(S&&p==="time"){const R=S.split(":").map(k=>parseInt(k,10));S=new Date(2e3,0,1,R[0],R[1],R[2]||0).valueOf(),b.step=""}else S.includes("T")||(S=`${S}T00:00`),S=new Date(S).valueOf();b.type="text"}h.userValue=S,h.lastCommittedValue!==S&&((P=this.linkService.eventBus)==null||P.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:S,willCommit:!0,commitKey:h.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}})),_(w)}),(i=this.data.actions)!=null&&i.Keystroke&&r.addEventListener("beforeinput",w=>{var I;h.lastCommittedValue=null;const{data:b,target:S}=w,{value:T,selectionStart:P,selectionEnd:R}=S;let k=P,C=R;switch(w.inputType){case"deleteWordBackward":{const M=T.substring(0,P).match(/\w*[^\w]*$/);M&&(k-=M[0].length);break}case"deleteWordForward":{const M=T.substring(P).match(/^[^\w]*\w*/);M&&(C+=M[0].length);break}case"deleteContentBackward":P===R&&(k-=1);break;case"deleteContentForward":P===R&&(C+=1);break}w.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:b||"",willCommit:!1,selStart:k,selEnd:C}})}),this._setEventListeners(r,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(y&&r.addEventListener("blur",y),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/l;r.classList.add("comb"),r.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell",this.data.hasOwnCanvas&&(r.hidden=!0);return this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class A1e extends Bf{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class T1e extends Bf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,r=t.id;let s=e.getValue(r,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(r,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const i=document.createElement("input");return If.add(i),i.setAttribute("data-element-id",r),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="checkbox",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.setAttribute("exportValue",t.exportValue),i.tabIndex=0,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r)){const h=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(r,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue||"Off";a.target.checked=o===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener("updatefromsandbox",a=>{const o={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(r,{value:l.target.checked})}};this._dispatchEventFromSandbox(o,a)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class uW extends Bf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,r=t.id;let s=e.getValue(r,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(r,{value:s})),s)for(const a of this._getElementsByName(t.fieldName,r))e.setValue(a.id,{value:!1});const i=document.createElement("input");if(If.add(i),i.setAttribute("data-element-id",r),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type="radio",i.name=t.fieldName,s&&i.setAttribute("checked",!0),i.tabIndex=0,i.addEventListener("change",a=>{const{name:o,checked:l}=a.target;for(const u of this._getElementsByName(o,r))e.setValue(u.id,{value:!1});e.setValue(r,{value:l})}),i.addEventListener("resetform",a=>{const o=t.defaultFieldValue;a.target.checked=o!=null&&o===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;i.addEventListener("updatefromsandbox",o=>{const l={value:u=>{const h=a===u.detail.value;for(const f of this._getElementsByName(u.target.name)){const p=h&&f.id===r;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}}};this._dispatchEventFromSandbox(l,o)}),this._setEventListeners(i,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class C1e extends kO{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",r=>{this._dispatchEventFromSandbox({},r)})),e}}class k1e extends Bf{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,r=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");If.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const f=this.data.defaultFieldValue;for(const p of s.options)p.selected=p.value===f});for(const h of this.data.options){const f=document.createElement("option");f.textContent=h.displayValue,f.value=h.exportValue,r.value.includes(h.exportValue)&&(f.setAttribute("selected",!0),i=!1),s.append(f)}let a=null;if(i){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),a=()=>{h.remove(),s.removeEventListener("input",a),a=null},s.addEventListener("input",a)}const o=h=>{const f=h?"value":"textContent",{options:p,multiple:g}=s;return g?Array.prototype.filter.call(p,v=>v.selected).map(v=>v[f]):p.selectedIndex===-1?null:p[p.selectedIndex][f]};let l=o(!1);const u=h=>{const f=h.target.options;return Array.prototype.map.call(f,p=>({displayValue:p.textContent,exportValue:p.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const f={value(p){a==null||a();const g=p.detail.value,v=new Set(Array.isArray(g)?g:[g]);for(const y of s.options)y.selected=v.has(y.value);e.setValue(t,{value:o(!0)}),l=o(!1)},multipleSelection(p){s.multiple=!0},remove(p){const g=s.options,v=p.detail.remove;g[v].selected=!1,s.remove(v),g.length>0&&Array.prototype.findIndex.call(g,_=>_.selected)===-1&&(g[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},clear(p){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=o(!1)},insert(p){const{index:g,displayValue:v,exportValue:y}=p.detail.insert,_=s.children[g],w=document.createElement("option");w.textContent=v,w.value=y,_?_.before(w):s.append(w),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},items(p){const{items:g}=p.detail;for(;s.length!==0;)s.remove(0);for(const v of g){const{displayValue:y,exportValue:_}=v,w=document.createElement("option");w.textContent=y,w.value=_,s.append(w)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:o(!0),items:u(p)}),l=o(!1)},indices(p){const g=new Set(p.detail.indices);for(const v of p.target.options)v.selected=g.has(v.index);e.setValue(t,{value:o(!0)}),l=o(!1)},editable(p){p.target.disabled=!p.detail.editable}};this._dispatchEventFromSandbox(f,h)}),s.addEventListener("input",h=>{var g;const f=o(!0),p=o(!1);e.setValue(t,{value:f}),h.preventDefault(),(g=this.linkService.eventBus)==null||g.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:p,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}var Fb,RD;class DD extends Jt{constructor(t){const{data:r,elements:s,parent:i}=t,a=!!i._commentManager;super(t,{isRenderable:!a&&Jt._hasPopupData(r)});x(this,Fb);if(this.elements=s,a&&Jt._hasPopupData(r)){const o=this.popup=D(this,Fb,RD).call(this);for(const l of s)l.popup=o}else this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const r=this.popup=D(this,Fb,RD).call(this),s=[];for(const i of this.elements)i.popup=r,i.container.ariaHasPopup="dialog",s.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",s.map(i=>`${_O}${i}`).join(",")),this.container}}Fb=new WeakSet,RD=function(){return new N1e({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})};var Hs,eu,iT,aT,tg,ng,an,to,tu,Ad,rg,sg,no,Ws,ml,gl,Hn,yl,nu,$b,vl,ig,Td,ru,Dr,su,ag,SE,Ub,MD,Vb,OD,Bb,LD,og,EE,zb,jD,oT,hW,lT,dW,cT,fW,uT,pW,lg,AE,cg,TE,Hb,FD;class N1e{constructor({container:e,color:t,elements:r,titleObj:s,modificationDate:i,contentsObj:a,richText:o,parent:l,rect:u,parentRect:h,open:f,commentManager:p=null}){x(this,ag);x(this,Ub);x(this,Vb);x(this,Bb);x(this,og);x(this,zb);x(this,oT);x(this,lT);x(this,cT);x(this,uT);x(this,lg);x(this,cg);x(this,Hb);x(this,Hs,null);x(this,eu,D(this,cT,fW).bind(this));x(this,iT,D(this,Hb,FD).bind(this));x(this,aT,D(this,cg,TE).bind(this));x(this,tg,D(this,lg,AE).bind(this));x(this,ng,null);x(this,an,null);x(this,to,null);x(this,tu,null);x(this,Ad,null);x(this,rg,null);x(this,sg,null);x(this,no,!1);x(this,Ws,null);x(this,ml,null);x(this,gl,null);x(this,Hn,null);x(this,yl,null);x(this,nu,null);x(this,$b,null);x(this,vl,null);x(this,ig,null);x(this,Td,null);x(this,ru,!1);x(this,Dr,null);x(this,su,null);A(this,an,e),A(this,ig,s),A(this,to,a),A(this,vl,o),A(this,rg,l),A(this,ng,t),A(this,$b,u),A(this,sg,h),A(this,Ad,r),A(this,Hs,p),A(this,Dr,r[0]),A(this,tu,X1.toDateObject(i)),this.trigger=r.flatMap(g=>g.getElementsToTriggerPopup()),p?this.renderCommentButton():(D(this,ag,SE).call(this),c(this,an).hidden=!0,f&&D(this,lg,AE).call(this))}renderCommentButton(){if(c(this,Hn)||(c(this,yl)||D(this,Ub,MD).call(this),!c(this,yl)))return;const{signal:e}=A(this,ml,new AbortController),t=!!c(this,Dr).extraPopupElement,r=()=>{c(this,Hs).toggleCommentPopup(this,!0,void 0,!t)},s=()=>{c(this,Hs).toggleCommentPopup(this,!1,!0,!t)},i=()=>{c(this,Hs).toggleCommentPopup(this,!1,!1)};if(t){A(this,Hn,c(this,Dr).container);for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",c(this,eu),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",s,{signal:e}),a.addEventListener("pointerleave",i,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=A(this,Hn,document.createElement("button"));a.className="annotationCommentButton";const o=c(this,Dr).container;a.style.zIndex=o.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),D(this,Bb,LD).call(this),D(this,Vb,OD).call(this),a.addEventListener("keydown",c(this,eu),{signal:e}),a.addEventListener("click",r,{signal:e}),a.addEventListener("pointerenter",s,{signal:e}),a.addEventListener("pointerleave",i,{signal:e}),o.after(a)}}get commentButtonColor(){const{color:e,opacity:t}=c(this,Dr).commentData;return e?c(this,rg)._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{var e;(e=c(this,Hn))==null||e.focus()},0)}getData(){const{richText:e,color:t,opacity:r,creationDate:s,modificationDate:i}=c(this,Dr).commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:r,creationDate:s,modificationDate:i}}get elementBeforePopup(){return c(this,Hn)}get comment(){return c(this,su)||A(this,su,c(this,Dr).commentText),c(this,su)}set comment(e){e!==this.comment&&(c(this,Dr).commentText=A(this,su,e))}get parentBoundingClientRect(){return c(this,Dr).layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){c(this,Hn)&&(c(this,Hn).classList.toggle("selected",e),c(this,Hn).ariaExpanded=t)}setSelectedCommentButton(e){c(this,Hn).classList.toggle("selected",e)}get commentPopupPosition(){if(c(this,nu))return c(this,nu);const{x:e,y:t,height:r}=c(this,Hn).getBoundingClientRect(),{x:s,y:i,width:a,height:o}=c(this,Dr).layer.getBoundingClientRect();return[(e-s)/a,(t+r-i)/o]}set commentPopupPosition(e){A(this,nu,e)}hasDefaultPopupPosition(){return c(this,nu)===null}get commentButtonPosition(){return c(this,yl)}get commentButtonWidth(){return c(this,Hn).getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,r]=c(this,nu)||this.commentButtonPosition.map(u=>u/100),s=this.parentBoundingClientRect,{x:i,y:a,width:o,height:l}=s;c(this,Hs).showDialog(null,this,i+t*o,a+r*l,{...e,parentDimensions:s})}render(){var r,s;if(c(this,Ws))return;const e=A(this,Ws,document.createElement("div"));if(e.className="popup",c(this,ng)){const i=e.style.outlineColor=ye.makeHexColor(...c(this,ng));e.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const t=document.createElement("span");if(t.className="header",(r=c(this,ig))!=null&&r.str){const i=document.createElement("span");i.className="title",t.append(i),{dir:i.dir,str:i.textContent}=c(this,ig)}if(e.append(t),c(this,tu)){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,tu).valueOf()})),i.dateTime=c(this,tu).toISOString(),t.append(i)}i9({html:c(this,og,EE)||c(this,to).str,dir:(s=c(this,to))==null?void 0:s.dir,className:"popupContent"},e),c(this,an).append(e)}updateEdited({rect:e,popup:t,deleted:r}){var s;if(c(this,Hs)){r?(this.remove(),A(this,su,null)):t&&(t.deleted?this.remove():(D(this,Bb,LD).call(this),A(this,su,t.text))),e&&(A(this,yl,null),D(this,Ub,MD).call(this),D(this,Vb,OD).call(this));return}if(r||t!=null&&t.deleted){this.remove();return}D(this,ag,SE).call(this),c(this,Td)||A(this,Td,{contentsObj:c(this,to),richText:c(this,vl)}),e&&A(this,gl,null),t&&t.text&&(A(this,vl,D(this,lT,dW).call(this,t.text)),A(this,tu,X1.toDateObject(t.date)),A(this,to,null)),(s=c(this,Ws))==null||s.remove(),A(this,Ws,null)}resetEdited(){var e;c(this,Td)&&({contentsObj:Cn(this,to)._,richText:Cn(this,vl)._}=c(this,Td),A(this,Td,null),(e=c(this,Ws))==null||e.remove(),A(this,Ws,null),A(this,gl,null))}remove(){var e,t,r;if((e=c(this,ml))==null||e.abort(),A(this,ml,null),(t=c(this,Ws))==null||t.remove(),A(this,Ws,null),A(this,ru,!1),A(this,no,!1),(r=c(this,Hn))==null||r.remove(),A(this,Hn,null),this.trigger)for(const s of this.trigger)s.classList.remove("popupTriggerArea")}forceHide(){A(this,ru,this.isVisible),c(this,ru)&&(c(this,an).hidden=!0)}maybeShow(){c(this,Hs)||(D(this,ag,SE).call(this),c(this,ru)&&(c(this,Ws)||D(this,cg,TE).call(this),A(this,ru,!1),c(this,an).hidden=!1))}get isVisible(){return c(this,Hs)?!1:c(this,an).hidden===!1}}Hs=new WeakMap,eu=new WeakMap,iT=new WeakMap,aT=new WeakMap,tg=new WeakMap,ng=new WeakMap,an=new WeakMap,to=new WeakMap,tu=new WeakMap,Ad=new WeakMap,rg=new WeakMap,sg=new WeakMap,no=new WeakMap,Ws=new WeakMap,ml=new WeakMap,gl=new WeakMap,Hn=new WeakMap,yl=new WeakMap,nu=new WeakMap,$b=new WeakMap,vl=new WeakMap,ig=new WeakMap,Td=new WeakMap,ru=new WeakMap,Dr=new WeakMap,su=new WeakMap,ag=new WeakSet,SE=function(){var t;if(c(this,ml))return;A(this,ml,new AbortController);const{signal:e}=c(this,ml);for(const r of this.trigger)r.addEventListener("click",c(this,tg),{signal:e}),r.addEventListener("pointerenter",c(this,aT),{signal:e}),r.addEventListener("pointerleave",c(this,iT),{signal:e}),r.classList.add("popupTriggerArea");for(const r of c(this,Ad))(t=r.container)==null||t.addEventListener("keydown",c(this,eu),{signal:e})},Ub=new WeakSet,MD=function(){const e=c(this,Ad).find(t=>t.hasCommentButton);e&&A(this,yl,e._normalizePoint(e.commentButtonPosition))},Vb=new WeakSet,OD=function(){if(c(this,Dr).extraPopupElement&&!c(this,Dr).editor)return;this.renderCommentButton();const[e,t]=c(this,yl),{style:r}=c(this,Hn);r.left=`calc(${e}%)`,r.top=`calc(${t}% - var(--comment-button-dim))`},Bb=new WeakSet,LD=function(){c(this,Dr).extraPopupElement||(this.renderCommentButton(),c(this,Hn).style.backgroundColor=this.commentButtonColor||"")},og=new WeakSet,EE=function(){const e=c(this,vl),t=c(this,to);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,vl).html||null},zb=new WeakSet,jD=function(){var e,t,r;return((r=(t=(e=c(this,og,EE))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.fontSize)||0},oT=new WeakSet,hW=function(){var e,t,r;return((r=(t=(e=c(this,og,EE))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:r.color)||null},lT=new WeakSet,dW=function(e){const t=[],r={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:c(this,oT,hW),fontSize:c(this,zb,jD)?`calc(${c(this,zb,jD)}px * var(--total-scale-factor))`:""}};for(const i of e.split(`
`))t.push({name:"span",value:i,attributes:s});return r},cT=new WeakSet,fW=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,no))&&D(this,lg,AE).call(this)},uT=new WeakSet,pW=function(){if(c(this,gl)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:r,pageX:s,pageY:i}}}=c(this,rg);let a=!!c(this,sg),o=a?c(this,sg):c(this,$b);for(const v of c(this,Ad))if(!o||ye.intersect(v.data.rect,o)!==null){o=v.data.rect,a=!0;break}const l=ye.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),u=5,h=a?o[2]-o[0]+u:0,f=l[0]+h,p=l[1];A(this,gl,[100*(f-s)/t,100*(p-i)/r]);const{style:g}=c(this,an);g.left=`${c(this,gl)[0]}%`,g.top=`${c(this,gl)[1]}%`},lg=new WeakSet,AE=function(){if(c(this,Hs)){c(this,Hs).toggleCommentPopup(this,!1);return}A(this,no,!c(this,no)),c(this,no)?(D(this,cg,TE).call(this),c(this,an).addEventListener("click",c(this,tg)),c(this,an).addEventListener("keydown",c(this,eu))):(D(this,Hb,FD).call(this),c(this,an).removeEventListener("click",c(this,tg)),c(this,an).removeEventListener("keydown",c(this,eu)))},cg=new WeakSet,TE=function(){c(this,Ws)||this.render(),this.isVisible?c(this,no)&&c(this,an).classList.add("focused"):(D(this,uT,pW).call(this),c(this,an).hidden=!1,c(this,an).style.zIndex=parseInt(c(this,an).style.zIndex)+1e3)},Hb=new WeakSet,FD=function(){c(this,an).classList.remove("focused"),!(c(this,no)||!this.isVisible)&&(c(this,an).hidden=!0,c(this,an).style.zIndex=parseInt(c(this,an).style.zIndex)-1e3)};class mW extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Fe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const r=document.createElement("span");r.textContent=t,e.append(r)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Wb;class P1e extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Wb,null)}render(){this.container.classList.add("lineAnnotation");const{data:t,width:r,height:s}=this,i=this.svgFactory.create(r,s,!0),a=A(this,Wb,this.svgFactory.createElement("svg:line"));return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Wb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Wb=new WeakMap;var Gb;class I1e extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Gb,null)}render(){this.container.classList.add("squareAnnotation");const{data:t,width:r,height:s}=this,i=this.svgFactory.create(r,s,!0),a=t.borderStyle.width,o=A(this,Gb,this.svgFactory.createElement("svg:rect"));return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",r-a),o.setAttribute("height",s-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Gb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Gb=new WeakMap;var qb;class D1e extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,qb,null)}render(){this.container.classList.add("circleAnnotation");const{data:t,width:r,height:s}=this,i=this.svgFactory.create(r,s,!0),a=t.borderStyle.width,o=A(this,qb,this.svgFactory.createElement("svg:ellipse"));return o.setAttribute("cx",r/2),o.setAttribute("cy",s/2),o.setAttribute("rx",r/2-a/2),o.setAttribute("ry",s/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,qb)}addHighlightArea(){this.container.classList.add("highlightArea")}}qb=new WeakMap;var Yb;class gW extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Yb,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:r,borderStyle:s,popupRef:i},width:a,height:o}=this;if(!r)return this.container;const l=this.svgFactory.create(a,o,!0);let u=[];for(let f=0,p=r.length;f<p;f+=2){const g=r[f]-t[0],v=t[3]-r[f+1];u.push(`${g},${v}`)}u=u.join(" ");const h=A(this,Yb,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Yb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Yb=new WeakMap;class R1e extends gW{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class M1e extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Kb,Cd,Xb,$D;class NO extends Jt{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});x(this,Xb);x(this,Kb,null);x(this,Cd,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Fe.HIGHLIGHT:Fe.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:r,inkLists:s,borderStyle:i,popupRef:a}}=this,{transform:o,width:l,height:u}=D(this,Xb,$D).call(this,r,t),h=this.svgFactory.create(l,u,!0),f=A(this,Kb,this.svgFactory.createElement("svg:g"));h.append(f),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,g=s.length;p<g;p++){const v=this.svgFactory.createElement(this.svgElementName);c(this,Cd).push(v),v.setAttribute("points",s[p].join(",")),f.append(v)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:r,points:s,rect:i}=t,a=c(this,Kb);if(r>=0&&a.setAttribute("stroke-width",r||1),s)for(let o=0,l=c(this,Cd).length;o<l;o++)c(this,Cd)[o].setAttribute("points",s[o].join(","));if(i){const{transform:o,width:l,height:u}=D(this,Xb,$D).call(this,this.data.rotation,i);a.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return c(this,Cd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Kb=new WeakMap,Cd=new WeakMap,Xb=new WeakSet,$D=function(t,r){switch(t){case 90:return{transform:`rotate(90) translate(${-r[0]},${r[1]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};case 180:return{transform:`rotate(180) translate(${-r[2]},${r[1]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]};case 270:return{transform:`rotate(270) translate(${-r[2]},${r[3]}) scale(1,-1)`,width:r[3]-r[1],height:r[2]-r[0]};default:return{transform:`translate(${-r[0]},${r[3]}) scale(1,-1)`,width:r[2]-r[0],height:r[3]-r[1]}}};class yW extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Fe.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const r=document.createElement("mark");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class O1e extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class L1e extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const r=document.createElement("u");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class j1e extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const r=document.createElement("s");r.classList.add("overlaidText"),r.textContent=e,this.container.append(r)}return this.container}}class vW extends Jt{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Fe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Qb,Jb,UD;class F1e extends Jt{constructor(t){var s;super(t,{isRenderable:!0});x(this,Jb);x(this,Qb,null);const{file:r}=this.data;this.filename=r.filename,this.content=r.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...r})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:r}=this;let s;r.hasAppearance||r.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(r.name)?"paperclip":"pushpin"}.svg`,r.fillAlpha&&r.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(r.fillAlpha*100)}%);`)),s.addEventListener("dblclick",D(this,Jb,UD).bind(this)),A(this,Qb,s);const{isMac:i}=mr.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(i?a.metaKey:a.ctrlKey)&&D(this,Jb,UD).call(this)}),!r.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return c(this,Qb)}addHighlightArea(){this.container.classList.add("highlightArea")}}Qb=new WeakMap,Jb=new WeakSet,UD=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var ug,kd,hg,iu,Zb,Nd,e_,BD,t_,zD;const jO=class jO{constructor({div:e,accessibilityManager:t,annotationCanvasMap:r,annotationEditorUIManager:s,page:i,viewport:a,structTreeLayer:o,commentManager:l,linkService:u,annotationStorage:h}){x(this,e_);x(this,t_);x(this,ug,null);x(this,kd,null);x(this,hg,null);x(this,iu,new Map);x(this,Zb,null);x(this,Nd,null);this.div=e,A(this,ug,t),A(this,kd,r),A(this,Zb,o||null),A(this,Nd,u||null),A(this,hg,h||new EO),this.page=i,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=l||null}hasEditableAnnotations(){return c(this,iu).size>0}async render(e){var a,o,l;const{annotations:t}=e,r=this.div;Nf(r,this.viewport);const s=new Map,i={data:null,layer:r,linkService:c(this,Nd),downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new sA,annotationStorage:c(this,hg),enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const u of t){if(u.noHTML)continue;const h=u.annotationType===_n.POPUP;if(h){const g=s.get(u.id);if(!g)continue;i.elements=g}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;i.data=u;const f=hU.create(i);if(!f.isRenderable)continue;if(!h&&u.popupRef){const g=s.get(u.popupRef);g?g.push(f):s.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),await D(this,e_,BD).call(this,p,u.id,i.elements),(o=(a=f.extraPopupElement)==null?void 0:a.popup)==null||o.renderCommentButton(),f._isEditable&&(c(this,iu).set(f.data.id,f),(l=this._annotationEditorUIManager)==null||l.renderAnnotationElement(f))}D(this,t_,zD).call(this)}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:c(this,Nd),svgFactory:new sA,parent:this};for(const r of e){r.borderStyle||(r.borderStyle=jO._defaultBorderStyle),t.data=r;const s=hU.create(t);if(!s.isRenderable)continue;const i=s.render();await D(this,e_,BD).call(this,i,r.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Nf(t,{rotation:e.rotation}),D(this,t_,zD).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,iu).values())}getEditableAnnotation(e){return c(this,iu).get(e)}addFakeAnnotation(e){var o;const{div:t}=this,{id:r,rotation:s}=e,i=new x1e({data:{id:r,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:c(this,Nd),annotationStorage:c(this,hg)}),a=i.render();return t.append(a),(o=c(this,ug))==null||o.moveElementInDOM(t,a,a,!1),i.createOrUpdatePopup(),i}static get _defaultBorderStyle(){return Ve(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:ip.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};ug=new WeakMap,kd=new WeakMap,hg=new WeakMap,iu=new WeakMap,Zb=new WeakMap,Nd=new WeakMap,e_=new WeakSet,BD=async function(e,t,r){var o,l;const s=e.firstChild||e,i=s.id=`${_O}${t}`,a=await((o=c(this,Zb))==null?void 0:o.getAriaAttributes(i));if(a)for(const[u,h]of a)s.setAttribute(u,h);r?r.at(-1).container.after(e):(this.div.append(e),(l=c(this,ug))==null||l.moveElementInDOM(this.div,e,s,!1))},t_=new WeakSet,zD=function(){var t;if(!c(this,kd))return;const e=this.div;for(const[r,s]of c(this,kd)){const i=e.querySelector(`[data-annotation-id="${r}"]`);if(!i)continue;s.className="annotationContent";const{firstChild:a}=i;a?a.nodeName==="CANVAS"?a.replaceWith(s):a.classList.contains("annotationContent")?a.after(s):a.before(s):i.append(s);const o=c(this,iu).get(r);o&&(o._hasNoCanvas?((t=this._annotationEditorUIManager)==null||t.setMissingCanvas(r,i.id,s),o._hasNoCanvas=!1):o.canvas=s)}c(this,kd).clear()};let VD=jO;const PS=/\r\n?|\n/g;var Gs,n_,Pd,qs,hT,wW,dT,bW,fT,_W,dg,CE,fg,kE,pg,NE,pT,xW,r_,WD,mT,SW;const Ct=class Ct extends It{constructor(t){super({...t,name:"freeTextEditor"});x(this,hT);x(this,dT);x(this,fT);x(this,dg);x(this,pg);x(this,pT);x(this,mT);x(this,Gs,"");x(this,n_,`${this.id}-editor`);x(this,Pd,null);x(this,qs,void 0);ie(this,"_colorPicker",null);this.color=t.color||Ct._defaultColor||It._defaultLineColor,A(this,qs,t.fontSize||Ct._defaultFontSize),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static get _keyboardManager(){const t=Ct.prototype,r=a=>a.isEmpty(),s=Pf.TRANSLATE_SMALL,i=Pf.TRANSLATE_BIG;return Ve(this,"_keyboardManager",new Ax([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:r}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:r}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:r}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[i,0],checker:r}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:r}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:r}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:r}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,i],checker:r}]]))}static initialize(t,r){It.initialize(t,r);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,r){switch(t){case Qe.FREETEXT_SIZE:Ct._defaultFontSize=r;break;case Qe.FREETEXT_COLOR:Ct._defaultColor=r;break}}updateParams(t,r){switch(t){case Qe.FREETEXT_SIZE:D(this,hT,wW).call(this,r);break;case Qe.FREETEXT_COLOR:D(this,dT,bW).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[Qe.FREETEXT_SIZE,Ct._defaultFontSize],[Qe.FREETEXT_COLOR,Ct._defaultColor||It._defaultLineColor]]}get propertiesToUpdate(){return[[Qe.FREETEXT_SIZE,c(this,qs)],[Qe.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new rA(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Qe.FREETEXT_COLOR}onUpdatedColor(){var t;this.editorDiv.style.color=this.color,(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_translateEmpty(t,r){this._uiManager.translateSelectedEditors(t,r,!0)}getInitialTranslation(){const t=this.parentScale;return[-Ct._internalPadding*t,-(Ct._internalPadding+c(this,qs))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),A(this,Pd,new AbortController);const t=this._uiManager.combinedSignal(c(this,Pd));return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){var t;return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,n_)),this._isDraggable=!0,(t=c(this,Pd))==null||t.abort(),A(this,Pd,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var r;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(r=this._initialOptions)!=null&&r.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,Gs),r=A(this,Gs,D(this,fT,_W).call(this).trimEnd());if(t===r)return;const s=i=>{if(A(this,Gs,i),!i){this.remove();return}D(this,pg,NE).call(this),this._uiManager.rebuild(this),D(this,dg,CE).call(this)};this.addCommands({cmd:()=>{s(r)},undo:()=>{s(t)},mustExec:!1}),D(this,dg,CE).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Ct._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,r;(this._isCopy||this.annotationElementId)&&(t=this.x,r=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,n_)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${c(this,qs)}px * var(--total-scale-factor))`,s.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,f]=this.pageDimensions,[p,g]=this.pageTranslation;let v,y;switch(this.rotation){case 0:v=t+(o[0]-p)/h,y=r+this.height-(o[1]-g)/f;break;case 90:v=t+(o[0]-p)/h,y=r-(o[1]-g)/f,[l,u]=[u,-l];break;case 180:v=t-this.width+(o[0]-p)/h,y=r-(o[1]-g)/f,[l,u]=[-l,-u];break;case 270:v=t+(o[0]-p-this.height*f)/h,y=r+(o[1]-g-this.width*h)/f,[l,u]=[-u,l];break}this.setAt(v*i,y*a,l,u)}else this._moveAfterPaste(t,r);D(this,pg,NE).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var v,y,_;const r=t.clipboardData||window.clipboardData,{types:s}=r;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const i=D(v=Ct,r_,WD).call(v,r.getData("text")||"").replaceAll(PS,`
`);if(!i)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:l,startOffset:u}=o,h=[],f=[];if(l.nodeType===Node.TEXT_NODE){const w=l.parentElement;if(f.push(l.nodeValue.slice(u).replaceAll(PS,"")),w!==this.editorDiv){let b=h;for(const S of this.editorDiv.childNodes){if(S===w){b=f;continue}b.push(D(y=Ct,fg,kE).call(y,S))}}h.push(l.nodeValue.slice(0,u).replaceAll(PS,""))}else if(l===this.editorDiv){let w=h,b=0;for(const S of this.editorDiv.childNodes)b++===u&&(w=f),w.push(D(_=Ct,fg,kE).call(_,S))}A(this,Gs,`${h.join(`
`)}${i}${f.join(`
`)}`),D(this,pg,NE).call(this);const p=new Range;let g=Math.sumPrecise(h.map(w=>w.length));for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const b=w.nodeValue.length;if(g<=b){p.setStart(w,g),p.setEnd(w,g);break}g-=b}a.removeAllRanges(),a.addRange(p)}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Ct._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,r,s){var o;let i=null;if(t instanceof mW){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:f,id:p,popupRef:g,richText:v,contentsObj:y,creationDate:_,modificationDate:w},textContent:b,textPosition:S,parent:{page:{pageNumber:T}}}=t;if(!b||b.length===0)return null;i=t={annotationType:Fe.FREETEXT,color:Array.from(u),fontSize:l,value:b.join(`
`),position:S,pageIndex:T-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:(y==null?void 0:y.str)||null,richText:v,creationDate:_,modificationDate:w}}const a=await super.deserialize(t,r,s);return A(a,qs,t.fontSize),a.color=ye.makeHexColor(...t.color),A(a,Gs,D(o=Ct,r_,WD).call(o,t.value)),a._initialData=i,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const r=It._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),s=Object.assign(super.serialize(t),{color:r,fontSize:c(this,qs),value:D(this,pT,xW).call(this)});return this.addComment(s),t?(s.isCopy=!0,s):this.annotationElementId&&!D(this,mT,SW).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){const r=super.renderAnnotationElement(t);if(!r)return null;const{style:s}=r;s.fontSize=`calc(${c(this,qs)}px * var(--total-scale-factor))`,s.color=this.color,r.replaceChildren();for(const i of c(this,Gs).split(`
`)){const a=document.createElement("div");a.append(i?document.createTextNode(i):document.createElement("br")),r.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:c(this,Gs)}}),r}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};Gs=new WeakMap,n_=new WeakMap,Pd=new WeakMap,qs=new WeakMap,hT=new WeakSet,wW=function(t){const r=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-c(this,qs))*this.parentScale),A(this,qs,i),D(this,dg,CE).call(this)},s=c(this,qs);this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},dT=new WeakSet,bW=function(t){const r=i=>{this.color=i,this.onUpdatedColor()},s=this.color;this.addCommands({cmd:r.bind(this,t),undo:r.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},fT=new WeakSet,_W=function(){var s;const t=[];this.editorDiv.normalize();let r=null;for(const i of this.editorDiv.childNodes)(r==null?void 0:r.nodeType)===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(D(s=Ct,fg,kE).call(s,i)),r=i);return t.join(`
`)},dg=new WeakSet,CE=function(){const[t,r]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:i,div:a}=this,o=a.style.display,l=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",i.div.append(this.div),s=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/r):(this.width=s.height/t,this.height=s.width/r),this.fixAndSetPosition()},fg=new WeakSet,kE=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(PS,"")},pg=new WeakSet,NE=function(){if(this.editorDiv.replaceChildren(),!!c(this,Gs))for(const t of c(this,Gs).split(`
`)){const r=document.createElement("div");r.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(r)}},pT=new WeakSet,xW=function(){return c(this,Gs).replaceAll(""," ")},r_=new WeakSet,WD=function(t){return t.replaceAll(" ","")},mT=new WeakSet,SW=function(t){const{value:r,fontSize:s,color:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==r||t.fontSize!==s||t.color.some((o,l)=>o!==i[l])||t.pageIndex!==a},x(Ct,fg),x(Ct,r_),ie(Ct,"_freeTextDefaultContent",""),ie(Ct,"_internalPadding",0),ie(Ct,"_defaultColor",null),ie(Ct,"_defaultFontSize",10),ie(Ct,"_type","freetext"),ie(Ct,"_editorType",Fe.FREETEXT);let HD=Ct;class ge{toSVGPath(){Tt("Abstract method `toSVGPath` must be implemented.")}get box(){Tt("Abstract getter `box` must be implemented.")}serialize(e,t){Tt("Abstract method `serialize` must be implemented.")}static _rescale(e,t,r,s,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o]*s,a[o+1]=r+e[o+1]*i;return a}static _rescaleAndSwap(e,t,r,s,i,a){a||(a=new Float32Array(e.length));for(let o=0,l=e.length;o<l;o+=2)a[o]=t+e[o+1]*s,a[o+1]=r+e[o]*i;return a}static _translate(e,t,r,s){s||(s=new Float32Array(e.length));for(let i=0,a=e.length;i<a;i+=2)s[i]=t+e[i],s[i+1]=r+e[i+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,r,s,i){switch(i){case 90:return[1-t/r,e/s];case 180:return[1-e/r,1-t/s];case 270:return[t/r,1-e/s];default:return[e/r,t/s]}}static _normalizePagePoint(e,t,r){switch(r){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,r,s,i,a){return[(e+5*r)/6,(t+5*s)/6,(5*r+i)/6,(5*s+a)/6,(r+i)/2,(s+a)/2]}}ie(ge,"PRECISION",1e-4);var Ys,la,mg,gg,ro,ze,Id,Dd,s_,i_,yg,vg,au,a_,gT,yT,Rd,Bv,vT,EW,wT,AW,bT,TW,_T,CW,xT,kW,ST,NW;const Bo=class Bo{constructor({x:e,y:t},r,s,i,a,o=0){x(this,Rd);x(this,vT);x(this,wT);x(this,bT);x(this,_T);x(this,xT);x(this,ST);x(this,Ys,void 0);x(this,la,[]);x(this,mg,void 0);x(this,gg,void 0);x(this,ro,[]);x(this,ze,new Float32Array(18));x(this,Id,void 0);x(this,Dd,void 0);x(this,s_,void 0);x(this,i_,void 0);x(this,yg,void 0);x(this,vg,void 0);x(this,au,[]);A(this,Ys,r),A(this,vg,i*s),A(this,gg,a),c(this,ze).set([NaN,NaN,NaN,NaN,e,t],6),A(this,mg,o),A(this,i_,c(Bo,a_)*s),A(this,s_,c(Bo,yT)*s),A(this,yg,s),c(this,au).push(e,t)}isEmpty(){return isNaN(c(this,ze)[8])}add({x:e,y:t}){var I;A(this,Id,e),A(this,Dd,t);const[r,s,i,a]=c(this,Ys);let[o,l,u,h]=c(this,ze).subarray(8,12);const f=e-u,p=t-h,g=Math.hypot(f,p);if(g<c(this,s_))return!1;const v=g-c(this,i_),y=v/g,_=y*f,w=y*p;let b=o,S=l;o=u,l=h,u+=_,h+=w,(I=c(this,au))==null||I.push(e,t);const T=-w/v,P=_/v,R=T*c(this,vg),k=P*c(this,vg);return c(this,ze).set(c(this,ze).subarray(2,8),0),c(this,ze).set([u+R,h+k],4),c(this,ze).set(c(this,ze).subarray(14,18),12),c(this,ze).set([u-R,h-k],16),isNaN(c(this,ze)[6])?(c(this,ro).length===0&&(c(this,ze).set([o+R,l+k],2),c(this,ro).push(NaN,NaN,NaN,NaN,(o+R-r)/i,(l+k-s)/a),c(this,ze).set([o-R,l-k],14),c(this,la).push(NaN,NaN,NaN,NaN,(o-R-r)/i,(l-k-s)/a)),c(this,ze).set([b,S,o,l,u,h],6),!this.isEmpty()):(c(this,ze).set([b,S,o,l,u,h],6),Math.abs(Math.atan2(S-l,b-o)-Math.atan2(w,_))<Math.PI/2?([o,l,u,h]=c(this,ze).subarray(2,6),c(this,ro).push(NaN,NaN,NaN,NaN,((o+u)/2-r)/i,((l+h)/2-s)/a),[o,l,b,S]=c(this,ze).subarray(14,18),c(this,la).push(NaN,NaN,NaN,NaN,((b+o)/2-r)/i,((S+l)/2-s)/a),!0):([b,S,o,l,u,h]=c(this,ze).subarray(0,6),c(this,ro).push(((b+5*o)/6-r)/i,((S+5*l)/6-s)/a,((5*o+u)/6-r)/i,((5*l+h)/6-s)/a,((o+u)/2-r)/i,((l+h)/2-s)/a),[u,h,o,l,b,S]=c(this,ze).subarray(12,18),c(this,la).push(((b+5*o)/6-r)/i,((S+5*l)/6-s)/a,((5*o+u)/6-r)/i,((5*l+h)/6-s)/a,((o+u)/2-r)/i,((l+h)/2-s)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,ro),t=c(this,la);if(isNaN(c(this,ze)[6])&&!this.isEmpty())return D(this,vT,EW).call(this);const r=[];r.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?r.push(`L${e[s+4]} ${e[s+5]}`):r.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);D(this,bT,TW).call(this,r);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?r.push(`L${t[s+4]} ${t[s+5]}`):r.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return D(this,wT,AW).call(this,r),r.join(" ")}newFreeDrawOutline(e,t,r,s,i,a){return new PW(e,t,r,s,i,a)}getOutlines(){var f;const e=c(this,ro),t=c(this,la),r=c(this,ze),[s,i,a,o]=c(this,Ys),l=new Float32Array((((f=c(this,au))==null?void 0:f.length)??0)+2);for(let p=0,g=l.length-2;p<g;p+=2)l[p]=(c(this,au)[p]-s)/a,l[p+1]=(c(this,au)[p+1]-i)/o;if(l[l.length-2]=(c(this,Id)-s)/a,l[l.length-1]=(c(this,Dd)-i)/o,isNaN(r[6])&&!this.isEmpty())return D(this,_T,CW).call(this,l);const u=new Float32Array(c(this,ro).length+24+c(this,la).length);let h=e.length;for(let p=0;p<h;p+=2){if(isNaN(e[p])){u[p]=u[p+1]=NaN;continue}u[p]=e[p],u[p+1]=e[p+1]}h=D(this,ST,NW).call(this,u,h);for(let p=t.length-6;p>=6;p-=6)for(let g=0;g<6;g+=2){if(isNaN(t[p+g])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[p+g],u[h+1]=t[p+g+1],h+=2}return D(this,xT,kW).call(this,u,h),this.newFreeDrawOutline(u,l,c(this,Ys),c(this,yg),c(this,mg),c(this,gg))}};Ys=new WeakMap,la=new WeakMap,mg=new WeakMap,gg=new WeakMap,ro=new WeakMap,ze=new WeakMap,Id=new WeakMap,Dd=new WeakMap,s_=new WeakMap,i_=new WeakMap,yg=new WeakMap,vg=new WeakMap,au=new WeakMap,a_=new WeakMap,gT=new WeakMap,yT=new WeakMap,Rd=new WeakSet,Bv=function(){const e=c(this,ze).subarray(4,6),t=c(this,ze).subarray(16,18),[r,s,i,a]=c(this,Ys);return[(c(this,Id)+(e[0]-t[0])/2-r)/i,(c(this,Dd)+(e[1]-t[1])/2-s)/a,(c(this,Id)+(t[0]-e[0])/2-r)/i,(c(this,Dd)+(t[1]-e[1])/2-s)/a]},vT=new WeakSet,EW=function(){const[e,t,r,s]=c(this,Ys),[i,a,o,l]=D(this,Rd,Bv).call(this);return`M${(c(this,ze)[2]-e)/r} ${(c(this,ze)[3]-t)/s} L${(c(this,ze)[4]-e)/r} ${(c(this,ze)[5]-t)/s} L${i} ${a} L${o} ${l} L${(c(this,ze)[16]-e)/r} ${(c(this,ze)[17]-t)/s} L${(c(this,ze)[14]-e)/r} ${(c(this,ze)[15]-t)/s} Z`},wT=new WeakSet,AW=function(e){const t=c(this,la);e.push(`L${t[4]} ${t[5]} Z`)},bT=new WeakSet,TW=function(e){const[t,r,s,i]=c(this,Ys),a=c(this,ze).subarray(4,6),o=c(this,ze).subarray(16,18),[l,u,h,f]=D(this,Rd,Bv).call(this);e.push(`L${(a[0]-t)/s} ${(a[1]-r)/i} L${l} ${u} L${h} ${f} L${(o[0]-t)/s} ${(o[1]-r)/i}`)},_T=new WeakSet,CW=function(e){const t=c(this,ze),[r,s,i,a]=c(this,Ys),[o,l,u,h]=D(this,Rd,Bv).call(this),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-r)/i,(t[3]-s)/a,NaN,NaN,NaN,NaN,(t[4]-r)/i,(t[5]-s)/a,NaN,NaN,NaN,NaN,o,l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-r)/i,(t[17]-s)/a,NaN,NaN,NaN,NaN,(t[14]-r)/i,(t[15]-s)/a],0),this.newFreeDrawOutline(f,e,c(this,Ys),c(this,yg),c(this,mg),c(this,gg))},xT=new WeakSet,kW=function(e,t){const r=c(this,la);return e.set([NaN,NaN,NaN,NaN,r[4],r[5]],t),t+=6},ST=new WeakSet,NW=function(e,t){const r=c(this,ze).subarray(4,6),s=c(this,ze).subarray(16,18),[i,a,o,l]=c(this,Ys),[u,h,f,p]=D(this,Rd,Bv).call(this);return e.set([NaN,NaN,NaN,NaN,(r[0]-i)/o,(r[1]-a)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(s[0]-i)/o,(s[1]-a)/l],t),t+=24},x(Bo,a_,8),x(Bo,gT,2),x(Bo,yT,c(Bo,a_)+c(Bo,gT));let iA=Bo;var wg,Md,wl,o_,Ks,l_,mn,ET,IW;class PW extends ge{constructor(t,r,s,i,a,o){super();x(this,ET);x(this,wg,void 0);x(this,Md,new Float32Array(4));x(this,wl,void 0);x(this,o_,void 0);x(this,Ks,void 0);x(this,l_,void 0);x(this,mn,void 0);A(this,mn,t),A(this,Ks,r),A(this,wg,s),A(this,l_,i),A(this,wl,a),A(this,o_,o),this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],D(this,ET,IW).call(this,o);const[l,u,h,f]=c(this,Md);for(let p=0,g=t.length;p<g;p+=2)t[p]=(t[p]-l)/h,t[p+1]=(t[p+1]-u)/f;for(let p=0,g=r.length;p<g;p+=2)r[p]=(r[p]-l)/h,r[p+1]=(r[p+1]-u)/f}toSVGPath(){const t=[`M${c(this,mn)[4]} ${c(this,mn)[5]}`];for(let r=6,s=c(this,mn).length;r<s;r+=6){if(isNaN(c(this,mn)[r])){t.push(`L${c(this,mn)[r+4]} ${c(this,mn)[r+5]}`);continue}t.push(`C${c(this,mn)[r]} ${c(this,mn)[r+1]} ${c(this,mn)[r+2]} ${c(this,mn)[r+3]} ${c(this,mn)[r+4]} ${c(this,mn)[r+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,r,s,i],a){const o=s-t,l=i-r;let u,h;switch(a){case 0:u=ge._rescale(c(this,mn),t,i,o,-l),h=ge._rescale(c(this,Ks),t,i,o,-l);break;case 90:u=ge._rescaleAndSwap(c(this,mn),t,r,o,l),h=ge._rescaleAndSwap(c(this,Ks),t,r,o,l);break;case 180:u=ge._rescale(c(this,mn),s,r,-o,l),h=ge._rescale(c(this,Ks),s,r,-o,l);break;case 270:u=ge._rescaleAndSwap(c(this,mn),s,i,-o,-l),h=ge._rescaleAndSwap(c(this,Ks),s,i,-o,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return c(this,Md)}newOutliner(t,r,s,i,a,o=0){return new iA(t,r,s,i,a,o)}getNewOutline(t,r){const[s,i,a,o]=c(this,Md),[l,u,h,f]=c(this,wg),p=a*h,g=o*f,v=s*h+l,y=i*f+u,_=this.newOutliner({x:c(this,Ks)[0]*p+v,y:c(this,Ks)[1]*g+y},c(this,wg),c(this,l_),t,c(this,o_),r??c(this,wl));for(let w=2;w<c(this,Ks).length;w+=2)_.add({x:c(this,Ks)[w]*p+v,y:c(this,Ks)[w+1]*g+y});return _.getOutlines()}}wg=new WeakMap,Md=new WeakMap,wl=new WeakMap,o_=new WeakMap,Ks=new WeakMap,l_=new WeakMap,mn=new WeakMap,ET=new WeakSet,IW=function(t){const r=c(this,mn);let s=r[4],i=r[5];const a=[s,i,s,i];let o=s,l=i,u=s,h=i;const f=t?Math.max:Math.min,p=new Float32Array(4);for(let v=6,y=r.length;v<y;v+=6){const _=r[v+4],w=r[v+5];isNaN(r[v])?(ye.pointBoundingBox(_,w,a),l>w?(o=_,l=w):l===w&&(o=f(o,_)),h<w?(u=_,h=w):h===w&&(u=f(u,_))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,ye.bezierBoundingBox(s,i,...r.slice(v,v+6),p),ye.rectBoundingBox(p[0],p[1],p[2],p[3],a),l>p[1]?(o=p[0],l=p[1]):l===p[1]&&(o=f(o,p[0])),h<p[3]?(u=p[2],h=p[3]):h===p[3]&&(u=f(u,p[2]))),s=_,i=w}const g=c(this,Md);g[0]=a[0]-c(this,wl),g[1]=a[1]-c(this,wl),g[2]=a[2]-a[0]+2*c(this,wl),g[3]=a[3]-a[1]+2*c(this,wl),this.firstPoint=[o,l],this.lastPoint=[u,h]};var c_,u_,h_,ou,ca,AT,DW,bg,PE,TT,RW,CT,MW,d_,qD;class GD{constructor(e,t=0,r=0,s=!0){x(this,AT);x(this,bg);x(this,TT);x(this,CT);x(this,d_);x(this,c_,void 0);x(this,u_,void 0);x(this,h_,void 0);x(this,ou,[]);x(this,ca,[]);const i=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:_,y:w,width:b,height:S}of e){const T=Math.floor((_-t)/o)*o,P=Math.ceil((_+b+t)/o)*o,R=Math.floor((w-t)/o)*o,k=Math.ceil((w+S+t)/o)*o,C=[T,R,k,!0],I=[P,R,k,!1];c(this,ou).push(C,I),ye.rectBoundingBox(T,R,P,k,i)}const l=i[2]-i[0]+2*r,u=i[3]-i[1]+2*r,h=i[0]-r,f=i[1]-r;let p=s?-1/0:1/0,g=1/0;const v=c(this,ou).at(s?-1:-2),y=[v[0],v[2]];for(const _ of c(this,ou)){const[w,b,S,T]=_;!T&&s?b<g?(g=b,p=w):b===g&&(p=Math.max(p,w)):T&&!s&&(b<g?(g=b,p=w):b===g&&(p=Math.min(p,w))),_[0]=(w-h)/l,_[1]=(b-f)/u,_[2]=(S-f)/u}A(this,c_,new Float32Array([h,f,l,u])),A(this,u_,[p,g]),A(this,h_,y)}getOutlines(){c(this,ou).sort((t,r)=>t[0]-r[0]||t[1]-r[1]||t[2]-r[2]);const e=[];for(const t of c(this,ou))t[3]?(e.push(...D(this,d_,qD).call(this,t)),D(this,TT,RW).call(this,t)):(D(this,CT,MW).call(this,t),e.push(...D(this,d_,qD).call(this,t)));return D(this,AT,DW).call(this,e)}}c_=new WeakMap,u_=new WeakMap,h_=new WeakMap,ou=new WeakMap,ca=new WeakMap,AT=new WeakSet,DW=function(e){const t=[],r=new Set;for(const a of e){const[o,l,u]=a;t.push([o,l,a],[o,u,a])}t.sort((a,o)=>a[1]-o[1]||a[0]-o[0]);for(let a=0,o=t.length;a<o;a+=2){const l=t[a][2],u=t[a+1][2];l.push(u),u.push(l),r.add(l),r.add(u)}const s=[];let i;for(;r.size>0;){const a=r.values().next().value;let[o,l,u,h,f]=a;r.delete(a);let p=o,g=l;for(i=[o,u],s.push(i);;){let v;if(r.has(h))v=h;else if(r.has(f))v=f;else break;r.delete(v),[o,l,u,h,f]=v,p!==o&&(i.push(p,g,o,g===l?l:u),p=o),g=g===l?u:l}i.push(p,g)}return new $1e(s,c(this,c_),c(this,u_),c(this,h_))},bg=new WeakSet,PE=function(e){const t=c(this,ca);let r=0,s=t.length-1;for(;r<=s;){const i=r+s>>1,a=t[i][0];if(a===e)return i;a<e?r=i+1:s=i-1}return s+1},TT=new WeakSet,RW=function([,e,t]){const r=D(this,bg,PE).call(this,e);c(this,ca).splice(r,0,[e,t])},CT=new WeakSet,MW=function([,e,t]){const r=D(this,bg,PE).call(this,e);for(let s=r;s<c(this,ca).length;s++){const[i,a]=c(this,ca)[s];if(i!==e)break;if(i===e&&a===t){c(this,ca).splice(s,1);return}}for(let s=r-1;s>=0;s--){const[i,a]=c(this,ca)[s];if(i!==e)break;if(i===e&&a===t){c(this,ca).splice(s,1);return}}},d_=new WeakSet,qD=function(e){const[t,r,s]=e,i=[[t,r,s]],a=D(this,bg,PE).call(this,s);for(let o=0;o<a;o++){const[l,u]=c(this,ca)[o];for(let h=0,f=i.length;h<f;h++){const[,p,g]=i[h];if(!(u<=p||g<=l)){if(p>=l){if(g>u)i[h][1]=u;else{if(f===1)return[];i.splice(h,1),h--,f--}continue}i[h][2]=l,g>u&&i.push([t,u,g])}}}return i};var f_,_g;class $1e extends ge{constructor(t,r,s,i){super();x(this,f_,void 0);x(this,_g,void 0);A(this,_g,t),A(this,f_,r),this.firstPoint=s,this.lastPoint=i}toSVGPath(){const t=[];for(const r of c(this,_g)){let[s,i]=r;t.push(`M${s} ${i}`);for(let a=2;a<r.length;a+=2){const o=r[a],l=r[a+1];o===s?(t.push(`V${l}`),i=l):l===i&&(t.push(`H${o}`),s=o)}t.push("Z")}return t.join(" ")}serialize([t,r,s,i],a){const o=[],l=s-t,u=i-r;for(const h of c(this,_g)){const f=new Array(h.length);for(let p=0;p<h.length;p+=2)f[p]=t+h[p]*l,f[p+1]=i-h[p+1]*u;o.push(f)}return o}get box(){return c(this,f_)}get classNamesForOutlining(){return["highlightOutline"]}}f_=new WeakMap,_g=new WeakMap;class YD extends iA{newFreeDrawOutline(e,t,r,s,i,a){return new U1e(e,t,r,s,i,a)}}class U1e extends PW{newOutliner(e,t,r,s,i,a=0){return new YD(e,t,r,s,i,a)}}var xg,p_,bl,Od,m_,gs,g_,y_,Ld,Xs,Qs,or,Sg,Eg,Rr,Ag,Ci,v_,w_,KD,Tg,IE,kT,OW,NT,LW,PT,jW,b_,XD,_l,gh,lu,hp,IT,FW,Cg,DE,kg,RE,DT,$W,RT,UW,MT,VW,OT,BW,LT,zW;const tt=class tt extends It{constructor(t){super({...t,name:"highlightEditor"});x(this,w_);x(this,Tg);x(this,kT);x(this,NT);x(this,PT);x(this,b_);x(this,_l);x(this,IT);x(this,Cg);x(this,kg);x(this,DT);x(this,RT);x(this,LT);x(this,xg,null);x(this,p_,0);x(this,bl,void 0);x(this,Od,null);x(this,m_,null);x(this,gs,null);x(this,g_,null);x(this,y_,0);x(this,Ld,null);x(this,Xs,null);x(this,Qs,null);x(this,or,!1);x(this,Sg,null);x(this,Eg,null);x(this,Rr,null);x(this,Ag,"");x(this,Ci,void 0);x(this,v_,"");this.color=t.color||tt._defaultColor,A(this,Ci,t.thickness||tt._defaultThickness),this.opacity=t.opacity||tt._defaultOpacity,A(this,bl,t.boxes||null),A(this,v_,t.methodOfCreation||""),A(this,Ag,t.text||""),this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(A(this,or,!0),D(this,Tg,IE).call(this,t),D(this,_l,gh).call(this)):c(this,bl)&&(A(this,xg,t.anchorNode),A(this,p_,t.anchorOffset),A(this,g_,t.focusNode),A(this,y_,t.focusOffset),D(this,w_,KD).call(this),D(this,_l,gh).call(this),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}static get _keyboardManager(){const t=tt.prototype;return Ve(this,"_keyboardManager",new Ax([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,or)?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:c(this,Ci),methodOfCreation:c(this,v_)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,r){var s;It.initialize(t,r),tt._defaultColor||(tt._defaultColor=((s=r.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,r){switch(t){case Qe.HIGHLIGHT_COLOR:tt._defaultColor=r;break;case Qe.HIGHLIGHT_THICKNESS:tt._defaultThickness=r;break}}translateInPage(t,r){}get toolbarPosition(){return c(this,Eg)}get commentButtonPosition(){return c(this,Sg)}updateParams(t,r){switch(t){case Qe.HIGHLIGHT_COLOR:D(this,kT,OW).call(this,r);break;case Qe.HIGHLIGHT_THICKNESS:D(this,NT,LW).call(this,r);break}}static get defaultPropertiesToUpdate(){return[[Qe.HIGHLIGHT_COLOR,tt._defaultColor],[Qe.HIGHLIGHT_THICKNESS,tt._defaultThickness]]}get propertiesToUpdate(){return[[Qe.HIGHLIGHT_COLOR,this.color||tt._defaultColor],[Qe.HIGHLIGHT_THICKNESS,c(this,Ci)||tt._defaultThickness],[Qe.HIGHLIGHT_FREE,c(this,or)]]}onUpdatedColor(){var t,r;(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Qs),{root:{fill:this.color,"fill-opacity":this.opacity}}),(r=c(this,m_))==null||r.updateColor(this.color),super.onUpdatedColor()}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",A(this,m_,new nA({editor:this}))]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(D(this,kg,RE).call(this))}getBaseTranslation(){return[0,0]}getRect(t,r){return super.getRect(t,r,D(this,kg,RE).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){D(this,b_,XD).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,_l,gh).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let r=!1;this.parent&&!t?D(this,b_,XD).call(this):t&&(D(this,_l,gh).call(this,t),r=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),r&&this.select()}rotate(t){var i,a,o;const{drawLayer:r}=this.parent;let s;c(this,or)?(t=(t-this.rotation+360)%360,s=D(i=tt,lu,hp).call(i,c(this,Xs).box,t)):s=D(a=tt,lu,hp).call(a,[this.x,this.y,this.width,this.height],t),r.updateProperties(c(this,Qs),{bbox:s,root:{"data-main-rotation":t}}),r.updateProperties(c(this,Rr),{bbox:D(o=tt,lu,hp).call(o,c(this,gs).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Ag)&&(t.setAttribute("aria-label",c(this,Ag)),t.setAttribute("role","mark")),c(this,or)?t.classList.add("free"):this.div.addEventListener("keydown",D(this,IT,FW).bind(this),{signal:this._uiManager._signal});const r=A(this,Ld,document.createElement("div"));return t.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",r.style.clipPath=c(this,Od),this.setDims(this.width,this.height),h9(this,c(this,Ld),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:D(this,Cg,DE).call(this,!0);break;case 1:case 3:D(this,Cg,DE).call(this,!1);break}}select(){var t;super.select(),c(this,Rr)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,Rr)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,Rr),{rootClass:{selected:!1}}),c(this,or)||D(this,Cg,DE).call(this,!1))}get _mustFixPosition(){return!c(this,or)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,Qs),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,Rr),{rootClass:{hidden:!t}}))}static startHighlighting(t,r,{target:s,x:i,y:a}){const{x:o,y:l,width:u,height:h}=s.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),g=v=>{f.abort(),D(this,OT,BW).call(this,t,v)};window.addEventListener("blur",g,{signal:p}),window.addEventListener("pointerup",g,{signal:p}),window.addEventListener("pointerdown",cn,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",Hi,{signal:p}),s.addEventListener("pointermove",D(this,MT,VW).bind(this,t),{signal:p}),this._freeHighlight=new YD({x:i,y:a},[o,l,u,h],t.scale,this._defaultThickness/2,r,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,r,s){var y,_,w,b;let i=null;if(t instanceof yW){const{data:{quadPoints:S,rect:T,rotation:P,id:R,color:k,opacity:C,popupRef:I,richText:M,contentsObj:L,creationDate:F,modificationDate:O},parent:{page:{pageNumber:Y}}}=t;i=t={annotationType:Fe.HIGHLIGHT,color:Array.from(k),opacity:C,quadPoints:S,boxes:null,pageIndex:Y-1,rect:T.slice(0),rotation:P,annotationElementId:R,id:R,deleted:!1,popupRef:I,richText:M,comment:(L==null?void 0:L.str)||null,creationDate:F,modificationDate:O}}else if(t instanceof NO){const{data:{inkLists:S,rect:T,rotation:P,id:R,color:k,borderStyle:{rawWidth:C},popupRef:I,richText:M,contentsObj:L,creationDate:F,modificationDate:O},parent:{page:{pageNumber:Y}}}=t;i=t={annotationType:Fe.HIGHLIGHT,color:Array.from(k),thickness:C,inkLists:S,boxes:null,pageIndex:Y-1,rect:T.slice(0),rotation:P,annotationElementId:R,id:R,deleted:!1,popupRef:I,richText:M,comment:(L==null?void 0:L.str)||null,creationDate:F,modificationDate:O}}const{color:a,quadPoints:o,inkLists:l,opacity:u}=t,h=await super.deserialize(t,r,s);h.color=ye.makeHexColor(...a),h.opacity=u||1,l&&A(h,Ci,t.thickness),h._initialData=i,t.comment&&h.setCommentData(t);const[f,p]=h.pageDimensions,[g,v]=h.pageTranslation;if(o){const S=A(h,bl,[]);for(let T=0;T<o.length;T+=8)S.push({x:(o[T]-g)/f,y:1-(o[T+1]-v)/p,width:(o[T+2]-o[T])/f,height:(o[T+1]-o[T+5])/p});D(y=h,w_,KD).call(y),D(_=h,_l,gh).call(_),h.rotate(h.rotation)}else if(l){A(h,or,!0);const S=l[0],T={x:S[0]-g,y:p-(S[1]-v)},P=new YD(T,[0,0,f,p],1,c(h,Ci)/2,!0,.001);for(let C=0,I=S.length;C<I;C+=2)T.x=S[C]-g,T.y=p-(S[C+1]-v),P.add(T);const{id:R,clipPathId:k}=r.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:P.toSVGPath()}},!0,!0);D(w=h,Tg,IE).call(w,{highlightOutlines:P.getOutlines(),highlightId:R,clipPathId:k}),D(b=h,_l,gh).call(b),h.rotate(h.parentRotation)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const r=It._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),s=super.serialize(t);return Object.assign(s,{color:r,opacity:this.opacity,thickness:c(this,Ci),quadPoints:D(this,DT,$W).call(this),outlines:D(this,RT,UW).call(this,s.rect)}),this.addComment(s),this.annotationElementId&&!D(this,LT,zW).call(this,s)?null:(s.id=this.annotationElementId,s)}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}};xg=new WeakMap,p_=new WeakMap,bl=new WeakMap,Od=new WeakMap,m_=new WeakMap,gs=new WeakMap,g_=new WeakMap,y_=new WeakMap,Ld=new WeakMap,Xs=new WeakMap,Qs=new WeakMap,or=new WeakMap,Sg=new WeakMap,Eg=new WeakMap,Rr=new WeakMap,Ag=new WeakMap,Ci=new WeakMap,v_=new WeakMap,w_=new WeakSet,KD=function(){const t=new GD(c(this,bl),.001);A(this,Xs,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Xs).box;const r=new GD(c(this,bl),.0025,.001,this._uiManager.direction==="ltr");A(this,gs,r.getOutlines());const{firstPoint:s}=c(this,Xs);A(this,Sg,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]);const{lastPoint:i}=c(this,gs);A(this,Eg,[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height])},Tg=new WeakSet,IE=function({highlightOutlines:t,highlightId:r,clipPathId:s}){var p,g;A(this,Xs,t);const i=1.5;if(A(this,gs,t.getNewOutline(c(this,Ci)/2+i,.0025)),r>=0)A(this,Qs,r),A(this,Od,s),this.parent.drawLayer.finalizeDraw(r,{bbox:t.box,path:{d:t.toSVGPath()}}),A(this,Rr,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,gs).box,path:{d:c(this,gs).toSVGPath()}},!0));else if(this.parent){const v=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,Qs),{bbox:D(p=tt,lu,hp).call(p,c(this,Xs).box,(v-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,Rr),{bbox:D(g=tt,lu,hp).call(g,c(this,gs).box,v),path:{d:c(this,gs).toSVGPath()}})}const[a,o,l,u]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=l,this.height=u;break;case 90:{const[v,y]=this.parentDimensions;this.x=o,this.y=1-a,this.width=l*y/v,this.height=u*v/y;break}case 180:this.x=1-a,this.y=1-o,this.width=l,this.height=u;break;case 270:{const[v,y]=this.parentDimensions;this.x=1-o,this.y=a,this.width=l*y/v,this.height=u*v/y;break}}const{firstPoint:h}=t;A(this,Sg,[(h[0]-a)/l,(h[1]-o)/u]);const{lastPoint:f}=c(this,gs);A(this,Eg,[(f[0]-a)/l,(f[1]-o)/u])},kT=new WeakSet,OW=function(t){const r=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},s=this.color,i=this.opacity;this.addCommands({cmd:r.bind(this,t,tt._defaultOpacity),undo:r.bind(this,s,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)},NT=new WeakSet,LW=function(t){const r=c(this,Ci),s=i=>{A(this,Ci,i),D(this,PT,jW).call(this,i)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Qe.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},PT=new WeakSet,jW=function(t){c(this,or)&&(D(this,Tg,IE).call(this,{highlightOutlines:c(this,Xs).getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))},b_=new WeakSet,XD=function(){c(this,Qs)===null||!this.parent||(this.parent.drawLayer.remove(c(this,Qs)),A(this,Qs,null),this.parent.drawLayer.remove(c(this,Rr)),A(this,Rr,null))},_l=new WeakSet,gh=function(t=this.parent){c(this,Qs)===null&&({id:Cn(this,Qs)._,clipPathId:Cn(this,Od)._}=t.drawLayer.draw({bbox:c(this,Xs).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:c(this,or)},path:{d:c(this,Xs).toSVGPath()}},!1,!0),A(this,Rr,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,or)},bbox:c(this,gs).box,path:{d:c(this,gs).toSVGPath()}},c(this,or))),c(this,Ld)&&(c(this,Ld).style.clipPath=c(this,Od)))},lu=new WeakSet,hp=function([t,r,s,i],a){switch(a){case 90:return[1-r-i,t,i,s];case 180:return[1-t-s,1-r-i,s,i];case 270:return[r,1-t-s,i,s]}return[t,r,s,i]},IT=new WeakSet,FW=function(t){tt._keyboardManager.exec(this,t)},Cg=new WeakSet,DE=function(t){if(!c(this,xg))return;const r=window.getSelection();t?r.setPosition(c(this,xg),c(this,p_)):r.setPosition(c(this,g_),c(this,y_))},kg=new WeakSet,RE=function(){return c(this,or)?this.rotation:0},DT=new WeakSet,$W=function(){if(c(this,or))return null;const[t,r]=this.pageDimensions,[s,i]=this.pageTranslation,a=c(this,bl),o=new Float32Array(a.length*8);let l=0;for(const{x:u,y:h,width:f,height:p}of a){const g=u*t+s,v=(1-h)*r+i;o[l]=o[l+4]=g,o[l+1]=o[l+3]=v,o[l+2]=o[l+6]=g+f*t,o[l+5]=o[l+7]=v-p*r,l+=8}return o},RT=new WeakSet,UW=function(t){return c(this,Xs).serialize(t,D(this,kg,RE).call(this))},MT=new WeakSet,VW=function(t,r){this._freeHighlight.add(r)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},OT=new WeakSet,BW=function(t,r){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(r,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},LT=new WeakSet,zW=function(t){const{color:r}=this._initialData;return this.hasEditedComment||t.color.some((s,i)=>s!==r[i])},x(tt,lu),x(tt,MT),x(tt,OT),ie(tt,"_defaultColor",null),ie(tt,"_defaultOpacity",1),ie(tt,"_defaultThickness",12),ie(tt,"_type","highlight"),ie(tt,"_editorType",Fe.HIGHLIGHT),ie(tt,"_freeHighlightId",-1),ie(tt,"_freeHighlight",null),ie(tt,"_freeHighlightClipId","");let aA=tt;var jd;class HW{constructor(){x(this,jd,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,r]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,r)}updateSVGProperty(e,t){c(this,jd)[e]=t}toSVGProperties(){const e=c(this,jd);return A(this,jd,Object.create(null)),{root:e}}reset(){A(this,jd,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Tt("Not implemented")}}jd=new WeakMap;var Js,Ng,Wn,Fd,$d,cu,uu,hu,Ud,__,QD,x_,JD,S_,ZD,Vd,zv,jT,WW,Pg,ME,Bd,Hv,du,dp;const be=class be extends It{constructor(t){super(t);x(this,__);x(this,x_);x(this,S_);x(this,Vd);x(this,jT);x(this,Pg);x(this,Bd);x(this,du);x(this,Js,null);x(this,Ng,void 0);ie(this,"_colorPicker",null);ie(this,"_drawId",null);A(this,Ng,t.mustBeCommitted||!1),this._addOutlines(t)}onUpdatedColor(){var t;(t=this._colorPicker)==null||t.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(D(this,__,QD).call(this,t),D(this,Vd,zv).call(this))}static _mergeSVGProperties(t,r){const s=new Set(Object.keys(t));for(const[i,a]of Object.entries(r))s.has(i)?Object.assign(t[i],a):t[i]=a;return t}static getDefaultDrawingOptions(t){Tt("Not implemented")}static get typesMap(){Tt("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,r){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,r),this._currentParent&&(c(be,Wn).updateProperty(s,r),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,r){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,r)}static get defaultPropertiesToUpdate(){const t=[],r=this._defaultDrawingOptions;for(const[s,i]of this.typesMap)t.push([s,r[i]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:r}=this;for(const[s,i]of this.constructor.typesMap)t.push([s,r[i]]);return t}_updateProperty(t,r,s){const i=this._drawingOptions,a=i[r],o=l=>{var h;i.updateProperty(r,l);const u=c(this,Js).updateProperty(r,l);u&&D(this,Bd,Hv).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,s),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,be._mergeSVGProperties(c(this,Js).getPathResizingSVGProperties(D(this,Pg,ME).call(this)),{bbox:D(this,du,dp).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,be._mergeSVGProperties(c(this,Js).getPathResizedSVGProperties(D(this,Pg,ME).call(this)),{bbox:D(this,du,dp).call(this)}))}_onTranslating(t,r){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:D(this,du,dp).call(this)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,be._mergeSVGProperties(c(this,Js).getPathTranslatedSVGProperties(D(this,Pg,ME).call(this),this.parentDimensions),{bbox:D(this,du,dp).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,Ng)&&(A(this,Ng,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){D(this,S_,ZD).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(D(this,Vd,zv).call(this),D(this,Bd,Hv).call(this,c(this,Js).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let r=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),D(this,S_,ZD).call(this)):t&&(this._uiManager.addShouldRescale(this),D(this,Vd,zv).call(this,t),r=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),r&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,be._mergeSVGProperties({bbox:D(this,du,dp).call(this)},c(this,Js).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&D(this,Bd,Hv).call(this,c(this,Js).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,r;this._isCopy&&(t=this.x,r=this.y);const s=super.render();s.classList.add("draw");const i=document.createElement("div");return s.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,r),s}static createDrawerInstance(t,r,s,i,a){Tt("Not implemented")}static startDrawing(t,r,s,i){var _;const{target:a,offsetX:o,offsetY:l,pointerId:u,pointerType:h}=i;if(c(be,uu)&&c(be,uu)!==h)return;const{viewport:{rotation:f}}=t,{width:p,height:g}=a.getBoundingClientRect(),v=A(be,Fd,new AbortController),y=t.combinedSignal(v);if(c(be,cu)||A(be,cu,u),c(be,uu)??A(be,uu,h),window.addEventListener("pointerup",w=>{var b;c(be,cu)===w.pointerId?this._endDraw(w):(b=c(be,hu))==null||b.delete(w.pointerId)},{signal:y}),window.addEventListener("pointercancel",w=>{var b;c(be,cu)===w.pointerId?this._currentParent.endDrawingSession():(b=c(be,hu))==null||b.delete(w.pointerId)},{signal:y}),window.addEventListener("pointerdown",w=>{c(be,uu)===w.pointerType&&((c(be,hu)||A(be,hu,new Set)).add(w.pointerId),c(be,Wn).isCancellable()&&(c(be,Wn).removeLastElement(),c(be,Wn).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Hi,{signal:y}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:y}),a.addEventListener("touchmove",w=>{w.timeStamp===c(be,Ud)&&cn(w)},{signal:y}),t.toggleDrawing(),(_=r._editorUndoBar)==null||_.hide(),c(be,Wn)){t.drawLayer.updateProperties(this._currentDrawId,c(be,Wn).startNew(o,l,p,g,f));return}r.updateUIForDefaultProperties(this),A(be,Wn,this.createDrawerInstance(o,l,p,g,f)),A(be,$d,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(be,$d).toSVGProperties(),c(be,Wn).defaultSVGProperties),!0,!1)}static _drawMove(t){var a;if(A(be,Ud,-1),!c(be,Wn))return;const{offsetX:r,offsetY:s,pointerId:i}=t;if(c(be,cu)===i){if(((a=c(be,hu))==null?void 0:a.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(be,Wn).add(r,s)),A(be,Ud,t.timeStamp),cn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,A(be,Wn,null),A(be,$d,null),A(be,uu,null),A(be,Ud,NaN)),c(be,Fd)&&(c(be,Fd).abort(),A(be,Fd,null),A(be,cu,NaN),A(be,hu,null))}static _endDraw(t){const r=this._currentParent;if(r){if(r.toggleDrawing(!0),this._cleanup(!1),(t==null?void 0:t.target)===r.div&&r.drawLayer.updateProperties(this._currentDrawId,c(be,Wn).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=c(be,Wn),i=this._currentDrawId,a=s.getLastElement();r.addCommands({cmd:()=>{r.drawLayer.updateProperties(i,s.setLastElement(a))},undo:()=>{r.drawLayer.updateProperties(i,s.removeLastElement())},mustExec:!1,type:Qe.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const r=this._currentParent;if(!r)return null;if(r.toggleDrawing(!0),r.cleanUndoStack(Qe.DRAW_STEP),!c(be,Wn).isEmpty()){const{pageDimensions:[s,i],scale:a}=r,o=r.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(be,Wn).getOutlines(s*a,i*a,a,this._INNER_MARGIN),drawingOptions:c(be,$d),mustBeCommitted:!t});return this._cleanup(!0),o}return r.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,r,s,i,a,o){Tt("Not implemented")}static async deserialize(t,r,s){var f,p;const{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:l}}=r.viewport,u=this.deserializeDraw(o,l,i,a,this._INNER_MARGIN,t),h=await super.deserialize(t,r,s);return h.createDrawingOptions(t),D(f=h,__,QD).call(f,{drawOutlines:u}),D(p=h,Vd,zv).call(p),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[r,s]=this.pageTranslation,[i,a]=this.pageDimensions;return c(this,Js).serialize([r,s,i,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}};Js=new WeakMap,Ng=new WeakMap,Wn=new WeakMap,Fd=new WeakMap,$d=new WeakMap,cu=new WeakMap,uu=new WeakMap,hu=new WeakMap,Ud=new WeakMap,__=new WeakSet,QD=function({drawOutlines:t,drawId:r,drawingOptions:s}){A(this,Js,t),this._drawingOptions||(this._drawingOptions=s),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),r>=0?(this._drawId=r,this.parent.drawLayer.finalizeDraw(r,t.defaultProperties)):this._drawId=D(this,x_,JD).call(this,t,this.parent),D(this,Bd,Hv).call(this,t.box)},x_=new WeakSet,JD=function(t,r){const{id:s}=r.drawLayer.draw(be._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},S_=new WeakSet,ZD=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Vd=new WeakSet,zv=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=D(this,x_,JD).call(this,c(this,Js),t)}},jT=new WeakSet,WW=function([t,r,s,i]){const{parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[r,1-t,s*(o/a),i*(a/o)];case 180:return[1-t,1-r,s,i];case 270:return[1-r,t,s*(o/a),i*(a/o)];default:return[t,r,s,i]}},Pg=new WeakSet,ME=function(){const{x:t,y:r,width:s,height:i,parentDimensions:[a,o],rotation:l}=this;switch(l){case 90:return[1-r,t,s*(a/o),i*(o/a)];case 180:return[1-t,1-r,s,i];case 270:return[r,1-t,s*(a/o),i*(o/a)];default:return[t,r,s,i]}},Bd=new WeakSet,Hv=function(t){[this.x,this.y,this.width,this.height]=D(this,jT,WW).call(this,t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()},du=new WeakSet,dp=function(){const{x:t,y:r,width:s,height:i,rotation:a,parentRotation:o,parentDimensions:[l,u]}=this;switch((a*4+o)/90){case 1:return[1-r-i,t,i,s];case 2:return[1-t-s,1-r-i,s,i];case 3:return[r,1-t-s,i,s];case 4:return[t,r-s*(l/u),i*(u/l),s*(l/u)];case 5:return[1-r,t,s*(l/u),i*(u/l)];case 6:return[1-t-i*(u/l),1-r,i*(u/l),s*(l/u)];case 7:return[r-s*(l/u),1-t-i*(u/l),s*(l/u),i*(u/l)];case 8:return[t-s,r-i,s,i];case 9:return[1-r,t-s,i,s];case 10:return[1-t,1-r,s,i];case 11:return[r-i,1-t,i,s];case 12:return[t-i*(u/l),r,i*(u/l),s*(l/u)];case 13:return[1-r-s*(l/u),t-i*(u/l),s*(l/u),i*(u/l)];case 14:return[1-t,1-r-s*(l/u),i*(u/l),s*(l/u)];case 15:return[r,1-t,s*(l/u),i*(u/l)];default:return[t,r,s,i]}},ie(be,"_currentDrawId",-1),ie(be,"_currentParent",null),x(be,Wn,null),x(be,Fd,null),x(be,$d,null),x(be,cu,NaN),x(be,uu,null),x(be,hu,null),x(be,Ud,NaN),ie(be,"_INNER_MARGIN",3);let oA=be;var so,Gn,qn,zd,Ig,Yr,lr,ki,Hd,Wd,Gd,Dg,OE;class V1e{constructor(e,t,r,s,i,a){x(this,Dg);x(this,so,new Float64Array(6));x(this,Gn,void 0);x(this,qn,void 0);x(this,zd,void 0);x(this,Ig,void 0);x(this,Yr,void 0);x(this,lr,"");x(this,ki,0);x(this,Hd,new Cx);x(this,Wd,void 0);x(this,Gd,void 0);A(this,Wd,r),A(this,Gd,s),A(this,zd,i),A(this,Ig,a),[e,t]=D(this,Dg,OE).call(this,e,t);const o=A(this,Gn,[NaN,NaN,NaN,NaN,e,t]);A(this,Yr,[e,t]),A(this,qn,[{line:o,points:c(this,Yr)}]),c(this,so).set(o,0)}updateProperty(e,t){e==="stroke-width"&&A(this,Ig,t)}isEmpty(){return!c(this,qn)||c(this,qn).length===0}isCancellable(){return c(this,Yr).length<=10}add(e,t){[e,t]=D(this,Dg,OE).call(this,e,t);const[r,s,i,a]=c(this,so).subarray(2,6),o=e-i,l=t-a;return Math.hypot(c(this,Wd)*o,c(this,Gd)*l)<=2?null:(c(this,Yr).push(e,t),isNaN(r)?(c(this,so).set([i,a,e,t],2),c(this,Gn).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,so)[0])&&c(this,Gn).splice(6,6),c(this,so).set([r,s,i,a,e,t],0),c(this,Gn).push(...ge.createBezierPoints(r,s,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const r=this.add(e,t);return r||(c(this,Yr).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,r,s,i){A(this,Wd,r),A(this,Gd,s),A(this,zd,i),[e,t]=D(this,Dg,OE).call(this,e,t);const a=A(this,Gn,[NaN,NaN,NaN,NaN,e,t]);A(this,Yr,[e,t]);const o=c(this,qn).at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),c(this,qn).push({line:a,points:c(this,Yr)}),c(this,so).set(a,0),A(this,ki,0),this.toSVGPath(),null}getLastElement(){return c(this,qn).at(-1)}setLastElement(e){return c(this,qn)?(c(this,qn).push(e),A(this,Gn,e.line),A(this,Yr,e.points),A(this,ki,0),{path:{d:this.toSVGPath()}}):c(this,Hd).setLastElement(e)}removeLastElement(){if(!c(this,qn))return c(this,Hd).removeLastElement();c(this,qn).pop(),A(this,lr,"");for(let e=0,t=c(this,qn).length;e<t;e++){const{line:r,points:s}=c(this,qn)[e];A(this,Gn,r),A(this,Yr,s),A(this,ki,0),this.toSVGPath()}return{path:{d:c(this,lr)}}}toSVGPath(){const e=ge.svgRound(c(this,Gn)[4]),t=ge.svgRound(c(this,Gn)[5]);if(c(this,Yr).length===2)return A(this,lr,`${c(this,lr)} M ${e} ${t} Z`),c(this,lr);if(c(this,Yr).length<=6){const s=c(this,lr).lastIndexOf("M");A(this,lr,`${c(this,lr).slice(0,s)} M ${e} ${t}`),A(this,ki,6)}if(c(this,Yr).length===4){const s=ge.svgRound(c(this,Gn)[10]),i=ge.svgRound(c(this,Gn)[11]);return A(this,lr,`${c(this,lr)} L ${s} ${i}`),A(this,ki,12),c(this,lr)}const r=[];c(this,ki)===0&&(r.push(`M ${e} ${t}`),A(this,ki,6));for(let s=c(this,ki),i=c(this,Gn).length;s<i;s+=6){const[a,o,l,u,h,f]=c(this,Gn).slice(s,s+6).map(ge.svgRound);r.push(`C${a} ${o} ${l} ${u} ${h} ${f}`)}return A(this,lr,c(this,lr)+r.join(" ")),A(this,ki,c(this,Gn).length),c(this,lr)}getOutlines(e,t,r,s){const i=c(this,qn).at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),c(this,Hd).build(c(this,qn),e,t,r,c(this,zd),c(this,Ig),s),A(this,so,null),A(this,Gn,null),A(this,qn,null),A(this,lr,null),c(this,Hd)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}so=new WeakMap,Gn=new WeakMap,qn=new WeakMap,zd=new WeakMap,Ig=new WeakMap,Yr=new WeakMap,lr=new WeakMap,ki=new WeakMap,Hd=new WeakMap,Wd=new WeakMap,Gd=new WeakMap,Dg=new WeakSet,OE=function(e,t){return ge._normalizePoint(e,t,c(this,Wd),c(this,Gd),c(this,zd))};var Kr,E_,A_,Zs,io,ao,Rg,Mg,qd,ua,Fo,FT,GW,$T,qW,UT,YW;class Cx extends ge{constructor(){super(...arguments);x(this,ua);x(this,FT);x(this,$T);x(this,UT);x(this,Kr,void 0);x(this,E_,0);x(this,A_,void 0);x(this,Zs,void 0);x(this,io,void 0);x(this,ao,void 0);x(this,Rg,void 0);x(this,Mg,void 0);x(this,qd,void 0)}build(t,r,s,i,a,o,l){A(this,io,r),A(this,ao,s),A(this,Rg,i),A(this,Mg,a),A(this,qd,o),A(this,A_,l??0),A(this,Zs,t),D(this,$T,qW).call(this)}get thickness(){return c(this,qd)}setLastElement(t){return c(this,Zs).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,Zs).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:r}of c(this,Zs)){if(t.push(`M${ge.svgRound(r[4])} ${ge.svgRound(r[5])}`),r.length===6){t.push("Z");continue}if(r.length===12&&isNaN(r[6])){t.push(`L${ge.svgRound(r[10])} ${ge.svgRound(r[11])}`);continue}for(let s=6,i=r.length;s<i;s+=6){const[a,o,l,u,h,f]=r.subarray(s,s+6).map(ge.svgRound);t.push(`C${a} ${o} ${l} ${u} ${h} ${f}`)}}return t.join("")}serialize([t,r,s,i],a){const o=[],l=[],[u,h,f,p]=D(this,FT,GW).call(this);let g,v,y,_,w,b,S,T,P;switch(c(this,Mg)){case 0:P=ge._rescale,g=t,v=r+i,y=s,_=-i,w=t+u*s,b=r+(1-h-p)*i,S=t+(u+f)*s,T=r+(1-h)*i;break;case 90:P=ge._rescaleAndSwap,g=t,v=r,y=s,_=i,w=t+h*s,b=r+u*i,S=t+(h+p)*s,T=r+(u+f)*i;break;case 180:P=ge._rescale,g=t+s,v=r,y=-s,_=i,w=t+(1-u-f)*s,b=r+h*i,S=t+(1-u)*s,T=r+(h+p)*i;break;case 270:P=ge._rescaleAndSwap,g=t+s,v=r+i,y=-s,_=-i,w=t+(1-h-p)*s,b=r+(1-u-f)*i,S=t+(1-h)*s,T=r+(1-u)*i;break}for(const{line:R,points:k}of c(this,Zs))o.push(P(R,g,v,y,_,a?new Array(R.length):null)),l.push(P(k,g,v,y,_,a?new Array(k.length):null));return{lines:o,points:l,rect:[w,b,S,T]}}static deserialize(t,r,s,i,a,{paths:{lines:o,points:l},rotation:u,thickness:h}){const f=[];let p,g,v,y,_;switch(u){case 0:_=ge._rescale,p=-t/s,g=r/i+1,v=1/s,y=-1/i;break;case 90:_=ge._rescaleAndSwap,p=-r/i,g=-t/s,v=1/i,y=1/s;break;case 180:_=ge._rescale,p=t/s+1,g=-r/i,v=-1/s,y=1/i;break;case 270:_=ge._rescaleAndSwap,p=r/i+1,g=t/s+1,v=-1/i,y=-1/s;break}if(!o){o=[];for(const b of l){const S=b.length;if(S===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(S===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const T=new Float32Array(3*(S-2));o.push(T);let[P,R,k,C]=b.subarray(0,4);T.set([NaN,NaN,NaN,NaN,P,R],0);for(let I=4;I<S;I+=2){const M=b[I],L=b[I+1];T.set(ge.createBezierPoints(P,R,k,C,M,L),(I-2)*3),[P,R,k,C]=[k,C,M,L]}}}for(let b=0,S=o.length;b<S;b++)f.push({line:_(o[b].map(T=>T??NaN),p,g,v,y),points:_(l[b].map(T=>T??NaN),p,g,v,y)});const w=new this.prototype.constructor;return w.build(f,s,i,1,u,h,a),w}get box(){return c(this,Kr)}updateProperty(t,r){return t==="stroke-width"?D(this,UT,YW).call(this,r):null}updateParentDimensions([t,r],s){const[i,a]=D(this,ua,Fo).call(this);A(this,io,t),A(this,ao,r),A(this,Rg,s);const[o,l]=D(this,ua,Fo).call(this),u=o-i,h=l-a,f=c(this,Kr);return f[0]-=u,f[1]-=h,f[2]+=2*u,f[3]+=2*h,f}updateRotation(t){return A(this,E_,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Kr).map(ge.svgRound).join(" ")}get defaultProperties(){const[t,r]=c(this,Kr);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(t)} ${ge.svgRound(r)}`}}}get rotationTransform(){const[,,t,r]=c(this,Kr);let s=0,i=0,a=0,o=0,l=0,u=0;switch(c(this,E_)){case 90:i=r/t,a=-t/r,l=t;break;case 180:s=-1,o=-1,l=t,u=r;break;case 270:i=-r/t,a=t/r,u=r;break;default:return""}return`matrix(${s} ${i} ${a} ${o} ${ge.svgRound(l)} ${ge.svgRound(u)})`}getPathResizingSVGProperties([t,r,s,i]){const[a,o]=D(this,ua,Fo).call(this),[l,u,h,f]=c(this,Kr);if(Math.abs(h-a)<=ge.PRECISION||Math.abs(f-o)<=ge.PRECISION){const _=t+s/2-(l+h/2),w=r+i/2-(u+f/2);return{path:{"transform-origin":`${ge.svgRound(t)} ${ge.svgRound(r)}`,transform:`${this.rotationTransform} translate(${_} ${w})`}}}const p=(s-2*a)/(h-2*a),g=(i-2*o)/(f-2*o),v=h/s,y=f/i;return{path:{"transform-origin":`${ge.svgRound(l)} ${ge.svgRound(u)}`,transform:`${this.rotationTransform} scale(${v} ${y}) translate(${ge.svgRound(a)} ${ge.svgRound(o)}) scale(${p} ${g}) translate(${ge.svgRound(-a)} ${ge.svgRound(-o)})`}}}getPathResizedSVGProperties([t,r,s,i]){const[a,o]=D(this,ua,Fo).call(this),l=c(this,Kr),[u,h,f,p]=l;if(l[0]=t,l[1]=r,l[2]=s,l[3]=i,Math.abs(f-a)<=ge.PRECISION||Math.abs(p-o)<=ge.PRECISION){const w=t+s/2-(u+f/2),b=r+i/2-(h+p/2);for(const{line:S,points:T}of c(this,Zs))ge._translate(S,w,b,S),ge._translate(T,w,b,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(t)} ${ge.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const g=(s-2*a)/(f-2*a),v=(i-2*o)/(p-2*o),y=-g*(u+a)+t+a,_=-v*(h+o)+r+o;if(g!==1||v!==1||y!==0||_!==0)for(const{line:w,points:b}of c(this,Zs))ge._rescale(w,y,_,g,v,w),ge._rescale(b,y,_,g,v,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${ge.svgRound(t)} ${ge.svgRound(r)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,r],s){const[i,a]=s,o=c(this,Kr),l=t-o[0],u=r-o[1];if(c(this,io)===i&&c(this,ao)===a)for(const{line:h,points:f}of c(this,Zs))ge._translate(h,l,u,h),ge._translate(f,l,u,f);else{const h=c(this,io)/i,f=c(this,ao)/a;A(this,io,i),A(this,ao,a);for(const{line:p,points:g}of c(this,Zs))ge._rescale(p,l,u,h,f,p),ge._rescale(g,l,u,h,f,g);o[2]*=h,o[3]*=f}return o[0]=t,o[1]=r,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(t)} ${ge.svgRound(r)}`}}}get defaultSVGProperties(){const t=c(this,Kr);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${ge.svgRound(t[0])} ${ge.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}Kr=new WeakMap,E_=new WeakMap,A_=new WeakMap,Zs=new WeakMap,io=new WeakMap,ao=new WeakMap,Rg=new WeakMap,Mg=new WeakMap,qd=new WeakMap,ua=new WeakSet,Fo=function(t=c(this,qd)){const r=c(this,A_)+t/2*c(this,Rg);return c(this,Mg)%180===0?[r/c(this,io),r/c(this,ao)]:[r/c(this,ao),r/c(this,io)]},FT=new WeakSet,GW=function(){const[t,r,s,i]=c(this,Kr),[a,o]=D(this,ua,Fo).call(this,0);return[t+a,r+o,s-2*a,i-2*o]},$T=new WeakSet,qW=function(){const t=A(this,Kr,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:i}of c(this,Zs)){if(i.length<=12){for(let l=4,u=i.length;l<u;l+=6)ye.pointBoundingBox(i[l],i[l+1],t);continue}let a=i[4],o=i[5];for(let l=6,u=i.length;l<u;l+=6){const[h,f,p,g,v,y]=i.subarray(l,l+6);ye.bezierBoundingBox(a,o,h,f,p,g,v,y,t),a=v,o=y}}const[r,s]=D(this,ua,Fo).call(this);t[0]=Jr(t[0]-r,0,1),t[1]=Jr(t[1]-s,0,1),t[2]=Jr(t[2]+r,0,1),t[3]=Jr(t[3]+s,0,1),t[2]-=t[0],t[3]-=t[1]},UT=new WeakSet,YW=function(t){const[r,s]=D(this,ua,Fo).call(this);A(this,qd,t);const[i,a]=D(this,ua,Fo).call(this),[o,l]=[i-r,a-s],u=c(this,Kr);return u[0]-=o,u[1]-=l,u[2]+=2*o,u[3]+=2*l,u};class Sk extends HW{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:It._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??(t=this["stroke-width"]),t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Sk(this._viewParameters);return e.updateAll(this),e}}var VT,KW;const Ip=class Ip extends oA{constructor(t){super({...t,name:"inkEditor"});x(this,VT);this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,r){It.initialize(t,r),this._defaultDrawingOptions=new Sk(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ve(this,"typesMap",new Map([[Qe.INK_THICKNESS,"stroke-width"],[Qe.INK_COLOR,"stroke"],[Qe.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,r,s,i,a){return new V1e(t,r,s,i,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,r,s,i,a,o){return Cx.deserialize(t,r,s,i,a,o)}static async deserialize(t,r,s){let i=null;if(t instanceof NO){const{data:{inkLists:o,rect:l,rotation:u,id:h,color:f,opacity:p,borderStyle:{rawWidth:g},popupRef:v,richText:y,contentsObj:_,creationDate:w,modificationDate:b},parent:{page:{pageNumber:S}}}=t;i=t={annotationType:Fe.INK,color:Array.from(f),thickness:g,opacity:p,paths:{points:o},boxes:null,pageIndex:S-1,rect:l.slice(0),rotation:u,annotationElementId:h,id:h,deleted:!1,popupRef:v,richText:y,comment:(_==null?void 0:_.str)||null,creationDate:w,modificationDate:b}}const a=await super.deserialize(t,r,s);return a._initialData=i,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||(this._colorPicker=new rA(this)),[["colorPicker",this._colorPicker]]}get colorType(){return Qe.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:r,parent:s}=this;r.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,r.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:r,opacity:s}){this._drawingOptions=Ip.getDefaultDrawingOptions({stroke:ye.makeHexColor(...t),"stroke-width":r,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:r,points:s}=this.serializeDraw(t),{_drawingOptions:{stroke:i,"stroke-opacity":a,"stroke-width":o}}=this,l=Object.assign(super.serialize(t),{color:It._colorManager.convert(i),opacity:a,thickness:o,paths:{lines:r,points:s}});return this.addComment(l),t?(l.isCopy=!0,l):this.annotationElementId&&!D(this,VT,KW).call(this,l)?null:(l.id=this.annotationElementId,l)}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:r,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:r,popup:this.comment}),null}};VT=new WeakSet,KW=function(t){const{color:r,thickness:s,opacity:i,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,l)=>o!==r[l])||t.thickness!==s||t.opacity!==i||t.pageIndex!==a},ie(Ip,"_type","ink"),ie(Ip,"_editorType",Fe.INK),ie(Ip,"_defaultDrawingOptions",null);let eR=Ip;class tR extends Cx{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const IS=8,pv=3;var Yd,T_,nR,ha,BT,XW,zT,QW,C_,rR,Og,LE,HT,JW,WT,ZW,GT,eG,k_,sR,N_,iR,qT,tG;class In{static extractContoursFromText(e,{fontFamily:t,fontStyle:r,fontWeight:s},i,a,o,l){let u=new OffscreenCanvas(1,1),h=u.getContext("2d",{alpha:!1});const f=200,p=h.font=`${r} ${s} ${f}px ${t}`,{actualBoundingBoxLeft:g,actualBoundingBoxRight:v,actualBoundingBoxAscent:y,actualBoundingBoxDescent:_,fontBoundingBoxAscent:w,fontBoundingBoxDescent:b,width:S}=h.measureText(e),T=1.5,P=Math.ceil(Math.max(Math.abs(g)+Math.abs(v)||0,S)*T),R=Math.ceil(Math.max(Math.abs(y)+Math.abs(_)||f,Math.abs(w)+Math.abs(b)||f)*T);u=new OffscreenCanvas(P,R),h=u.getContext("2d",{alpha:!0,willReadFrequently:!0}),h.font=p,h.filter="grayscale(1)",h.fillStyle="white",h.fillRect(0,0,P,R),h.fillStyle="black",h.fillText(e,P*(T-1)/2,R*(3-T)/2);const k=D(this,k_,sR).call(this,h.getImageData(0,0,P,R).data),C=D(this,GT,eG).call(this,k),I=D(this,N_,iR).call(this,C),M=D(this,C_,rR).call(this,k,P,R,I);return this.processDrawnLines({lines:{curves:M,width:P,height:R},pageWidth:i,pageHeight:a,rotation:o,innerMargin:l,mustSmooth:!0,areContours:!0})}static process(e,t,r,s,i){const[a,o,l]=D(this,qT,tG).call(this,e),[u,h]=D(this,WT,ZW).call(this,a,o,l,Math.hypot(o,l)*c(this,Yd).sigmaSFactor,c(this,Yd).sigmaR,c(this,Yd).kernelSize),f=D(this,N_,iR).call(this,h),p=D(this,C_,rR).call(this,u,o,l,f);return this.processDrawnLines({lines:{curves:p,width:o,height:l},pageWidth:t,pageHeight:r,rotation:s,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:r,rotation:s,innerMargin:i,mustSmooth:a,areContours:o}){s%180!==0&&([t,r]=[r,t]);const{curves:l,width:u,height:h}=e,f=e.thickness??0,p=[],g=Math.min(t/u,r/h),v=g/t,y=g/r,_=[];for(const{points:b}of l){const S=a?D(this,HT,JW).call(this,b):b;if(!S)continue;_.push(S);const T=S.length,P=new Float32Array(T),R=new Float32Array(3*(T===2?2:T-2));if(p.push({line:R,points:P}),T===2){P[0]=S[0]*v,P[1]=S[1]*y,R.set([NaN,NaN,NaN,NaN,P[0],P[1]],0);continue}let[k,C,I,M]=S;k*=v,C*=y,I*=v,M*=y,P.set([k,C,I,M],0),R.set([NaN,NaN,NaN,NaN,k,C],0);for(let L=4;L<T;L+=2){const F=P[L]=S[L]*v,O=P[L+1]=S[L+1]*y;R.set(ge.createBezierPoints(k,C,I,M,F,O),(L-2)*3),[k,C,I,M]=[I,M,F,O]}}if(p.length===0)return null;const w=o?new tR:new Cx;return w.build(p,t,r,1,s,o?0:f,i),{outline:w,newCurves:_,areContours:o,thickness:f,width:u,height:h}}static async compressSignature({outlines:e,areContours:t,thickness:r,width:s,height:i}){let a=1/0,o=-1/0,l=0;for(const S of e){l+=S.length;for(let T=2,P=S.length;T<P;T++){const R=S[T]-S[T-2];a=Math.min(a,R),o=Math.max(o,R)}}let u;a>=-128&&o<=127?u=Int8Array:a>=-32768&&o<=32767?u=Int16Array:u=Int32Array;const h=e.length,f=IS+pv*h,p=new Uint32Array(f);let g=0;p[g++]=f*Uint32Array.BYTES_PER_ELEMENT+(l-2*h)*u.BYTES_PER_ELEMENT,p[g++]=0,p[g++]=s,p[g++]=i,p[g++]=t?0:1,p[g++]=Math.max(0,Math.floor(r??0)),p[g++]=h,p[g++]=u.BYTES_PER_ELEMENT;for(const S of e)p[g++]=S.length-2,p[g++]=S[0],p[g++]=S[1];const v=new CompressionStream("deflate-raw"),y=v.writable.getWriter();await y.ready,y.write(p);const _=u.prototype.constructor;for(const S of e){const T=new _(S.length-2);for(let P=2,R=S.length;P<R;P++)T[P-2]=S[P]-S[P-2];y.write(T)}y.close();const w=await new Response(v.readable).arrayBuffer(),b=new Uint8Array(w);return r9(b)}static async decompressSignature(e){try{const t=rEe(e),{readable:r,writable:s}=new DecompressionStream("deflate-raw"),i=s.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let a=null,o=0;for await(const S of r)a||(a=new Uint8Array(new Uint32Array(S.buffer,0,4)[0])),a.set(S,o),o+=S.length;const l=new Uint32Array(a.buffer,0,a.length>>2),u=l[1];if(u!==0)throw new Error(`Invalid version: ${u}`);const h=l[2],f=l[3],p=l[4]===0,g=l[5],v=l[6],y=l[7],_=[],w=(IS+pv*v)*Uint32Array.BYTES_PER_ELEMENT;let b;switch(y){case Int8Array.BYTES_PER_ELEMENT:b=new Int8Array(a.buffer,w);break;case Int16Array.BYTES_PER_ELEMENT:b=new Int16Array(a.buffer,w);break;case Int32Array.BYTES_PER_ELEMENT:b=new Int32Array(a.buffer,w);break}o=0;for(let S=0;S<v;S++){const T=l[pv*S+IS],P=new Float32Array(T+2);_.push(P);for(let R=0;R<pv-1;R++)P[R]=l[pv*S+IS+R+1];for(let R=0;R<T;R++)P[R+2]=P[R]+b[o++]}return{areContours:p,thickness:g,outlines:_,width:h,height:f}}catch(t){return Oe(`decompressSignature: ${t}`),null}}}Yd=new WeakMap,T_=new WeakSet,nR=function(e,t,r,s){return r-=e,s-=t,r===0?s>0?0:4:r===1?s+6:2-s},ha=new WeakMap,BT=new WeakSet,XW=function(e,t,r,s,i,a,o){const l=D(this,T_,nR).call(this,r,s,i,a);for(let u=0;u<8;u++){const h=(-u+l-o+16)%8,f=c(this,ha)[2*h],p=c(this,ha)[2*h+1];if(e[(r+f)*t+(s+p)]!==0)return h}return-1},zT=new WeakSet,QW=function(e,t,r,s,i,a,o){const l=D(this,T_,nR).call(this,r,s,i,a);for(let u=0;u<8;u++){const h=(u+l+o+16)%8,f=c(this,ha)[2*h],p=c(this,ha)[2*h+1];if(e[(r+f)*t+(s+p)]!==0)return h}return-1},C_=new WeakSet,rR=function(e,t,r,s){const i=e.length,a=new Int32Array(i);for(let h=0;h<i;h++)a[h]=e[h]<=s?1:0;for(let h=1;h<r-1;h++)a[h*t]=a[h*t+t-1]=0;for(let h=0;h<t;h++)a[h]=a[t*r-1-h]=0;let o=1,l;const u=[];for(let h=1;h<r-1;h++){l=1;for(let f=1;f<t-1;f++){const p=h*t+f,g=a[p];if(g===0)continue;let v=h,y=f;if(g===1&&a[p-1]===0)o+=1,y-=1;else if(g>=1&&a[p+1]===0)o+=1,y+=1,g>1&&(l=g);else{g!==1&&(l=Math.abs(g));continue}const _=[f,h],w=y===f+1,b={isHole:w,points:_,id:o,parent:0};u.push(b);let S;for(const L of u)if(L.id===l){S=L;break}S?S.isHole?b.parent=w?S.parent:l:b.parent=w?l:S.parent:b.parent=w?l:0;const T=D(this,BT,XW).call(this,a,t,h,f,v,y,0);if(T===-1){a[p]=-o,a[p]!==1&&(l=Math.abs(a[p]));continue}let P=c(this,ha)[2*T],R=c(this,ha)[2*T+1];const k=h+P,C=f+R;v=k,y=C;let I=h,M=f;for(;;){const L=D(this,zT,QW).call(this,a,t,I,M,v,y,1);P=c(this,ha)[2*L],R=c(this,ha)[2*L+1];const F=I+P,O=M+R;_.push(O,F);const Y=I*t+M;if(a[Y+1]===0?a[Y]=-o:a[Y]===1&&(a[Y]=o),F===h&&O===f&&I===k&&M===C){a[p]!==1&&(l=Math.abs(a[p]));break}else v=I,y=M,I=F,M=O}}}return u},Og=new WeakSet,LE=function(e,t,r,s){if(r-t<=4){for(let k=t;k<r-2;k+=2)s.push(e[k],e[k+1]);return}const i=e[t],a=e[t+1],o=e[r-4]-i,l=e[r-3]-a,u=Math.hypot(o,l),h=o/u,f=l/u,p=h*a-f*i,g=l/o,v=1/u,y=Math.atan(g),_=Math.cos(y),w=Math.sin(y),b=v*(Math.abs(_)+Math.abs(w)),S=v*(1-b+b**2),T=Math.max(Math.atan(Math.abs(w+_)*S),Math.atan(Math.abs(w-_)*S));let P=0,R=t;for(let k=t+2;k<r-2;k+=2){const C=Math.abs(p-h*e[k+1]+f*e[k]);C>P&&(R=k,P=C)}P>(u*T)**2?(D(this,Og,LE).call(this,e,t,R+2,s),D(this,Og,LE).call(this,e,R,r,s)):s.push(i,a)},HT=new WeakSet,JW=function(e){const t=[],r=e.length;return D(this,Og,LE).call(this,e,0,r,t),t.push(e[r-2],e[r-1]),t.length<=4?null:t},WT=new WeakSet,ZW=function(e,t,r,s,i,a){const o=new Float32Array(a**2),l=-2*s**2,u=a>>1;for(let y=0;y<a;y++){const _=(y-u)**2;for(let w=0;w<a;w++)o[y*a+w]=Math.exp((_+(w-u)**2)/l)}const h=new Float32Array(256),f=-2*i**2;for(let y=0;y<256;y++)h[y]=Math.exp(y**2/f);const p=e.length,g=new Uint8Array(p),v=new Uint32Array(256);for(let y=0;y<r;y++)for(let _=0;_<t;_++){const w=y*t+_,b=e[w];let S=0,T=0;for(let R=0;R<a;R++){const k=y+R-u;if(!(k<0||k>=r))for(let C=0;C<a;C++){const I=_+C-u;if(I<0||I>=t)continue;const M=e[k*t+I],L=o[R*a+C]*h[Math.abs(M-b)];S+=M*L,T+=L}}const P=g[w]=Math.round(S/T);v[P]++}return[g,v]},GT=new WeakSet,eG=function(e){const t=new Uint32Array(256);for(const r of e)t[r]++;return t},k_=new WeakSet,sR=function(e){const t=e.length,r=new Uint8ClampedArray(t>>2);let s=-1/0,i=1/0;for(let o=0,l=r.length;o<l;o++){const u=r[o]=e[o<<2];s=Math.max(s,u),i=Math.min(i,u)}const a=255/(s-i);for(let o=0,l=r.length;o<l;o++)r[o]=(r[o]-i)*a;return r},N_=new WeakSet,iR=function(e){let t,r=-1/0,s=-1/0;const i=e.findIndex(l=>l!==0);let a=i,o=i;for(t=i;t<256;t++){const l=e[t];l>r&&(t-a>s&&(s=t-a,o=t-1),r=l,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t},qT=new WeakSet,tG=function(e){const t=e,{width:r,height:s}=e,{maxDim:i}=c(this,Yd);let a=r,o=s;if(r>i||s>i){let p=r,g=s,v=Math.log2(Math.max(r,s)/i);const y=Math.floor(v);v=v===y?y-1:y;for(let w=0;w<v;w++){a=Math.ceil(p/2),o=Math.ceil(g/2);const b=new OffscreenCanvas(a,o);b.getContext("2d").drawImage(e,0,0,p,g,0,0,a,o),p=a,g=o,e!==t&&e.close(),e=b.transferToImageBitmap()}const _=Math.min(i/a,i/o);a=Math.round(a*_),o=Math.round(o*_)}const u=new OffscreenCanvas(a,o).getContext("2d",{willReadFrequently:!0});u.fillStyle="white",u.fillRect(0,0,a,o),u.filter="grayscale(1)",u.drawImage(e,0,0,e.width,e.height,0,0,a,o);const h=u.getImageData(0,0,a,o).data;return[D(this,k_,sR).call(this,h),a,o]},x(In,T_),x(In,BT),x(In,zT),x(In,C_),x(In,Og),x(In,HT),x(In,WT),x(In,GT),x(In,k_),x(In,N_),x(In,qT),x(In,Yd,{maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16}),x(In,ha,new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]));class PO extends HW{constructor(){super(),super.updateProperties({fill:It._defaultLineColor,"stroke-width":0})}clone(){const e=new PO;return e.updateAll(this),e}}class IO extends Sk{constructor(e){super(e),super.updateProperties({stroke:It._defaultLineColor,"stroke-width":1})}clone(){const e=new IO(this._viewParameters);return e.updateAll(this),e}}var fu,oo,pu,Kd;const Ls=class Ls extends oA{constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"});x(this,fu,!1);x(this,oo,null);x(this,pu,null);x(this,Kd,null);this._willKeepAspectRatio=!0,A(this,pu,t.signatureData||null),A(this,oo,null),this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,r){It.initialize(t,r),this._defaultDrawingOptions=new PO,this._defaultDrawnSignatureOptions=new IO(r.viewParameters)}static getDefaultDrawingOptions(t){const r=this._defaultDrawingOptions.clone();return r.updateProperties(t),r}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ve(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!c(this,oo)}}static computeTelemetryFinalData(t){const r=t.get("hasDescription");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,r;const{_isCopy:s}=this;if(s&&(this._isCopy=!1,t=this.x,r=this.y),super.render(),this._drawId===null)if(c(this,pu)){const{lines:i,mustSmooth:a,areContours:o,description:l,uuid:u,heightInPage:h}=c(this,pu),{rawDims:{pageWidth:f,pageHeight:p},rotation:g}=this.parent.viewport,v=In.processDrawnLines({lines:i,pageWidth:f,pageHeight:p,rotation:g,innerMargin:Ls._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(v,h,l,u)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:c(this,oo)||""}));return s&&(this._isCopy=!0,this._moveAfterPaste(t,r)),this.div}setUuid(t){A(this,Kd,t),this.addEditToolbar()}getUuid(){return c(this,Kd)}get description(){return c(this,oo)}set description(t){A(this,oo,t),this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(r=>{r==null||r.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:r,thickness:s,width:i,height:a}=c(this,pu),o=Math.max(i,a),l=In.processDrawnLines({lines:{curves:t.map(u=>({points:u})),thickness:s,width:i,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:r});return{areContours:r,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,r,s,i){const{x:a,y:o}=this,{outline:l}=A(this,pu,t);A(this,fu,l instanceof tR),this.description=s;let u;c(this,fu)?u=Ls.getDefaultDrawingOptions():(u=Ls._defaultDrawnSignatureOptions.clone(),u.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:u});const[,h]=this.pageDimensions;let f=r/h;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!s}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:r,pageHeight:s},rotation:i}=this.parent.viewport;return In.process(t,r,s,i,Ls._INNER_MARGIN)}getFromText(t,r){const{rawDims:{pageWidth:s,pageHeight:i},rotation:a}=this.parent.viewport;return In.extractContoursFromText(t,r,s,i,a,Ls._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:r,pageHeight:s},rotation:i}=this.parent.viewport;return In.processDrawnLines({lines:t,pageWidth:r,pageHeight:s,rotation:i,innerMargin:Ls._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:r}){t?this._drawingOptions=Ls.getDefaultDrawingOptions():(this._drawingOptions=Ls._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":r}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:r,points:s}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":i}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:c(this,fu),color:[0,0,0],thickness:c(this,fu)?0:i});return this.addComment(a),t?(a.paths={lines:r,points:s},a.uuid=c(this,Kd),a.isCopy=!0):a.lines=r,c(this,oo)&&(a.accessibilityData={type:"Figure",alt:c(this,oo)}),a}static deserializeDraw(t,r,s,i,a,o){return o.areContours?tR.deserialize(t,r,s,i,a,o):Cx.deserialize(t,r,s,i,a,o)}static async deserialize(t,r,s){var a;const i=await super.deserialize(t,r,s);return A(i,fu,t.areContours),i.description=((a=t.accessibilityData)==null?void 0:a.alt)||"",A(i,Kd,t.uuid),i}};fu=new WeakMap,oo=new WeakMap,pu=new WeakMap,Kd=new WeakMap,ie(Ls,"_type","signature"),ie(Ls,"_editorType",Fe.SIGNATURE),ie(Ls,"_defaultDrawingOptions",null);let aR=Ls;var Wt,Yn,mu,xl,gu,Lg,Sl,Xd,lo,ei,jg,Qd,Wv,Jd,Gv,Fg,jE,$g,FE,Ug,$E,P_,lR,Vg,UE,YT,nG;class oR extends It{constructor(t){super({...t,name:"stampEditor"});x(this,Qd);x(this,Jd);x(this,Fg);x(this,$g);x(this,Ug);x(this,P_);x(this,Vg);x(this,YT);x(this,Wt,null);x(this,Yn,null);x(this,mu,null);x(this,xl,null);x(this,gu,null);x(this,Lg,"");x(this,Sl,null);x(this,Xd,!1);x(this,lo,null);x(this,ei,!1);x(this,jg,!1);A(this,xl,t.bitmapUrl),A(this,gu,t.bitmapFile),this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,r){It.initialize(t,r)}static isHandlingMimeForPasting(t){return HI.includes(t)}static paste(t,r){r.pasteEditor({mode:Fe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const r=t.get("hasAltText");return{hasAltText:r.get(!0)??0,hasNoAltText:r.get(!1)??0}}async mlGuessAltText(t=null,r=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:i,width:a,height:o,channels:i.length/(a*o)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),r&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;c(this,Yn)&&(A(this,Wt,null),this._uiManager.imageManager.deleteId(c(this,Yn)),(t=c(this,Sl))==null||t.remove(),A(this,Sl,null),c(this,lo)&&(clearTimeout(c(this,lo)),A(this,lo,null))),super.remove()}rebuild(){if(!this.parent){c(this,Yn)&&D(this,Fg,jE).call(this);return}super.rebuild(),this.div!==null&&(c(this,Yn)&&c(this,Sl)===null&&D(this,Fg,jE).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,mu)||c(this,Wt)||c(this,xl)||c(this,gu)||c(this,Yn)||c(this,Xd))}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,r;return this._isCopy&&(t=this.x,r=this.y),super.render(),this.div.hidden=!0,this.createAltText(),c(this,Xd)||(c(this,Wt)?D(this,$g,FE).call(this):D(this,Fg,jE).call(this)),this._isCopy&&this._moveAfterPaste(t,r),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,r){const{id:s,bitmap:i}=this._uiManager.imageManager.getFromCanvas(t,r);r.remove(),s&&this._uiManager.imageManager.isValidId(s)&&(A(this,Yn,s),i&&A(this,Wt,i),A(this,Xd,!1),D(this,$g,FE).call(this))}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,lo)!==null&&clearTimeout(c(this,lo)),A(this,lo,setTimeout(()=>{A(this,lo,null),D(this,P_,lR).call(this)},200))}copyCanvas(t,r,s=!1){t||(t=224);const{width:i,height:a}=c(this,Wt),o=new Co;let l=c(this,Wt),u=i,h=a,f=null;if(r){if(i>r||a>r){const k=Math.min(r/i,r/a);u=Math.floor(i*k),h=Math.floor(a*k)}f=document.createElement("canvas");const g=f.width=Math.ceil(u*o.sx),v=f.height=Math.ceil(h*o.sy);c(this,ei)||(l=D(this,Ug,$E).call(this,g,v));const y=f.getContext("2d");y.filter=this._uiManager.hcmFilter;let _="white",w="#cfcfd8";this._uiManager.hcmFilter!=="none"?w="black":cEe.isDarkMode&&(_="#8f8f9d",w="#42414d");const b=15,S=b*o.sx,T=b*o.sy,P=new OffscreenCanvas(S*2,T*2),R=P.getContext("2d");R.fillStyle=_,R.fillRect(0,0,S*2,T*2),R.fillStyle=w,R.fillRect(0,0,S,T),R.fillRect(S,T,S,T),y.fillStyle=y.createPattern(P,"repeat"),y.fillRect(0,0,g,v),y.drawImage(l,0,0,l.width,l.height,0,0,g,v)}let p=null;if(s){let g,v;if(o.symmetric&&l.width<t&&l.height<t)g=l.width,v=l.height;else if(l=c(this,Wt),i>t||a>t){const w=Math.min(t/i,t/a);g=Math.floor(i*w),v=Math.floor(a*w),c(this,ei)||(l=D(this,Ug,$E).call(this,g,v))}const _=new OffscreenCanvas(g,v).getContext("2d",{willReadFrequently:!0});_.drawImage(l,0,0,l.width,l.height,0,0,g,v),p={width:g,height:v,data:_.getImageData(0,0,g,v).data}}return{canvas:f,width:u,height:h,imageData:p}}static async deserialize(t,r,s){var _;let i=null,a=!1;if(t instanceof vW){const{data:{rect:w,rotation:b,id:S,structParent:T,popupRef:P,richText:R,contentsObj:k,creationDate:C,modificationDate:I},container:M,parent:{page:{pageNumber:L}},canvas:F}=t;let O,Y;F?(delete t.canvas,{id:O,bitmap:Y}=s.imageManager.getFromCanvas(M.id,F),F.remove()):(a=!0,t._hasNoCanvas=!0);const Z=((_=await r._structTree.getAriaAttributes(`${_O}${S}`))==null?void 0:_.get("aria-label"))||"";i=t={annotationType:Fe.STAMP,bitmapId:O,bitmap:Y,pageIndex:L-1,rect:w.slice(0),rotation:b,annotationElementId:S,id:S,deleted:!1,accessibilityData:{decorative:!1,altText:Z},isSvg:!1,structParent:T,popupRef:P,richText:R,comment:(k==null?void 0:k.str)||null,creationDate:C,modificationDate:I}}const o=await super.deserialize(t,r,s),{rect:l,bitmap:u,bitmapUrl:h,bitmapId:f,isSvg:p,accessibilityData:g}=t;a?(s.addMissingCanvas(t.id,o),A(o,Xd,!0)):f&&s.imageManager.isValidId(f)?(A(o,Yn,f),u&&A(o,Wt,u)):A(o,xl,h),A(o,ei,p);const[v,y]=o.pageDimensions;return o.width=(l[2]-l[0])/v,o.height=(l[3]-l[1])/y,g&&(o.altTextData=g),o._initialData=i,t.comment&&o.setCommentData(t),A(o,jg,!!i),o}serialize(t=!1,r=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s=Object.assign(super.serialize(t),{bitmapId:c(this,Yn),isSvg:c(this,ei)});if(this.addComment(s),t)return s.bitmapUrl=D(this,Vg,UE).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s.isCopy=!0,s;const{decorative:i,altText:a}=this.serializeAltText(!1);if(!i&&a&&(s.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const l=D(this,YT,nG).call(this,s);return l.isSame?null:(l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1,s.id=this.annotationElementId,delete s.bitmapId,s)}if(r===null)return s;r.stamps||(r.stamps=new Map);const o=c(this,ei)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!r.stamps.has(c(this,Yn)))r.stamps.set(c(this,Yn),{area:o,serialized:s}),s.bitmap=D(this,Vg,UE).call(this,!1);else if(c(this,ei)){const l=r.stamps.get(c(this,Yn));o>l.area&&(l.area=o,l.serialized.bitmap.close(),l.serialized.bitmap=D(this,Vg,UE).call(this,!1))}return s}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}Wt=new WeakMap,Yn=new WeakMap,mu=new WeakMap,xl=new WeakMap,gu=new WeakMap,Lg=new WeakMap,Sl=new WeakMap,Xd=new WeakMap,lo=new WeakMap,ei=new WeakMap,jg=new WeakMap,Qd=new WeakSet,Wv=function(t,r=!1){if(!t){this.remove();return}A(this,Wt,t.bitmap),r||(A(this,Yn,t.id),A(this,ei,t.isSvg)),t.file&&A(this,Lg,t.file.name),D(this,$g,FE).call(this)},Jd=new WeakSet,Gv=function(){if(A(this,mu,null),this._uiManager.enableWaiting(!1),!!c(this,Sl)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Wt)){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,Wt)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},Fg=new WeakSet,jE=function(){if(c(this,Yn)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,Yn)).then(s=>D(this,Qd,Wv).call(this,s,!0)).finally(()=>D(this,Jd,Gv).call(this));return}if(c(this,xl)){const s=c(this,xl);A(this,xl,null),this._uiManager.enableWaiting(!0),A(this,mu,this._uiManager.imageManager.getFromUrl(s).then(i=>D(this,Qd,Wv).call(this,i)).finally(()=>D(this,Jd,Gv).call(this)));return}if(c(this,gu)){const s=c(this,gu);A(this,gu,null),this._uiManager.enableWaiting(!0),A(this,mu,this._uiManager.imageManager.getFromFile(s).then(i=>D(this,Qd,Wv).call(this,i)).finally(()=>D(this,Jd,Gv).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=HI.join(",");const r=this._uiManager._signal;A(this,mu,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),D(this,Qd,Wv).call(this,i)}s()},{signal:r}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:r})}).finally(()=>D(this,Jd,Gv).call(this))),t.click()},$g=new WeakSet,FE=function(){var u;const{div:t}=this;let{width:r,height:s}=c(this,Wt);const[i,a]=this.pageDimensions,o=.75;if(this.width)r=this.width*i,s=this.height*a;else if(r>o*i||s>o*a){const h=Math.min(o*i/r,o*a/s);r*=h,s*=h}this._uiManager.enableWaiting(!1);const l=A(this,Sl,document.createElement("canvas"));l.setAttribute("role","img"),this.addContainer(l),this.width=r/i,this.height=s/a,this.setDims(),(u=this._initialOptions)!=null&&u.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),D(this,P_,lR).call(this),c(this,jg)||(this.parent.addUndoableEditor(this),A(this,jg,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,Lg)&&this.div.setAttribute("aria-description",c(this,Lg)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")},Ug=new WeakSet,$E=function(t,r){const{width:s,height:i}=c(this,Wt);let a=s,o=i,l=c(this,Wt);for(;a>2*t||o>2*r;){const u=a,h=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*r&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(l,0,0,u,h,0,0,a,o),l=f.transferToImageBitmap()}return l},P_=new WeakSet,lR=function(){const[t,r]=this.parentDimensions,{width:s,height:i}=this,a=new Co,o=Math.ceil(s*t*a.sx),l=Math.ceil(i*r*a.sy),u=c(this,Sl);if(!u||u.width===o&&u.height===l)return;u.width=o,u.height=l;const h=c(this,ei)?c(this,Wt):D(this,Ug,$E).call(this,o,l),f=u.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(h,0,0,h.width,h.height,0,0,o,l)},Vg=new WeakSet,UE=function(t){if(t){if(c(this,ei)){const i=this._uiManager.imageManager.getSvgUrl(c(this,Yn));if(i)return i}const r=document.createElement("canvas");return{width:r.width,height:r.height}=c(this,Wt),r.getContext("2d").drawImage(c(this,Wt),0,0),r.toDataURL()}if(c(this,ei)){const[r,s]=this.pageDimensions,i=Math.round(this.width*r*Yu.PDF_TO_CSS_UNITS),a=Math.round(this.height*s*Yu.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(i,a);return o.getContext("2d").drawImage(c(this,Wt),0,0,c(this,Wt).width,c(this,Wt).height,0,0,i,a),o.transferToImageBitmap()}return structuredClone(c(this,Wt))},YT=new WeakSet,nG=function(t){var o;const{pageIndex:r,accessibilityData:{altText:s}}=this._initialData,i=t.pageIndex===r,a=(((o=t.accessibilityData)==null?void 0:o.alt)||"")===s;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&a,isSameAltText:a}},ie(oR,"_type","stamp"),ie(oR,"_editorType",Fe.STAMP);var Zd,Bg,yu,vu,El,ys,wu,zg,Hg,da,Al,Kn,Tl,bu,Wg,Ee,_u,I_,uR,KT,rG,Ni,La,D_,hR,R_,dR,Gg,VE;const Ji=class Ji{constructor({uiManager:e,pageIndex:t,div:r,structTreeLayer:s,accessibilityManager:i,annotationLayer:a,drawLayer:o,textLayer:l,viewport:u,l10n:h}){x(this,I_);x(this,KT);x(this,Ni);x(this,D_);x(this,R_);x(this,Gg);x(this,Zd,void 0);x(this,Bg,!1);x(this,yu,null);x(this,vu,null);x(this,El,null);x(this,ys,new Map);x(this,wu,!1);x(this,zg,!1);x(this,Hg,!1);x(this,da,null);x(this,Al,null);x(this,Kn,null);x(this,Tl,null);x(this,bu,null);x(this,Wg,-1);x(this,Ee,void 0);const f=[...c(Ji,_u).values()];if(!Ji._initialized){Ji._initialized=!0;for(const p of f)p.initialize(h,e)}e.registerEditorTypes(f),A(this,Ee,e),this.pageIndex=t,this.div=r,A(this,Zd,i),A(this,yu,a),this.viewport=u,A(this,Kn,l),this.drawLayer=o,this._structTree=s,c(this,Ee).addLayer(this)}get isEmpty(){return c(this,ys).size===0}get isInvisible(){return this.isEmpty&&c(this,Ee).getMode()===Fe.NONE}updateToolbar(e){c(this,Ee).updateToolbar(e)}updateMode(e=c(this,Ee).getMode()){switch(D(this,Gg,VE).call(this),e){case Fe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Fe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Fe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Fe.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const r of c(Ji,_u).values())t.toggle(`${r._type}Editing`,e===r._editorType)}this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,Kn))==null?void 0:t.div)}setEditingState(e){c(this,Ee).setEditingState(e)}addCommands(e){c(this,Ee).addCommands(e)}cleanUndoStack(e){c(this,Ee).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,yu))==null||t.div.classList.toggle("disabled",!e)}async enable(){var r;A(this,Hg,!0),this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),(r=c(this,bu))==null||r.abort(),A(this,bu,null);const e=new Set;for(const s of c(this,I_,uR))s.enableEditing(),s.show(!0),s.annotationElementId&&(c(this,Ee).removeChangedExistingAnnotation(s),e.add(s.annotationElementId));const t=c(this,yu);if(t)for(const s of t.getEditableAnnotations()){if(s.hide(),c(this,Ee).isDeletedAnnotationElement(s.data.id)||e.has(s.data.id))continue;const i=await this.deserialize(s);i&&(this.addOrRebuild(i),i.enableEditing())}A(this,Hg,!1),c(this,Ee)._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){var r;if(A(this,zg,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),c(this,Kn)&&!c(this,bu)){A(this,bu,new AbortController);const s=c(this,Ee).combinedSignal(c(this,bu));c(this,Kn).div.addEventListener("pointerdown",i=>{const{clientX:o,clientY:l,timeStamp:u}=i,h=c(this,Wg);if(u-h>500){A(this,Wg,u);return}A(this,Wg,-1);const{classList:f}=this.div;f.toggle("getElements",!0);const p=document.elementsFromPoint(o,l);if(f.toggle("getElements",!1),!this.div.contains(p[0]))return;let g;const v=new RegExp(`^${sw}[0-9]+$`);for(const _ of p)if(v.test(_.id)){g=_.id;break}if(!g)return;const y=c(this,ys).get(g);(y==null?void 0:y.annotationElementId)===null&&(i.stopPropagation(),i.preventDefault(),y.dblclick(i))},{signal:s,capture:!0})}const e=c(this,yu);if(e){const s=new Map,i=new Map;for(const o of c(this,I_,uR)){if(o.disableEditing(),!o.annotationElementId){o.updateFakeAnnotationElement(e);continue}if(o.serialize()!==null){s.set(o.annotationElementId,o);continue}else i.set(o.annotationElementId,o);(r=this.getEditableAnnotation(o.annotationElementId))==null||r.show(),o.remove()}const a=e.getEditableAnnotations();for(const o of a){const{id:l}=o.data;if(c(this,Ee).isDeletedAnnotationElement(l)){o.updateEdited({deleted:!0});continue}let u=i.get(l);if(u){u.resetAnnotationElement(o),u.show(!1),o.show();continue}u=s.get(l),u&&(c(this,Ee).addChangedExistingAnnotation(u),u.renderAnnotationElement(o)&&u.show(!1)),o.show()}}D(this,Gg,VE).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const s of c(Ji,_u).values())t.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),A(this,zg,!1)}getEditableAnnotation(e){var t;return((t=c(this,yu))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,Ee).getActive()!==e&&c(this,Ee).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,Kn))!=null&&e.div&&!c(this,Tl)){A(this,Tl,new AbortController);const t=c(this,Ee).combinedSignal(c(this,Tl));c(this,Kn).div.addEventListener("pointerdown",D(this,KT,rG).bind(this),{signal:t}),c(this,Kn).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,Kn))!=null&&e.div&&c(this,Tl)&&(c(this,Tl).abort(),A(this,Tl,null),c(this,Kn).div.classList.remove("highlighting"))}enableClick(){if(c(this,vu))return;A(this,vu,new AbortController);const e=c(this,Ee).combinedSignal(c(this,vu));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,vu))==null||e.abort(),A(this,vu,null)}attach(e){c(this,ys).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,Ee).isDeletedAnnotationElement(t)&&c(this,Ee).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,ys).delete(e.id),(t=c(this,Zd))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,zg)&&e.annotationElementId&&c(this,Ee).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,Ee).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,Ee).addDeletedAnnotationElement(e.annotationElementId),It.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,Ee).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,Hg)),c(this,Ee).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var r;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,El)&&(e._focusEventsAllowed=!1,A(this,El,setTimeout(()=>{A(this,El,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,Ee)._signal}),t.focus())},0))),e._structTreeParentId=(r=c(this,Zd))==null?void 0:r.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),r=()=>{e.remove()};this.addCommands({cmd:t,undo:r,mustExec:!1})}getEditorByUID(e){for(const t of c(this,ys).values())if(t.uid===e)return t;return null}getNextId(){return c(this,Ee).getId()}combinedSignal(e){return c(this,Ee).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,Ni,La))==null?void 0:e.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await c(this,Ee).updateMode(e.mode);const{offsetX:r,offsetY:s}=D(this,R_,dR).call(this),i=this.getNextId(),a=D(this,D_,hR).call(this,{parent:this,id:i,x:r,y:s,uiManager:c(this,Ee),isCentered:!0,...t});a&&this.add(a)}async deserialize(e){var t;return await((t=c(Ji,_u).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,Ee)))||null}createAndAddNewEditor(e,t,r={}){const s=this.getNextId(),i=D(this,D_,hR).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:c(this,Ee),isCentered:t,...r});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}addNewEditor(e={}){this.createAndAddNewEditor(D(this,R_,dR).call(this),!0,e)}setSelected(e){c(this,Ee).setSelected(e)}toggleSelected(e){c(this,Ee).toggleSelected(e)}unselect(e){c(this,Ee).unselect(e)}pointerup(e){var s;const{isMac:t}=mr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!c(this,wu)||(A(this,wu,!1),(s=c(this,Ni,La))!=null&&s.isDrawer&&c(this,Ni,La).supportMultipleDrawings))return;if(!c(this,Bg)){A(this,Bg,!0);return}const r=c(this,Ee).getMode();if(r===Fe.STAMP||r===Fe.SIGNATURE){c(this,Ee).unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){var s;if(c(this,Ee).getMode()===Fe.HIGHLIGHT&&this.enableTextSelection(),c(this,wu)){A(this,wu,!1);return}const{isMac:t}=mr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(A(this,wu,!0),(s=c(this,Ni,La))!=null&&s.isDrawer){this.startDrawingSession(e);return}const r=c(this,Ee).getActive();A(this,Bg,!r||r.isEmpty())}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),c(this,da)){c(this,Ni,La).startDrawing(this,c(this,Ee),!1,e);return}c(this,Ee).setCurrentDrawingSession(this),A(this,da,new AbortController);const t=c(this,Ee).combinedSignal(c(this,da));this.div.addEventListener("blur",({relatedTarget:r})=>{r&&!this.div.contains(r)&&(A(this,Al,null),this.commitOrRemove())},{signal:t}),c(this,Ni,La).startDrawing(this,c(this,Ee),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&A(this,Al,t);return}c(this,Al)&&setTimeout(()=>{var t;(t=c(this,Al))==null||t.focus(),A(this,Al,null)},0)}endDrawingSession(e=!1){return c(this,da)?(c(this,Ee).setCurrentDrawingSession(null),c(this,da).abort(),A(this,da,null),A(this,Al,null),c(this,Ni,La).endDrawing(e)):null}findNewParent(e,t,r){const s=c(this,Ee).findParent(t,r);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return c(this,da)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,da)&&c(this,Ni,La).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,Ee).getActive())==null?void 0:e.parent)===this&&(c(this,Ee).commitOrRemove(),c(this,Ee).setActiveEditor(null)),c(this,El)&&(clearTimeout(c(this,El)),A(this,El,null));for(const r of c(this,ys).values())(t=c(this,Zd))==null||t.removePointerInTextLayer(r.contentDiv),r.setParent(null),r.isAttachedToDOM=!1,r.div.remove();this.div=null,c(this,ys).clear(),c(this,Ee).removeLayer(this)}render({viewport:e}){this.viewport=e,Nf(this.div,e);for(const t of c(this,Ee).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,Ee).commitOrRemove(),D(this,Gg,VE).call(this);const t=this.viewport.rotation,r=e.rotation;if(this.viewport=e,Nf(this.div,{rotation:r}),t!==r)for(const s of c(this,ys).values())s.rotate(r)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,Ee).viewParameters.realScale}};Zd=new WeakMap,Bg=new WeakMap,yu=new WeakMap,vu=new WeakMap,El=new WeakMap,ys=new WeakMap,wu=new WeakMap,zg=new WeakMap,Hg=new WeakMap,da=new WeakMap,Al=new WeakMap,Kn=new WeakMap,Tl=new WeakMap,bu=new WeakMap,Wg=new WeakMap,Ee=new WeakMap,_u=new WeakMap,I_=new WeakSet,uR=function(){return c(this,ys).size!==0?c(this,ys).values():c(this,Ee).getEditors(this.pageIndex)},KT=new WeakSet,rG=function(e){c(this,Ee).unselectAll();const{target:t}=e;if(t===c(this,Kn).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,Kn).div.contains(t)){const{isMac:r}=mr.platform;if(e.button!==0||e.ctrlKey&&r)return;c(this,Ee).showAllEditors("highlight",!0,!0),c(this,Kn).div.classList.add("free"),this.toggleDrawing(),aA.startHighlighting(this,c(this,Ee).direction==="ltr",{target:c(this,Kn).div,x:e.x,y:e.y}),c(this,Kn).div.addEventListener("pointerup",()=>{c(this,Kn).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,Ee)._signal}),e.preventDefault()}},Ni=new WeakSet,La=function(){return c(Ji,_u).get(c(this,Ee).getMode())},D_=new WeakSet,hR=function(e){const t=c(this,Ni,La);return t?new t.prototype.constructor(e):null},R_=new WeakSet,dR=function(){const{x:e,y:t,width:r,height:s}=this.boundingClientRect,i=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+r),l=Math.min(window.innerHeight,t+s),u=(i+o)/2-e,h=(a+l)/2-t,[f,p]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:f,offsetY:p}},Gg=new WeakSet,VE=function(){for(const e of c(this,ys).values())e.isEmpty()&&e.remove()},ie(Ji,"_initialized",!1),x(Ji,_u,new Map([HD,eR,oR,aA,aR].map(e=>[e._editorType,e])));let cR=Ji;var fa,Xr,ef,M_,XT,sG,O_,pR,QT,iG,L_,mR;const kn=class kn{constructor({pageIndex:e}){x(this,O_);x(this,QT);x(this,L_);x(this,fa,null);x(this,Xr,new Map);x(this,ef,new Map);this.pageIndex=e}setParent(e){if(!c(this,fa)){A(this,fa,e);return}if(c(this,fa)!==e){if(c(this,Xr).size>0)for(const t of c(this,Xr).values())t.remove(),e.append(t);A(this,fa,e)}}static get _svgFactory(){return Ve(this,"_svgFactory",new sA)}draw(e,t=!1,r=!1){const s=Cn(kn,M_)._++,i=D(this,O_,pR).call(this),a=kn._svgFactory.createElement("defs");i.append(a);const o=kn._svgFactory.createElement("path");a.append(o);const l=`path_p${this.pageIndex}_${s}`;o.setAttribute("id",l),o.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,ef).set(s,o);const u=r?D(this,QT,iG).call(this,a,l):null,h=kn._svgFactory.createElement("use");return i.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(i,e),c(this,Xr).set(s,i),{id:s,clipPathId:`url(#${u})`}}drawOutline(e,t){const r=Cn(kn,M_)._++,s=D(this,O_,pR).call(this),i=kn._svgFactory.createElement("defs");s.append(i);const a=kn._svgFactory.createElement("path");i.append(a);const o=`path_p${this.pageIndex}_${r}`;a.setAttribute("id",o),a.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const f=kn._svgFactory.createElement("mask");i.append(f),l=`mask_p${this.pageIndex}_${r}`,f.setAttribute("id",l),f.setAttribute("maskUnits","objectBoundingBox");const p=kn._svgFactory.createElement("rect");f.append(p),p.setAttribute("width","1"),p.setAttribute("height","1"),p.setAttribute("fill","white");const g=kn._svgFactory.createElement("use");f.append(g),g.setAttribute("href",`#${o}`),g.setAttribute("stroke","none"),g.setAttribute("fill","black"),g.setAttribute("fill-rule","nonzero"),g.classList.add("mask")}const u=kn._svgFactory.createElement("use");s.append(u),u.setAttribute("href",`#${o}`),l&&u.setAttribute("mask",`url(#${l})`);const h=u.cloneNode();return s.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),c(this,Xr).set(r,s),r}finalizeDraw(e,t){c(this,ef).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:r,bbox:s,rootClass:i,path:a}=t,o=typeof e=="number"?c(this,Xr).get(e):e;if(o){if(r&&D(this,L_,mR).call(this,o,r),s&&D(l=kn,XT,sG).call(l,o,s),i){const{classList:u}=o;for(const[h,f]of Object.entries(i))u.toggle(h,f)}if(a){const h=o.firstChild.firstChild;D(this,L_,mR).call(this,h,a)}}}updateParent(e,t){if(t===this)return;const r=c(this,Xr).get(e);r&&(c(t,fa).append(r),c(this,Xr).delete(e),c(t,Xr).set(e,r))}remove(e){c(this,ef).delete(e),c(this,fa)!==null&&(c(this,Xr).get(e).remove(),c(this,Xr).delete(e))}destroy(){A(this,fa,null);for(const e of c(this,Xr).values())e.remove();c(this,Xr).clear(),c(this,ef).clear()}};fa=new WeakMap,Xr=new WeakMap,ef=new WeakMap,M_=new WeakMap,XT=new WeakSet,sG=function(e,[t,r,s,i]){const{style:a}=e;a.top=`${100*r}%`,a.left=`${100*t}%`,a.width=`${100*s}%`,a.height=`${100*i}%`},O_=new WeakSet,pR=function(){const e=kn._svgFactory.create(1,1,!0);return c(this,fa).append(e),e.setAttribute("aria-hidden",!0),e},QT=new WeakSet,iG=function(e,t){const r=kn._svgFactory.createElement("clipPath");e.append(r);const s=`clip_${t}`;r.setAttribute("id",s),r.setAttribute("clipPathUnits","objectBoundingBox");const i=kn._svgFactory.createElement("use");return r.append(i),i.setAttribute("href",`#${t}`),i.classList.add("clip"),s},L_=new WeakSet,mR=function(e,t){for(const[r,s]of Object.entries(t))s===null?e.removeAttribute(r):e.setAttribute(r,s)},x(kn,XT),x(kn,M_,0);let fR=kn;globalThis._pdfjsTestingUtils={HighlightOutliner:GD};globalThis.pdfjsLib={AbortException:qu,AnnotationEditorLayer:cR,AnnotationEditorParamsType:Qe,AnnotationEditorType:Fe,AnnotationEditorUIManager:Pf,AnnotationLayer:VD,AnnotationMode:_c,AnnotationType:_n,applyOpacity:hEe,build:v1e,ColorPicker:nA,createValidAbsoluteUrl:ZH,CSSConstants:uEe,DOMSVGFactory:sA,DrawLayer:fR,FeatureTest:mr,fetchData:xx,findContrastColor:dEe,getDocument:CO,getFilenameFromUrl:sEe,getPdfFilenameFromUrl:iEe,getRGB:Ex,getUuid:n9,getXfaPageViewport:oEe,GlobalWorkerOptions:ga,ImageKind:cE,InvalidPDFException:BI,isDataScheme:_k,isPdfFile:SO,isValidExplicitDest:xEe,MathClamp:Jr,noContextMenu:Hi,normalizeUnicode:tEe,OPS:iw,OutputScale:Co,PasswordResponses:GSe,PDFDataRangeTransport:sW,PDFDateString:X1,PDFWorker:lw,PermissionFlag:WSe,PixelsPerInch:Yu,RenderingCancelledException:xO,renderRichText:i9,ResponseException:K1,setLayerDimensions:Nf,shadow:Ve,SignatureExtractor:In,stopEvent:cn,SupportedImageMimeTypes:HI,TextLayer:ow,TouchManager:J1,updateUrlHash:e9,Util:ye,VerbosityLevel:vk,version:y1e,XfaLayer:s9};ga.workerSrc="/pdf.worker.min.mjs";const B1e=({pdfUrl:n,onPageClick:e,signaturePlacements:t,onLoadSuccess:r})=>{const s=B.useRef(null),[i,a]=B.useState(null),[o,l]=B.useState(!0),[u,h]=B.useState(null),[f,p]=B.useState([]),g=B.useRef([]);B.useEffect(()=>{v()},[n]),B.useEffect(()=>{i&&y()},[i]);const v=async()=>{l(!0),h(null);try{const S=await CO(n).promise;a(S),r&&r(S.numPages),l(!1)}catch(b){console.error("Error loading PDF:",b),h(b.message),l(!1)}},y=async()=>{if(!i)return;const b=i.numPages,S=[];g.current=Array(b).fill(null).map(()=>H.createRef());for(let T=1;T<=b;T++)S.push({pageNum:T});p(S),setTimeout(async()=>{for(let T=1;T<=b;T++)await _(T)},100)},_=async b=>{if(i)try{const S=await i.getPage(b),T=g.current[b-1];if(!T)return;const P=T.getContext("2d"),R=S.getViewport({scale:1.5});T.height=R.height,T.width=R.width;const k={canvasContext:P,viewport:R};await S.render(k).promise}catch(S){console.error(`Error rendering page ${b}:`,S)}},w=(b,S)=>{const T=g.current[S-1];if(!T)return;const P=T.getBoundingClientRect(),R=(b.clientX-P.left)/P.width*100,k=(b.clientY-P.top)/P.height*100;e&&e({x:R,y:k,page:S})};return o?d.jsx("div",{className:"flex items-center justify-center p-12 border border-gray-300 rounded",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading PDF..."})]})}):u?d.jsx("div",{className:"flex items-center justify-center p-12 border border-red-300 bg-red-50 rounded",children:d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-red-600 font-medium",children:"Error loading PDF"}),d.jsx("p",{className:"text-red-500 text-sm mt-2",children:u})]})}):d.jsx("div",{ref:s,className:"space-y-4",children:f.map((b,S)=>{const T=b.pageNum,P=t.filter(R=>R.page===T);return d.jsxs("div",{className:"relative inline-block",children:[d.jsxs("div",{className:"absolute top-2 left-2 bg-blue-900 text-white px-2 py-1 rounded text-xs font-medium z-10",children:["Page ",T]}),d.jsx("canvas",{ref:R=>g.current[S]=R,onClick:R=>w(R,T),className:"border border-gray-300 cursor-crosshair block"}),P.map(R=>d.jsx("div",{className:"absolute border-2 border-green-500 bg-green-100 bg-opacity-30 pointer-events-none",style:{left:`${R.x}%`,top:`${R.y}%`,width:"150px",height:"50px",transform:"translate(-50%, -50%)"},children:d.jsx("div",{className:"text-xs text-green-700 text-center mt-3 font-medium",children:" Signature"})},R.id))]},T)})})},z1e=({clients:n,onClose:e,onSuccess:t})=>{const[r,s]=B.useState(1),[i,a]=B.useState(null),[o,l]=B.useState(""),[u,h]=B.useState(!1),[f,p]=B.useState(""),[g,v]=B.useState(""),[y,_]=B.useState("Please review and sign this document at your earliest convenience."),[w,b]=B.useState(!1),[S,T]=B.useState(""),[P,R]=B.useState(!0),[k,C]=B.useState(!1),[I,M]=B.useState(1),[L,F]=B.useState([]),[O,Y]=B.useState(!0),[Z,X]=B.useState(""),[J,K]=B.useState(""),[te,ae]=B.useState(""),q=async V=>{const ee=V.target.files[0];if(ee){if(ee.type!=="application/pdf"){T("Please select a PDF file");return}a(ee),v(ee.name.replace(".pdf","")),h(!0),T("");try{const re=Date.now(),ce=sx(xy,`signature-requests/${re}_${ee.name}`),Ae=await nx(ce,ee),_e=await rx(Ae.ref);l(_e)}catch(re){console.error("Upload error:",re),T("Failed to upload PDF")}finally{h(!1)}}},$=V=>{const ee={id:Date.now(),...V};F([...L,ee])},U=V=>{F(L.filter(ee=>ee.id!==V))},G=async V=>{if(V.preventDefault(),O){if(!f){T("Please select a client");return}}else if(!Z||!J){T("Please enter client name and email");return}if(!o){T("Please upload a document first");return}if(!P&&!k){T("Please select at least one notification method");return}b(!0),T("");try{let ee,re,ce,Ae;if(O){const ke=n.find(Ye=>Ye.id===f);if(!ke)throw new Error("Client not found");ee=`${ke.firstName} ${ke.lastName}`,re=ke.email,ce=ke.phone||"",Ae=f}else ee=Z,re=J,ce=te||"",Ae=null;const _e={documentTitle:g,documentUrl:o,clientId:Ae,clientName:ee,clientEmail:re,clientPhone:ce,message:y,signatureFields:L,status:"pending",createdAt:En(),signed:!1,signature:null,signedAt:null},xe=await _a(ot(Re,"signatureRequests"),_e);try{await ns(rs,"sendSignatureRequestNotification")({requestId:xe.id,clientName:ee,clientEmail:re,clientPhone:ce,documentTitle:g,message:y,sendViaEmail:P,sendViaSMS:k})}catch(ke){console.error("Notification error:",ke)}t&&t(),alert(`Signature request sent to ${ee}!${P?`
 Email notification sent`:""}${k?`
 SMS notification sent`:""}`),e&&e()}catch(ee){console.error("Error sending request:",ee),T("Failed to send signature request: "+ee.message)}finally{b(!1)}};return d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsxs("div",{className:"p-6 border-b flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-medium text-gray-900",children:"Send Signature Request"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Step ",r," of 3: ",r===1?"Upload Document":r===2?"Mark Signature Fields":"Send Request"]})]}),d.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("div",{className:"flex-1 overflow-auto p-6",children:[S&&d.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md flex items-center mb-4",children:[d.jsx(So,{className:"h-5 w-5 text-red-400 mr-2"}),d.jsx("span",{className:"text-red-700",children:S})]}),r===1&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Document (PDF)"}),d.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[d.jsx(k0,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),d.jsxs("label",{className:"cursor-pointer",children:[d.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Choose PDF to upload"}),d.jsx("input",{type:"file",accept:".pdf",onChange:q,className:"hidden",disabled:u})]}),i&&d.jsxs("p",{className:"text-sm text-green-600 mt-2",children:[" ",i.name]}),u&&d.jsxs("div",{className:"mt-4 flex items-center justify-center",children:[d.jsx(d1,{className:"h-6 w-6 text-blue-600 animate-spin mr-2"}),d.jsx("span",{className:"text-sm text-gray-600",children:"Uploading..."})]})]})]}),o&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Document Title"}),d.jsx("input",{type:"text",value:g,onChange:V=>v(V.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:d.jsx("p",{className:"text-sm text-blue-900",children:' PDF uploaded successfully! Click "Next" to mark signature fields.'})})]})]}),r===2&&o&&d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[d.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Click on the PDF where you want the client to sign"}),d.jsxs("p",{className:"text-xs text-blue-700 mt-1",children:[L.length," signature field(s) added"]})]}),d.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Total Pages: ",I]}),d.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50 overflow-auto",style:{maxHeight:"600px"},children:d.jsx(B1e,{pdfUrl:o,onPageClick:$,signaturePlacements:L,onLoadSuccess:V=>M(V)})}),L.length>0&&d.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Signature Fields:"}),d.jsx("div",{className:"space-y-2",children:L.map(V=>d.jsxs("div",{className:"flex items-center justify-between text-sm",children:[d.jsxs("span",{className:"text-gray-600",children:["Page ",V.page," - Position (",V.x.toFixed(0),"%, ",V.y.toFixed(0),"%)"]}),d.jsx("button",{onClick:()=>U(V.id),className:"text-red-600 hover:text-red-700",children:d.jsx(u2,{className:"h-4 w-4"})})]},V.id))})]})]}),r===3&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Client Information *"}),d.jsxs("div",{className:"flex space-x-4 mb-4",children:[d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"radio",checked:O,onChange:()=>Y(!0),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),d.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Select existing client"})]}),d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"radio",checked:!O,onChange:()=>Y(!1),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300"}),d.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Enter new client details"})]})]}),O?d.jsxs("select",{value:f,onChange:V=>p(V.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[d.jsx("option",{value:"",children:"Choose a client..."}),n.map(V=>d.jsxs("option",{value:V.id,children:[V.firstName," ",V.lastName," (",V.email,")"]},V.id))]}):d.jsxs("div",{className:"space-y-3 bg-gray-50 p-4 rounded-md border border-gray-200",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-600",children:"Full Name *"}),d.jsx("input",{type:"text",value:Z,onChange:V=>X(V.target.value),placeholder:"John Doe",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-600",children:"Email Address *"}),d.jsx("input",{type:"email",value:J,onChange:V=>K(V.target.value),placeholder:"john@example.com",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-xs font-medium text-gray-600",children:"Phone Number (optional, for SMS)"}),d.jsx("input",{type:"tel",value:te,onChange:V=>ae(V.target.value),placeholder:"+1 (555) 123-4567",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 text-sm"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message to Client"}),d.jsx("textarea",{value:y,onChange:V=>_(V.target.value),rows:4,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"border-t pt-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Notification Method"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:P,onChange:V=>R(V.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),d.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Send via Email"})]}),d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:k,onChange:V=>C(V.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),d.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Send via SMS"})]})]})]}),d.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[d.jsx("h4",{className:"text-sm font-medium text-green-900 mb-2",children:"Review:"}),d.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[d.jsxs("li",{children:[" Document: ",g]}),d.jsxs("li",{children:[" Signature Fields: ",L.length]}),d.jsxs("li",{children:[" Notifications: ",P&&"Email",P&&k&&", ",k&&"SMS"]})]})]})]})]}),d.jsxs("div",{className:"p-6 border-t bg-gray-50 flex justify-between",children:[d.jsx("button",{type:"button",onClick:()=>{r>1?s(r-1):e()},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:r===1?"Cancel":"Back"}),r<3?d.jsx("button",{onClick:()=>s(r+1),disabled:r===1&&!o,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:"Next"}):d.jsx("button",{onClick:G,disabled:w||!o||(O?!f:!Z||!J),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 flex items-center",children:w?d.jsxs(d.Fragment,{children:[d.jsx(d1,{className:"h-4 w-4 mr-2 animate-spin"}),"Sending..."]}):d.jsxs(d.Fragment,{children:[d.jsx(m1,{className:"h-4 w-4 mr-2"}),"Send Request"]})})]})]})})};bO.init("tlwGhvG0aPvocwYcO");const H1e=Fwe(pe),W1e=()=>{var Wf,Ia,Fy,ih;const[n,e]=B.useState(null),[t,r]=B.useState(!0),[s,i]=B.useState("overview"),[a,o]=B.useState(!1),[l,u]=B.useState("month"),[h,f]=B.useState(new Date),[p,g]=B.useState([]),[v,y]=B.useState([]),[_,w]=B.useState([]),[b,S]=B.useState([]),[T,P]=B.useState([]),[R,k]=B.useState([]),[C,I]=B.useState([]),[M,L]=B.useState({totalClients:0,activeMatters:0,totalDocuments:0,unreadMessages:0,upcomingAppointments:0,pendingSignatures:0}),[F,O]=B.useState(!1),[Y,Z]=B.useState(!1),[X,J]=B.useState(!1),[K,te]=B.useState(!1),[ae,q]=B.useState(0),[$,U]=B.useState(null),[G,V]=B.useState({firstName:"",lastName:"",email:"",phone:"",address:"",password:"",matterType:"Estate Planning",matterTitle:"",matterDescription:""}),[ee,re]=B.useState(""),[ce,Ae]=B.useState(""),[_e,xe]=B.useState(""),[ke,Ye]=B.useState(!0),[Ke,Zn]=B.useState(!1),[wr,zr]=B.useState(""),[Yi,Io]=B.useState(null),[er,fe]=B.useState(""),[Ne,mt]=B.useState(!1),[lt,br]=B.useState(null),[Hr,gt]=B.useState(!1),[Dt,Is]=B.useState(null),[Rt,Ds]=B.useState({firstName:"",lastName:"",email:"",phone:"",address:""}),kx=["rozsagyenelaw@yahoo.com"];B.useEffect(()=>wB(On,async he=>{he&&kx.includes(he.email)?(e(he),await Rs()):e(null),r(!1)}),[]);const Rs=async()=>{try{const he=(await Rn(Mn(ot(Re,"users"),vn("role","==","client")))).docs.map(He=>({id:He.id,...He.data()}));console.log("Loaded clients:",he),g(he);const De=(await Rn(ot(Re,"matters"))).docs.map(He=>({id:He.id,...He.data()}));y(De);const fn=(await Rn(Mn(ot(Re,"documents"),yh("uploadDate","desc")))).docs.map(He=>({id:He.id,...He.data()}));w(fn);const Ms=(await Rn(Mn(ot(Re,"messages"),yh("date","desc")))).docs.map(He=>({id:He.id,...He.data()}));S(Ms);const Da=(await Rn(Mn(ot(Re,"appointments"),vn("status","!=","cancelled")))).docs.map(He=>{var ic;return{id:He.id,...He.data(),appointmentDate:(ic=He.data().appointmentDate)==null?void 0:ic.toDate()}});k(Da);const Ek=(await Rn(Mn(ot(Re,"appointments"),vn("status","==","confirmed"),yh("appointmentDate","asc")))).docs.map(He=>{var ic;return{id:He.id,...He.data(),appointmentDate:(ic=He.data().appointmentDate)==null?void 0:ic.toDate()}}),Gf=new Date,$y=Ek.filter(He=>He.appointmentDate>=Gf);P($y);const qf=(await Rn(Mn(ot(Re,"signatureRequests"),yh("createdAt","desc")))).docs.map(He=>({id:He.id,...He.data()}));I(qf),L({totalClients:he.length,activeMatters:De.filter(He=>He.status==="Active").length,totalDocuments:fn.length,unreadMessages:Ms.filter(He=>He.unread).length,upcomingAppointments:$y.length})}catch(z){console.error("Error loading dashboard data:",z)}},zf=async z=>{if(window.confirm("Are you sure you want to delete this signature request? This action cannot be undone."))try{await ZZ(si(Re,"signatureRequests",z));const ct=(await Rn(Mn(ot(Re,"signatureRequests"),yh("createdAt","desc")))).docs.map(De=>({id:De.id,...De.data()}));I(ct),alert("Signature request deleted successfully.")}catch(he){console.error("Error deleting signature request:",he),alert("Failed to delete signature request: "+he.message)}},sh=async z=>{var he;if(window.confirm("Are you sure you want to cancel this appointment?"))try{const ct=await Q5(si(Re,"appointments",z));if(!ct.exists()){alert("Appointment not found.");return}const De=ct.data(),os=(he=De.appointmentDate)==null?void 0:he.toDate();await bf(si(Re,"appointments",z),{status:"cancelled",cancelledAt:En()});try{const fn={appointmentId:z,clientName:De.clientName,clientEmail:De.clientEmail,clientPhone:De.clientPhone||"",appointmentDateFormatted:os.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/Los_Angeles"}),appointmentTime:os.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:"America/Los_Angeles"}),appointmentType:De.appointmentType==="virtual"?"Virtual Consultation":"Phone Consultation",cancelledBy:"Admin"};await ns(rs,"sendClientCancellationConfirmation")(fn),await ns(rs,"sendAttorneyCancellationNotification")(fn),console.log(" Cancellation emails sent successfully")}catch(fn){console.error("Failed to send cancellation emails:",fn)}alert("Appointment cancelled successfully. Confirmation emails have been sent."),await Rs(),U(null)}catch(ct){console.error("Error cancelling appointment:",ct),alert("Failed to cancel appointment. Please try again.")}},Hf=R.map(z=>({id:z.id,title:`${z.clientName} - ${z.appointmentType==="virtual"?"Virtual":"Phone"}`,start:z.appointmentDate,end:new Date(z.appointmentDate.getTime()+60*60*1e3),resource:z})),Ly=z=>{const he=z.resource;let ct="#3B82F6";switch(he.status){case"confirmed":ct="#10B981";break;case"pending":ct="#F59E0B";break;case"cancelled":ct="#EF4444";break;default:ct="#6B7280"}return{style:{backgroundColor:ct,borderRadius:"4px",opacity:.9,color:"white",border:"none",display:"block"}}},Bt=z=>{U(z.resource)},mi=({label:z,onNavigate:he,onView:ct})=>d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px",flexWrap:"wrap",gap:"10px"},children:[d.jsxs("div",{style:{display:"flex",gap:"10px"},children:[d.jsx("button",{onClick:()=>he("PREV"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:d.jsx(k3,{size:20})}),d.jsx("button",{onClick:()=>he("TODAY"),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:"Today"}),d.jsx("button",{onClick:()=>he("NEXT"),className:"px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:d.jsx(N3,{size:20})})]}),d.jsx("h2",{className:"text-xl font-semibold",children:z}),d.jsx("div",{style:{display:"flex",gap:"5px"},children:["month","week","day"].map(De=>d.jsx("button",{onClick:()=>{u(De),ct(De)},className:`px-4 py-2 rounded-md ${l===De?"bg-blue-900 text-white":"border border-gray-300 hover:bg-gray-50"}`,children:De.charAt(0).toUpperCase()+De.slice(1)},De))})]}),rc=async z=>{z.preventDefault();try{const he="temp_"+Date.now()+"_"+Math.random().toString(36).substr(2,9);await J5(si(Re,"users",he),{uid:he,email:G.email,firstName:G.firstName,lastName:G.lastName,phone:G.phone,address:G.address,role:"client",needsAuthSetup:!0,tempPassword:G.password,createdAt:En(),createdBy:n.email}),G.matterTitle&&await _a(ot(Re,"matters"),{clientId:he,clientName:`${G.firstName} ${G.lastName}`,title:G.matterTitle,type:G.matterType,description:G.matterDescription,status:"Active",createdAt:En(),lastUpdate:En()}),V({firstName:"",lastName:"",email:"",phone:"",address:"",password:"",matterType:"Estate Planning",matterTitle:"",matterDescription:""}),O(!1),await Rs(),alert("Client profile created! Note: Client will need to set up their login credentials on first visit.")}catch(he){console.error("Error creating client:",he),he.code==="auth/email-already-in-use"?alert("This email is already registered. Please use a different email."):he.code==="auth/weak-password"?alert("Password is too weak. Please use at least 6 characters."):alert("Error creating client: "+he.message)}},jy=async z=>{if(z.preventDefault(),!ee||!ce||!_e){alert("Please fill in all fields");return}if(!ke&&!Ke){alert("Please select at least one notification method (Email or SMS)");return}console.log("Selected client ID:",ee),console.log("Available clients:",p);try{const he=p.find(fn=>fn.id===ee);if(console.log("Found client data:",he),!he){alert("Client not found. Please select a valid client.");return}const ct=`${he.firstName} ${he.lastName}`,De=he.email,os=he.phone||"";if(console.log("Sending message to:",De),console.log("Client data:",he),!De){alert("Client email address not found. Please make sure the client has an email address.");return}await _a(ot(Re,"messages"),{clientId:he.uid||he.id,clientName:ct,from:"Law Offices of Rozsa Gyene",subject:ce,message:_e,date:En(),unread:!0,sentViaEmail:ke,sentViaSMS:!!(Ke&&os)});try{const Vn=await ns(rs,"sendMessageNotification")({clientName:ct,clientEmail:De,clientPhone:os,messageSubject:ce,messageContent:_e,sendViaEmail:ke,sendViaSMS:Ke});console.log("Notification result:",Vn.data);let Ms="Message saved successfully!";Vn.data.results&&(Vn.data.results.email.sent&&(Ms+=`
 Email notification sent`),Vn.data.results.sms.sent&&(Ms+=`
 SMS notification sent`),Vn.data.results.email.error&&(Ms+=`
 Email notification failed: `+Vn.data.results.email.error),Vn.data.results.sms.error&&(Ms+=`
 SMS notification failed: `+Vn.data.results.sms.error)),alert(Ms)}catch(fn){console.error("Notification error:",fn),alert("Message saved but notification failed: "+fn.message)}re(""),Ae(""),xe(""),Ye(!0),Zn(!1),Z(!1),await Rs()}catch(he){console.error("Error sending message:",he),alert("Failed to send message: "+he.message)}},Pa=async z=>{if(z.preventDefault(),!wr||!Yi||!er){alert("Please fill in all fields");return}q(10);try{const he=p.find(Da=>Da.id===wr);if(!he){alert("Please select a client");return}const ct=`${he.firstName} ${he.lastName}`,De=he.uid||he.id,os=new Date().getTime(),fn=`${De}/${er}/${os}_${Yi.name}`,Vn=sx(xy,`documents/${fn}`);q(30);const Ms=await nx(Vn,Yi);q(60);const Nx=await rx(Ms.ref);q(80),await _a(ot(Re,"documents"),{name:Yi.name,category:er,url:Nx,size:`${(Yi.size/1024/1024).toFixed(2)} MB`,uploadDate:En(),clientId:De,clientName:ct,uploadedBy:n.email}),q(100),zr(""),Io(null),fe(""),J(!1),q(0),await Rs(),alert("Document uploaded successfully!")}catch(he){console.error("Error uploading document:",he),alert("Failed to upload document"),q(0)}},sc=async z=>{z.preventDefault();try{await bf(si(Re,"users",Dt.id),{firstName:Rt.firstName,lastName:Rt.lastName,email:Rt.email,phone:Rt.phone,address:Rt.address,updatedAt:En()}),Ds({firstName:"",lastName:"",email:"",phone:"",address:""}),gt(!1),Is(null),await Rs(),alert("Client updated successfully!")}catch(he){console.error("Error updating client:",he),alert("Error updating client: "+he.message)}};return t?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ho,{className:"h-12 w-12 text-blue-900 animate-pulse mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading admin dashboard..."})]})}):n?d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:d.jsx("button",{onClick:()=>o(!a),className:"p-2 rounded-md bg-white shadow-md",children:a?d.jsx(es,{className:"h-6 w-6"}):d.jsx(O3,{className:"h-6 w-6"})})}),d.jsx("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-blue-900 transform ${a?"translate-x-0":"-translate-x-full"} lg:translate-x-0 transition-transform duration-300 ease-in-out`,children:d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-center text-white mb-8",children:[d.jsx(ho,{className:"h-8 w-8 mr-3"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold",children:"Admin Dashboard"}),d.jsx("p",{className:"text-sm text-blue-200",children:"Law Offices of Rozsa Gyene"})]})]}),d.jsx("nav",{className:"space-y-2",children:[{id:"overview",icon:D3,label:"Overview"},{id:"clients",icon:Dj,label:"Clients"},{id:"calendar",icon:ya,label:"Calendar"},{id:"appointments",icon:pf,label:"Appointments List"},{id:"documents",icon:bs,label:"Documents"},{id:"signatures",icon:VP,label:"Signature Requests"},{id:"messages",icon:p1,label:"Messages"},{id:"matters",icon:UP,label:"Matters"}].map(z=>d.jsxs("button",{onClick:()=>{i(z.id),o(!1)},className:`w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${s===z.id?"bg-blue-800 text-white":"text-blue-100 hover:bg-blue-800 hover:text-white"}`,children:[d.jsx(z.icon,{className:"h-5 w-5 mr-3"}),z.label]},z.id))})]}),d.jsxs("div",{className:"mt-auto p-6",children:[d.jsx("div",{className:"text-blue-200 text-sm mb-4",children:n.email}),d.jsxs("button",{onClick:()=>bB(On),className:"w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg text-blue-100 hover:bg-blue-800 hover:text-white transition-colors",children:[d.jsx(M3,{className:"h-5 w-5 mr-3"}),"Sign Out"]})]})]})}),d.jsx("div",{className:"lg:ml-64",children:d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[s==="calendar"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Calendar"}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"View and manage all appointments"})]}),d.jsx("div",{className:"flex items-center space-x-4",children:d.jsxs("div",{className:"flex space-x-2",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-3 h-3 rounded-full bg-green-500 mr-1"}),d.jsx("span",{className:"text-xs text-gray-600",children:"Confirmed"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-3 h-3 rounded-full bg-orange-500 mr-1"}),d.jsx("span",{className:"text-xs text-gray-600",children:"Pending"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("span",{className:"w-3 h-3 rounded-full bg-red-500 mr-1"}),d.jsx("span",{className:"text-xs text-gray-600",children:"Cancelled"})]})]})})]}),d.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:d.jsx(Dwe,{localizer:H1e,events:Hf,startAccessor:"start",endAccessor:"end",style:{height:700},onSelectEvent:Bt,view:l,date:h,onView:u,onNavigate:f,eventPropGetter:Ly,components:{toolbar:mi}})})]}),s==="overview"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Dashboard Overview"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(Dj,{className:"h-10 w-10 text-blue-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Total Clients"}),d.jsx("p",{className:"text-2xl font-semibold",children:M.totalClients})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(UP,{className:"h-10 w-10 text-green-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Active Matters"}),d.jsx("p",{className:"text-2xl font-semibold",children:M.activeMatters})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(bs,{className:"h-10 w-10 text-purple-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Documents"}),d.jsx("p",{className:"text-2xl font-semibold",children:M.totalDocuments})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(p1,{className:"h-10 w-10 text-orange-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Unread Messages"}),d.jsx("p",{className:"text-2xl font-semibold",children:M.unreadMessages})]})]})})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Upcoming Appointments"}),d.jsxs("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:[M.upcomingAppointments," upcoming"]})]}),T.slice(0,3).length>0?d.jsxs("div",{className:"space-y-3",children:[T.slice(0,3).map(z=>{var he;return d.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ya,{className:"h-5 w-5 text-blue-600 mr-3"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.clientName}),d.jsx("p",{className:"text-xs text-gray-500",children:(he=z.appointmentDate)==null?void 0:he.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})})]})]}),d.jsx("span",{className:"text-xs text-gray-500",children:z.appointmentType==="virtual"?"Virtual":"Phone"})]},z.id)}),d.jsx("button",{onClick:()=>i("calendar"),className:"w-full text-center text-sm text-blue-600 hover:text-blue-800 font-medium py-2",children:"View calendar "})]}):d.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"No upcoming appointments"})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Quick Actions"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("button",{onClick:()=>O(!0),className:"flex items-center justify-center px-4 py-3 bg-blue-900 text-white rounded-md hover:bg-blue-800",children:[d.jsx(WS,{className:"h-5 w-5 mr-2"}),"New Client"]}),d.jsxs("button",{onClick:()=>J(!0),className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-md hover:bg-green-700",children:[d.jsx(k0,{className:"h-5 w-5 mr-2"}),"Upload Document"]}),d.jsxs("button",{onClick:()=>Z(!0),className:"flex items-center justify-center px-4 py-3 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:[d.jsx(m1,{className:"h-5 w-5 mr-2"}),"Send Message"]})]})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Recent Activity"})}),d.jsx("div",{className:"p-6",children:d.jsx("div",{className:"space-y-4",children:_.slice(0,5).map(z=>{var he;return d.jsx("div",{className:"flex items-center justify-between",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(bs,{className:"h-5 w-5 text-gray-400 mr-3"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:z.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:["Uploaded for ",z.clientName,"  ",(he=z.uploadDate)!=null&&he.toDate?z.uploadDate.toDate().toLocaleDateString():"Recently"]})]})]})},z.id)})})})]})]}),s==="appointments"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Appointments List"}),d.jsxs("span",{className:"px-4 py-2 bg-blue-100 text-blue-800 text-sm font-medium rounded-full",children:[T.length," upcoming"]})]}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:T.length>0?d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notes"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.map(z=>{var he,ct;return d.jsxs("tr",{children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.clientName}),d.jsx("div",{className:"text-sm text-gray-500",children:z.clientEmail})]})}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[d.jsx("div",{className:"text-sm text-gray-900",children:(he=z.appointmentDate)==null?void 0:he.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),d.jsxs("div",{className:"text-sm text-gray-500",children:[(ct=z.appointmentDate)==null?void 0:ct.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," PT"]})]}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:z.appointmentType==="virtual"?"Virtual":"Phone"})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 flex items-center w-fit",children:[d.jsx(ci,{className:"h-3 w-3 mr-1"}),"Confirmed"]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("div",{className:"text-sm text-gray-500 max-w-xs truncate",children:z.notes||"No notes"})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:d.jsx("button",{onClick:()=>sh(z.id),className:"text-red-600 hover:text-red-900",children:"Cancel"})})]},z.id)})})]})}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ya,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-500",children:"No upcoming appointments"})]})})]}),s==="clients"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Clients"}),d.jsxs("button",{onClick:()=>O(!0),className:"flex items-center px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800",children:[d.jsx(WS,{className:"h-5 w-5 mr-2"}),"New Client"]})]}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Created"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:p.map(z=>{var he;return d.jsxs("tr",{children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[z.firstName," ",z.lastName]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-500",children:z.email})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-500",children:z.phone})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(he=z.createdAt)!=null&&he.toDate?z.createdAt.toDate().toLocaleDateString():"N/A"}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[d.jsx("button",{onClick:()=>{br(z),mt(!0)},className:"text-blue-600 hover:text-blue-900 mr-3",children:"View"}),d.jsx("button",{onClick:()=>{Is(z),Ds({firstName:z.firstName,lastName:z.lastName,email:z.email,phone:z.phone,address:z.address||""}),gt(!0)},className:"text-gray-600 hover:text-gray-900",children:"Edit"})]})]},z.id)})})]})})})]}),s==="documents"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Documents"}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsxs("button",{onClick:()=>te(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[d.jsx(bs,{className:"h-5 w-5 mr-2"}),"Request Signature"]}),d.jsxs("button",{onClick:()=>J(!0),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:[d.jsx(k0,{className:"h-5 w-5 mr-2"}),"Upload Document"]})]})]}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"space-y-4",children:[_.map(z=>{var he;return d.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(bs,{className:"h-8 w-8 text-gray-400 mr-4"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:z.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:[z.clientName,"  ",z.category,"  ",(he=z.uploadDate)!=null&&he.toDate?z.uploadDate.toDate().toLocaleDateString():"Recently"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("span",{className:"text-sm text-gray-500",children:z.size}),d.jsx("button",{onClick:()=>{console.log("Downloading document:",z.name),console.log("URL:",z.url),z.url?window.open(z.url,"_blank"):alert("Download URL not available")},className:"text-blue-600 hover:text-blue-800 p-2 rounded hover:bg-blue-50",title:"Download document",children:d.jsx(I3,{className:"h-5 w-5"})})]})]},z.id)}),_.length===0&&d.jsx("p",{className:"text-center text-gray-500",children:"No documents uploaded yet"})]})})})]}),s==="messages"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Messages"}),d.jsxs("button",{onClick:()=>Z(!0),className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:[d.jsx(m1,{className:"h-5 w-5 mr-2"}),"Send Message"]})]}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:d.jsx("div",{className:"divide-y divide-gray-200",children:b.map(z=>{var he;return d.jsx("div",{className:`p-6 ${z.unread?"bg-blue-50":""}`,children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:z.subject}),d.jsx("span",{className:"text-sm text-gray-500",children:(he=z.date)!=null&&he.toDate?z.date.toDate().toLocaleDateString():"Recently"})]}),d.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["To: ",z.clientName]}),d.jsx("p",{className:"text-sm text-gray-700 mt-2",children:z.message}),d.jsxs("div",{className:"mt-3 flex items-center space-x-2",children:[z.sentViaEmail&&d.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:" Email"}),z.sentViaSMS&&d.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:" SMS"})]})]}),z.unread&&d.jsx("span",{className:"ml-4 px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"Unread"})]})},z.id)})})})]}),s==="matters"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Matters"}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Title"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(z=>{var he;return d.jsxs("tr",{children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.title})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-500",children:z.clientName})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm text-gray-500",children:z.type})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${z.status==="Active"?"bg-green-100 text-green-800":z.status==="In Progress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:z.status})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(he=z.lastUpdate)!=null&&he.toDate?z.lastUpdate.toDate().toLocaleDateString():"N/A"})]},z.id)})})]})})})]}),s==="signatures"&&d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Signature Requests"}),d.jsxs("button",{onClick:()=>te(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[d.jsx(WS,{className:"h-5 w-5 mr-2"}),"New Signature Request"]})]}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:d.jsxs("div",{className:"overflow-x-auto",children:[d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Document"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sent"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Signed"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(z=>{var he,ct,De;return d.jsxs("tr",{children:[d.jsxs("td",{className:"px-6 py-4",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.documentTitle}),d.jsxs("div",{className:"text-xs text-gray-500",children:[((he=z.signatureFields)==null?void 0:he.length)||0," signature field(s)"]})]}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[d.jsx("div",{className:"text-sm text-gray-900",children:z.clientName}),d.jsx("div",{className:"text-xs text-gray-500",children:z.clientEmail})]}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:z.signed?d.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-green-100 text-green-800 flex items-center w-fit",children:[d.jsx(ci,{className:"h-3 w-3 mr-1"}),"Signed"]}):d.jsxs("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-yellow-100 text-yellow-800 flex items-center w-fit",children:[d.jsx(pf,{className:"h-3 w-3 mr-1"}),"Pending"]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(ct=z.createdAt)!=null&&ct.toDate?z.createdAt.toDate().toLocaleDateString():"N/A"}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(De=z.signedAt)!=null&&De.toDate?z.signedAt.toDate().toLocaleDateString():"-"}),d.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:[d.jsxs("button",{onClick:()=>{const os=`http://localhost:5175/sign/${z.id}`;navigator.clipboard.writeText(os),alert(`Localhost URL copied!

${os}

Paste this in your browser to test signing.`)},className:"text-blue-600 hover:text-blue-900 mr-3",title:"Copy localhost test URL",children:[d.jsx(n7,{className:"h-4 w-4 inline mr-1"}),"Test Link"]}),d.jsx("a",{href:z.signed&&z.signedPdfUrl?z.signedPdfUrl:z.documentUrl,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-gray-900 mr-3",title:z.signed&&z.signedPdfUrl?"View signed PDF":"View original PDF",children:d.jsx(HS,{className:"h-4 w-4 inline"})}),d.jsx("button",{onClick:()=>zf(z.id),className:"text-red-600 hover:text-red-900",title:"Delete signature request",children:d.jsx(c7,{className:"h-4 w-4 inline"})})]})]},z.id)})})]}),C.length===0&&d.jsxs("div",{className:"text-center py-12",children:[d.jsx(VP,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-500",children:"No signature requests yet"}),d.jsx("button",{onClick:()=>te(!0),className:"mt-4 text-blue-600 hover:text-blue-700",children:"Create your first signature request"})]})]})})]})]})}),$&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Appointment Details"}),d.jsx("button",{onClick:()=>U(null),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:$.clientName}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:$.clientEmail})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Date & Time"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(Wf=$.appointmentDate)==null?void 0:Wf.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),d.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[(Ia=$.appointmentDate)==null?void 0:Ia.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," PT"]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Type"}),d.jsx("span",{className:"mt-1 inline-block px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:$.appointmentType==="virtual"?"Virtual Meeting":"Phone Call"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),d.jsx("span",{className:`mt-1 inline-block px-2 py-1 text-xs font-medium rounded-full ${$.status==="confirmed"?"bg-green-100 text-green-800":$.status==="pending"?"bg-orange-100 text-orange-800":"bg-red-100 text-red-800"}`,children:$.status.charAt(0).toUpperCase()+$.status.slice(1)})]}),$.notes&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:$.notes})]}),d.jsxs("div",{className:"pt-4 flex space-x-3",children:[$.status==="confirmed"&&d.jsx("button",{onClick:()=>{sh($.id)},className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Cancel Appointment"}),d.jsx("button",{onClick:()=>U(null),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Close"})]})]})]})}),F&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Create New Client"}),d.jsx("button",{onClick:()=>O(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("form",{onSubmit:rc,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),d.jsx("input",{type:"text",value:G.firstName,onChange:z=>V({...G,firstName:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),d.jsx("input",{type:"text",value:G.lastName,onChange:z=>V({...G,lastName:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsx("input",{type:"email",value:G.email,onChange:z=>V({...G,email:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),d.jsx("input",{type:"tel",value:G.phone,onChange:z=>V({...G,phone:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),d.jsx("input",{type:"text",value:G.address,onChange:z=>V({...G,address:z.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),d.jsx("input",{type:"password",value:G.password,onChange:z=>V({...G,password:z.target.value}),required:!0,minLength:6,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Minimum 6 characters"})]}),d.jsxs("div",{className:"border-t pt-4 mt-4",children:[d.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Initial Matter (Optional)"}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Matter Type"}),d.jsxs("select",{value:G.matterType,onChange:z=>V({...G,matterType:z.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[d.jsx("option",{children:"Estate Planning"}),d.jsx("option",{children:"Probate"}),d.jsx("option",{children:"Trust Administration"}),d.jsx("option",{children:"Conservatorship"})]})]}),d.jsxs("div",{className:"mt-3",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Matter Title"}),d.jsx("input",{type:"text",value:G.matterTitle,onChange:z=>V({...G,matterTitle:z.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"mt-3",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Description"}),d.jsx("textarea",{value:G.matterDescription,onChange:z=>V({...G,matterDescription:z.target.value}),rows:3,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>O(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800",children:"Create Client"})]})]})]})}),X&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Upload Document"}),d.jsx("button",{onClick:()=>J(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("form",{onSubmit:Pa,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client"}),d.jsxs("select",{value:wr,onChange:z=>zr(z.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[d.jsx("option",{value:"",children:"Select a client..."}),p.map(z=>d.jsxs("option",{value:z.id,children:[z.firstName," ",z.lastName]},z.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Category"}),d.jsx("input",{type:"text",value:er,onChange:z=>fe(z.target.value),placeholder:"e.g., Trust Documents, Tax Returns",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"File"}),d.jsx("input",{type:"file",onChange:z=>Io(z.target.files[0]),required:!0,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})]}),ae>0&&d.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:d.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${ae}%`}})}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>J(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700",children:"Upload"})]})]})]})}),Y&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Send Message"}),d.jsx("button",{onClick:()=>Z(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("form",{onSubmit:jy,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Client"}),d.jsxs("select",{value:ee,onChange:z=>re(z.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",children:[d.jsx("option",{value:"",children:"Select a client..."}),p.map(z=>d.jsxs("option",{value:z.id,children:[z.firstName," ",z.lastName]},z.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),d.jsx("input",{type:"text",value:ce,onChange:z=>Ae(z.target.value),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Message"}),d.jsx("textarea",{value:_e,onChange:z=>xe(z.target.value),rows:4,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"border-t pt-4 mt-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Send Notification Via:"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:ke,onChange:z=>Ye(z.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),d.jsx("span",{className:"ml-2 text-sm text-gray-700",children:" Email (Recommended)"})]}),d.jsxs("label",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",checked:Ke,onChange:z=>Zn(z.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),d.jsxs("span",{className:"ml-2 text-sm text-gray-700",children:[" SMS ",ee&&((Fy=p.find(z=>z.id===ee))!=null&&Fy.phone)?"":"(No phone number on file)"]})]})]}),!ke&&!Ke&&d.jsx("p",{className:"mt-2 text-sm text-red-600",children:" Please select at least one notification method"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>Z(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Send Message"})]})]})]})}),Ne&&lt&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Client Details"}),d.jsx("button",{onClick:()=>mt(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),d.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[lt.firstName," ",lt.lastName]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:lt.email})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:lt.phone})]}),lt.address&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:lt.address})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Created"}),d.jsx("p",{className:"mt-1 text-sm text-gray-900",children:(ih=lt.createdAt)!=null&&ih.toDate?lt.createdAt.toDate().toLocaleDateString():"N/A"})]}),d.jsxs("div",{className:"pt-4 flex space-x-3",children:[d.jsx("button",{onClick:()=>{re(lt.uid),i("documents"),mt(!1)},className:"flex-1 px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800",children:"View Documents"}),d.jsx("button",{onClick:()=>{re(lt.uid),i("messages"),mt(!1)},className:"flex-1 px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"View Messages"})]})]})]})}),Hr&&Dt&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-md w-full p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Client"}),d.jsx("button",{onClick:()=>gt(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("form",{onSubmit:sc,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),d.jsx("input",{type:"text",value:Rt.firstName,onChange:z=>Ds({...Rt,firstName:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),d.jsx("input",{type:"text",value:Rt.lastName,onChange:z=>Ds({...Rt,lastName:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsx("input",{type:"email",value:Rt.email,onChange:z=>Ds({...Rt,email:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),d.jsx("input",{type:"tel",value:Rt.phone,onChange:z=>Ds({...Rt,phone:z.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),d.jsx("input",{type:"text",value:Rt.address,onChange:z=>Ds({...Rt,address:z.target.value}),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:()=>gt(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800",children:"Save Changes"})]})]})]})}),K&&d.jsx(z1e,{clients:p,onClose:()=>te(!1),onSuccess:()=>{te(!1)}})]}):d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ho,{className:"h-12 w-12 text-red-600 mx-auto mb-4"}),d.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Access Denied"}),d.jsx("p",{className:"text-gray-600",children:"You don't have permission to access this page."}),d.jsx("button",{onClick:()=>window.location.href="/",className:"mt-4 px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800",children:"Return to Client Portal"})]})})},G1e=({userProfile:n})=>{const[e,t]=B.useState([]),[r,s]=B.useState(!0),[i,a]=B.useState(!1),[o,l]=B.useState(""),[u,h]=B.useState(""),[f,p]=B.useState("phone"),[g,v]=B.useState(""),[y,_]=B.useState([]),[w,b]=B.useState(""),[S,T]=B.useState(""),[P,R]=B.useState(!1),[k,C]=B.useState(""),[I,M]=B.useState(""),[L,F]=B.useState(""),O=[{value:"virtual",label:"Virtual Consultation",icon:Fp},{value:"phone",label:"Over the Phone",icon:f1}],Y={monday:{start:9,end:17},tuesday:{start:9,end:17},wednesday:{start:9,end:17},thursday:{start:9,end:17},friday:{start:9,end:17},saturday:{start:9,end:14},sunday:null},Z=30,X=On.currentUser!==null;B.useEffect(()=>{On.currentUser?J():s(!1)},[]),B.useEffect(()=>{o&&K(o)},[o]);const J=async()=>{try{const U=Mn(ot(Re,"appointments"),vn("clientId","==",On.currentUser.uid),vn("status","!=","cancelled"),yh("status"),yh("appointmentDate","asc")),V=(await Rn(U)).docs.map(ce=>{var Ae;return{id:ce.id,...ce.data(),appointmentDate:(Ae=ce.data().appointmentDate)==null?void 0:Ae.toDate()}}),ee=new Date,re=V.filter(ce=>ce.appointmentDate>=ee);t(re)}catch(U){console.error("Error loading appointments:",U)}finally{s(!1)}},K=async U=>{const G=new Date(U+"T00:00:00-08:00"),V=G.toLocaleDateString("en-US",{weekday:"long",timeZone:"America/Los_Angeles"}).toLowerCase(),ee=Y[V];if(!ee){_([]);return}const re=new Date().toLocaleString("en-US",{timeZone:"America/Los_Angeles"}),ce=new Date(re),Ae=[];for(let _e=ee.start;_e<ee.end;_e++)for(let xe=0;xe<60;xe+=Z){const ke=`${_e.toString().padStart(2,"0")}:${xe.toString().padStart(2,"0")}`;new Date(U+`T${ke}:00-08:00`)>ce&&Ae.push(ke)}try{const _e=Mn(ot(Re,"appointments"),vn("appointmentDate",">=",new Date(G.setHours(0,0,0,0))),vn("appointmentDate","<=",new Date(G.setHours(23,59,59,999))),vn("status","==","confirmed")),ke=(await Rn(_e)).docs.map(Ke=>{const Zn=Ke.data().appointmentDate.toDate();return`${Zn.getHours().toString().padStart(2,"0")}:${Zn.getMinutes().toString().padStart(2,"0")}`}),Ye=Ae.filter(Ke=>!ke.includes(Ke));_(Ye)}catch(_e){console.error("Error checking availability:",_e),_(Ae)}},te=async U=>{var G;U.preventDefault(),R(!0),T(""),b("");try{const V=X?n?`${n.firstName} ${n.lastName}`:On.currentUser.email:k,ee=X?On.currentUser.email:I,re=X?(n==null?void 0:n.phone)||"":L,[ce,Ae]=u.split(":"),_e=`${o}T${u}:00-08:00`,xe=new Date(_e),ke={clientId:X?On.currentUser.uid:"guest",clientName:V,clientEmail:ee,clientPhone:re,appointmentDate:xe,appointmentType:f,notes:g,status:"confirmed",createdAt:En(),isGuestBooking:!X,remindersSent:{"24hours":!1,"1hour":!1}},Ye=await _a(ot(Re,"appointments"),ke);try{const Ke={appointmentId:Ye.id,clientName:V,clientEmail:ee,clientPhone:re,appointmentDate:xe.toISOString(),appointmentDateFormatted:xe.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/Los_Angeles"}),appointmentTime:xe.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:"America/Los_Angeles"}),appointmentType:(G=O.find(zr=>zr.value===f))==null?void 0:G.label,notes:g||"None"};await ns(rs,"sendClientAppointmentConfirmation")(Ke),await ns(rs,"sendAttorneyAppointmentNotification")(Ke)}catch(Ke){console.error("Email notification failed:",Ke)}b("Appointment booked successfully! You will receive a confirmation email shortly."),a(!1),l(""),h(""),p("phone"),v(""),C(""),M(""),F(""),X&&await J(),setTimeout(()=>{b("")},5e3)}catch(V){console.error("Error booking appointment:",V),T("Failed to book appointment. Please try again.")}finally{R(!1)}},ae=async U=>{var G;if(window.confirm("Are you sure you want to cancel this appointment?"))try{const V=e.find(ce=>ce.id===U);if(!V){T("Appointment not found.");return}const ee=V,re=ee.appointmentDate;await bf(si(Re,"appointments",U),{status:"cancelled",cancelledAt:En()});try{const ce={appointmentId:U,clientName:ee.clientName,clientEmail:ee.clientEmail,clientPhone:ee.clientPhone||"",appointmentDateFormatted:re.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/Los_Angeles"}),appointmentTime:re.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:"America/Los_Angeles"}),appointmentType:(G=O.find(xe=>xe.value===ee.appointmentType))==null?void 0:G.label,cancelledBy:"Client"};await ns(rs,"sendClientCancellationConfirmation")(ce),await ns(rs,"sendAttorneyCancellationNotification")(ce),console.log(" Cancellation emails sent successfully")}catch(ce){console.error("Failed to send cancellation emails:",ce)}b("Appointment cancelled successfully. Confirmation emails have been sent."),await J(),setTimeout(()=>{b("")},3e3)}catch(V){console.error("Error cancelling appointment:",V),T("Failed to cancel appointment. Please try again.")}},q=()=>new Date().toISOString().split("T")[0],$=()=>{const U=new Date;return U.setMonth(U.getMonth()+3),U.toISOString().split("T")[0]};return r?d.jsx("div",{className:"flex items-center justify-center p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ya,{className:"h-12 w-12 text-blue-900 animate-pulse mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading appointments..."})]})}):d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Appointments"}),d.jsxs("button",{onClick:()=>a(!0),className:"flex items-center px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[d.jsx(WS,{className:"h-5 w-5 mr-2"}),"Book Appointment"]})]}),w&&d.jsxs("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded relative flex items-center",children:[d.jsx(ci,{className:"h-5 w-5 mr-2"}),w]}),S&&d.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded relative flex items-center",children:[d.jsx(So,{className:"h-5 w-5 mr-2"}),S]}),d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[d.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-2",children:"Schedule a Consultation"}),d.jsx("p",{className:"text-blue-700 mb-4",children:"Book a consultation for estate planning, probate, or trust administration matters."}),d.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(pf,{className:"h-4 w-4 mr-2"}),d.jsx("span",{children:"30-minute appointments"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(ya,{className:"h-4 w-4 mr-2"}),d.jsx("span",{children:"Available Mon-Fri: 9:00 AM - 5:00 PM, Sat: 9:00 AM - 2:00 PM (Pacific Time)"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Fp,{className:"h-4 w-4 mr-2"}),d.jsx("span",{children:"Virtual or phone consultations available"})]})]})]}),X&&d.jsxs("div",{className:"bg-white shadow rounded-lg",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Your Appointments"})}),d.jsx("div",{className:"p-6",children:e.length>0?d.jsx("div",{className:"space-y-4",children:e.map(U=>{var G;return d.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[U.appointmentType==="virtual"?d.jsx(Fp,{className:"h-5 w-5 text-green-600 mr-2"}):d.jsx(f1,{className:"h-5 w-5 text-blue-600 mr-2"}),d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:(G=O.find(V=>V.value===U.appointmentType))==null?void 0:G.label})]}),d.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ya,{className:"h-4 w-4 mr-2"}),d.jsx("span",{children:U.appointmentDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(pf,{className:"h-4 w-4 mr-2"}),d.jsxs("span",{children:[U.appointmentDate.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," (Pacific Time)"]})]}),U.notes&&d.jsxs("p",{className:"mt-2 text-gray-700",children:[d.jsx("strong",{children:"Notes:"})," ",U.notes]})]})]}),d.jsxs("div",{className:"ml-4 flex flex-col items-end space-y-2",children:[d.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[d.jsx(ci,{className:"h-3 w-3 mr-1"}),"Confirmed"]}),d.jsx("button",{onClick:()=>ae(U.id),className:"text-sm text-red-600 hover:text-red-800",children:"Cancel"})]})]})},U.id)})}):d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ya,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-500",children:"No upcoming appointments"}),d.jsx("button",{onClick:()=>a(!0),className:"mt-4 text-blue-600 hover:text-blue-800 font-medium",children:"Book your first appointment"})]})})]}),i&&d.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center p-4",children:d.jsxs("div",{className:"relative bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Book an Appointment"}),d.jsx("button",{onClick:()=>a(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsxs("form",{onSubmit:te,className:"p-6 space-y-6",children:[!X&&d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-4",children:[d.jsx("h4",{className:"font-medium text-blue-900",children:"Your Information"}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),d.jsx("input",{type:"text",value:k,onChange:U=>C(U.target.value),required:!0,placeholder:"John Smith",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),d.jsx("input",{type:"email",value:I,onChange:U=>M(U.target.value),required:!0,placeholder:"john@example.com",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),d.jsx("input",{type:"tel",value:L,onChange:U=>F(U.target.value),required:!0,placeholder:"(555) 123-4567",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Appointment Type"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:O.map(U=>{const G=U.icon;return d.jsxs("button",{type:"button",onClick:()=>p(U.value),className:`p-4 border-2 rounded-lg flex items-center justify-center space-x-3 transition-colors ${f===U.value?"border-blue-600 bg-blue-50":"border-gray-300 hover:border-gray-400"}`,children:[d.jsx(G,{className:`h-6 w-6 ${f===U.value?"text-blue-600":"text-gray-400"}`}),d.jsx("span",{className:`font-medium ${f===U.value?"text-blue-900":"text-gray-700"}`,children:U.label})]},U.value)})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),d.jsx("input",{type:"date",value:o,onChange:U=>l(U.target.value),min:q(),max:$(),required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Available Mon-Fri: 9 AM - 5 PM, Sat: 9 AM - 2 PM"})]}),o&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Time (Pacific Time)"}),y.length>0?d.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-2 max-h-64 overflow-y-auto",children:y.map(U=>d.jsx("button",{type:"button",onClick:()=>h(U),className:`px-3 py-2 text-sm border rounded-md transition-colors ${u===U?"border-blue-600 bg-blue-50 text-blue-700 font-medium":"border-gray-300 hover:border-gray-400 text-gray-700"}`,children:new Date(`2000-01-01T${U}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},U))}):d.jsx("p",{className:"text-sm text-gray-500 py-4 text-center",children:"No available time slots for this date. Please select another date."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),d.jsx("textarea",{value:g,onChange:U=>v(U.target.value),rows:3,placeholder:"Any specific topics you'd like to discuss?",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{type:"button",onClick:()=>a(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:!o||!u||P,className:"px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:P?"Booking...":"Confirm Appointment"})]})]})]})})]})},q1e=({document:n,user:e,userProfile:t,onClose:r,onSigned:s})=>{const[i,a]=B.useState(""),[o,l]=B.useState(!1),[u,h]=B.useState(!1),[f,p]=B.useState(!1),[g,v]=B.useState(!1),[y,_]=B.useState(""),[w,b]=B.useState(!1),[S,T]=B.useState(""),P=B.useRef(null),[R,k]=B.useState(1);B.useState(1);const[C,I]=B.useState([]);B.useState(!1),B.useEffect(()=>{fetch("https://api.ipify.org?format=json").then($=>$.json()).then($=>_($.ip)).catch(()=>_("Unknown"))},[]),B.useEffect(()=>{if(u&&P.current){const $=P.current,U=$.getContext("2d");U.fillStyle="white",U.fillRect(0,0,$.width,$.height),U.strokeStyle="#000",U.lineWidth=2,U.lineCap="round",U.lineJoin="round"}},[u]);const M=$=>{if(!i){T("Please draw your signature first");return}const U=$.currentTarget.getBoundingClientRect(),G=($.clientX-U.left)/U.width*100,V=($.clientY-U.top)/U.height*100,ee={page:R,x:G,y:V,id:Date.now(),signatureImage:i};I([...C,ee]),T("")},L=$=>{I(C.filter(U=>U.id!==$))},F=$=>{l(!0);const U=P.current,G=U.getBoundingClientRect(),V=U.getContext("2d"),ee=$.type.includes("mouse")?$.clientX-G.left:$.touches[0].clientX-G.left,re=$.type.includes("mouse")?$.clientY-G.top:$.touches[0].clientY-G.top;V.beginPath(),V.moveTo(ee,re)},O=$=>{if(!o)return;const U=P.current,G=U.getBoundingClientRect(),V=U.getContext("2d"),ee=$.type.includes("mouse")?$.clientX-G.left:$.touches[0].clientX-G.left,re=$.type.includes("mouse")?$.clientY-G.top:$.touches[0].clientY-G.top;V.lineTo(ee,re),V.stroke()},Y=()=>{o&&(l(!1),X())},Z=()=>{const $=P.current,U=$.getContext("2d");U.fillStyle="white",U.fillRect(0,0,$.width,$.height),a("")},X=()=>{const U=P.current.toDataURL("image/png");a(U)},J=()=>{if(!i){T("Please draw your signature first");return}h(!1),p(!0),T("")},K=async $=>{const G=new TextEncoder().encode($),V=await crypto.subtle.digest("SHA-256",G);return Array.from(new Uint8Array(V)).map(ce=>ce.toString(16).padStart(2,"0")).join("")},te=async($,U)=>{await _a(ot(Re,"auditTrails"),{documentId:n.id,userId:e.uid,userName:t?`${t.firstName} ${t.lastName}`:e.email,action:$,details:U,timestamp:En(),ipAddress:y,userAgent:navigator.userAgent,documentHash:await K(n.content||n.name)})},ae=async()=>{if(!i||!g){T("Please provide your signature and agree to the terms");return}if(C.length===0){T("Please click on the document where you want to place your signature");return}b(!0),T("");try{const $=await fetch(i).then(_e=>_e.blob()),U=`signatures/${e.uid}/${n.id}_signature_${Date.now()}.png`,G=sx(xy,U),V=await nx(G,$),ee=await rx(V.ref);let re=n.url;try{const _e=w6(_y),xe=ns(_e,"embedSignatureInPDFv2");if(!On.currentUser)throw console.error("No authenticated user"),new Error("User not authenticated");await On.currentUser.getIdToken(!0),console.log("Calling Firebase function with authenticated user:",On.currentUser.uid);const ke=await xe({documentId:n.id,pdfUrl:n.url,signatureUrl:ee,placements:C.map(Ye=>({page:Ye.page,x:Ye.x,y:Ye.y})),signerName:t?`${t.firstName} ${t.lastName}`:e.email,ipAddress:y});ke.data.success&&(re=ke.data.signedPdfUrl,console.log("Signed PDF created:",re))}catch(_e){console.log("Firebase function error:",_e)}const ce={documentId:n.id,documentName:n.name,signerId:e.uid,signerName:t?`${t.firstName} ${t.lastName}`:e.email,signerEmail:e.email,signatureImage:ee,signaturePlacements:C.map(_e=>({page:_e.page,x:_e.x,y:_e.y})),signedAt:En(),ipAddress:y,userAgent:navigator.userAgent,documentHash:await K(n.content||n.name),certificationStatement:`I, ${t?`${t.firstName} ${t.lastName}`:e.email}, certify that I have read and agree to the terms of this document.`,esignConsent:!0,agreedToTerms:!0,originalDocumentUrl:n.url,signedDocumentUrl:re},Ae=await _a(ot(Re,"signatures"),ce);await bf(si(Re,"documents",n.id),{signed:!0,signatureId:Ae.id,signedAt:En(),signedDocumentUrl:re,originalDocumentUrl:n.url}),await te("DOCUMENT_SIGNED",{signatureId:Ae.id,method:"electronic_signature",placementMethod:"click_to_place",signaturePlacements:C}),await q(Ae.id,ce),s&&s({documentId:n.id,signatureId:Ae.id,signedAt:new Date,signedDocumentUrl:re}),p(!1),re&&re!==n.url?alert("Document signed successfully! The signed PDF with embedded signature is ready for court filing."):alert("Document signed successfully! The signature has been saved."),r&&r()}catch($){console.error("Error signing document:",$),T("Error signing document. Please try again.")}finally{b(!1)}},q=async($,U)=>{const G={certificateId:`CERT-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,documentId:n.id,documentName:n.name,signatureId:$,signerInfo:{name:U.signerName,email:U.signerEmail,ipAddress:U.ipAddress},signedAt:new Date().toISOString(),verificationCode:await K($+Date.now()),legalNotice:"This certificate confirms that the above-named individual has electronically signed the referenced document in accordance with the ESIGN Act and UETA.",courtCompliance:"This electronic signature is legally binding and admissible in court proceedings."};await _a(ot(Re,"certificates"),G)};return d.jsxs(d.Fragment,{children:[!u&&!f&&d.jsx("button",{onClick:()=>h(!0),className:"text-blue-600 hover:text-blue-700 p-2 hover:bg-blue-50 rounded-lg transition-colors",title:"Sign Document",children:d.jsx(i7,{className:"h-5 w-5"})}),u&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Step 1: Draw Your Signature"}),d.jsx("button",{onClick:()=>{h(!1),r&&r()},className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),S&&d.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-md flex items-center",children:[d.jsx(So,{className:"h-5 w-5 text-red-400 mr-2"}),d.jsx("span",{className:"text-red-700",children:S})]}),d.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-4 mb-6",children:d.jsxs("div",{className:"flex items-start",children:[d.jsx(R3,{className:"h-5 w-5 text-blue-600 mr-2 mt-0.5"}),d.jsxs("div",{className:"text-sm",children:[d.jsx("p",{className:"font-medium text-blue-900 mb-1",children:"Legal Electronic Signature"}),d.jsx("p",{className:"text-blue-700",children:"This electronic signature will be legally binding and court-admissible under the ESIGN Act and UETA."})]})]})}),d.jsxs("div",{className:"bg-gray-50 rounded p-4 mb-6",children:[d.jsx("h4",{className:"font-medium mb-2",children:"Document Information"}),d.jsxs("div",{className:"space-y-1 text-sm",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(bs,{className:"h-4 w-4 mr-2 text-gray-500"}),d.jsx("span",{children:n.name})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(u7,{className:"h-4 w-4 mr-2 text-gray-500"}),d.jsx("span",{children:t?`${t.firstName} ${t.lastName}`:e.email})]})]})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Draw your signature below"}),d.jsx("div",{className:"border-2 border-gray-300 rounded bg-white",children:d.jsx("canvas",{ref:P,width:600,height:200,className:"w-full cursor-crosshair",onMouseDown:F,onMouseMove:O,onMouseUp:Y,onMouseLeave:Y,onTouchStart:$=>{$.preventDefault();const U=$.touches[0],G=new MouseEvent("mousedown",{clientX:U.clientX,clientY:U.clientY});P.current.dispatchEvent(G)},onTouchMove:$=>{$.preventDefault();const U=$.touches[0],G=new MouseEvent("mousemove",{clientX:U.clientX,clientY:U.clientY});P.current.dispatchEvent(G)},onTouchEnd:$=>{$.preventDefault();const U=new MouseEvent("mouseup",{});P.current.dispatchEvent(U)},style:{touchAction:"none"}})}),d.jsx("button",{onClick:Z,className:"mt-2 px-3 py-1 text-sm border border-gray-300 rounded hover:bg-gray-50",children:"Clear"}),i&&d.jsxs("div",{className:"mt-2 text-sm text-green-600 flex items-center",children:[d.jsx(C3,{className:"h-4 w-4 mr-1"}),"Signature captured"]})]}),d.jsx("div",{className:"mb-6",children:d.jsxs("label",{className:"flex items-start",children:[d.jsx("input",{type:"checkbox",checked:g,onChange:$=>v($.target.checked),className:"mt-1 mr-2"}),d.jsx("span",{className:"text-sm text-gray-700",children:"I agree that my electronic signature is the legal equivalent of my manual signature on this document."})]})}),d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:()=>{h(!1),r&&r()},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{onClick:J,disabled:!i||!g,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next: Place Signature"})]})]})}),f&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[d.jsxs("div",{className:"p-6 border-b",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Step 2: Click Where to Place Your Signature"}),d.jsx("button",{onClick:()=>{p(!1),I([]),r&&r()},className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),S&&d.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-md flex items-center",children:[d.jsx(So,{className:"h-5 w-5 text-red-400 mr-2"}),d.jsx("span",{className:"text-red-700",children:S})]}),d.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-md",children:d.jsxs("div",{className:"flex items-start",children:[d.jsx(s7,{className:"h-5 w-5 text-yellow-600 mr-2 mt-0.5"}),d.jsxs("div",{className:"text-sm",children:[d.jsx("p",{className:"font-medium text-yellow-900 mb-1",children:"Instructions"}),d.jsx("p",{className:"text-yellow-700",children:"The PDF will open below. Click directly on the PDF where you want to place your signature. You can place multiple signatures if needed. Use the page navigation to move between pages."})]})]})})]}),d.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-100",children:d.jsxs("div",{className:"max-w-4xl mx-auto",children:[d.jsxs("div",{className:"relative bg-white shadow-lg",children:[n.url&&d.jsxs("div",{className:"relative",children:[d.jsx("iframe",{src:n.url,className:"w-full",style:{height:"850px",border:"none"},title:"PDF Document"}),d.jsxs("div",{className:"absolute inset-0",onClick:M,style:{cursor:"crosshair",backgroundColor:"rgba(255, 255, 255, 0.01)",zIndex:10},children:[C.filter($=>$.page===R).length===0&&d.jsx("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-blue-100 border border-blue-300 rounded-lg px-4 py-2 pointer-events-none",children:d.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Click anywhere on the document to place your signature"})}),C.filter($=>$.page===R).map($=>d.jsx("div",{className:"absolute",style:{left:`${$.x}%`,top:`${$.y}%`,width:"180px",height:"60px",transform:"translate(-50%, -50%)",zIndex:20,pointerEvents:"none"},children:d.jsxs("div",{className:"relative w-full h-full",children:[d.jsx("img",{src:$.signatureImage,alt:"Signature",className:"w-full h-full object-contain",style:{filter:"drop-shadow(2px 2px 4px rgba(0,0,0,0.4))",backgroundColor:"rgba(255, 255, 255, 0.95)",padding:"4px",borderRadius:"2px"}}),d.jsx("button",{onClick:U=>{U.stopPropagation(),L($.id)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 shadow-lg",style:{zIndex:30,pointerEvents:"auto"},children:d.jsx(es,{className:"h-3 w-3"})})]})},$.id))]})]}),!n.url&&d.jsxs("div",{className:"p-12 text-center",children:[d.jsx(bs,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"No PDF URL available"})]})]}),d.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"text-sm text-gray-600",children:[d.jsx("strong",{children:"Tip:"})," Scroll down in the PDF viewer to see all pages. The PDF shows all pages - scroll to find signature lines."]}),d.jsxs("a",{href:n.url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-600 hover:text-blue-700 flex items-center",children:[d.jsx(bs,{className:"h-4 w-4 mr-1"}),"Open full PDF"]})]})})]})}),d.jsxs("div",{className:"p-6 border-t bg-white",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("button",{onClick:()=>k(Math.max(1,R-1)),disabled:R===1,className:"flex items-center px-3 py-2 border border-gray-300 rounded-md disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-50",children:[d.jsx(k3,{className:"h-4 w-4 mr-1"}),"Previous Page"]}),d.jsxs("div",{className:"text-sm text-gray-600",children:["Page ",R,d.jsx("span",{className:"mx-2",children:"|"}),d.jsx("button",{onClick:()=>{const $=prompt("Enter page number:");$&&!isNaN($)&&k(parseInt($))},className:"text-blue-600 hover:text-blue-700",children:"Go to page"})]}),d.jsxs("button",{onClick:()=>k(R+1),className:"flex items-center px-3 py-2 border border-gray-300 rounded-md hover:bg-gray-50",children:["Next Page",d.jsx(N3,{className:"h-4 w-4 ml-1"})]})]}),C.length>0&&d.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("p",{className:"text-sm text-green-800",children:d.jsxs("strong",{children:[C.length," signature(s) placed"]})}),d.jsxs("button",{onClick:()=>I([]),className:"text-sm text-red-600 hover:text-red-700 flex items-center",children:[d.jsx(u2,{className:"h-4 w-4 mr-1"}),"Clear all"]})]}),d.jsxs("div",{className:"mt-2 text-xs text-green-700",children:["Pages with signatures: ",[...new Set(C.map($=>$.page))].join(", ")]})]}),d.jsxs("div",{className:"flex justify-between",children:[d.jsx("button",{onClick:()=>{p(!1),h(!0)},className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Back to Signature"}),d.jsx("button",{onClick:ae,disabled:C.length===0||w,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:w?d.jsxs(d.Fragment,{children:[d.jsx(d1,{className:"h-4 w-4 mr-2 animate-spin"}),"Signing..."]}):"Complete Signing"})]})]})]})})]})};function Y1e({user:n}){const[e,t]=B.useState("upload");B.useState([]);const[r,s]=B.useState([]),[i,a]=B.useState(!1),[o,l]=B.useState(null),[u,h]=B.useState({title:"",signerName:"",signerEmail:"",message:"Please review and sign this document.",sendViaEmail:!1});B.useEffect(()=>{if(!n)return;const _=Mn(ot(Re,"docusignRequests"),vn("userId","==",n.uid)),w=eee(_,b=>{const S=b.docs.map(T=>({id:T.id,...T.data()}));s(S)},b=>{console.error("Error loading DocuSign requests:",b)});return()=>w()},[n]);const f=_=>{const w=_.target.files[0];w&&w.type==="application/pdf"?l(w):alert("Please select a PDF file")},p=async _=>{if(_.preventDefault(),!o){alert("Please select a PDF file");return}a(!0);try{if(!On.currentUser)throw new Error("You must be logged in to create signature requests");await On.currentUser.getIdToken(!0),console.log("User authenticated:",On.currentUser.uid),console.log("Token refreshed"),console.log("Starting file upload...");const w=sx(xy,`signatures/${n.uid}/${Date.now()}_${o.name}`),b=await nx(w,o),S=await rx(b.ref);console.log("File uploaded successfully, URL:",S),console.log("Calling createSignatureRequest function...");const T=ns(rs,"createSignatureRequest"),P={title:u.title||o.name,subject:`Please sign: ${u.title||o.name}`,message:u.message,signerEmail:u.signerEmail,signerName:u.signerName,fileUrl:S,useEmail:u.sendViaEmail};console.log("Request data:",P);const R=await T(P);if(console.log("Function response:",R),R.data&&R.data.requestId){await _a(ot(Re,"docusignRequests"),{userId:n.uid,envelopeId:R.data.requestId,documentTitle:u.title||o.name,signerName:u.signerName,signerEmail:u.signerEmail,status:"sent",createdAt:En(),embeddedUrl:R.data.signUrl||null}),alert("Document sent for signature successfully!"),h({title:"",signerName:"",signerEmail:"",message:"Please review and sign this document.",sendViaEmail:!1}),l(null);const k=document.querySelector('input[type="file"]');k&&(k.value=""),!u.sendViaEmail&&R.data.signUrl&&window.open(R.data.signUrl,"_blank")}else throw new Error("Failed to create signature request - no request ID returned")}catch(w){console.error("Error creating signature request:",w),w.code==="functions/unauthenticated"?alert("Authentication error: Please log out and log back in."):w.code==="functions/internal"?alert(`Server error: ${w.message}`):w.message?alert(`Error: ${w.message}`):alert("Failed to create signature request. Please try again.")}finally{a(!1)}},g=async(_,w)=>{try{console.log("Checking status for envelope:",_);const S=await ns(rs,"getSignatureStatus")({requestId:_});console.log("Status response:",S),S.data&&(await bf(si(Re,"docusignRequests",w),{status:S.data.status,lastChecked:En()}),alert(`Document status: ${S.data.status}`))}catch(b){console.error("Error checking status:",b),b.code==="functions/unauthenticated"?alert("Authentication error: Please log out and log back in."):alert(`Failed to check status: ${b.message}`)}},v=_=>{switch(_==null?void 0:_.toLowerCase()){case"completed":return d.jsx(ci,{className:"w-5 h-5 text-green-500"});case"sent":case"delivered":return d.jsx(pf,{className:"w-5 h-5 text-yellow-500"});case"declined":case"voided":return d.jsx(es,{className:"w-5 h-5 text-red-500"});default:return d.jsx(bs,{className:"w-5 h-5 text-gray-500"})}},y=_=>_?_.charAt(0).toUpperCase()+_.slice(1):"Pending";return d.jsxs("div",{className:"max-w-6xl mx-auto",children:[d.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Document Signing"}),d.jsxs("div",{className:"flex space-x-1 mb-6 border-b",children:[d.jsx("button",{onClick:()=>t("upload"),className:`px-4 py-2 font-medium transition-colors ${e==="upload"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:"Upload & Sign"}),d.jsxs("button",{onClick:()=>t("requests"),className:`px-4 py-2 font-medium transition-colors ${e==="requests"?"text-blue-600 border-b-2 border-blue-600":"text-gray-600 hover:text-gray-900"}`,children:["Signature Requests (",r.length,")"]})]}),e==="upload"&&d.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:d.jsxs("form",{onSubmit:p,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload PDF Document"}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsxs("label",{className:"cursor-pointer bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[d.jsx(k0,{className:"w-5 h-5"}),d.jsx("span",{children:"Choose File"}),d.jsx("input",{type:"file",accept:".pdf",onChange:f,className:"hidden",required:!0})]}),d.jsx("span",{className:"text-gray-600",children:o?o.name:"No file chosen"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Document Title"}),d.jsx("input",{type:"text",value:u.title,onChange:_=>h({...u,title:_.target.value}),placeholder:"Enter document title",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Signer Name *"}),d.jsx("input",{type:"text",value:u.signerName,onChange:_=>h({...u,signerName:_.target.value}),placeholder:"John Doe",required:!0,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Signer Email *"}),d.jsx("input",{type:"email",value:u.signerEmail,onChange:_=>h({...u,signerEmail:_.target.value}),placeholder:"john@example.com",required:!0,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message to Signer"}),d.jsx("textarea",{value:u.message,onChange:_=>h({...u,message:_.target.value}),rows:3,className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"sendViaEmail",checked:u.sendViaEmail,onChange:_=>h({...u,sendViaEmail:_.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),d.jsx("label",{htmlFor:"sendViaEmail",className:"ml-2 text-sm text-gray-700",children:"Send via email (instead of embedded signing)"})]}),d.jsx("button",{type:"submit",disabled:i||!o,className:`w-full py-3 px-4 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2 ${i||!o?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:i?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),d.jsx("span",{children:"Processing..."})]}):d.jsxs(d.Fragment,{children:[d.jsx(m1,{className:"w-5 h-5"}),d.jsx("span",{children:"Send for Signature"})]})})]})}),e==="requests"&&d.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Signature Requests"}),r.length===0?d.jsx("p",{className:"text-gray-500 text-center py-8",children:"No signature requests yet"}):d.jsx("div",{className:"space-y-4",children:r.map(_=>{var w,b,S;return d.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 transition-colors",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h3",{className:"font-medium text-gray-900",children:_.documentTitle}),d.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Signer: ",_.signerName," (",_.signerEmail,")"]}),d.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Created: ",((S=(b=(w=_.createdAt)==null?void 0:w.toDate)==null?void 0:b.call(w))==null?void 0:S.toLocaleDateString())||"Recently"]})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-1",children:[v(_.status),d.jsx("span",{className:"text-sm font-medium",children:y(_.status)})]}),d.jsx("button",{onClick:()=>g(_.envelopeId,_.id),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Check Status",children:d.jsx(a7,{className:"w-5 h-5"})})]})]})},_.id)})})]})]})}const aG=()=>{const[n,e]=B.useState(""),[t,r]=B.useState(""),[s,i]=B.useState("phone"),[a,o]=B.useState(""),[l,u]=B.useState([]),[h,f]=B.useState(""),[p,g]=B.useState(""),[v,y]=B.useState(!1),[_,w]=B.useState(""),[b,S]=B.useState(""),[T,P]=B.useState(""),[R,k]=B.useState(!1),[C,I]=B.useState(""),[M,L]=B.useState([]),[F,O]=B.useState(!1),[Y,Z]=B.useState(""),X=[{value:"virtual",label:"Virtual Consultation",icon:Fp},{value:"phone",label:"Over the Phone",icon:f1}],J={monday:{start:9,end:17},tuesday:{start:9,end:17},wednesday:{start:9,end:17},thursday:{start:9,end:17},friday:{start:9,end:17},saturday:{start:9,end:14},sunday:null},K=30;B.useEffect(()=>{n&&te(n)},[n]);const te=async V=>{const ee=new Date(V+"T00:00:00-08:00"),re=ee.toLocaleDateString("en-US",{weekday:"long",timeZone:"America/Los_Angeles"}).toLowerCase(),ce=J[re];if(!ce){u([]);return}const Ae=new Date().toLocaleString("en-US",{timeZone:"America/Los_Angeles"}),_e=new Date(Ae),xe=[];for(let ke=ce.start;ke<ce.end;ke++)for(let Ye=0;Ye<60;Ye+=K){const Ke=`${ke.toString().padStart(2,"0")}:${Ye.toString().padStart(2,"0")}`;new Date(V+`T${Ke}:00-08:00`)>_e&&xe.push(Ke)}try{const ke=Mn(ot(Re,"appointments"),vn("appointmentDate",">=",new Date(ee.setHours(0,0,0,0))),vn("appointmentDate","<=",new Date(ee.setHours(23,59,59,999))),vn("status","==","confirmed")),Ke=(await Rn(ke)).docs.map(wr=>{const zr=wr.data().appointmentDate.toDate();return`${zr.getHours().toString().padStart(2,"0")}:${zr.getMinutes().toString().padStart(2,"0")}`}),Zn=xe.filter(wr=>!Ke.includes(wr));u(Zn)}catch(ke){console.error("Error checking availability:",ke),u(xe)}},ae=async V=>{var ee;V.preventDefault(),y(!0),g(""),f("");try{const re=`${n}T${t}:00-08:00`,ce=new Date(re),Ae={clientId:"guest",clientName:_,clientEmail:b,clientPhone:T,smsConsent:R,appointmentDate:ce,appointmentType:s,notes:a,status:"confirmed",createdAt:En(),isGuestBooking:!0,remindersSent:{"24hours":!1,"1hour":!1}},_e=await _a(ot(Re,"appointments"),Ae);try{const xe={appointmentId:_e.id,clientName:_,clientEmail:b,clientPhone:R?T:"",appointmentDate:ce.toISOString(),appointmentDateFormatted:ce.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/Los_Angeles"}),appointmentTime:ce.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:"America/Los_Angeles"}),appointmentType:(ee=X.find(Ke=>Ke.value===s))==null?void 0:ee.label,notes:a||"None"};await ns(rs,"sendClientAppointmentConfirmation")(xe),await ns(rs,"sendAttorneyAppointmentNotification")(xe)}catch(xe){console.error("Email notification failed:",xe)}f("Appointment booked successfully! You will receive a confirmation email shortly."),e(""),r(""),i("phone"),o(""),w(""),S(""),P(""),k(!1),window.scrollTo({top:0,behavior:"smooth"})}catch(re){console.error("Error booking appointment:",re),g("Failed to book appointment. Please try again or contact us directly.")}finally{y(!1)}},q=async V=>{V.preventDefault(),O(!0),Z(""),L([]);try{const ee=Mn(ot(Re,"appointments"),vn("clientEmail","==",C.toLowerCase().trim()),vn("status","==","confirmed")),ce=(await Rn(ee)).docs.map(xe=>{var ke;return{id:xe.id,...xe.data(),appointmentDate:(ke=xe.data().appointmentDate)==null?void 0:ke.toDate()}}),Ae=new Date,_e=ce.filter(xe=>xe.appointmentDate>=Ae);_e.length===0?Z("No upcoming appointments found for this email address."):L(_e)}catch(ee){console.error("Error looking up appointments:",ee),Z("Failed to look up appointments. Please try again.")}finally{O(!1)}},$=async(V,ee)=>{var re;if(window.confirm("Are you sure you want to cancel this appointment? This action cannot be undone."))try{const ce=ee,Ae=ce.appointmentDate;await bf(si(Re,"appointments",V),{status:"cancelled",cancelledAt:En()});try{const _e={appointmentId:V,clientName:ce.clientName,clientEmail:ce.clientEmail,clientPhone:ce.smsConsent&&ce.clientPhone||"",appointmentDateFormatted:Ae.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"America/Los_Angeles"}),appointmentTime:Ae.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0,timeZone:"America/Los_Angeles"}),appointmentType:(re=X.find(Ye=>Ye.value===ce.appointmentType))==null?void 0:re.label,cancelledBy:"Guest/Client"};await ns(rs,"sendClientCancellationConfirmation")(_e),await ns(rs,"sendAttorneyCancellationNotification")(_e),console.log(" Cancellation emails sent successfully")}catch(_e){console.error("Failed to send cancellation emails:",_e)}L(_e=>_e.filter(xe=>xe.id!==V)),f("Appointment cancelled successfully. You will receive a confirmation email shortly."),window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>f(""),5e3)}catch(ce){console.error("Error cancelling appointment:",ce),Z("Failed to cancel appointment. Please try again or contact us directly.")}},U=()=>new Date().toISOString().split("T")[0],G=()=>{const V=new Date;return V.setMonth(V.getMonth()+3),V.toISOString().split("T")[0]};return d.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"max-w-3xl mx-auto",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Schedule a Consultation"}),d.jsx("p",{className:"text-lg text-gray-600",children:"Law Offices of Rozsa Gyene - Estate Planning & Probate"})]}),h&&d.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-6 py-4 rounded-lg flex items-start",children:[d.jsx(ci,{className:"h-6 w-6 mr-3 flex-shrink-0 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium",children:h}),d.jsx("p",{className:"text-sm mt-1",children:"Please check your email for confirmation details."})]})]}),p&&d.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-6 py-4 rounded-lg flex items-start",children:[d.jsx(So,{className:"h-6 w-6 mr-3 flex-shrink-0 mt-0.5"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium",children:p}),d.jsx("p",{className:"text-sm mt-1",children:"Email: rozsagyenelaw1@gmail.com"})]})]}),d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-3",children:"What to Expect"}),d.jsxs("div",{className:"space-y-2 text-sm text-blue-800",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(pf,{className:"h-5 w-5 mr-3 flex-shrink-0"}),d.jsx("span",{children:"30-minute consultation appointments"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(ya,{className:"h-5 w-5 mr-3 flex-shrink-0"}),d.jsx("span",{children:"Available Mon-Fri: 9:00 AM - 5:00 PM, Sat: 9:00 AM - 2:00 PM (Pacific Time)"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(Fp,{className:"h-5 w-5 mr-3 flex-shrink-0"}),d.jsx("span",{children:"Choose between virtual or phone consultations"})]})]})]}),d.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 mb-8",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Book New Appointment"}),d.jsxs("form",{onSubmit:ae,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Your Information"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name *"}),d.jsx("input",{type:"text",value:_,onChange:V=>w(V.target.value),required:!0,placeholder:"John Smith",className:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address *"}),d.jsx("input",{type:"email",value:b,onChange:V=>S(V.target.value),required:!0,placeholder:"john@example.com",className:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),d.jsx("input",{type:"tel",value:T,onChange:V=>P(V.target.value),required:!0,placeholder:"(555) 123-4567",className:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"mt-4 bg-blue-50 border-2 border-blue-200 rounded-lg p-4",children:[d.jsxs("label",{className:"flex items-start cursor-pointer group",children:[d.jsx("input",{type:"checkbox",checked:R,onChange:V=>k(V.target.checked),className:"mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded cursor-pointer"}),d.jsxs("span",{className:"ml-3 text-sm text-gray-700 leading-relaxed",children:["I agree to receive appointment reminders and notifications via SMS/text message from ",d.jsx("strong",{children:"Law Offices of Rozsa Gyene"}),". Message frequency: 2-4 messages per appointment (confirmation, reminders, cancellations). Message and data rates may apply. Reply ",d.jsx("strong",{children:"STOP"})," to unsubscribe. Reply ",d.jsx("strong",{children:"HELP"})," for help."]})]}),d.jsx("p",{className:"text-xs text-gray-600 mt-2 ml-7 italic",children:" Optional - You can still book your appointment without SMS notifications. You'll always receive email confirmations."})]})]})]}),d.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Appointment Details"}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Consultation Type *"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:X.map(V=>{const ee=V.icon;return d.jsxs("button",{type:"button",onClick:()=>i(V.value),className:`p-4 border-2 rounded-lg flex items-center justify-center space-x-3 transition-all ${s===V.value?"border-blue-600 bg-blue-50 shadow-md":"border-gray-300 hover:border-gray-400"}`,children:[d.jsx(ee,{className:`h-6 w-6 ${s===V.value?"text-blue-600":"text-gray-400"}`}),d.jsx("span",{className:`font-medium ${s===V.value?"text-blue-900":"text-gray-700"}`,children:V.label})]},V.value)})})]}),d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date *"}),d.jsx("input",{type:"date",value:n,onChange:V=>e(V.target.value),min:U(),max:G(),required:!0,className:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Available Mon-Fri: 9 AM - 5 PM, Sat: 9 AM - 2 PM (Pacific Time)"})]}),n&&d.jsxs("div",{className:"mb-6",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Time (Pacific Time) *"}),l.length>0?d.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3 max-h-80 overflow-y-auto p-2",children:l.map(V=>d.jsx("button",{type:"button",onClick:()=>r(V),className:`px-4 py-3 text-sm border-2 rounded-lg transition-all ${t===V?"border-blue-600 bg-blue-50 text-blue-700 font-semibold shadow-md":"border-gray-300 hover:border-gray-400 text-gray-700 hover:bg-gray-50"}`,children:new Date(`2000-01-01T${V}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})},V))}):d.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border border-gray-200",children:[d.jsx(ya,{className:"h-12 w-12 text-gray-400 mx-auto mb-2"}),d.jsx("p",{className:"text-sm text-gray-600",children:"No available time slots for this date. Please select another date."})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes (Optional)"}),d.jsx("textarea",{value:a,onChange:V=>o(V.target.value),rows:4,placeholder:"Please share any specific topics you'd like to discuss or questions you have...",className:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),d.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[d.jsx("button",{type:"submit",disabled:!n||!t||v,className:"w-full flex justify-center items-center px-6 py-4 bg-blue-900 text-white text-lg font-semibold rounded-lg hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Booking Your Appointment..."]}):d.jsxs(d.Fragment,{children:[d.jsx(ci,{className:"h-5 w-5 mr-2"}),"Confirm Appointment"]})}),d.jsx("p",{className:"mt-3 text-center text-sm text-gray-500",children:"You'll receive a confirmation email with all the details"})]})]})]}),d.jsxs("div",{className:"bg-white shadow-lg rounded-lg p-8 mb-8",children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Manage Your Appointment"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Already booked an appointment? Enter your email to view and manage your upcoming appointments."}),d.jsx("form",{onSubmit:q,className:"mb-6",children:d.jsxs("div",{className:"flex gap-3",children:[d.jsx("div",{className:"flex-1",children:d.jsx("input",{type:"email",value:C,onChange:V=>I(V.target.value),required:!0,placeholder:"Enter your email address",className:"block w-full px-4 py-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),d.jsx("button",{type:"submit",disabled:F,className:"flex items-center px-6 py-3 bg-blue-900 text-white font-semibold rounded-lg hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:F?d.jsxs(d.Fragment,{children:[d.jsxs("svg",{className:"animate-spin h-5 w-5 mr-2",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Searching..."]}):d.jsxs(d.Fragment,{children:[d.jsx(o7,{className:"h-5 w-5 mr-2"}),"Find Appointments"]})})]})}),Y&&d.jsxs("div",{className:"mb-4 bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-lg flex items-start",children:[d.jsx(So,{className:"h-5 w-5 mr-2 flex-shrink-0 mt-0.5"}),d.jsx("p",{className:"text-sm",children:Y})]}),M.length>0&&d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Your Upcoming Appointments"}),M.map(V=>{var ee;return d.jsx("div",{className:"border border-gray-200 rounded-lg p-5 bg-gray-50",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-3",children:[V.appointmentType==="virtual"?d.jsx(Fp,{className:"h-5 w-5 text-green-600 mr-2"}):d.jsx(f1,{className:"h-5 w-5 text-blue-600 mr-2"}),d.jsx("h4",{className:"text-base font-semibold text-gray-900",children:(ee=X.find(re=>re.value===V.appointmentType))==null?void 0:ee.label})]}),d.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ya,{className:"h-4 w-4 mr-2"}),d.jsx("span",{children:V.appointmentDate.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(pf,{className:"h-4 w-4 mr-2"}),d.jsxs("span",{children:[V.appointmentDate.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})," (Pacific Time)"]})]}),V.notes&&d.jsxs("p",{className:"mt-2 text-gray-700",children:[d.jsx("strong",{children:"Notes:"})," ",V.notes]}),d.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Confirmation: #",V.id.substring(0,8)]})]})]}),d.jsx("div",{className:"ml-4",children:d.jsx("button",{onClick:()=>$(V.id,V),className:"px-4 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Cancel Appointment"})})]})},V.id)})]})]}),d.jsxs("div",{className:"mt-8 text-center text-sm text-gray-600",children:[d.jsxs("p",{children:["Need help? Contact us at ",d.jsx("a",{href:"mailto:rozsagyenelaw1@gmail.com",className:"text-blue-600 hover:text-blue-800",children:"rozsagyenelaw1@gmail.com"})]}),d.jsxs("p",{className:"mt-2",children:["Already have an account? ",d.jsx("a",{href:"/login",className:"text-blue-600 hover:text-blue-800 font-medium",children:"Sign in to your portal"})]})]})]})})};ga.workerSrc="/pdf.worker.min.mjs";const K1e=({pdfUrl:n,signatureFields:e,signedFields:t,onSignField:r})=>{const s=B.useRef(null),[i,a]=B.useState(null),[o,l]=B.useState(!0),[u,h]=B.useState(null),[f,p]=B.useState([]),g=B.useRef([]);B.useEffect(()=>{v()},[n]),B.useEffect(()=>{i&&y()},[i]);const v=async()=>{l(!0),h(null);try{const b=await CO(n).promise;a(b),l(!1)}catch(w){console.error("Error loading PDF:",w),h(w.message),l(!1)}},y=async()=>{if(!i)return;const w=i.numPages,b=[];g.current=Array(w).fill(null).map(()=>H.createRef());for(let S=1;S<=w;S++)b.push({pageNum:S});p(b),setTimeout(async()=>{for(let S=1;S<=w;S++)await _(S)},100)},_=async w=>{if(i)try{const b=await i.getPage(w),S=g.current[w-1];if(!S)return;const T=S.getContext("2d"),P=b.getViewport({scale:1.5});S.height=P.height,S.width=P.width;const R={canvasContext:T,viewport:P};await b.render(R).promise}catch(b){console.error(`Error rendering page ${w}:`,b)}};return o?d.jsx("div",{className:"flex items-center justify-center p-12",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading PDF..."})]})}):u?d.jsx("div",{className:"flex items-center justify-center p-12 border border-red-300 bg-red-50 rounded",children:d.jsxs("div",{className:"text-center",children:[d.jsx("p",{className:"text-red-600 font-medium",children:"Error loading PDF"}),d.jsx("p",{className:"text-red-500 text-sm mt-2",children:u})]})}):d.jsx("div",{ref:s,className:"space-y-4",children:f.map((w,b)=>{const S=w.pageNum,T=e.filter(P=>P.page===S);return d.jsxs("div",{className:"relative inline-block",children:[d.jsxs("div",{className:"absolute top-2 left-2 bg-blue-900 text-white px-2 py-1 rounded text-xs font-medium z-10",children:["Page ",S]}),d.jsx("canvas",{ref:P=>g.current[b]=P,className:"border border-gray-300 block"}),T.map(P=>{const R=e.indexOf(P);return d.jsx("div",{className:"absolute cursor-pointer",style:{left:`${P.x}%`,top:`${P.y}%`,transform:"translate(-50%, -50%)"},onClick:()=>r(R),children:t[R]?d.jsxs("div",{className:"relative",children:[d.jsx("img",{src:t[R],alt:"Signature",className:"border-2 border-green-500 bg-white rounded",style:{width:"150px",height:"50px"}}),d.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs",children:""})]}):d.jsx("div",{className:"border-2 border-blue-500 bg-blue-50 hover:bg-blue-100 rounded px-4 py-2 flex items-center justify-center transition-colors",style:{width:"150px",height:"50px"},children:d.jsx("span",{className:"text-blue-700 text-sm font-medium",children:"Click to Sign"})})},R)})]},S)})})},X1e=()=>{var M,L,F;const[n,e]=B.useState(!0),[t,r]=B.useState(null),[s,i]=B.useState(""),[a,o]=B.useState(!1),[l,u]=B.useState(!1),h=B.useRef(null),[f,p]=B.useState(null),[g,v]=B.useState(!1),[y,_]=B.useState(0),[w,b]=B.useState([]);B.useEffect(()=>{(async()=>{try{const Y=window.location.pathname.split("/"),Z=Y[Y.length-1];if(!Z||Z==="sign"){i("Invalid signature request link"),e(!1);return}const X=si(Re,"signatureRequests",Z),J=await Q5(X);J.exists()?r({id:J.id,...J.data()}):i("Signature request not found")}catch(Y){console.error("Error fetching signature request:",Y),i("Failed to load signature request")}finally{e(!1)}})()},[]);const S=O=>{const Y=h.current,Z=Y.getContext("2d"),X=Y.getBoundingClientRect(),J=O.clientX-X.left,K=O.clientY-X.top;u(!0),Z.beginPath(),Z.moveTo(J,K)},T=O=>{if(!l)return;const Y=h.current,Z=Y.getContext("2d"),X=Y.getBoundingClientRect(),J=O.clientX-X.left,K=O.clientY-X.top;Z.lineTo(J,K),Z.strokeStyle="#000",Z.lineWidth=2,Z.lineCap="round",Z.stroke()},P=()=>{u(!1),h.current&&p(h.current.toDataURL())},R=()=>{const O=h.current;O.getContext("2d").clearRect(0,0,O.width,O.height),p(null)},k=O=>{_(O),v(!0),setTimeout(()=>{if(h.current){const Y=h.current;Y.getContext("2d").clearRect(0,0,Y.width,Y.height),p(null)}},100)},C=()=>{if(!f){alert("Please draw your signature first");return}const O=[...w];O[y]=f,b(O),v(!1),p(null)},I=async()=>{var Y;const O=((Y=t.signatureFields)==null?void 0:Y.length)||0;if(w.filter(Z=>Z).length!==O){alert(`Please sign all ${O} required field(s) before submitting.`);return}o(!0);try{const{httpsCallable:Z}=await UI(()=>import("./index.esm-bd500ce8.js"),[]),{functions:X}=await UI(()=>Promise.resolve().then(()=>Dte),void 0),J=Z(X,"generateSignedPdf");console.log("Generating signed PDF...");const te=(await J({originalPdfUrl:t.documentUrl,signatures:w,signatureFields:t.signatureFields,requestId:t.id})).data.signedPdfUrl;console.log("Signed PDF generated:",te);const ae=si(Re,"signatureRequests",t.id);await bf(ae,{signed:!0,signatures:w,signedPdfUrl:te,signedAt:En(),status:"signed"}),r({...t,signed:!0,signatures:w,signedPdfUrl:te,signedAt:new Date}),alert("Document signed successfully! Thank you.")}catch(Z){console.error("Error signing document:",Z),alert("Failed to sign document. Please try again. Error: "+Z.message)}finally{o(!1)}};return n?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ho,{className:"h-12 w-12 text-blue-900 animate-pulse mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading your document..."})]})}):s||!t?d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:d.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8",children:d.jsxs("div",{className:"text-center",children:[d.jsx(So,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Unable to Load Document"}),d.jsx("p",{className:"text-gray-600 mb-6",children:s||"The signature request you are looking for could not be found."}),d.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[d.jsx("p",{className:"text-sm text-blue-900 font-medium mb-2",children:"Need Help?"}),d.jsx("p",{className:"text-sm text-blue-700",children:"Please contact our office for assistance"})]})]})})}):d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsxs("div",{className:"max-w-6xl mx-auto p-4 sm:p-6 lg:p-8",children:[d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[d.jsxs("div",{className:"flex items-center mb-4",children:[d.jsx(ho,{className:"h-8 w-8 text-blue-900 mr-3"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Document Signature Request"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Law Offices of Rozsa Gyene"})]})]}),t.signed?d.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center",children:[d.jsx(ci,{className:"h-6 w-6 text-green-600 mr-3"}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-green-900",children:"Document Already Signed"}),d.jsxs("p",{className:"text-sm text-green-700",children:["This document was signed on ",(M=t.signedAt)==null?void 0:M.toDate().toLocaleDateString()]})]})]}):d.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:d.jsxs("p",{className:"text-sm text-blue-900",children:[d.jsx("strong",{children:"Status:"})," Awaiting your signature (",w.filter(O=>O).length," of ",((L=t.signatureFields)==null?void 0:L.length)||0," signed)"]})})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[d.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[d.jsx(bs,{className:"h-5 w-5 mr-2"}),t.documentTitle]}),t.message&&d.jsxs("div",{className:"mb-4",children:[d.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Message from Attorney:"}),d.jsx("p",{className:"text-gray-900 bg-blue-50 border border-blue-200 rounded p-3 mt-2",children:t.message})]}),d.jsx("p",{className:"text-sm text-gray-600",children:"Please review the document below and click on each signature field to sign."})]}),!t.signed&&t.documentUrl&&d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Document for Signature"}),d.jsx("div",{className:"border border-gray-300 rounded-lg p-4 bg-gray-50 overflow-auto",style:{maxHeight:"800px"},children:d.jsx(K1e,{pdfUrl:t.documentUrl,signatureFields:t.signatureFields||[],signedFields:w,onSignField:k})}),d.jsx("div",{className:"mt-6 flex justify-center",children:d.jsx("button",{onClick:I,disabled:a||w.filter(O=>O).length!==(((F=t.signatureFields)==null?void 0:F.length)||0),className:"flex items-center px-8 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-lg font-medium",children:a?d.jsxs(d.Fragment,{children:[d.jsx(d1,{className:"h-5 w-5 mr-2 animate-spin"}),"Submitting..."]}):d.jsxs(d.Fragment,{children:[d.jsx(ci,{className:"h-5 w-5 mr-2"}),"Submit Signed Document"]})})})]}),t.signed&&t.documentUrl&&d.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Signed Document"}),d.jsxs("a",{href:t.documentUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800 transition-colors",children:[d.jsx(bs,{className:"h-4 w-4 mr-2"}),"View Signed Document"]})]}),d.jsxs("div",{className:"text-center mt-8 text-sm text-gray-500",children:[d.jsxs("p",{children:[" ",new Date().getFullYear()," Law Offices of Rozsa Gyene. All rights reserved."]}),d.jsx("p",{className:"mt-1",children:"Estate Planning & Probate Attorney"})]})]}),g&&d.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Draw Your Signature"}),d.jsx("button",{onClick:()=>v(!1),className:"text-gray-400 hover:text-gray-500",children:d.jsx(es,{className:"h-6 w-6"})})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Please sign in the box below using your mouse or touchscreen:"}),d.jsx("div",{className:"border-2 border-gray-300 rounded-lg bg-white mb-4",children:d.jsx("canvas",{ref:h,width:700,height:200,onMouseDown:S,onMouseMove:T,onMouseUp:P,onMouseLeave:P,className:"w-full cursor-crosshair",style:{touchAction:"none"}})}),d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("button",{onClick:R,className:"flex items-center px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:[d.jsx(u2,{className:"h-4 w-4 mr-2"}),"Clear"]}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsxs("button",{onClick:C,disabled:!f,className:"flex items-center px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[d.jsx(ci,{className:"h-4 w-4 mr-2"}),"Apply Signature"]})]})]})]})})]})};bO.init("tlwGhvG0aPvocwYcO");const Q1e=()=>{const[n,e]=B.useState(null),[t,r]=B.useState(!0),[s,i]=B.useState(!1),[a,o]=B.useState("dashboard"),[l,u]=B.useState(!1),[h,f]=B.useState(!1),[p,g]=B.useState(""),[v,y]=B.useState(0),[_,w]=B.useState([]),[b,S]=B.useState([]),[T,P]=B.useState([]),[R,k]=B.useState(!1),[C,I]=B.useState(null),[M,L]=B.useState(null),[F,O]=B.useState(""),[Y,Z]=B.useState(""),[X,J]=B.useState(""),[K,te]=B.useState(!1),[ae,q]=B.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[$,U]=B.useState(!1),[G,V]=B.useState(!1),[ee,re]=B.useState(""),[ce,Ae]=B.useState(""),_e=["rozsagyenelaw@yahoo.com"],xe=window.location.pathname==="/admin",ke=window.location.pathname==="/book"||window.location.pathname==="/book-appointment"||window.location.pathname==="/appointments",Ye=window.location.pathname.startsWith("/sign/");B.useEffect(()=>wB(On,async Ne=>{if(Ne){e(Ne);const mt=_e.includes(Ne.email);if(k(mt),!mt){let lt=Mn(ot(Re,"users"),vn("uid","==",Ne.uid)),br=await Rn(lt);if(br.empty&&(lt=Mn(ot(Re,"users"),vn("email","==",Ne.email)),br=await Rn(lt)),!br.empty){const Hr={id:br.docs[0].id,...br.docs[0].data()};I(Hr),await Ke(Ne,Hr)}}}else e(null),k(!1),I(null);r(!1)}),[]);const Ke=async(fe,Ne=null)=>{try{const mt=Ne?Ne.uid||Ne.id:fe.uid,lt=Mn(ot(Re,"matters"),vn("clientId","==",mt)),Hr=(await Rn(lt)).docs.map(Bt=>({id:Bt.id,...Bt.data()}));S(Hr);const gt=Mn(ot(Re,"documents"),vn("clientId","==",fe.uid)),Dt=await Rn(gt);let Is={docs:[]};if(Ne&&Ne.uid&&Ne.uid!==fe.uid){const Bt=Mn(ot(Re,"documents"),vn("clientId","==",Ne.uid));Is=await Rn(Bt)}let Rt={docs:[]};if(Ne&&Ne.id){const Bt=Mn(ot(Re,"documents"),vn("clientId","==",Ne.id));Rt=await Rn(Bt)}const zf=[...Dt.docs,...Is.docs,...Rt.docs].reduce((Bt,mi)=>(Bt.find(rc=>rc.id===mi.id)||Bt.push(mi),Bt),[]).map(Bt=>({id:Bt.id,...Bt.data()})).sort((Bt,mi)=>{var Pa,sc;const rc=(Pa=Bt.uploadDate)!=null&&Pa.toDate?Bt.uploadDate.toDate():new Date(Bt.uploadDate||0);return((sc=mi.uploadDate)!=null&&sc.toDate?mi.uploadDate.toDate():new Date(mi.uploadDate||0))-rc});w(zf);const sh=Mn(ot(Re,"messages"),vn("clientId","==",mt)),Ly=(await Rn(sh)).docs.map(Bt=>({id:Bt.id,...Bt.data()}));P(Ly)}catch(mt){console.error("Error loading user data:",mt)}},Zn=async fe=>{if(fe.preventDefault(),Z(""),J(""),!M){Z("Please select a file to upload");return}if(!F){Z("Please select a category");return}te(!0),y(0);try{const Ne=new Date().getTime(),mt=`${n.uid}/${F}/${Ne}_${M.name}`,lt=sx(xy,`client-uploads/${mt}`),Hr=await nx(lt,M),gt=await rx(Hr.ref),Dt={name:M.name,category:F,url:gt,size:`${(M.size/1024/1024).toFixed(2)} MB`,uploadDate:En(),clientId:n.uid,clientName:C?`${C.firstName} ${C.lastName}`:n.email,uploadedBy:"client",status:"pending_review"};await _a(ot(Re,"documents"),Dt);try{const Rt={client_name:C?`${C.firstName} ${C.lastName}`:n.email,document_name:M.name,category:F.replace(/_/g," ").replace(/\b\w/g,Ds=>Ds.toUpperCase()),upload_date:new Date().toLocaleDateString()};await bO.send("service_1y5vmr2","template_xcta2pl",Rt)}catch(Rt){console.error("Email notification failed:",Rt)}J("Document uploaded successfully!"),L(null),O("");const Is=document.querySelector('input[type="file"]');Is&&(Is.value=""),await Ke(n),setTimeout(()=>{J("")},5e3)}catch(Ne){console.error("Upload error:",Ne),Z("Failed to upload document. Please try again.")}finally{te(!1),y(0)}},wr=async fe=>{await Ke(n,C),J("Document signed successfully!"),setTimeout(()=>{J("")},5e3)},zr=async fe=>{if(fe.preventDefault(),Ae(""),re(""),ae.newPassword!==ae.confirmPassword){Ae("New passwords do not match");return}if(ae.newPassword.length<6){Ae("Password must be at least 6 characters");return}try{const Ne=Lf.credential(n.email,ae.currentPassword);await jK(n,Ne),await UK(n,ae.newPassword),re("Password changed successfully!"),q({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>{re("")},3e3)}catch(Ne){Ne.code==="auth/wrong-password"?Ae("Current password is incorrect"):Ae("Error changing password: "+Ne.message)}},Yi=async fe=>{fe.preventDefault(),g("");const Ne=new FormData(fe.target);try{await $K(On,Ne.get("email"),Ne.get("password"))}catch{g("Invalid email or password")}},Io=async fe=>{fe.preventDefault(),g("");const Ne=new FormData(fe.target);if(Ne.get("password")!==Ne.get("confirmPassword")){g("Passwords do not match");return}try{const mt=await FK(On,Ne.get("email"),Ne.get("password"));await J5(si(Re,"users",mt.user.uid),{uid:mt.user.uid,email:Ne.get("email"),firstName:Ne.get("firstName"),lastName:Ne.get("lastName"),phone:Ne.get("phone"),role:"client",createdAt:En()})}catch(mt){g(mt.message)}},er=async()=>{await bB(On),o("dashboard")};if(Ye)return d.jsx(X1e,{});if(t)return d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx(ho,{className:"h-12 w-12 text-blue-900 animate-pulse mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600",children:"Loading..."})]})});if(xe){if(n&&R)return d.jsx(W1e,{});if(n&&!R)return window.location.href="/",null}return ke&&!n?d.jsx(aG,{}):n?d.jsxs("div",{className:"min-h-screen bg-gray-50",children:[d.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:d.jsx("button",{onClick:()=>f(!h),className:"p-2 rounded-md bg-white shadow-md",children:h?d.jsx(es,{className:"h-6 w-6"}):d.jsx(O3,{className:"h-6 w-6"})})}),d.jsx("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-blue-900 transform ${h?"translate-x-0":"-translate-x-full"} lg:translate-x-0 transition-transform duration-300 ease-in-out`,children:d.jsxs("div",{className:"h-full flex flex-col",children:[d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex items-center text-white mb-8",children:[d.jsx(ho,{className:"h-8 w-8 mr-3"}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold",children:"Client Portal"}),d.jsx("p",{className:"text-sm text-blue-200",children:"Rozsa Gyene Law"})]})]}),d.jsx("nav",{className:"space-y-2",children:[{id:"dashboard",icon:D3,label:"Dashboard"},{id:"documents",icon:bs,label:"Documents"},{id:"docusign",icon:VP,label:"E-Signatures"},{id:"appointments",icon:ya,label:"Appointments"},{id:"messages",icon:p1,label:"Messages"},{id:"billing",icon:P3,label:"Billing"},{id:"settings",icon:l7,label:"Account Settings"}].map(fe=>d.jsxs("button",{onClick:()=>{o(fe.id),f(!1)},className:`w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-colors ${a===fe.id?"bg-blue-800 text-white":"text-blue-100 hover:bg-blue-800 hover:text-white"}`,children:[d.jsx(fe.icon,{className:"h-5 w-5 mr-3"}),fe.label]},fe.id))})]}),d.jsxs("div",{className:"mt-auto p-6",children:[d.jsx("div",{className:"text-blue-200 text-sm mb-4",children:C?`${C.firstName} ${C.lastName}`:n.email}),R&&!xe&&d.jsxs("button",{onClick:()=>window.location.href="/admin",className:"w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg text-blue-100 hover:bg-blue-800 hover:text-white transition-colors mb-2",children:[d.jsx(ho,{className:"h-5 w-5 mr-3"}),"Admin Dashboard"]}),d.jsxs("button",{onClick:er,className:"w-full flex items-center px-4 py-3 text-sm font-medium rounded-lg text-blue-100 hover:bg-blue-800 hover:text-white transition-colors",children:[d.jsx(M3,{className:"h-5 w-5 mr-3"}),"Sign Out"]})]})]})}),d.jsx("div",{className:"lg:ml-64",children:d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[a==="dashboard"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Welcome Back!"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(UP,{className:"h-10 w-10 text-blue-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Active Matters"}),d.jsx("p",{className:"text-2xl font-semibold",children:b.filter(fe=>fe.status==="Active").length})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(bs,{className:"h-10 w-10 text-green-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Documents"}),d.jsx("p",{className:"text-2xl font-semibold",children:_.length})]})]})}),d.jsx("div",{className:"bg-white p-6 rounded-lg shadow",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(p1,{className:"h-10 w-10 text-purple-600 mr-4"}),d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-gray-600",children:"Unread Messages"}),d.jsx("p",{className:"text-2xl font-semibold",children:T.filter(fe=>fe.unread).length})]})]})})]}),d.jsxs("div",{className:"bg-white rounded-lg shadow",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Your Matters"})}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"space-y-4",children:[b.map(fe=>d.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:fe.title}),d.jsx("p",{className:"text-sm text-gray-500",children:fe.type})]}),d.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${fe.status==="Active"?"bg-green-100 text-green-800":fe.status==="In Progress"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:fe.status})]},fe.id)),b.length===0&&d.jsx("p",{className:"text-sm text-gray-500 text-center",children:"No active matters"})]})})]})]}),a==="documents"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Your Documents"}),d.jsxs("div",{className:"bg-white shadow rounded-lg mb-6",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Upload Documents"})}),d.jsxs("div",{className:"p-6",children:[X&&d.jsxs("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded relative",children:[d.jsx(ci,{className:"h-5 w-5 inline mr-2"}),X]}),Y&&d.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded relative",children:[d.jsx(So,{className:"h-5 w-5 inline mr-2"}),Y]}),d.jsxs("form",{onSubmit:Zn,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Category"}),d.jsxs("select",{value:F,onChange:fe=>O(fe.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[d.jsx("option",{value:"",children:"Choose a category..."}),d.jsx("option",{value:"existing_documents",children:"Existing Documents"}),d.jsx("option",{value:"completed_documents",children:"Completed Documents"}),d.jsx("option",{value:"supporting_documents",children:"Supporting Documents"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select File"}),d.jsx("input",{type:"file",onChange:fe=>L(fe.target.files[0]),className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100",required:!0}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Maximum file size: 10MB. Supported formats: PDF, DOC, DOCX, JPG, PNG"})]}),d.jsxs("button",{type:"submit",disabled:K,className:"flex items-center px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:[d.jsx(k0,{className:"h-4 w-4 mr-2"}),K?"Uploading...":"Upload Document"]})]})]})]}),d.jsxs("div",{className:"bg-white shadow rounded-lg",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Document Library"})}),d.jsx("div",{className:"p-6",children:d.jsxs("div",{className:"space-y-4",children:[_.map(fe=>{var Ne,mt;return d.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(bs,{className:"h-8 w-8 text-gray-400 mr-4"}),d.jsxs("div",{children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:fe.name}),d.jsxs("p",{className:"text-sm text-gray-500",children:[fe.category&&d.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 mr-2",children:fe.category.replace(/_/g," ").replace(/\b\w/g,lt=>lt.toUpperCase())}),"Uploaded ",(Ne=fe.uploadDate)!=null&&Ne.toDate?fe.uploadDate.toDate().toLocaleDateString():"Recently",fe.signed&&d.jsxs("span",{className:"ml-2 text-green-600",children:[" Signed on ",(mt=fe.signedAt)!=null&&mt.toDate?fe.signedAt.toDate().toLocaleDateString():"Recently"]})]})]})]}),d.jsxs("div",{className:"flex items-center space-x-4",children:[d.jsx("span",{className:"text-sm text-gray-500",children:fe.size}),!fe.signed&&d.jsx(q1e,{document:fe,user:n,userProfile:C,onSigned:wr}),d.jsx("a",{href:fe.signedDocumentUrl||fe.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",title:fe.signed?"Download Signed Document":"Download Document",children:d.jsx(I3,{className:"h-5 w-5"})}),fe.signed&&d.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[d.jsx(ci,{className:"h-3 w-3 mr-1"}),"Signed"]})]})]},fe.id)}),_.length===0&&d.jsx("p",{className:"text-center text-gray-500",children:"No documents uploaded yet"})]})})]})]}),a==="docusign"&&d.jsx(Y1e,{user:n}),a==="appointments"&&d.jsx(G1e,{userProfile:C}),a==="messages"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Messages"}),d.jsx("div",{className:"bg-white shadow rounded-lg",children:d.jsxs("div",{className:"divide-y divide-gray-200",children:[T.map(fe=>{var Ne;return d.jsx("div",{className:`p-6 ${fe.unread?"bg-blue-50":""}`,children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h4",{className:"text-sm font-medium text-gray-900",children:fe.subject}),d.jsx("span",{className:"text-sm text-gray-500",children:(Ne=fe.date)!=null&&Ne.toDate?fe.date.toDate().toLocaleDateString():"Recently"})]}),d.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["From: ",fe.from]}),d.jsx("p",{className:"text-sm text-gray-700 mt-2",children:fe.message})]}),fe.unread&&d.jsx("span",{className:"ml-4 px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:"New"})]})},fe.id)}),T.length===0&&d.jsx("div",{className:"p-6 text-center text-gray-500",children:"No messages yet"})]})})]}),a==="billing"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Billing & Payments"}),d.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Payment Options"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Choose your preferred payment method for our services."}),d.jsx(Vte,{})]})]}),a==="settings"&&d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Account Settings"}),d.jsxs("div",{className:"bg-white shadow rounded-lg mb-6",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Profile Information"})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),d.jsx("input",{type:"text",value:(C==null?void 0:C.firstName)||"",readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),d.jsx("input",{type:"text",value:(C==null?void 0:C.lastName)||"",readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),d.jsx("input",{type:"email",value:n.email,readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),d.jsx("input",{type:"tel",value:(C==null?void 0:C.phone)||"",readOnly:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50"})]})]}),d.jsx("p",{className:"mt-4 text-sm text-gray-500",children:"To update your profile information, please contact our office."})]})]}),d.jsxs("div",{className:"bg-white shadow rounded-lg",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Change Password"})}),d.jsxs("div",{className:"p-6",children:[ee&&d.jsxs("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded relative",children:[d.jsx(ci,{className:"h-5 w-5 inline mr-2"}),ee]}),ce&&d.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded relative",children:[d.jsx(So,{className:"h-5 w-5 inline mr-2"}),ce]}),d.jsxs("form",{onSubmit:zr,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Password"}),d.jsxs("div",{className:"mt-1 relative",children:[d.jsx("input",{type:$?"text":"password",value:ae.currentPassword,onChange:fe=>q({...ae,currentPassword:fe.target.value}),required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d.jsx("button",{type:"button",onClick:()=>U(!$),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:$?d.jsx(cN,{className:"h-5 w-5 text-gray-400"}):d.jsx(HS,{className:"h-5 w-5 text-gray-400"})})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),d.jsxs("div",{className:"mt-1 relative",children:[d.jsx("input",{type:G?"text":"password",value:ae.newPassword,onChange:fe=>q({...ae,newPassword:fe.target.value}),required:!0,minLength:6,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),d.jsx("button",{type:"button",onClick:()=>V(!G),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:G?d.jsx(cN,{className:"h-5 w-5 text-gray-400"}):d.jsx(HS,{className:"h-5 w-5 text-gray-400"})})]}),d.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Must be at least 6 characters"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),d.jsx("input",{type:"password",value:ae.confirmPassword,onChange:fe=>q({...ae,confirmPassword:fe.target.value}),required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsx("div",{className:"pt-4",children:d.jsxs("button",{type:"submit",className:"flex items-center px-4 py-2 bg-blue-900 text-white rounded-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[d.jsx(R3,{className:"h-4 w-4 mr-2"}),"Update Password"]})})]})]})]})]})]})})]}):d.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:d.jsxs("div",{className:"max-w-md w-full space-y-8",children:[d.jsxs("div",{className:"text-center",children:[d.jsx(ho,{className:"mx-auto h-12 w-12 text-blue-900"}),d.jsx("h1",{className:"mt-6 text-3xl font-bold text-gray-900",children:xe?"Admin Access":"Client Portal Access"}),d.jsx("p",{className:"mt-2 text-gray-600",children:"Law Offices of Rozsa Gyene"}),d.jsx("p",{className:"text-sm text-gray-500",children:"Estate Planning & Probate"})]}),d.jsxs("div",{className:"mt-8 bg-white py-8 px-4 shadow rounded-lg sm:px-10",children:[p&&d.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded relative",children:p}),l?d.jsxs("form",{className:"space-y-6",onSubmit:Io,children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),d.jsx("input",{name:"firstName",type:"text",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),d.jsx("input",{name:"lastName",type:"text",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email address"}),d.jsx("input",{name:"email",type:"email",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Phone"}),d.jsx("input",{name:"phone",type:"tel",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),d.jsx("input",{name:"password",type:"password",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),d.jsx("input",{name:"confirmPassword",type:"password",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Create Account"}),d.jsxs("div",{className:"text-center",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Already have an account? "}),d.jsx("button",{type:"button",onClick:()=>u(!1),className:"text-sm text-blue-600 hover:text-blue-500",children:"Sign in"})]})]}):d.jsxs("form",{className:"space-y-6",onSubmit:Yi,children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email address"}),d.jsx("input",{name:"email",type:"email",required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Email address"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Password"}),d.jsxs("div",{className:"mt-1 relative",children:[d.jsx("input",{name:"password",type:s?"text":"password",required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Password"}),d.jsx("button",{type:"button",onClick:()=>i(!s),className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:s?d.jsx(cN,{className:"h-5 w-5 text-gray-400"}):d.jsx(HS,{className:"h-5 w-5 text-gray-400"})})]})]}),d.jsx("div",{className:"flex items-center justify-between",children:d.jsx("a",{href:"#",className:"text-sm text-blue-600 hover:text-blue-500",children:"Forgot your password?"})}),d.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-900 hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sign in"}),!xe&&d.jsxs("div",{className:"text-center",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Don't have an account? "}),d.jsx("button",{type:"button",onClick:()=>u(!0),className:"text-sm text-blue-600 hover:text-blue-500",children:"Sign up"})]})]}),!xe&&d.jsx("div",{className:"mt-6 text-center",children:d.jsx("a",{href:"/admin",className:"text-xs text-gray-500 hover:text-gray-700",children:"Admin Access"})})]})]})})},J1e=()=>window.location.pathname==="/book"?d.jsx(aG,{}):d.jsx(Q1e,{});qN.createRoot(document.getElementById("root")).render(d.jsx(H.StrictMode,{children:d.jsx(J1e,{})}));export{sAe as a,Pte as c,w6 as g,ns as h};
